var e,t,n=Object.defineProperty,a=(e,t,a)=>((e,t,a)=>t in e?n(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a)(e,"symbol"!=typeof t?t+"":t,a);import{a as s,b as r,g as i,r as l,R as o,L as c,u as d,c as u,d as m,N as p,e as f,f as h,h as g,H as x,i as y,j as b}from"./react-vendor-C5RsYY5e.js";import{_ as v,E as N,a as w,u as k,w as E}from"./utils-DHcxWcvv.js";import{_ as j,C,r as _,S as T,a as S,F as A,g as I,b as D,c as O,d as R,i as P,p as M,u as U,e as L,f as F,h as B,G as $,j as G,k as V,l as z,m as W,n as q,s as H,o as K,q as Y,w as J,t as Z,v as Q,x as X,y as ee,z as te,A as ne,B as ae,D as se,E as re,H as ie}from"./firebase-B8V1oFvZ.js";import{L as le,S as oe,F as ce,a as de,b as ue,P as me,c as pe,d as fe,C as he,B as ge,e as xe,f as ye,U as be,g as ve,A as Ne,h as we,M as ke,i as Ee,j as je,T as Ce,R as _e,H as Te,k as Se,X as Ae,l as Ie,m as De,n as Oe,o as Re,p as Pe,q as Me}from"./ui-vendor-CvLLZSC5.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var Ue,Le,Fe={exports:{}},Be={};var $e,Ge,Ve,ze,We=(Le||(Le=1,Fe.exports=function(){if(Ue)return Be;Ue=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(t,n,a){var s=null;if(void 0!==a&&(s=""+a),void 0!==n.key&&(s=""+n.key),"key"in n)for(var r in a={},n)"key"!==r&&(a[r]=n[r]);else a=n;return n=a.ref,{$$typeof:e,type:t,key:s,ref:void 0!==n?n:null,props:a}}return Be.Fragment=t,Be.jsx=n,Be.jsxs=n,Be}()),Fe.exports),qe={exports:{}},He={},Ke={exports:{}},Ye={};function Je(){return Ge||(Ge=1,Ke.exports=($e||($e=1,function(e){function t(e,t){var n=e.length;e.push(t);e:for(;0<n;){var a=n-1>>>1,r=e[a];if(!(0<s(r,t)))break e;e[a]=t,e[n]=r,n=a}}function n(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var a=0,r=e.length,i=r>>>1;a<i;){var l=2*(a+1)-1,o=e[l],c=l+1,d=e[c];if(0>s(o,n))c<r&&0>s(d,o)?(e[a]=d,e[c]=n,a=c):(e[a]=o,e[l]=n,a=l);else{if(!(c<r&&0>s(d,n)))break e;e[a]=d,e[c]=n,a=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(e.unstable_now=void 0,"object"==typeof performance&&"function"==typeof performance.now){var r=performance;e.unstable_now=function(){return r.now()}}else{var i=Date,l=i.now();e.unstable_now=function(){return i.now()-l}}var o=[],c=[],d=1,u=null,m=3,p=!1,f=!1,h=!1,g=!1,x="function"==typeof setTimeout?setTimeout:null,y="function"==typeof clearTimeout?clearTimeout:null,b="undefined"!=typeof setImmediate?setImmediate:null;function v(e){for(var s=n(c);null!==s;){if(null===s.callback)a(c);else{if(!(s.startTime<=e))break;a(c),s.sortIndex=s.expirationTime,t(o,s)}s=n(c)}}function N(e){if(h=!1,v(e),!f)if(null!==n(o))f=!0,k||(k=!0,w());else{var t=n(c);null!==t&&I(N,t.startTime-e)}}var w,k=!1,E=-1,j=5,C=-1;function _(){return!(!g&&e.unstable_now()-C<j)}function T(){if(g=!1,k){var t=e.unstable_now();C=t;var s=!0;try{e:{f=!1,h&&(h=!1,y(E),E=-1),p=!0;var r=m;try{t:{for(v(t),u=n(o);null!==u&&!(u.expirationTime>t&&_());){var i=u.callback;if("function"==typeof i){u.callback=null,m=u.priorityLevel;var l=i(u.expirationTime<=t);if(t=e.unstable_now(),"function"==typeof l){u.callback=l,v(t),s=!0;break t}u===n(o)&&a(o),v(t)}else a(o);u=n(o)}if(null!==u)s=!0;else{var d=n(c);null!==d&&I(N,d.startTime-t),s=!1}}break e}finally{u=null,m=r,p=!1}s=void 0}}finally{s?w():k=!1}}}if("function"==typeof b)w=function(){b(T)};else if("undefined"!=typeof MessageChannel){var S=new MessageChannel,A=S.port2;S.port1.onmessage=T,w=function(){A.postMessage(null)}}else w=function(){x(T,0)};function I(t,n){E=x(function(){t(e.unstable_now())},n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_forceFrameRate=function(e){0>e||125<e||(j=0<e?Math.floor(1e3/e):5)},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_next=function(e){switch(m){case 1:case 2:case 3:var t=3;break;default:t=m}var n=m;m=t;try{return e()}finally{m=n}},e.unstable_requestPaint=function(){g=!0},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=m;m=e;try{return t()}finally{m=n}},e.unstable_scheduleCallback=function(a,s,r){var i=e.unstable_now();switch(r="object"==typeof r&&null!==r&&"number"==typeof(r=r.delay)&&0<r?i+r:i,a){case 1:var l=-1;break;case 2:l=250;break;case 5:l=1073741823;break;case 4:l=1e4;break;default:l=5e3}return a={id:d++,callback:s,priorityLevel:a,startTime:r,expirationTime:l=r+l,sortIndex:-1},r>i?(a.sortIndex=r,t(c,a),null===n(o)&&a===n(c)&&(h?(y(E),E=-1):h=!0,I(N,r-i))):(a.sortIndex=l,t(o,a),f||p||(f=!0,k||(k=!0,w()))),a},e.unstable_shouldYield=_,e.unstable_wrapCallback=function(e){var t=m;return function(){var n=m;m=t;try{return e.apply(this,arguments)}finally{m=n}}}}(Ye)),Ye)),Ke.exports}
/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function Ze(){if(Ve)return He;Ve=1;var e=Je(),t=s(),n=r();function a(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function o(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function c(e){if(l(e)!==e)throw Error(a(188))}function d(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=d(e)))return t;e=e.sibling}return null}var u=Object.assign,m=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),f=Symbol.for("react.portal"),h=Symbol.for("react.fragment"),g=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),y=Symbol.for("react.provider"),b=Symbol.for("react.consumer"),v=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),k=Symbol.for("react.suspense_list"),E=Symbol.for("react.memo"),j=Symbol.for("react.lazy"),C=Symbol.for("react.activity"),_=Symbol.for("react.memo_cache_sentinel"),T=Symbol.iterator;function S(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=T&&e[T]||e["@@iterator"])?e:null}var A=Symbol.for("react.client.reference");function I(e){if(null==e)return null;if("function"==typeof e)return e.$$typeof===A?null:e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case h:return"Fragment";case x:return"Profiler";case g:return"StrictMode";case w:return"Suspense";case k:return"SuspenseList";case C:return"Activity"}if("object"==typeof e)switch(e.$$typeof){case f:return"Portal";case v:return(e.displayName||"Context")+".Provider";case b:return(e._context.displayName||"Context")+".Consumer";case N:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case E:return null!==(t=e.displayName||null)?t:I(e.type)||"Memo";case j:t=e._payload,e=e._init;try{return I(e(t))}catch(n){}}return null}var D=Array.isArray,O=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,R=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,P={pending:!1,data:null,method:null,action:null},M=[],U=-1;function L(e){return{current:e}}function F(e){0>U||(e.current=M[U],M[U]=null,U--)}function B(e,t){U++,M[U]=e.current,e.current=t}var $=L(null),G=L(null),V=L(null),z=L(null);function W(e,t){switch(B(V,t),B(G,e),B($,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?iu(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=lu(t=iu(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}F($),B($,e)}function q(){F($),F(G),F(V)}function H(e){null!==e.memoizedState&&B(z,e);var t=$.current,n=lu(t,e.type);t!==n&&(B(G,e),B($,n))}function K(e){G.current===e&&(F($),F(G)),z.current===e&&(F(z),Ju._currentValue=P)}var Y=Object.prototype.hasOwnProperty,J=e.unstable_scheduleCallback,Z=e.unstable_cancelCallback,Q=e.unstable_shouldYield,X=e.unstable_requestPaint,ee=e.unstable_now,te=e.unstable_getCurrentPriorityLevel,ne=e.unstable_ImmediatePriority,ae=e.unstable_UserBlockingPriority,se=e.unstable_NormalPriority,re=e.unstable_LowPriority,ie=e.unstable_IdlePriority,le=e.log,oe=e.unstable_setDisableYieldValue,ce=null,de=null;function ue(e){if("function"==typeof le&&oe(e),de&&"function"==typeof de.setStrictMode)try{de.setStrictMode(ce,e)}catch(t){}}var me=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(pe(e)/fe|0)|0},pe=Math.log,fe=Math.LN2;var he=256,ge=4194304;function xe(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194048&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function ye(e,t,n){var a=e.pendingLanes;if(0===a)return 0;var s=0,r=e.suspendedLanes,i=e.pingedLanes;e=e.warmLanes;var l=134217727&a;return 0!==l?0!==(a=l&~r)?s=xe(a):0!==(i&=l)?s=xe(i):n||0!==(n=l&~e)&&(s=xe(n)):0!==(l=a&~r)?s=xe(l):0!==i?s=xe(i):n||0!==(n=a&~e)&&(s=xe(n)),0===s?0:0!==t&&t!==s&&0===(t&r)&&((r=s&-s)>=(n=t&-t)||32===r&&4194048&n)?t:s}function be(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function ve(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Ne(){var e=he;return!(4194048&(he<<=1))&&(he=256),e}function we(){var e=ge;return!(62914560&(ge<<=1))&&(ge=4194304),e}function ke(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ee(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function je(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var a=31-me(t);e.entangledLanes|=t,e.entanglements[a]=1073741824|e.entanglements[a]|4194090&n}function Ce(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var a=31-me(n),s=1<<a;s&t|e[a]&t&&(e[a]|=t),n&=~s}}function _e(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Te(e){return 2<(e&=-e)?8<e?134217727&e?32:268435456:8:2}function Se(){var e=R.p;return 0!==e?e:void 0===(e=window.event)?32:um(e.type)}var Ae=Math.random().toString(36).slice(2),Ie="__reactFiber$"+Ae,De="__reactProps$"+Ae,Oe="__reactContainer$"+Ae,Re="__reactEvents$"+Ae,Pe="__reactListeners$"+Ae,Me="__reactHandles$"+Ae,Ue="__reactResources$"+Ae,Le="__reactMarker$"+Ae;function Fe(e){delete e[Ie],delete e[De],delete e[Re],delete e[Pe],delete e[Me]}function Be(e){var t=e[Ie];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Oe]||n[Ie]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Nu(e);null!==e;){if(n=e[Ie])return n;e=Nu(e)}return t}n=(e=n).parentNode}return null}function $e(e){if(e=e[Ie]||e[Oe]){var t=e.tag;if(5===t||6===t||13===t||26===t||27===t||3===t)return e}return null}function Ge(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(a(33))}function ze(e){var t=e[Ue];return t||(t=e[Ue]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function We(e){e[Le]=!0}var qe=new Set,Ke={};function Ye(e,t){Ze(e,t),Ze(e+"Capture",t)}function Ze(e,t){for(Ke[e]=t,e=0;e<t.length;e++)qe.add(t[e])}var Qe,Xe,et=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),tt={},nt={};function at(e,t,n){if(s=t,Y.call(nt,s)||!Y.call(tt,s)&&(et.test(s)?nt[s]=!0:(tt[s]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var a=t.toLowerCase().slice(0,5);if("data-"!==a&&"aria-"!==a)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var s}function st(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function rt(e,t,n,a){if(null===a)e.removeAttribute(n);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+a)}}function it(e){if(void 0===Qe)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Qe=t&&t[1]||"",Xe=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+Qe+e+Xe}var lt=!1;function ot(e,t){if(!e||lt)return"";lt=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var a={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(s){var a=s}Reflect.construct(e,[],n)}else{try{n.call()}catch(r){a=r}e.call(n.prototype)}}else{try{throw Error()}catch(i){a=i}(n=e())&&"function"==typeof n.catch&&n.catch(function(){})}}catch(l){if(l&&a&&"string"==typeof l.stack)return[l.stack,a.stack]}return[null,null]}};a.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var s=Object.getOwnPropertyDescriptor(a.DetermineComponentFrameRoot,"name");s&&s.configurable&&Object.defineProperty(a.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var r=a.DetermineComponentFrameRoot(),i=r[0],l=r[1];if(i&&l){var o=i.split("\n"),c=l.split("\n");for(s=a=0;a<o.length&&!o[a].includes("DetermineComponentFrameRoot");)a++;for(;s<c.length&&!c[s].includes("DetermineComponentFrameRoot");)s++;if(a===o.length||s===c.length)for(a=o.length-1,s=c.length-1;1<=a&&0<=s&&o[a]!==c[s];)s--;for(;1<=a&&0<=s;a--,s--)if(o[a]!==c[s]){if(1!==a||1!==s)do{if(a--,0>--s||o[a]!==c[s]){var d="\n"+o[a].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}}while(1<=a&&0<=s);break}}}finally{lt=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?it(n):""}function ct(e){switch(e.tag){case 26:case 27:case 5:return it(e.type);case 16:return it("Lazy");case 13:return it("Suspense");case 19:return it("SuspenseList");case 0:case 15:return ot(e.type,!1);case 11:return ot(e.type.render,!1);case 1:return ot(e.type,!0);case 31:return it("Activity");default:return""}}function dt(e){try{var t="";do{t+=ct(e),e=e.return}while(e);return t}catch(n){return"\nError generating stack: "+n.message+"\n"+n.stack}}function ut(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function mt(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function pt(e){e._valueTracker||(e._valueTracker=function(e){var t=mt(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var s=n.get,r=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(e){a=""+e,r.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return a},setValue:function(e){a=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function ft(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),a="";return e&&(a=mt(e)?e.checked?"true":"false":e.value),(e=a)!==n&&(t.setValue(e),!0)}function ht(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var gt=/[\n"\\]/g;function xt(e){return e.replace(gt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function yt(e,t,n,a,s,r,i,l){e.name="",null!=i&&"function"!=typeof i&&"symbol"!=typeof i&&"boolean"!=typeof i?e.type=i:e.removeAttribute("type"),null!=t?"number"===i?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ut(t)):e.value!==""+ut(t)&&(e.value=""+ut(t)):"submit"!==i&&"reset"!==i||e.removeAttribute("value"),null!=t?vt(e,i,ut(t)):null!=n?vt(e,i,ut(n)):null!=a&&e.removeAttribute("value"),null==s&&null!=r&&(e.defaultChecked=!!r),null!=s&&(e.checked=s&&"function"!=typeof s&&"symbol"!=typeof s),null!=l&&"function"!=typeof l&&"symbol"!=typeof l&&"boolean"!=typeof l?e.name=""+ut(l):e.removeAttribute("name")}function bt(e,t,n,a,s,r,i,l){if(null!=r&&"function"!=typeof r&&"symbol"!=typeof r&&"boolean"!=typeof r&&(e.type=r),null!=t||null!=n){if(("submit"===r||"reset"===r)&&null==t)return;n=null!=n?""+ut(n):"",t=null!=t?""+ut(t):n,l||t===e.value||(e.value=t),e.defaultValue=t}a="function"!=typeof(a=null!=a?a:s)&&"symbol"!=typeof a&&!!a,e.checked=l?e.checked:!!a,e.defaultChecked=!!a,null!=i&&"function"!=typeof i&&"symbol"!=typeof i&&"boolean"!=typeof i&&(e.name=i)}function vt(e,t,n){"number"===t&&ht(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function Nt(e,t,n,a){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&a&&(e[n].defaultSelected=!0)}else{for(n=""+ut(n),t=null,s=0;s<e.length;s++){if(e[s].value===n)return e[s].selected=!0,void(a&&(e[s].defaultSelected=!0));null!==t||e[s].disabled||(t=e[s])}null!==t&&(t.selected=!0)}}function wt(e,t,n){null==t||((t=""+ut(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+ut(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function kt(e,t,n,s){if(null==t){if(null!=s){if(null!=n)throw Error(a(92));if(D(s)){if(1<s.length)throw Error(a(93));s=s[0]}n=s}null==n&&(n=""),t=n}n=ut(t),e.defaultValue=n,(s=e.textContent)===n&&""!==s&&null!==s&&(e.value=s)}function Et(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var jt=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ct(e,t,n){var a=0===t.indexOf("--");null==n||"boolean"==typeof n||""===n?a?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":a?e.setProperty(t,n):"number"!=typeof n||0===n||jt.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function _t(e,t,n){if(null!=t&&"object"!=typeof t)throw Error(a(62));if(e=e.style,null!=n){for(var s in n)!n.hasOwnProperty(s)||null!=t&&t.hasOwnProperty(s)||(0===s.indexOf("--")?e.setProperty(s,""):"float"===s?e.cssFloat="":e[s]="");for(var r in t)s=t[r],t.hasOwnProperty(r)&&n[r]!==s&&Ct(e,r,s)}else for(var i in t)t.hasOwnProperty(i)&&Ct(e,i,t[i])}function Tt(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var St=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),At=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function It(e){return At.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var Dt=null;function Ot(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Rt=null,Pt=null;function Mt(e){var t=$e(e);if(t&&(e=t.stateNode)){var n=e[De]||null;e:switch(e=t.stateNode,t.type){case"input":if(yt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+xt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var s=n[t];if(s!==e&&s.form===e.form){var r=s[De]||null;if(!r)throw Error(a(90));yt(s,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name)}}for(t=0;t<n.length;t++)(s=n[t]).form===e.form&&ft(s)}break e;case"textarea":wt(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&Nt(e,!!n.multiple,t,!1)}}}var Ut=!1;function Lt(e,t,n){if(Ut)return e(t,n);Ut=!0;try{return e(t)}finally{if(Ut=!1,(null!==Rt||null!==Pt)&&(Vc(),Rt&&(t=Rt,e=Pt,Pt=Rt=null,Mt(t),e)))for(t=0;t<e.length;t++)Mt(e[t])}}function Ft(e,t){var n=e.stateNode;if(null===n)return null;var s=n[De]||null;if(null===s)return null;n=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(s=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!s;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(a(231,t,typeof n));return n}var Bt=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),$t=!1;if(Bt)try{var Gt={};Object.defineProperty(Gt,"passive",{get:function(){$t=!0}}),window.addEventListener("test",Gt,Gt),window.removeEventListener("test",Gt,Gt)}catch(Pm){$t=!1}var Vt=null,zt=null,Wt=null;function qt(){if(Wt)return Wt;var e,t,n=zt,a=n.length,s="value"in Vt?Vt.value:Vt.textContent,r=s.length;for(e=0;e<a&&n[e]===s[e];e++);var i=a-e;for(t=1;t<=i&&n[a-t]===s[r-t];t++);return Wt=s.slice(e,1<t?1-t:void 0)}function Ht(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Kt(){return!0}function Yt(){return!1}function Jt(e){function t(t,n,a,s,r){for(var i in this._reactName=t,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=r,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(s):s[i]);return this.isDefaultPrevented=(null!=s.defaultPrevented?s.defaultPrevented:!1===s.returnValue)?Kt:Yt,this.isPropagationStopped=Yt,this}return u(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Kt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Kt)},persist:function(){},isPersistent:Kt}),t}var Zt,Qt,Xt,en={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},tn=Jt(en),nn=u({},en,{view:0,detail:0}),an=Jt(nn),sn=u({},nn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Xt&&(Xt&&"mousemove"===e.type?(Zt=e.screenX-Xt.screenX,Qt=e.screenY-Xt.screenY):Qt=Zt=0,Xt=e),Zt)},movementY:function(e){return"movementY"in e?e.movementY:Qt}}),rn=Jt(sn),ln=Jt(u({},sn,{dataTransfer:0})),on=Jt(u({},nn,{relatedTarget:0})),cn=Jt(u({},en,{animationName:0,elapsedTime:0,pseudoElement:0})),dn=Jt(u({},en,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),un=Jt(u({},en,{data:0})),mn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},pn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function hn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=fn[e])&&!!t[e]}function gn(){return hn}var xn=Jt(u({},nn,{key:function(e){if(e.key){var t=mn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Ht(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?pn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gn,charCode:function(e){return"keypress"===e.type?Ht(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Ht(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),yn=Jt(u({},sn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),bn=Jt(u({},nn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gn})),vn=Jt(u({},en,{propertyName:0,elapsedTime:0,pseudoElement:0})),Nn=Jt(u({},sn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),wn=Jt(u({},en,{newState:0,oldState:0})),kn=[9,13,27,32],En=Bt&&"CompositionEvent"in window,jn=null;Bt&&"documentMode"in document&&(jn=document.documentMode);var Cn=Bt&&"TextEvent"in window&&!jn,_n=Bt&&(!En||jn&&8<jn&&11>=jn),Tn=String.fromCharCode(32),Sn=!1;function An(e,t){switch(e){case"keyup":return-1!==kn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function In(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Dn=!1;var On={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Rn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!On[e.type]:"textarea"===t}function Pn(e,t,n,a){Rt?Pt?Pt.push(a):Pt=[a]:Rt=a,0<(t=qd(t,"onChange")).length&&(n=new tn("onChange","change",null,n,a),e.push({event:n,listeners:t}))}var Mn=null,Un=null;function Ln(e){Ld(e,0)}function Fn(e){if(ft(Ge(e)))return e}function Bn(e,t){if("change"===e)return t}var $n=!1;if(Bt){var Gn;if(Bt){var Vn="oninput"in document;if(!Vn){var zn=document.createElement("div");zn.setAttribute("oninput","return;"),Vn="function"==typeof zn.oninput}Gn=Vn}else Gn=!1;$n=Gn&&(!document.documentMode||9<document.documentMode)}function Wn(){Mn&&(Mn.detachEvent("onpropertychange",qn),Un=Mn=null)}function qn(e){if("value"===e.propertyName&&Fn(Un)){var t=[];Pn(t,Un,e,Ot(e)),Lt(Ln,t)}}function Hn(e,t,n){"focusin"===e?(Wn(),Un=n,(Mn=t).attachEvent("onpropertychange",qn)):"focusout"===e&&Wn()}function Kn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Fn(Un)}function Yn(e,t){if("click"===e)return Fn(t)}function Jn(e,t){if("input"===e||"change"===e)return Fn(t)}var Zn="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function Qn(e,t){if(Zn(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(a=0;a<n.length;a++){var s=n[a];if(!Y.call(t,s)||!Zn(e[s],t[s]))return!1}return!0}function Xn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ea(e,t){var n,a=Xn(e);for(e=0;a;){if(3===a.nodeType){if(n=e+a.textContent.length,e<=t&&n>=t)return{node:a,offset:t-e};e=n}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=Xn(a)}}function ta(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ta(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function na(e){for(var t=ht((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(a){n=!1}if(!n)break;t=ht((e=t.contentWindow).document)}return t}function aa(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var sa=Bt&&"documentMode"in document&&11>=document.documentMode,ra=null,ia=null,la=null,oa=!1;function ca(e,t,n){var a=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;oa||null==ra||ra!==ht(a)||("selectionStart"in(a=ra)&&aa(a)?a={start:a.selectionStart,end:a.selectionEnd}:a={anchorNode:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset},la&&Qn(la,a)||(la=a,0<(a=qd(ia,"onSelect")).length&&(t=new tn("onSelect","select",null,t,n),e.push({event:t,listeners:a}),t.target=ra)))}function da(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ua={animationend:da("Animation","AnimationEnd"),animationiteration:da("Animation","AnimationIteration"),animationstart:da("Animation","AnimationStart"),transitionrun:da("Transition","TransitionRun"),transitionstart:da("Transition","TransitionStart"),transitioncancel:da("Transition","TransitionCancel"),transitionend:da("Transition","TransitionEnd")},ma={},pa={};function fa(e){if(ma[e])return ma[e];if(!ua[e])return e;var t,n=ua[e];for(t in n)if(n.hasOwnProperty(t)&&t in pa)return ma[e]=n[t];return e}Bt&&(pa=document.createElement("div").style,"AnimationEvent"in window||(delete ua.animationend.animation,delete ua.animationiteration.animation,delete ua.animationstart.animation),"TransitionEvent"in window||delete ua.transitionend.transition);var ha=fa("animationend"),ga=fa("animationiteration"),xa=fa("animationstart"),ya=fa("transitionrun"),ba=fa("transitionstart"),va=fa("transitioncancel"),Na=fa("transitionend"),wa=new Map,ka="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ea(e,t){wa.set(e,t),Ye(t,[e])}ka.push("scrollEnd");var ja=new WeakMap;function Ca(e,t){if("object"==typeof e&&null!==e){var n=ja.get(e);return void 0!==n?n:(t={value:e,source:t,stack:dt(t)},ja.set(e,t),t)}return{value:e,source:t,stack:dt(t)}}var _a=[],Ta=0,Sa=0;function Aa(){for(var e=Ta,t=Sa=Ta=0;t<e;){var n=_a[t];_a[t++]=null;var a=_a[t];_a[t++]=null;var s=_a[t];_a[t++]=null;var r=_a[t];if(_a[t++]=null,null!==a&&null!==s){var i=a.pending;null===i?s.next=s:(s.next=i.next,i.next=s),a.pending=s}0!==r&&Ra(n,s,r)}}function Ia(e,t,n,a){_a[Ta++]=e,_a[Ta++]=t,_a[Ta++]=n,_a[Ta++]=a,Sa|=a,e.lanes|=a,null!==(e=e.alternate)&&(e.lanes|=a)}function Da(e,t,n,a){return Ia(e,t,n,a),Pa(e)}function Oa(e,t){return Ia(e,null,null,t),Pa(e)}function Ra(e,t,n){e.lanes|=n;var a=e.alternate;null!==a&&(a.lanes|=n);for(var s=!1,r=e.return;null!==r;)r.childLanes|=n,null!==(a=r.alternate)&&(a.childLanes|=n),22===r.tag&&(null===(e=r.stateNode)||1&e._visibility||(s=!0)),e=r,r=r.return;return 3===e.tag?(r=e.stateNode,s&&null!==t&&(s=31-me(n),null===(a=(e=r.hiddenUpdates)[s])?e[s]=[t]:a.push(t),t.lane=536870912|n),r):null}function Pa(e){if(50<Rc)throw Rc=0,Pc=null,Error(a(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Ma={};function Ua(e,t,n,a){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function La(e,t,n,a){return new Ua(e,t,n,a)}function Fa(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ba(e,t){var n=e.alternate;return null===n?((n=La(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function $a(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Ga(e,t,n,s,r,i){var l=0;if(s=e,"function"==typeof e)Fa(e)&&(l=1);else if("string"==typeof e)l=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!=typeof t.precedence||"string"!=typeof t.href||""===t.href)break;return!0;case"link":if("string"!=typeof t.rel||"string"!=typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"==typeof t.precedence&&null==e);case"script":if(t.async&&"function"!=typeof t.async&&"symbol"!=typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"==typeof t.src)return!0}return!1}(e,n,$.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case C:return(e=La(31,n,t,r)).elementType=C,e.lanes=i,e;case h:return Va(n.children,r,i,t);case g:l=8,r|=24;break;case x:return(e=La(12,n,t,2|r)).elementType=x,e.lanes=i,e;case w:return(e=La(13,n,t,r)).elementType=w,e.lanes=i,e;case k:return(e=La(19,n,t,r)).elementType=k,e.lanes=i,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case y:case v:l=10;break e;case b:l=9;break e;case N:l=11;break e;case E:l=14;break e;case j:l=16,s=null;break e}l=29,n=Error(a(130,null===e?"null":typeof e,"")),s=null}return(t=La(l,n,t,r)).elementType=e,t.type=s,t.lanes=i,t}function Va(e,t,n,a){return(e=La(7,e,a,t)).lanes=n,e}function za(e,t,n){return(e=La(6,e,null,t)).lanes=n,e}function Wa(e,t,n){return(t=La(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var qa=[],Ha=0,Ka=null,Ya=0,Ja=[],Za=0,Qa=null,Xa=1,es="";function ts(e,t){qa[Ha++]=Ya,qa[Ha++]=Ka,Ka=e,Ya=t}function ns(e,t,n){Ja[Za++]=Xa,Ja[Za++]=es,Ja[Za++]=Qa,Qa=e;var a=Xa;e=es;var s=32-me(a)-1;a&=~(1<<s),n+=1;var r=32-me(t)+s;if(30<r){var i=s-s%5;r=(a&(1<<i)-1).toString(32),a>>=i,s-=i,Xa=1<<32-me(t)+s|n<<s|a,es=r+e}else Xa=1<<r|n<<s|a,es=e}function as(e){null!==e.return&&(ts(e,1),ns(e,1,0))}function ss(e){for(;e===Ka;)Ka=qa[--Ha],qa[Ha]=null,Ya=qa[--Ha],qa[Ha]=null;for(;e===Qa;)Qa=Ja[--Za],Ja[Za]=null,es=Ja[--Za],Ja[Za]=null,Xa=Ja[--Za],Ja[Za]=null}var rs=null,is=null,ls=!1,os=null,cs=!1,ds=Error(a(519));function us(e){throw xs(Ca(Error(a(418,"")),e)),ds}function ms(e){var t=e.stateNode,n=e.type,a=e.memoizedProps;switch(t[Ie]=e,t[De]=a,n){case"dialog":Fd("cancel",t),Fd("close",t);break;case"iframe":case"object":case"embed":Fd("load",t);break;case"video":case"audio":for(n=0;n<Md.length;n++)Fd(Md[n],t);break;case"source":Fd("error",t);break;case"img":case"image":case"link":Fd("error",t),Fd("load",t);break;case"details":Fd("toggle",t);break;case"input":Fd("invalid",t),bt(t,a.value,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name,!0),pt(t);break;case"select":Fd("invalid",t);break;case"textarea":Fd("invalid",t),kt(t,a.value,a.defaultValue,a.children),pt(t)}"string"!=typeof(n=a.children)&&"number"!=typeof n&&"bigint"!=typeof n||t.textContent===""+n||!0===a.suppressHydrationWarning||Qd(t.textContent,n)?(null!=a.popover&&(Fd("beforetoggle",t),Fd("toggle",t)),null!=a.onScroll&&Fd("scroll",t),null!=a.onScrollEnd&&Fd("scrollend",t),null!=a.onClick&&(t.onclick=Xd),t=!0):t=!1,t||us(e)}function ps(e){for(rs=e.return;rs;)switch(rs.tag){case 5:case 13:return void(cs=!1);case 27:case 3:return void(cs=!0);default:rs=rs.return}}function fs(e){if(e!==rs)return!1;if(!ls)return ps(e),ls=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||ou(e.type,e.memoizedProps)),t=!t),t&&is&&us(e),ps(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,n=0;e;){if(8===e.nodeType)if("/$"===(t=e.data)){if(0===n){is=bu(e.nextSibling);break e}n--}else"$"!==t&&"$!"!==t&&"$?"!==t||n++;e=e.nextSibling}is=null}}else 27===n?(n=is,hu(e.type)?(e=vu,vu=null,is=e):is=n):is=rs?bu(e.stateNode.nextSibling):null;return!0}function hs(){is=rs=null,ls=!1}function gs(){var e=os;return null!==e&&(null===Nc?Nc=e:Nc.push.apply(Nc,e),os=null),e}function xs(e){null===os?os=[e]:os.push(e)}var ys=L(null),bs=null,vs=null;function Ns(e,t,n){B(ys,t._currentValue),t._currentValue=n}function ws(e){e._currentValue=ys.current,F(ys)}function ks(e,t,n){for(;null!==e;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==a&&(a.childLanes|=t)):null!==a&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===n)break;e=e.return}}function Es(e,t,n,s){var r=e.child;for(null!==r&&(r.return=e);null!==r;){var i=r.dependencies;if(null!==i){var l=r.child;i=i.firstContext;e:for(;null!==i;){var o=i;i=r;for(var c=0;c<t.length;c++)if(o.context===t[c]){i.lanes|=n,null!==(o=i.alternate)&&(o.lanes|=n),ks(i.return,n,e),s||(l=null);break e}i=o.next}}else if(18===r.tag){if(null===(l=r.return))throw Error(a(341));l.lanes|=n,null!==(i=l.alternate)&&(i.lanes|=n),ks(l,n,e),l=null}else l=r.child;if(null!==l)l.return=r;else for(l=r;null!==l;){if(l===e){l=null;break}if(null!==(r=l.sibling)){r.return=l.return,l=r;break}l=l.return}r=l}}function js(e,t,n,s){e=null;for(var r=t,i=!1;null!==r;){if(!i)if(524288&r.flags)i=!0;else if(262144&r.flags)break;if(10===r.tag){var l=r.alternate;if(null===l)throw Error(a(387));if(null!==(l=l.memoizedProps)){var o=r.type;Zn(r.pendingProps.value,l.value)||(null!==e?e.push(o):e=[o])}}else if(r===z.current){if(null===(l=r.alternate))throw Error(a(387));l.memoizedState.memoizedState!==r.memoizedState.memoizedState&&(null!==e?e.push(Ju):e=[Ju])}r=r.return}null!==e&&Es(t,e,n,s),t.flags|=262144}function Cs(e){for(e=e.firstContext;null!==e;){if(!Zn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function _s(e){bs=e,vs=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Ts(e){return As(bs,e)}function Ss(e,t){return null===bs&&_s(e),As(e,t)}function As(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===vs){if(null===e)throw Error(a(308));vs=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else vs=vs.next=t;return n}var Is="undefined"!=typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Ds=e.unstable_scheduleCallback,Os=e.unstable_NormalPriority,Rs={$$typeof:v,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ps(){return{controller:new Is,data:new Map,refCount:0}}function Ms(e){e.refCount--,0===e.refCount&&Ds(Os,function(){e.controller.abort()})}var Us=null,Ls=0,Fs=0,Bs=null;function $s(){if(0===--Ls&&null!==Us){null!==Bs&&(Bs.status="fulfilled");var e=Us;Us=null,Fs=0,Bs=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Gs=O.S;O.S=function(e,t){"object"==typeof t&&null!==t&&"function"==typeof t.then&&function(e,t){if(null===Us){var n=Us=[];Ls=0,Fs=Id(),Bs={status:"pending",value:void 0,then:function(e){n.push(e)}}}Ls++,t.then($s,$s)}(0,t),null!==Gs&&Gs(e,t)};var Vs=L(null);function zs(){var e=Vs.current;return null!==e?e:rc.pooledCache}function Ws(e,t){B(Vs,null===t?Vs.current:t.pool)}function qs(){var e=zs();return null===e?null:{parent:Rs._currentValue,pool:e}}var Hs=Error(a(460)),Ks=Error(a(474)),Ys=Error(a(542)),Js={then:function(){}};function Zs(e){return"fulfilled"===(e=e.status)||"rejected"===e}function Qs(){}function Xs(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(Qs,Qs),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw nr(e=t.reason),e;default:if("string"==typeof t.status)t.then(Qs,Qs);else{if(null!==(e=rc)&&100<e.shellSuspendCounter)throw Error(a(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw nr(e=t.reason),e}throw er=t,Hs}}var er=null;function tr(){if(null===er)throw Error(a(459));var e=er;return er=null,e}function nr(e){if(e===Hs||e===Ys)throw Error(a(483))}var ar=!1;function sr(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function rr(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ir(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function lr(e,t,n){var a=e.updateQueue;if(null===a)return null;if(a=a.shared,2&sc){var s=a.pending;return null===s?t.next=t:(t.next=s.next,s.next=t),a.pending=t,t=Pa(e),Ra(e,null,n),t}return Ia(e,a,t,n),Pa(e)}function or(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,4194048&n)){var a=t.lanes;n|=a&=e.pendingLanes,t.lanes=n,Ce(e,n)}}function cr(e,t){var n=e.updateQueue,a=e.alternate;if(null!==a&&n===(a=a.updateQueue)){var s=null,r=null;if(null!==(n=n.firstBaseUpdate)){do{var i={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===r?s=r=i:r=r.next=i,n=n.next}while(null!==n);null===r?s=r=t:r=r.next=t}else s=r=t;return n={baseState:a.baseState,firstBaseUpdate:s,lastBaseUpdate:r,shared:a.shared,callbacks:a.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var dr=!1;function ur(){if(dr){if(null!==Bs)throw Bs}}function mr(e,t,n,a){dr=!1;var s=e.updateQueue;ar=!1;var r=s.firstBaseUpdate,i=s.lastBaseUpdate,l=s.shared.pending;if(null!==l){s.shared.pending=null;var o=l,c=o.next;o.next=null,null===i?r=c:i.next=c,i=o;var d=e.alternate;null!==d&&((l=(d=d.updateQueue).lastBaseUpdate)!==i&&(null===l?d.firstBaseUpdate=c:l.next=c,d.lastBaseUpdate=o))}if(null!==r){var m=s.baseState;for(i=0,d=c=o=null,l=r;;){var p=-536870913&l.lane,f=p!==l.lane;if(f?(lc&p)===p:(a&p)===p){0!==p&&p===Fs&&(dr=!0),null!==d&&(d=d.next={lane:0,tag:l.tag,payload:l.payload,callback:null,next:null});e:{var h=e,g=l;p=t;var x=n;switch(g.tag){case 1:if("function"==typeof(h=g.payload)){m=h.call(x,m,p);break e}m=h;break e;case 3:h.flags=-65537&h.flags|128;case 0:if(null==(p="function"==typeof(h=g.payload)?h.call(x,m,p):h))break e;m=u({},m,p);break e;case 2:ar=!0}}null!==(p=l.callback)&&(e.flags|=64,f&&(e.flags|=8192),null===(f=s.callbacks)?s.callbacks=[p]:f.push(p))}else f={lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},null===d?(c=d=f,o=m):d=d.next=f,i|=p;if(null===(l=l.next)){if(null===(l=s.shared.pending))break;l=(f=l).next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}null===d&&(o=m),s.baseState=o,s.firstBaseUpdate=c,s.lastBaseUpdate=d,null===r&&(s.shared.lanes=0),hc|=i,e.lanes=i,e.memoizedState=m}}function pr(e,t){if("function"!=typeof e)throw Error(a(191,e));e.call(t)}function fr(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)pr(n[e],t)}var hr=L(null),gr=L(0);function xr(e,t){B(gr,e=pc),B(hr,t),pc=e|t.baseLanes}function yr(){B(gr,pc),B(hr,hr.current)}function br(){pc=gr.current,F(hr),F(gr)}var vr=0,Nr=null,wr=null,kr=null,Er=!1,jr=!1,Cr=!1,_r=0,Tr=0,Sr=null,Ar=0;function Ir(){throw Error(a(321))}function Dr(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Zn(e[n],t[n]))return!1;return!0}function Or(e,t,n,a,s,r){return vr=r,Nr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,O.H=null===e||null===e.memoizedState?Hi:Ki,Cr=!1,r=n(a,s),Cr=!1,jr&&(r=Pr(t,n,a,s)),Rr(e),r}function Rr(e){O.H=qi;var t=null!==wr&&null!==wr.next;if(vr=0,kr=wr=Nr=null,Er=!1,Tr=0,Sr=null,t)throw Error(a(300));null===e||Tl||null!==(e=e.dependencies)&&Cs(e)&&(Tl=!0)}function Pr(e,t,n,s){Nr=e;var r=0;do{if(jr&&(Sr=null),Tr=0,jr=!1,25<=r)throw Error(a(301));if(r+=1,kr=wr=null,null!=e.updateQueue){var i=e.updateQueue;i.lastEffect=null,i.events=null,i.stores=null,null!=i.memoCache&&(i.memoCache.index=0)}O.H=Yi,i=t(n,s)}while(jr);return i}function Mr(){var e=O.H,t=e.useState()[0];return t="function"==typeof t.then?Gr(t):t,e=e.useState()[0],(null!==wr?wr.memoizedState:null)!==e&&(Nr.flags|=1024),t}function Ur(){var e=0!==_r;return _r=0,e}function Lr(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function Fr(e){if(Er){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Er=!1}vr=0,kr=wr=Nr=null,jr=!1,Tr=_r=0,Sr=null}function Br(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===kr?Nr.memoizedState=kr=e:kr=kr.next=e,kr}function $r(){if(null===wr){var e=Nr.alternate;e=null!==e?e.memoizedState:null}else e=wr.next;var t=null===kr?Nr.memoizedState:kr.next;if(null!==t)kr=t,wr=e;else{if(null===e){if(null===Nr.alternate)throw Error(a(467));throw Error(a(310))}e={memoizedState:(wr=e).memoizedState,baseState:wr.baseState,baseQueue:wr.baseQueue,queue:wr.queue,next:null},null===kr?Nr.memoizedState=kr=e:kr=kr.next=e}return kr}function Gr(e){var t=Tr;return Tr+=1,null===Sr&&(Sr=[]),e=Xs(Sr,e,t),t=Nr,null===(null===kr?t.memoizedState:kr.next)&&(t=t.alternate,O.H=null===t||null===t.memoizedState?Hi:Ki),e}function Vr(e){if(null!==e&&"object"==typeof e){if("function"==typeof e.then)return Gr(e);if(e.$$typeof===v)return Ts(e)}throw Error(a(438,String(e)))}function zr(e){var t=null,n=Nr.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var a=Nr.alternate;null!==a&&(null!==(a=a.updateQueue)&&(null!=(a=a.memoCache)&&(t={data:a.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},Nr.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),a=0;a<e;a++)n[a]=_;return t.index++,n}function Wr(e,t){return"function"==typeof t?t(e):t}function qr(e){return Hr($r(),wr,e)}function Hr(e,t,n){var s=e.queue;if(null===s)throw Error(a(311));s.lastRenderedReducer=n;var r=e.baseQueue,i=s.pending;if(null!==i){if(null!==r){var l=r.next;r.next=i.next,i.next=l}t.baseQueue=r=i,s.pending=null}if(i=e.baseState,null===r)e.memoizedState=i;else{var o=l=null,c=null,d=t=r.next,u=!1;do{var m=-536870913&d.lane;if(m!==d.lane?(lc&m)===m:(vr&m)===m){var p=d.revertLane;if(0===p)null!==c&&(c=c.next={lane:0,revertLane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),m===Fs&&(u=!0);else{if((vr&p)===p){d=d.next,p===Fs&&(u=!0);continue}m={lane:0,revertLane:d.revertLane,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===c?(o=c=m,l=i):c=c.next=m,Nr.lanes|=p,hc|=p}m=d.action,Cr&&n(i,m),i=d.hasEagerState?d.eagerState:n(i,m)}else p={lane:m,revertLane:d.revertLane,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===c?(o=c=p,l=i):c=c.next=p,Nr.lanes|=m,hc|=m;d=d.next}while(null!==d&&d!==t);if(null===c?l=i:c.next=o,!Zn(i,e.memoizedState)&&(Tl=!0,u&&null!==(n=Bs)))throw n;e.memoizedState=i,e.baseState=l,e.baseQueue=c,s.lastRenderedState=i}return null===r&&(s.lanes=0),[e.memoizedState,s.dispatch]}function Kr(e){var t=$r(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var s=n.dispatch,r=n.pending,i=t.memoizedState;if(null!==r){n.pending=null;var l=r=r.next;do{i=e(i,l.action),l=l.next}while(l!==r);Zn(i,t.memoizedState)||(Tl=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,s]}function Yr(e,t,n){var s=Nr,r=$r(),i=ls;if(i){if(void 0===n)throw Error(a(407));n=n()}else n=t();var l=!Zn((wr||r).memoizedState,n);if(l&&(r.memoizedState=n,Tl=!0),r=r.queue,yi(2048,8,Qr.bind(null,s,r,e),[e]),r.getSnapshot!==t||l||null!==kr&&1&kr.memoizedState.tag){if(s.flags|=2048,hi(9,{destroy:void 0,resource:void 0},Zr.bind(null,s,r,n,t),null),null===rc)throw Error(a(349));i||124&vr||Jr(s,t,n)}return n}function Jr(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=Nr.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},Nr.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Zr(e,t,n,a){t.value=n,t.getSnapshot=a,Xr(t)&&ei(e)}function Qr(e,t,n){return n(function(){Xr(t)&&ei(e)})}function Xr(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Zn(e,n)}catch(a){return!0}}function ei(e){var t=Oa(e,2);null!==t&&Lc(t,e,2)}function ti(e){var t=Br();if("function"==typeof e){var n=e;if(e=n(),Cr){ue(!0);try{n()}finally{ue(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wr,lastRenderedState:e},t}function ni(e,t,n,a){return e.baseState=n,Hr(e,wr,"function"==typeof a?a:Wr)}function ai(e,t,n,s,r){if(Vi(e))throw Error(a(485));if(null!==(e=t.action)){var i={payload:r,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){i.listeners.push(e)}};null!==O.T?n(!0):i.isTransition=!1,s(i),null===(n=t.pending)?(i.next=t.pending=i,si(t,i)):(i.next=n.next,t.pending=n.next=i)}}function si(e,t){var n=t.action,a=t.payload,s=e.state;if(t.isTransition){var r=O.T,i={};O.T=i;try{var l=n(s,a),o=O.S;null!==o&&o(i,l),ri(e,t,l)}catch(c){li(e,t,c)}finally{O.T=r}}else try{ri(e,t,r=n(s,a))}catch(d){li(e,t,d)}}function ri(e,t,n){null!==n&&"object"==typeof n&&"function"==typeof n.then?n.then(function(n){ii(e,t,n)},function(n){return li(e,t,n)}):ii(e,t,n)}function ii(e,t,n){t.status="fulfilled",t.value=n,oi(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,si(e,n)))}function li(e,t,n){var a=e.pending;if(e.pending=null,null!==a){a=a.next;do{t.status="rejected",t.reason=n,oi(t),t=t.next}while(t!==a)}e.action=null}function oi(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function ci(e,t){return t}function di(e,t){if(ls){var n=rc.formState;if(null!==n){e:{var a=Nr;if(ls){if(is){t:{for(var s=is,r=cs;8!==s.nodeType;){if(!r){s=null;break t}if(null===(s=bu(s.nextSibling))){s=null;break t}}s="F!"===(r=s.data)||"F"===r?s:null}if(s){is=bu(s.nextSibling),a="F!"===s.data;break e}}us(a)}a=!1}a&&(t=n[0])}}return(n=Br()).memoizedState=n.baseState=t,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ci,lastRenderedState:t},n.queue=a,n=Bi.bind(null,Nr,a),a.dispatch=n,a=ti(!1),r=Gi.bind(null,Nr,!1,a.queue),s={state:t,dispatch:null,action:e,pending:null},(a=Br()).queue=s,n=ai.bind(null,Nr,s,r,n),s.dispatch=n,a.memoizedState=e,[t,n,!1]}function ui(e){return mi($r(),wr,e)}function mi(e,t,n){if(t=Hr(e,t,ci)[0],e=qr(Wr)[0],"object"==typeof t&&null!==t&&"function"==typeof t.then)try{var a=Gr(t)}catch(i){if(i===Hs)throw Ys;throw i}else a=t;var s=(t=$r()).queue,r=s.dispatch;return n!==t.memoizedState&&(Nr.flags|=2048,hi(9,{destroy:void 0,resource:void 0},pi.bind(null,s,n),null)),[a,r,e]}function pi(e,t){e.action=t}function fi(e){var t=$r(),n=wr;if(null!==n)return mi(t,n,e);$r(),t=t.memoizedState;var a=(n=$r()).queue.dispatch;return n.memoizedState=e,[t,a,!1]}function hi(e,t,n,a){return e={tag:e,create:n,deps:a,inst:t,next:null},null===(t=Nr.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},Nr.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(a=n.next,n.next=e,e.next=a,t.lastEffect=e),e}function gi(){return $r().memoizedState}function xi(e,t,n,a){var s=Br();a=void 0===a?null:a,Nr.flags|=e,s.memoizedState=hi(1|t,{destroy:void 0,resource:void 0},n,a)}function yi(e,t,n,a){var s=$r();a=void 0===a?null:a;var r=s.memoizedState.inst;null!==wr&&null!==a&&Dr(a,wr.memoizedState.deps)?s.memoizedState=hi(t,r,n,a):(Nr.flags|=e,s.memoizedState=hi(1|t,r,n,a))}function bi(e,t){xi(8390656,8,e,t)}function vi(e,t){yi(2048,8,e,t)}function Ni(e,t){return yi(4,2,e,t)}function wi(e,t){return yi(4,4,e,t)}function ki(e,t){if("function"==typeof t){e=e();var n=t(e);return function(){"function"==typeof n?n():t(null)}}if(null!=t)return e=e(),t.current=e,function(){t.current=null}}function Ei(e,t,n){n=null!=n?n.concat([e]):null,yi(4,4,ki.bind(null,t,e),n)}function ji(){}function Ci(e,t){var n=$r();t=void 0===t?null:t;var a=n.memoizedState;return null!==t&&Dr(t,a[1])?a[0]:(n.memoizedState=[e,t],e)}function _i(e,t){var n=$r();t=void 0===t?null:t;var a=n.memoizedState;if(null!==t&&Dr(t,a[1]))return a[0];if(a=e(),Cr){ue(!0);try{e()}finally{ue(!1)}}return n.memoizedState=[a,t],a}function Ti(e,t,n){return void 0===n||1073741824&vr?e.memoizedState=t:(e.memoizedState=n,e=Uc(),Nr.lanes|=e,hc|=e,n)}function Si(e,t,n,a){return Zn(n,t)?n:null!==hr.current?(e=Ti(e,n,a),Zn(e,t)||(Tl=!0),e):42&vr?(e=Uc(),Nr.lanes|=e,hc|=e,t):(Tl=!0,e.memoizedState=n)}function Ai(e,t,n,a,s){var r=R.p;R.p=0!==r&&8>r?r:8;var i,l,o,c=O.T,d={};O.T=d,Gi(e,!1,t,n);try{var u=s(),m=O.S;if(null!==m&&m(d,u),null!==u&&"object"==typeof u&&"function"==typeof u.then)$i(e,t,(i=a,l=[],o={status:"pending",value:null,reason:null,then:function(e){l.push(e)}},u.then(function(){o.status="fulfilled",o.value=i;for(var e=0;e<l.length;e++)(0,l[e])(i)},function(e){for(o.status="rejected",o.reason=e,e=0;e<l.length;e++)(0,l[e])(void 0)}),o),Mc());else $i(e,t,a,Mc())}catch(p){$i(e,t,{then:function(){},status:"rejected",reason:p},Mc())}finally{R.p=r,O.T=c}}function Ii(){}function Di(e,t,n,s){if(5!==e.tag)throw Error(a(476));var r=Oi(e).queue;Ai(e,r,t,P,null===n?Ii:function(){return Ri(e),n(s)})}function Oi(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:P,baseState:P,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wr,lastRenderedState:P},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wr,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function Ri(e){$i(e,Oi(e).next.queue,{},Mc())}function Pi(){return Ts(Ju)}function Mi(){return $r().memoizedState}function Ui(){return $r().memoizedState}function Li(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Mc(),a=lr(t,e=ir(n),n);return null!==a&&(Lc(a,t,n),or(a,t,n)),t={cache:Ps()},void(e.payload=t)}t=t.return}}function Fi(e,t,n){var a=Mc();n={lane:a,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},Vi(e)?zi(t,n):null!==(n=Da(e,t,n,a))&&(Lc(n,e,a),Wi(n,t,a))}function Bi(e,t,n){$i(e,t,n,Mc())}function $i(e,t,n,a){var s={lane:a,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(Vi(e))zi(t,s);else{var r=e.alternate;if(0===e.lanes&&(null===r||0===r.lanes)&&null!==(r=t.lastRenderedReducer))try{var i=t.lastRenderedState,l=r(i,n);if(s.hasEagerState=!0,s.eagerState=l,Zn(l,i))return Ia(e,t,s,0),null===rc&&Aa(),!1}catch(o){}if(null!==(n=Da(e,t,s,a)))return Lc(n,e,a),Wi(n,t,a),!0}return!1}function Gi(e,t,n,s){if(s={lane:2,revertLane:Id(),action:s,hasEagerState:!1,eagerState:null,next:null},Vi(e)){if(t)throw Error(a(479))}else null!==(t=Da(e,n,s,2))&&Lc(t,e,2)}function Vi(e){var t=e.alternate;return e===Nr||null!==t&&t===Nr}function zi(e,t){jr=Er=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Wi(e,t,n){if(4194048&n){var a=t.lanes;n|=a&=e.pendingLanes,t.lanes=n,Ce(e,n)}}var qi={readContext:Ts,use:Vr,useCallback:Ir,useContext:Ir,useEffect:Ir,useImperativeHandle:Ir,useLayoutEffect:Ir,useInsertionEffect:Ir,useMemo:Ir,useReducer:Ir,useRef:Ir,useState:Ir,useDebugValue:Ir,useDeferredValue:Ir,useTransition:Ir,useSyncExternalStore:Ir,useId:Ir,useHostTransitionStatus:Ir,useFormState:Ir,useActionState:Ir,useOptimistic:Ir,useMemoCache:Ir,useCacheRefresh:Ir},Hi={readContext:Ts,use:Vr,useCallback:function(e,t){return Br().memoizedState=[e,void 0===t?null:t],e},useContext:Ts,useEffect:bi,useImperativeHandle:function(e,t,n){n=null!=n?n.concat([e]):null,xi(4194308,4,ki.bind(null,t,e),n)},useLayoutEffect:function(e,t){return xi(4194308,4,e,t)},useInsertionEffect:function(e,t){xi(4,2,e,t)},useMemo:function(e,t){var n=Br();t=void 0===t?null:t;var a=e();if(Cr){ue(!0);try{e()}finally{ue(!1)}}return n.memoizedState=[a,t],a},useReducer:function(e,t,n){var a=Br();if(void 0!==n){var s=n(t);if(Cr){ue(!0);try{n(t)}finally{ue(!1)}}}else s=t;return a.memoizedState=a.baseState=s,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:s},a.queue=e,e=e.dispatch=Fi.bind(null,Nr,e),[a.memoizedState,e]},useRef:function(e){return e={current:e},Br().memoizedState=e},useState:function(e){var t=(e=ti(e)).queue,n=Bi.bind(null,Nr,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:ji,useDeferredValue:function(e,t){return Ti(Br(),e,t)},useTransition:function(){var e=ti(!1);return e=Ai.bind(null,Nr,e.queue,!0,!1),Br().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var s=Nr,r=Br();if(ls){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===rc)throw Error(a(349));124&lc||Jr(s,t,n)}r.memoizedState=n;var i={value:n,getSnapshot:t};return r.queue=i,bi(Qr.bind(null,s,i,e),[e]),s.flags|=2048,hi(9,{destroy:void 0,resource:void 0},Zr.bind(null,s,i,n,t),null),n},useId:function(){var e=Br(),t=rc.identifierPrefix;if(ls){var n=es;t=""+t+"R"+(n=(Xa&~(1<<32-me(Xa)-1)).toString(32)+n),0<(n=_r++)&&(t+="H"+n.toString(32)),t+=""}else t=""+t+"r"+(n=Ar++).toString(32)+"";return e.memoizedState=t},useHostTransitionStatus:Pi,useFormState:di,useActionState:di,useOptimistic:function(e){var t=Br();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=Gi.bind(null,Nr,!0,n),n.dispatch=t,[e,t]},useMemoCache:zr,useCacheRefresh:function(){return Br().memoizedState=Li.bind(null,Nr)}},Ki={readContext:Ts,use:Vr,useCallback:Ci,useContext:Ts,useEffect:vi,useImperativeHandle:Ei,useInsertionEffect:Ni,useLayoutEffect:wi,useMemo:_i,useReducer:qr,useRef:gi,useState:function(){return qr(Wr)},useDebugValue:ji,useDeferredValue:function(e,t){return Si($r(),wr.memoizedState,e,t)},useTransition:function(){var e=qr(Wr)[0],t=$r().memoizedState;return["boolean"==typeof e?e:Gr(e),t]},useSyncExternalStore:Yr,useId:Mi,useHostTransitionStatus:Pi,useFormState:ui,useActionState:ui,useOptimistic:function(e,t){return ni($r(),0,e,t)},useMemoCache:zr,useCacheRefresh:Ui},Yi={readContext:Ts,use:Vr,useCallback:Ci,useContext:Ts,useEffect:vi,useImperativeHandle:Ei,useInsertionEffect:Ni,useLayoutEffect:wi,useMemo:_i,useReducer:Kr,useRef:gi,useState:function(){return Kr(Wr)},useDebugValue:ji,useDeferredValue:function(e,t){var n=$r();return null===wr?Ti(n,e,t):Si(n,wr.memoizedState,e,t)},useTransition:function(){var e=Kr(Wr)[0],t=$r().memoizedState;return["boolean"==typeof e?e:Gr(e),t]},useSyncExternalStore:Yr,useId:Mi,useHostTransitionStatus:Pi,useFormState:fi,useActionState:fi,useOptimistic:function(e,t){var n=$r();return null!==wr?ni(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:zr,useCacheRefresh:Ui},Ji=null,Zi=0;function Qi(e){var t=Zi;return Zi+=1,null===Ji&&(Ji=[]),Xs(Ji,e,t)}function Xi(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function el(e,t){if(t.$$typeof===m)throw Error(a(525));throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function tl(e){return(0,e._init)(e._payload)}function nl(e){function t(t,n){if(e){var a=t.deletions;null===a?(t.deletions=[n],t.flags|=16):a.push(n)}}function n(n,a){if(!e)return null;for(;null!==a;)t(n,a),a=a.sibling;return null}function s(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function r(e,t){return(e=Ba(e,t)).index=0,e.sibling=null,e}function i(t,n,a){return t.index=a,e?null!==(a=t.alternate)?(a=a.index)<n?(t.flags|=67108866,n):a:(t.flags|=67108866,n):(t.flags|=1048576,n)}function l(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function o(e,t,n,a){return null===t||6!==t.tag?((t=za(n,e.mode,a)).return=e,t):((t=r(t,n)).return=e,t)}function c(e,t,n,a){var s=n.type;return s===h?u(e,t,n.props.children,a,n.key):null!==t&&(t.elementType===s||"object"==typeof s&&null!==s&&s.$$typeof===j&&tl(s)===t.type)?(Xi(t=r(t,n.props),n),t.return=e,t):(Xi(t=Ga(n.type,n.key,n.props,null,e.mode,a),n),t.return=e,t)}function d(e,t,n,a){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Wa(n,e.mode,a)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function u(e,t,n,a,s){return null===t||7!==t.tag?((t=Va(n,e.mode,a,s)).return=e,t):((t=r(t,n)).return=e,t)}function m(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t||"bigint"==typeof t)return(t=za(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case p:return Xi(n=Ga(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case f:return(t=Wa(t,e.mode,n)).return=e,t;case j:return m(e,t=(0,t._init)(t._payload),n)}if(D(t)||S(t))return(t=Va(t,e.mode,n,null)).return=e,t;if("function"==typeof t.then)return m(e,Qi(t),n);if(t.$$typeof===v)return m(e,Ss(e,t),n);el(e,t)}return null}function g(e,t,n,a){var s=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n||"bigint"==typeof n)return null!==s?null:o(e,t,""+n,a);if("object"==typeof n&&null!==n){switch(n.$$typeof){case p:return n.key===s?c(e,t,n,a):null;case f:return n.key===s?d(e,t,n,a):null;case j:return g(e,t,n=(s=n._init)(n._payload),a)}if(D(n)||S(n))return null!==s?null:u(e,t,n,a,null);if("function"==typeof n.then)return g(e,t,Qi(n),a);if(n.$$typeof===v)return g(e,t,Ss(e,n),a);el(e,n)}return null}function x(e,t,n,a,s){if("string"==typeof a&&""!==a||"number"==typeof a||"bigint"==typeof a)return o(t,e=e.get(n)||null,""+a,s);if("object"==typeof a&&null!==a){switch(a.$$typeof){case p:return c(t,e=e.get(null===a.key?n:a.key)||null,a,s);case f:return d(t,e=e.get(null===a.key?n:a.key)||null,a,s);case j:return x(e,t,n,a=(0,a._init)(a._payload),s)}if(D(a)||S(a))return u(t,e=e.get(n)||null,a,s,null);if("function"==typeof a.then)return x(e,t,n,Qi(a),s);if(a.$$typeof===v)return x(e,t,n,Ss(t,a),s);el(t,a)}return null}function y(o,c,d,u){if("object"==typeof d&&null!==d&&d.type===h&&null===d.key&&(d=d.props.children),"object"==typeof d&&null!==d){switch(d.$$typeof){case p:e:{for(var b=d.key;null!==c;){if(c.key===b){if((b=d.type)===h){if(7===c.tag){n(o,c.sibling),(u=r(c,d.props.children)).return=o,o=u;break e}}else if(c.elementType===b||"object"==typeof b&&null!==b&&b.$$typeof===j&&tl(b)===c.type){n(o,c.sibling),Xi(u=r(c,d.props),d),u.return=o,o=u;break e}n(o,c);break}t(o,c),c=c.sibling}d.type===h?((u=Va(d.props.children,o.mode,u,d.key)).return=o,o=u):(Xi(u=Ga(d.type,d.key,d.props,null,o.mode,u),d),u.return=o,o=u)}return l(o);case f:e:{for(b=d.key;null!==c;){if(c.key===b){if(4===c.tag&&c.stateNode.containerInfo===d.containerInfo&&c.stateNode.implementation===d.implementation){n(o,c.sibling),(u=r(c,d.children||[])).return=o,o=u;break e}n(o,c);break}t(o,c),c=c.sibling}(u=Wa(d,o.mode,u)).return=o,o=u}return l(o);case j:return y(o,c,d=(b=d._init)(d._payload),u)}if(D(d))return function(a,r,l,o){for(var c=null,d=null,u=r,p=r=0,f=null;null!==u&&p<l.length;p++){u.index>p?(f=u,u=null):f=u.sibling;var h=g(a,u,l[p],o);if(null===h){null===u&&(u=f);break}e&&u&&null===h.alternate&&t(a,u),r=i(h,r,p),null===d?c=h:d.sibling=h,d=h,u=f}if(p===l.length)return n(a,u),ls&&ts(a,p),c;if(null===u){for(;p<l.length;p++)null!==(u=m(a,l[p],o))&&(r=i(u,r,p),null===d?c=u:d.sibling=u,d=u);return ls&&ts(a,p),c}for(u=s(u);p<l.length;p++)null!==(f=x(u,a,p,l[p],o))&&(e&&null!==f.alternate&&u.delete(null===f.key?p:f.key),r=i(f,r,p),null===d?c=f:d.sibling=f,d=f);return e&&u.forEach(function(e){return t(a,e)}),ls&&ts(a,p),c}(o,c,d,u);if(S(d)){if("function"!=typeof(b=S(d)))throw Error(a(150));return function(r,l,o,c){if(null==o)throw Error(a(151));for(var d=null,u=null,p=l,f=l=0,h=null,y=o.next();null!==p&&!y.done;f++,y=o.next()){p.index>f?(h=p,p=null):h=p.sibling;var b=g(r,p,y.value,c);if(null===b){null===p&&(p=h);break}e&&p&&null===b.alternate&&t(r,p),l=i(b,l,f),null===u?d=b:u.sibling=b,u=b,p=h}if(y.done)return n(r,p),ls&&ts(r,f),d;if(null===p){for(;!y.done;f++,y=o.next())null!==(y=m(r,y.value,c))&&(l=i(y,l,f),null===u?d=y:u.sibling=y,u=y);return ls&&ts(r,f),d}for(p=s(p);!y.done;f++,y=o.next())null!==(y=x(p,r,f,y.value,c))&&(e&&null!==y.alternate&&p.delete(null===y.key?f:y.key),l=i(y,l,f),null===u?d=y:u.sibling=y,u=y);return e&&p.forEach(function(e){return t(r,e)}),ls&&ts(r,f),d}(o,c,d=b.call(d),u)}if("function"==typeof d.then)return y(o,c,Qi(d),u);if(d.$$typeof===v)return y(o,c,Ss(o,d),u);el(o,d)}return"string"==typeof d&&""!==d||"number"==typeof d||"bigint"==typeof d?(d=""+d,null!==c&&6===c.tag?(n(o,c.sibling),(u=r(c,d)).return=o,o=u):(n(o,c),(u=za(d,o.mode,u)).return=o,o=u),l(o)):n(o,c)}return function(e,t,n,a){try{Zi=0;var s=y(e,t,n,a);return Ji=null,s}catch(i){if(i===Hs||i===Ys)throw i;var r=La(29,i,null,e.mode);return r.lanes=a,r.return=e,r}}}var al=nl(!0),sl=nl(!1),rl=L(null),il=null;function ll(e){var t=e.alternate;B(ul,1&ul.current),B(rl,e),null===il&&(null===t||null!==hr.current||null!==t.memoizedState)&&(il=e)}function ol(e){if(22===e.tag){if(B(ul,ul.current),B(rl,e),null===il){var t=e.alternate;null!==t&&null!==t.memoizedState&&(il=e)}}else cl()}function cl(){B(ul,ul.current),B(rl,rl.current)}function dl(e){F(rl),il===e&&(il=null),F(ul)}var ul=L(0);function ml(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||yu(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(128&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function pl(e,t,n,a){n=null==(n=n(a,t=e.memoizedState))?t:u({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var fl={enqueueSetState:function(e,t,n){e=e._reactInternals;var a=Mc(),s=ir(a);s.payload=t,null!=n&&(s.callback=n),null!==(t=lr(e,s,a))&&(Lc(t,e,a),or(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var a=Mc(),s=ir(a);s.tag=1,s.payload=t,null!=n&&(s.callback=n),null!==(t=lr(e,s,a))&&(Lc(t,e,a),or(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Mc(),a=ir(n);a.tag=2,null!=t&&(a.callback=t),null!==(t=lr(e,a,n))&&(Lc(t,e,n),or(t,e,n))}};function hl(e,t,n,a,s,r,i){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(a,r,i):!t.prototype||!t.prototype.isPureReactComponent||(!Qn(n,a)||!Qn(s,r))}function gl(e,t,n,a){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,a),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,a),t.state!==e&&fl.enqueueReplaceState(t,t.state,null)}function xl(e,t){var n=t;if("ref"in t)for(var a in n={},t)"ref"!==a&&(n[a]=t[a]);if(e=e.defaultProps)for(var s in n===t&&(n=u({},n)),e)void 0===n[s]&&(n[s]=e[s]);return n}var yl="function"==typeof reportError?reportError:function(e){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof e&&null!==e&&"string"==typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"==typeof process&&"function"==typeof process.emit)return void process.emit("uncaughtException",e)};function bl(e){yl(e)}function vl(e){}function Nl(e){yl(e)}function wl(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function kl(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(a){setTimeout(function(){throw a})}}function El(e,t,n){return(n=ir(n)).tag=3,n.payload={element:null},n.callback=function(){wl(e,t)},n}function jl(e){return(e=ir(e)).tag=3,e}function Cl(e,t,n,a){var s=n.type.getDerivedStateFromError;if("function"==typeof s){var r=a.value;e.payload=function(){return s(r)},e.callback=function(){kl(t,n,a)}}var i=n.stateNode;null!==i&&"function"==typeof i.componentDidCatch&&(e.callback=function(){kl(t,n,a),"function"!=typeof s&&(null===Cc?Cc=new Set([this]):Cc.add(this));var e=a.stack;this.componentDidCatch(a.value,{componentStack:null!==e?e:""})})}var _l=Error(a(461)),Tl=!1;function Sl(e,t,n,a){t.child=null===e?sl(t,null,n,a):al(t,e.child,n,a)}function Al(e,t,n,a,s){n=n.render;var r=t.ref;if("ref"in a){var i={};for(var l in a)"ref"!==l&&(i[l]=a[l])}else i=a;return _s(t),a=Or(e,t,n,i,r,s),l=Ur(),null===e||Tl?(ls&&l&&as(t),t.flags|=1,Sl(e,t,a,s),t.child):(Lr(e,t,s),Jl(e,t,s))}function Il(e,t,n,a,s){if(null===e){var r=n.type;return"function"!=typeof r||Fa(r)||void 0!==r.defaultProps||null!==n.compare?((e=Ga(n.type,null,a,t,t.mode,s)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=r,Dl(e,t,r,a,s))}if(r=e.child,!Zl(e,s)){var i=r.memoizedProps;if((n=null!==(n=n.compare)?n:Qn)(i,a)&&e.ref===t.ref)return Jl(e,t,s)}return t.flags|=1,(e=Ba(r,a)).ref=t.ref,e.return=t,t.child=e}function Dl(e,t,n,a,s){if(null!==e){var r=e.memoizedProps;if(Qn(r,a)&&e.ref===t.ref){if(Tl=!1,t.pendingProps=a=r,!Zl(e,s))return t.lanes=e.lanes,Jl(e,t,s);131072&e.flags&&(Tl=!0)}}return Ml(e,t,n,a,s)}function Ol(e,t,n){var a=t.pendingProps,s=a.children,r=null!==e?e.memoizedState:null;if("hidden"===a.mode){if(128&t.flags){if(a=null!==r?r.baseLanes|n:n,null!==e){for(s=t.child=e.child,r=0;null!==s;)r=r|s.lanes|s.childLanes,s=s.sibling;t.childLanes=r&~a}else t.childLanes=0,t.child=null;return Rl(e,t,a,n)}if(!(536870912&n))return t.lanes=t.childLanes=536870912,Rl(e,t,null!==r?r.baseLanes|n:n,n);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Ws(0,null!==r?r.cachePool:null),null!==r?xr(t,r):yr(),ol(t)}else null!==r?(Ws(0,r.cachePool),xr(t,r),cl(),t.memoizedState=null):(null!==e&&Ws(0,null),yr(),cl());return Sl(e,t,s,n),t.child}function Rl(e,t,n,a){var s=zs();return s=null===s?null:{parent:Rs._currentValue,pool:s},t.memoizedState={baseLanes:n,cachePool:s},null!==e&&Ws(0,null),yr(),ol(t),null!==e&&js(e,t,a,!0),null}function Pl(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!=typeof n&&"object"!=typeof n)throw Error(a(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Ml(e,t,n,a,s){return _s(t),n=Or(e,t,n,a,void 0,s),a=Ur(),null===e||Tl?(ls&&a&&as(t),t.flags|=1,Sl(e,t,n,s),t.child):(Lr(e,t,s),Jl(e,t,s))}function Ul(e,t,n,a,s,r){return _s(t),t.updateQueue=null,n=Pr(t,a,n,s),Rr(e),a=Ur(),null===e||Tl?(ls&&a&&as(t),t.flags|=1,Sl(e,t,n,r),t.child):(Lr(e,t,r),Jl(e,t,r))}function Ll(e,t,n,a,s){if(_s(t),null===t.stateNode){var r=Ma,i=n.contextType;"object"==typeof i&&null!==i&&(r=Ts(i)),r=new n(a,r),t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,r.updater=fl,t.stateNode=r,r._reactInternals=t,(r=t.stateNode).props=a,r.state=t.memoizedState,r.refs={},sr(t),i=n.contextType,r.context="object"==typeof i&&null!==i?Ts(i):Ma,r.state=t.memoizedState,"function"==typeof(i=n.getDerivedStateFromProps)&&(pl(t,n,i,a),r.state=t.memoizedState),"function"==typeof n.getDerivedStateFromProps||"function"==typeof r.getSnapshotBeforeUpdate||"function"!=typeof r.UNSAFE_componentWillMount&&"function"!=typeof r.componentWillMount||(i=r.state,"function"==typeof r.componentWillMount&&r.componentWillMount(),"function"==typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),i!==r.state&&fl.enqueueReplaceState(r,r.state,null),mr(t,a,r,s),ur(),r.state=t.memoizedState),"function"==typeof r.componentDidMount&&(t.flags|=4194308),a=!0}else if(null===e){r=t.stateNode;var l=t.memoizedProps,o=xl(n,l);r.props=o;var c=r.context,d=n.contextType;i=Ma,"object"==typeof d&&null!==d&&(i=Ts(d));var u=n.getDerivedStateFromProps;d="function"==typeof u||"function"==typeof r.getSnapshotBeforeUpdate,l=t.pendingProps!==l,d||"function"!=typeof r.UNSAFE_componentWillReceiveProps&&"function"!=typeof r.componentWillReceiveProps||(l||c!==i)&&gl(t,r,a,i),ar=!1;var m=t.memoizedState;r.state=m,mr(t,a,r,s),ur(),c=t.memoizedState,l||m!==c||ar?("function"==typeof u&&(pl(t,n,u,a),c=t.memoizedState),(o=ar||hl(t,n,o,a,m,c,i))?(d||"function"!=typeof r.UNSAFE_componentWillMount&&"function"!=typeof r.componentWillMount||("function"==typeof r.componentWillMount&&r.componentWillMount(),"function"==typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount()),"function"==typeof r.componentDidMount&&(t.flags|=4194308)):("function"==typeof r.componentDidMount&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=c),r.props=a,r.state=c,r.context=i,a=o):("function"==typeof r.componentDidMount&&(t.flags|=4194308),a=!1)}else{r=t.stateNode,rr(e,t),d=xl(n,i=t.memoizedProps),r.props=d,u=t.pendingProps,m=r.context,c=n.contextType,o=Ma,"object"==typeof c&&null!==c&&(o=Ts(c)),(c="function"==typeof(l=n.getDerivedStateFromProps)||"function"==typeof r.getSnapshotBeforeUpdate)||"function"!=typeof r.UNSAFE_componentWillReceiveProps&&"function"!=typeof r.componentWillReceiveProps||(i!==u||m!==o)&&gl(t,r,a,o),ar=!1,m=t.memoizedState,r.state=m,mr(t,a,r,s),ur();var p=t.memoizedState;i!==u||m!==p||ar||null!==e&&null!==e.dependencies&&Cs(e.dependencies)?("function"==typeof l&&(pl(t,n,l,a),p=t.memoizedState),(d=ar||hl(t,n,d,a,m,p,o)||null!==e&&null!==e.dependencies&&Cs(e.dependencies))?(c||"function"!=typeof r.UNSAFE_componentWillUpdate&&"function"!=typeof r.componentWillUpdate||("function"==typeof r.componentWillUpdate&&r.componentWillUpdate(a,p,o),"function"==typeof r.UNSAFE_componentWillUpdate&&r.UNSAFE_componentWillUpdate(a,p,o)),"function"==typeof r.componentDidUpdate&&(t.flags|=4),"function"==typeof r.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof r.componentDidUpdate||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),"function"!=typeof r.getSnapshotBeforeUpdate||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=p),r.props=a,r.state=p,r.context=o,a=d):("function"!=typeof r.componentDidUpdate||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),"function"!=typeof r.getSnapshotBeforeUpdate||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),a=!1)}return r=a,Pl(e,t),a=!!(128&t.flags),r||a?(r=t.stateNode,n=a&&"function"!=typeof n.getDerivedStateFromError?null:r.render(),t.flags|=1,null!==e&&a?(t.child=al(t,e.child,null,s),t.child=al(t,null,n,s)):Sl(e,t,n,s),t.memoizedState=r.state,e=t.child):e=Jl(e,t,s),e}function Fl(e,t,n,a){return hs(),t.flags|=256,Sl(e,t,n,a),t.child}var Bl={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function $l(e){return{baseLanes:e,cachePool:qs()}}function Gl(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=yc),e}function Vl(e,t,n){var s,r=t.pendingProps,i=!1,l=!!(128&t.flags);if((s=l)||(s=(null===e||null!==e.memoizedState)&&!!(2&ul.current)),s&&(i=!0,t.flags&=-129),s=!!(32&t.flags),t.flags&=-33,null===e){if(ls){if(i?ll(t):cl(),ls){var o,c=is;if(o=c){e:{for(o=c,c=cs;8!==o.nodeType;){if(!c){c=null;break e}if(null===(o=bu(o.nextSibling))){c=null;break e}}c=o}null!==c?(t.memoizedState={dehydrated:c,treeContext:null!==Qa?{id:Xa,overflow:es}:null,retryLane:536870912,hydrationErrors:null},(o=La(18,null,null,0)).stateNode=c,o.return=t,t.child=o,rs=t,is=null,o=!0):o=!1}o||us(t)}if(null!==(c=t.memoizedState)&&null!==(c=c.dehydrated))return yu(c)?t.lanes=32:t.lanes=536870912,null;dl(t)}return c=r.children,r=r.fallback,i?(cl(),c=Wl({mode:"hidden",children:c},i=t.mode),r=Va(r,i,n,null),c.return=t,r.return=t,c.sibling=r,t.child=c,(i=t.child).memoizedState=$l(n),i.childLanes=Gl(e,s,n),t.memoizedState=Bl,r):(ll(t),zl(t,c))}if(null!==(o=e.memoizedState)&&null!==(c=o.dehydrated)){if(l)256&t.flags?(ll(t),t.flags&=-257,t=ql(e,t,n)):null!==t.memoizedState?(cl(),t.child=e.child,t.flags|=128,t=null):(cl(),i=r.fallback,c=t.mode,r=Wl({mode:"visible",children:r.children},c),(i=Va(i,c,n,null)).flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,al(t,e.child,null,n),(r=t.child).memoizedState=$l(n),r.childLanes=Gl(e,s,n),t.memoizedState=Bl,t=i);else if(ll(t),yu(c)){if(s=c.nextSibling&&c.nextSibling.dataset)var d=s.dgst;s=d,(r=Error(a(419))).stack="",r.digest=s,xs({value:r,source:null,stack:null}),t=ql(e,t,n)}else if(Tl||js(e,t,n,!1),s=0!==(n&e.childLanes),Tl||s){if(null!==(s=rc)&&(0!==(r=0!==((r=42&(r=n&-n)?1:_e(r))&(s.suspendedLanes|n))?0:r)&&r!==o.retryLane))throw o.retryLane=r,Oa(e,r),Lc(s,e,r),_l;"$?"===c.data||Yc(),t=ql(e,t,n)}else"$?"===c.data?(t.flags|=192,t.child=e.child,t=null):(e=o.treeContext,is=bu(c.nextSibling),rs=t,ls=!0,os=null,cs=!1,null!==e&&(Ja[Za++]=Xa,Ja[Za++]=es,Ja[Za++]=Qa,Xa=e.id,es=e.overflow,Qa=t),(t=zl(t,r.children)).flags|=4096);return t}return i?(cl(),i=r.fallback,c=t.mode,d=(o=e.child).sibling,(r=Ba(o,{mode:"hidden",children:r.children})).subtreeFlags=65011712&o.subtreeFlags,null!==d?i=Ba(d,i):(i=Va(i,c,n,null)).flags|=2,i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,null===(c=e.child.memoizedState)?c=$l(n):(null!==(o=c.cachePool)?(d=Rs._currentValue,o=o.parent!==d?{parent:d,pool:d}:o):o=qs(),c={baseLanes:c.baseLanes|n,cachePool:o}),i.memoizedState=c,i.childLanes=Gl(e,s,n),t.memoizedState=Bl,r):(ll(t),e=(n=e.child).sibling,(n=Ba(n,{mode:"visible",children:r.children})).return=t,n.sibling=null,null!==e&&(null===(s=t.deletions)?(t.deletions=[e],t.flags|=16):s.push(e)),t.child=n,t.memoizedState=null,n)}function zl(e,t){return(t=Wl({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Wl(e,t){return(e=La(22,e,null,t)).lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function ql(e,t,n){return al(t,e.child,null,n),(e=zl(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Hl(e,t,n){e.lanes|=t;var a=e.alternate;null!==a&&(a.lanes|=t),ks(e.return,t,n)}function Kl(e,t,n,a,s){var r=e.memoizedState;null===r?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:n,tailMode:s}:(r.isBackwards=t,r.rendering=null,r.renderingStartTime=0,r.last=a,r.tail=n,r.tailMode=s)}function Yl(e,t,n){var a=t.pendingProps,s=a.revealOrder,r=a.tail;if(Sl(e,t,a.children,n),2&(a=ul.current))a=1&a|2,t.flags|=128;else{if(null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Hl(e,n,t);else if(19===e.tag)Hl(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}switch(B(ul,a),s){case"forwards":for(n=t.child,s=null;null!==n;)null!==(e=n.alternate)&&null===ml(e)&&(s=n),n=n.sibling;null===(n=s)?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Kl(t,!1,s,n,r);break;case"backwards":for(n=null,s=t.child,t.child=null;null!==s;){if(null!==(e=s.alternate)&&null===ml(e)){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Kl(t,!0,n,null,r);break;case"together":Kl(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Jl(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),hc|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(js(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Ba(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Ba(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Zl(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Cs(e))}function Ql(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Tl=!0;else{if(!(Zl(e,n)||128&t.flags))return Tl=!1,function(e,t,n){switch(t.tag){case 3:W(t,t.stateNode.containerInfo),Ns(0,Rs,e.memoizedState.cache),hs();break;case 27:case 5:H(t);break;case 4:W(t,t.stateNode.containerInfo);break;case 10:Ns(0,t.type,t.memoizedProps.value);break;case 13:var a=t.memoizedState;if(null!==a)return null!==a.dehydrated?(ll(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Vl(e,t,n):(ll(t),null!==(e=Jl(e,t,n))?e.sibling:null);ll(t);break;case 19:var s=!!(128&e.flags);if((a=0!==(n&t.childLanes))||(js(e,t,n,!1),a=0!==(n&t.childLanes)),s){if(a)return Yl(e,t,n);t.flags|=128}if(null!==(s=t.memoizedState)&&(s.rendering=null,s.tail=null,s.lastEffect=null),B(ul,ul.current),a)break;return null;case 22:case 23:return t.lanes=0,Ol(e,t,n);case 24:Ns(0,Rs,e.memoizedState.cache)}return Jl(e,t,n)}(e,t,n);Tl=!!(131072&e.flags)}else Tl=!1,ls&&1048576&t.flags&&ns(t,Ya,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var s=t.elementType,r=s._init;if(s=r(s._payload),t.type=s,"function"!=typeof s){if(null!=s){if((r=s.$$typeof)===N){t.tag=11,t=Al(null,t,s,e,n);break e}if(r===E){t.tag=14,t=Il(null,t,s,e,n);break e}}throw t=I(s)||s,Error(a(306,t,""))}Fa(s)?(e=xl(s,e),t.tag=1,t=Ll(null,t,s,e,n)):(t.tag=0,t=Ml(null,t,s,e,n))}return t;case 0:return Ml(e,t,t.type,t.pendingProps,n);case 1:return Ll(e,t,s=t.type,r=xl(s,t.pendingProps),n);case 3:e:{if(W(t,t.stateNode.containerInfo),null===e)throw Error(a(387));s=t.pendingProps;var i=t.memoizedState;r=i.element,rr(e,t),mr(t,s,null,n);var l=t.memoizedState;if(s=l.cache,Ns(0,Rs,s),s!==i.cache&&Es(t,[Rs],n,!0),ur(),s=l.element,i.isDehydrated){if(i={element:s,isDehydrated:!1,cache:l.cache},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Fl(e,t,s,n);break e}if(s!==r){xs(r=Ca(Error(a(424)),t)),t=Fl(e,t,s,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(is=bu(e.firstChild),rs=t,ls=!0,os=null,cs=!0,n=sl(t,null,s,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(hs(),s===r){t=Jl(e,t,n);break e}Sl(e,t,s,n)}t=t.child}return t;case 26:return Pl(e,t),null===e?(n=Au(t.type,null,t.pendingProps,null))?t.memoizedState=n:ls||(n=t.type,e=t.pendingProps,(s=ru(V.current).createElement(n))[Ie]=t,s[De]=e,nu(s,n,e),We(s),t.stateNode=s):t.memoizedState=Au(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return H(t),null===e&&ls&&(s=t.stateNode=wu(t.type,t.pendingProps,V.current),rs=t,cs=!0,r=is,hu(t.type)?(vu=r,is=bu(s.firstChild)):is=r),Sl(e,t,t.pendingProps.children,n),Pl(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&ls&&((r=s=is)&&(null!==(s=function(e,t,n,a){for(;1===e.nodeType;){var s=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!a&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(a){if(!e[Le])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(r=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(r!==s.rel||e.getAttribute("href")!==(null==s.href||""===s.href?null:s.href)||e.getAttribute("crossorigin")!==(null==s.crossOrigin?null:s.crossOrigin)||e.getAttribute("title")!==(null==s.title?null:s.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((r=e.getAttribute("src"))!==(null==s.src?null:s.src)||e.getAttribute("type")!==(null==s.type?null:s.type)||e.getAttribute("crossorigin")!==(null==s.crossOrigin?null:s.crossOrigin))&&r&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var r=null==s.name?null:""+s.name;if("hidden"===s.type&&e.getAttribute("name")===r)return e}if(null===(e=bu(e.nextSibling)))break}return null}(s,t.type,t.pendingProps,cs))?(t.stateNode=s,rs=t,is=bu(s.firstChild),cs=!1,r=!0):r=!1),r||us(t)),H(t),r=t.type,i=t.pendingProps,l=null!==e?e.memoizedProps:null,s=i.children,ou(r,i)?s=null:null!==l&&ou(r,l)&&(t.flags|=32),null!==t.memoizedState&&(r=Or(e,t,Mr,null,null,n),Ju._currentValue=r),Pl(e,t),Sl(e,t,s,n),t.child;case 6:return null===e&&ls&&((e=n=is)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=bu(e.nextSibling)))return null}return e}(n,t.pendingProps,cs))?(t.stateNode=n,rs=t,is=null,e=!0):e=!1),e||us(t)),null;case 13:return Vl(e,t,n);case 4:return W(t,t.stateNode.containerInfo),s=t.pendingProps,null===e?t.child=al(t,null,s,n):Sl(e,t,s,n),t.child;case 11:return Al(e,t,t.type,t.pendingProps,n);case 7:return Sl(e,t,t.pendingProps,n),t.child;case 8:case 12:return Sl(e,t,t.pendingProps.children,n),t.child;case 10:return s=t.pendingProps,Ns(0,t.type,s.value),Sl(e,t,s.children,n),t.child;case 9:return r=t.type._context,s=t.pendingProps.children,_s(t),s=s(r=Ts(r)),t.flags|=1,Sl(e,t,s,n),t.child;case 14:return Il(e,t,t.type,t.pendingProps,n);case 15:return Dl(e,t,t.type,t.pendingProps,n);case 19:return Yl(e,t,n);case 31:return s=t.pendingProps,n=t.mode,s={mode:s.mode,children:s.children},null===e?((n=Wl(s,n)).ref=t.ref,t.child=n,n.return=t,t=n):((n=Ba(e.child,s)).ref=t.ref,t.child=n,n.return=t,t=n),t;case 22:return Ol(e,t,n);case 24:return _s(t),s=Ts(Rs),null===e?(null===(r=zs())&&(r=rc,i=Ps(),r.pooledCache=i,i.refCount++,null!==i&&(r.pooledCacheLanes|=n),r=i),t.memoizedState={parent:s,cache:r},sr(t),Ns(0,Rs,r)):(0!==(e.lanes&n)&&(rr(e,t),mr(t,null,null,n),ur()),r=e.memoizedState,i=t.memoizedState,r.parent!==s?(r={parent:s,cache:s},t.memoizedState=r,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=r),Ns(0,Rs,s)):(s=i.cache,Ns(0,Rs,s),s!==r.cache&&Es(t,[Rs],n,!0))),Sl(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(a(156,t.tag))}function Xl(e){e.flags|=4}function eo(e,t){if("stylesheet"!==t.type||4&t.state.loading)e.flags&=-16777217;else if(e.flags|=16777216,!Vu(t)){if(null!==(t=rl.current)&&((4194048&lc)===lc?null!==il:(62914560&lc)!==lc&&!(536870912&lc)||t!==il))throw er=Js,Ks;e.flags|=8192}}function to(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?we():536870912,e.lanes|=t,bc|=t)}function no(e,t){if(!ls)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var a=null;null!==n;)null!==n.alternate&&(a=n),n=n.sibling;null===a?t||null===e.tail?e.tail=null:e.tail.sibling=null:a.sibling=null}}function ao(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,a=0;if(t)for(var s=e.child;null!==s;)n|=s.lanes|s.childLanes,a|=65011712&s.subtreeFlags,a|=65011712&s.flags,s.return=e,s=s.sibling;else for(s=e.child;null!==s;)n|=s.lanes|s.childLanes,a|=s.subtreeFlags,a|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=a,e.childLanes=n,t}function so(e,t,n){var s=t.pendingProps;switch(ss(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return ao(t),null;case 3:return n=t.stateNode,s=null,null!==e&&(s=e.memoizedState.cache),t.memoizedState.cache!==s&&(t.flags|=2048),ws(Rs),q(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(fs(t)?Xl(t):null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,gs())),ao(t),null;case 26:return n=t.memoizedState,null===e?(Xl(t),null!==n?(ao(t),eo(t,n)):(ao(t),t.flags&=-16777217)):n?n!==e.memoizedState?(Xl(t),ao(t),eo(t,n)):(ao(t),t.flags&=-16777217):(e.memoizedProps!==s&&Xl(t),ao(t),t.flags&=-16777217),null;case 27:K(t),n=V.current;var r=t.type;if(null!==e&&null!=t.stateNode)e.memoizedProps!==s&&Xl(t);else{if(!s){if(null===t.stateNode)throw Error(a(166));return ao(t),null}e=$.current,fs(t)?ms(t):(e=wu(r,s,n),t.stateNode=e,Xl(t))}return ao(t),null;case 5:if(K(t),n=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==s&&Xl(t);else{if(!s){if(null===t.stateNode)throw Error(a(166));return ao(t),null}if(e=$.current,fs(t))ms(t);else{switch(r=ru(V.current),e){case 1:e=r.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=r.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":(e=r.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e="string"==typeof s.is?r.createElement("select",{is:s.is}):r.createElement("select"),s.multiple?e.multiple=!0:s.size&&(e.size=s.size);break;default:e="string"==typeof s.is?r.createElement(n,{is:s.is}):r.createElement(n)}}e[Ie]=t,e[De]=s;e:for(r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&27!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break e;for(;null===r.sibling;){if(null===r.return||r.return===t)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}t.stateNode=e;e:switch(nu(e,n,s),n){case"button":case"input":case"select":case"textarea":e=!!s.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Xl(t)}}return ao(t),t.flags&=-16777217,null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==s&&Xl(t);else{if("string"!=typeof s&&null===t.stateNode)throw Error(a(166));if(e=V.current,fs(t)){if(e=t.stateNode,n=t.memoizedProps,s=null,null!==(r=rs))switch(r.tag){case 27:case 5:s=r.memoizedProps}e[Ie]=t,(e=!!(e.nodeValue===n||null!==s&&!0===s.suppressHydrationWarning||Qd(e.nodeValue,n)))||us(t)}else(e=ru(e).createTextNode(s))[Ie]=t,t.stateNode=e}return ao(t),null;case 13:if(s=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(r=fs(t),null!==s&&null!==s.dehydrated){if(null===e){if(!r)throw Error(a(318));if(!(r=null!==(r=t.memoizedState)?r.dehydrated:null))throw Error(a(317));r[Ie]=t}else hs(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;ao(t),r=!1}else r=gs(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=r),r=!0;if(!r)return 256&t.flags?(dl(t),t):(dl(t),null)}if(dl(t),128&t.flags)return t.lanes=n,t;if(n=null!==s,e=null!==e&&null!==e.memoizedState,n){r=null,null!==(s=t.child).alternate&&null!==s.alternate.memoizedState&&null!==s.alternate.memoizedState.cachePool&&(r=s.alternate.memoizedState.cachePool.pool);var i=null;null!==s.memoizedState&&null!==s.memoizedState.cachePool&&(i=s.memoizedState.cachePool.pool),i!==r&&(s.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),to(t,t.updateQueue),ao(t),null;case 4:return q(),null===e&&Gd(t.stateNode.containerInfo),ao(t),null;case 10:return ws(t.type),ao(t),null;case 19:if(F(ul),null===(r=t.memoizedState))return ao(t),null;if(s=!!(128&t.flags),null===(i=r.rendering))if(s)no(r,!1);else{if(0!==fc||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(i=ml(e))){for(t.flags|=128,no(r,!1),e=i.updateQueue,t.updateQueue=e,to(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)$a(n,e),n=n.sibling;return B(ul,1&ul.current|2),t.child}e=e.sibling}null!==r.tail&&ee()>Ec&&(t.flags|=128,s=!0,no(r,!1),t.lanes=4194304)}else{if(!s)if(null!==(e=ml(i))){if(t.flags|=128,s=!0,e=e.updateQueue,t.updateQueue=e,to(t,e),no(r,!0),null===r.tail&&"hidden"===r.tailMode&&!i.alternate&&!ls)return ao(t),null}else 2*ee()-r.renderingStartTime>Ec&&536870912!==n&&(t.flags|=128,s=!0,no(r,!1),t.lanes=4194304);r.isBackwards?(i.sibling=t.child,t.child=i):(null!==(e=r.last)?e.sibling=i:t.child=i,r.last=i)}return null!==r.tail?(t=r.tail,r.rendering=t,r.tail=t.sibling,r.renderingStartTime=ee(),t.sibling=null,e=ul.current,B(ul,s?1&e|2:1&e),t):(ao(t),null);case 22:case 23:return dl(t),br(),s=null!==t.memoizedState,null!==e?null!==e.memoizedState!==s&&(t.flags|=8192):s&&(t.flags|=8192),s?!!(536870912&n)&&!(128&t.flags)&&(ao(t),6&t.subtreeFlags&&(t.flags|=8192)):ao(t),null!==(n=t.updateQueue)&&to(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),s=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(s=t.memoizedState.cachePool.pool),s!==n&&(t.flags|=2048),null!==e&&F(Vs),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),ws(Rs),ao(t),null;case 25:case 30:return null}throw Error(a(156,t.tag))}function ro(e,t){switch(ss(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return ws(Rs),q(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return K(t),null;case 13:if(dl(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));hs()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return F(ul),null;case 4:return q(),null;case 10:return ws(t.type),null;case 22:case 23:return dl(t),br(),null!==e&&F(Vs),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return ws(Rs),null;default:return null}}function io(e,t){switch(ss(t),t.tag){case 3:ws(Rs),q();break;case 26:case 27:case 5:K(t);break;case 4:q();break;case 13:dl(t);break;case 19:F(ul);break;case 10:ws(t.type);break;case 22:case 23:dl(t),br(),null!==e&&F(Vs);break;case 24:ws(Rs)}}function lo(e,t){try{var n=t.updateQueue,a=null!==n?n.lastEffect:null;if(null!==a){var s=a.next;n=s;do{if((n.tag&e)===e){a=void 0;var r=n.create,i=n.inst;a=r(),i.destroy=a}n=n.next}while(n!==s)}}catch(l){md(t,t.return,l)}}function oo(e,t,n){try{var a=t.updateQueue,s=null!==a?a.lastEffect:null;if(null!==s){var r=s.next;a=r;do{if((a.tag&e)===e){var i=a.inst,l=i.destroy;if(void 0!==l){i.destroy=void 0,s=t;var o=n,c=l;try{c()}catch(d){md(s,o,d)}}}a=a.next}while(a!==r)}}catch(d){md(t,t.return,d)}}function co(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{fr(t,n)}catch(a){md(e,e.return,a)}}}function uo(e,t,n){n.props=xl(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(a){md(e,t,a)}}function mo(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var a=e.stateNode;break;default:a=e.stateNode}"function"==typeof n?e.refCleanup=n(a):n.current=a}}catch(s){md(e,t,s)}}function po(e,t){var n=e.ref,a=e.refCleanup;if(null!==n)if("function"==typeof a)try{a()}catch(s){md(e,t,s)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"==typeof n)try{n(null)}catch(r){md(e,t,r)}else n.current=null}function fo(e){var t=e.type,n=e.memoizedProps,a=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&a.focus();break e;case"img":n.src?a.src=n.src:n.srcSet&&(a.srcset=n.srcSet)}}catch(s){md(e,e.return,s)}}function ho(e,t,n){try{var s=e.stateNode;!function(e,t,n,s){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var r=null,i=null,l=null,o=null,c=null,d=null,u=null;for(f in n){var m=n[f];if(n.hasOwnProperty(f)&&null!=m)switch(f){case"checked":case"value":break;case"defaultValue":c=m;default:s.hasOwnProperty(f)||eu(e,t,f,null,s,m)}}for(var p in s){var f=s[p];if(m=n[p],s.hasOwnProperty(p)&&(null!=f||null!=m))switch(p){case"type":i=f;break;case"name":r=f;break;case"checked":d=f;break;case"defaultChecked":u=f;break;case"value":l=f;break;case"defaultValue":o=f;break;case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(a(137,t));break;default:f!==m&&eu(e,t,p,f,s,m)}}return void yt(e,l,o,c,d,u,i,r);case"select":for(i in f=l=o=p=null,n)if(c=n[i],n.hasOwnProperty(i)&&null!=c)switch(i){case"value":break;case"multiple":f=c;default:s.hasOwnProperty(i)||eu(e,t,i,null,s,c)}for(r in s)if(i=s[r],c=n[r],s.hasOwnProperty(r)&&(null!=i||null!=c))switch(r){case"value":p=i;break;case"defaultValue":o=i;break;case"multiple":l=i;default:i!==c&&eu(e,t,r,i,s,c)}return t=o,n=l,s=f,void(null!=p?Nt(e,!!n,p,!1):!!s!=!!n&&(null!=t?Nt(e,!!n,t,!0):Nt(e,!!n,n?[]:"",!1)));case"textarea":for(o in f=p=null,n)if(r=n[o],n.hasOwnProperty(o)&&null!=r&&!s.hasOwnProperty(o))switch(o){case"value":case"children":break;default:eu(e,t,o,null,s,r)}for(l in s)if(r=s[l],i=n[l],s.hasOwnProperty(l)&&(null!=r||null!=i))switch(l){case"value":p=r;break;case"defaultValue":f=r;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=r)throw Error(a(91));break;default:r!==i&&eu(e,t,l,r,s,i)}return void wt(e,p,f);case"option":for(var h in n)if(p=n[h],n.hasOwnProperty(h)&&null!=p&&!s.hasOwnProperty(h))if("selected"===h)e.selected=!1;else eu(e,t,h,null,s,p);for(c in s)if(p=s[c],f=n[c],s.hasOwnProperty(c)&&p!==f&&(null!=p||null!=f))if("selected"===c)e.selected=p&&"function"!=typeof p&&"symbol"!=typeof p;else eu(e,t,c,p,s,f);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)p=n[g],n.hasOwnProperty(g)&&null!=p&&!s.hasOwnProperty(g)&&eu(e,t,g,null,s,p);for(d in s)if(p=s[d],f=n[d],s.hasOwnProperty(d)&&p!==f&&(null!=p||null!=f))switch(d){case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(a(137,t));break;default:eu(e,t,d,p,s,f)}return;default:if(Tt(t)){for(var x in n)p=n[x],n.hasOwnProperty(x)&&void 0!==p&&!s.hasOwnProperty(x)&&tu(e,t,x,void 0,s,p);for(u in s)p=s[u],f=n[u],!s.hasOwnProperty(u)||p===f||void 0===p&&void 0===f||tu(e,t,u,p,s,f);return}}for(var y in n)p=n[y],n.hasOwnProperty(y)&&null!=p&&!s.hasOwnProperty(y)&&eu(e,t,y,null,s,p);for(m in s)p=s[m],f=n[m],!s.hasOwnProperty(m)||p===f||null==p&&null==f||eu(e,t,m,p,s,f)}(s,e.type,n,t),s[De]=t}catch(r){md(e,e.return,r)}}function go(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&hu(e.type)||4===e.tag}function xo(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||go(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&hu(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function yo(e,t,n){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=Xd));else if(4!==a&&(27===a&&hu(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(yo(e,t,n),e=e.sibling;null!==e;)yo(e,t,n),e=e.sibling}function bo(e,t,n){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==a&&(27===a&&hu(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(bo(e,t,n),e=e.sibling;null!==e;)bo(e,t,n),e=e.sibling}function vo(e){var t=e.stateNode,n=e.memoizedProps;try{for(var a=e.type,s=t.attributes;s.length;)t.removeAttributeNode(s[0]);nu(t,a,n),t[Ie]=e,t[De]=n}catch(r){md(e,e.return,r)}}var No=!1,wo=!1,ko=!1,Eo="function"==typeof WeakSet?WeakSet:Set,jo=null;function Co(e,t,n){var a=n.flags;switch(n.tag){case 0:case 11:case 15:Fo(e,n),4&a&&lo(5,n);break;case 1:if(Fo(e,n),4&a)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(i){md(n,n.return,i)}else{var s=xl(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(s,t,e.__reactInternalSnapshotBeforeUpdate)}catch(l){md(n,n.return,l)}}64&a&&co(n),512&a&&mo(n,n.return);break;case 3:if(Fo(e,n),64&a&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{fr(e,t)}catch(i){md(n,n.return,i)}}break;case 27:null===t&&4&a&&vo(n);case 26:case 5:Fo(e,n),null===t&&4&a&&fo(n),512&a&&mo(n,n.return);break;case 12:Fo(e,n);break;case 13:Fo(e,n),4&a&&Do(e,n),64&a&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$?"!==e.data||"complete"===n.readyState)t();else{var a=function(){t(),n.removeEventListener("DOMContentLoaded",a)};n.addEventListener("DOMContentLoaded",a),e._reactRetry=a}}(e,n=gd.bind(null,n))));break;case 22:if(!(a=null!==n.memoizedState||No)){t=null!==t&&null!==t.memoizedState||wo,s=No;var r=wo;No=a,(wo=t)&&!r?$o(e,n,!!(8772&n.subtreeFlags)):Fo(e,n),No=s,wo=r}break;case 30:break;default:Fo(e,n)}}function _o(e){var t=e.alternate;null!==t&&(e.alternate=null,_o(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Fe(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var To=null,So=!1;function Ao(e,t,n){for(n=n.child;null!==n;)Io(e,t,n),n=n.sibling}function Io(e,t,n){if(de&&"function"==typeof de.onCommitFiberUnmount)try{de.onCommitFiberUnmount(ce,n)}catch(r){}switch(n.tag){case 26:wo||po(n,t),Ao(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:wo||po(n,t);var a=To,s=So;hu(n.type)&&(To=n.stateNode,So=!1),Ao(e,t,n),ku(n.stateNode),To=a,So=s;break;case 5:wo||po(n,t);case 6:if(a=To,s=So,To=null,Ao(e,t,n),So=s,null!==(To=a))if(So)try{(9===To.nodeType?To.body:"HTML"===To.nodeName?To.ownerDocument.body:To).removeChild(n.stateNode)}catch(i){md(n,t,i)}else try{To.removeChild(n.stateNode)}catch(i){md(n,t,i)}break;case 18:null!==To&&(So?(gu(9===(e=To).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Sm(e)):gu(To,n.stateNode));break;case 4:a=To,s=So,To=n.stateNode.containerInfo,So=!0,Ao(e,t,n),To=a,So=s;break;case 0:case 11:case 14:case 15:wo||oo(2,n,t),wo||oo(4,n,t),Ao(e,t,n);break;case 1:wo||(po(n,t),"function"==typeof(a=n.stateNode).componentWillUnmount&&uo(n,t,a)),Ao(e,t,n);break;case 21:Ao(e,t,n);break;case 22:wo=(a=wo)||null!==n.memoizedState,Ao(e,t,n),wo=a;break;default:Ao(e,t,n)}}function Do(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Sm(e)}catch(n){md(t,t.return,n)}}function Oo(e,t){var n=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Eo),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Eo),t;default:throw Error(a(435,e.tag))}}(e);t.forEach(function(t){var a=xd.bind(null,e,t);n.has(t)||(n.add(t),t.then(a,a))})}function Ro(e,t){var n=t.deletions;if(null!==n)for(var s=0;s<n.length;s++){var r=n[s],i=e,l=t,o=l;e:for(;null!==o;){switch(o.tag){case 27:if(hu(o.type)){To=o.stateNode,So=!1;break e}break;case 5:To=o.stateNode,So=!1;break e;case 3:case 4:To=o.stateNode.containerInfo,So=!0;break e}o=o.return}if(null===To)throw Error(a(160));Io(i,l,r),To=null,So=!1,null!==(i=r.alternate)&&(i.return=null),r.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)Mo(t,e),t=t.sibling}var Po=null;function Mo(e,t){var n=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Ro(t,e),Uo(e),4&s&&(oo(3,e,e.return),lo(3,e),oo(5,e,e.return));break;case 1:Ro(t,e),Uo(e),512&s&&(wo||null===n||po(n,n.return)),64&s&&No&&(null!==(e=e.updateQueue)&&(null!==(s=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?s:n.concat(s))));break;case 26:var r=Po;if(Ro(t,e),Uo(e),512&s&&(wo||null===n||po(n,n.return)),4&s){var i=null!==n?n.memoizedState:null;if(s=e.memoizedState,null===n)if(null===s)if(null===e.stateNode){e:{s=e.type,n=e.memoizedProps,r=r.ownerDocument||r;t:switch(s){case"title":(!(i=r.getElementsByTagName("title")[0])||i[Le]||i[Ie]||"http://www.w3.org/2000/svg"===i.namespaceURI||i.hasAttribute("itemprop"))&&(i=r.createElement(s),r.head.insertBefore(i,r.querySelector("head > title"))),nu(i,s,n),i[Ie]=e,We(i),s=i;break e;case"link":var l=$u("link","href",r).get(s+(n.href||""));if(l)for(var o=0;o<l.length;o++)if((i=l[o]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&i.getAttribute("rel")===(null==n.rel?null:n.rel)&&i.getAttribute("title")===(null==n.title?null:n.title)&&i.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){l.splice(o,1);break t}nu(i=r.createElement(s),s,n),r.head.appendChild(i);break;case"meta":if(l=$u("meta","content",r).get(s+(n.content||"")))for(o=0;o<l.length;o++)if((i=l[o]).getAttribute("content")===(null==n.content?null:""+n.content)&&i.getAttribute("name")===(null==n.name?null:n.name)&&i.getAttribute("property")===(null==n.property?null:n.property)&&i.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&i.getAttribute("charset")===(null==n.charSet?null:n.charSet)){l.splice(o,1);break t}nu(i=r.createElement(s),s,n),r.head.appendChild(i);break;default:throw Error(a(468,s))}i[Ie]=e,We(i),s=i}e.stateNode=s}else Gu(r,e.type,e.stateNode);else e.stateNode=Mu(r,s,e.memoizedProps);else i!==s?(null===i?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):i.count--,null===s?Gu(r,e.type,e.stateNode):Mu(r,s,e.memoizedProps)):null===s&&null!==e.stateNode&&ho(e,e.memoizedProps,n.memoizedProps)}break;case 27:Ro(t,e),Uo(e),512&s&&(wo||null===n||po(n,n.return)),null!==n&&4&s&&ho(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Ro(t,e),Uo(e),512&s&&(wo||null===n||po(n,n.return)),32&e.flags){r=e.stateNode;try{Et(r,"")}catch(f){md(e,e.return,f)}}4&s&&null!=e.stateNode&&ho(e,r=e.memoizedProps,null!==n?n.memoizedProps:r),1024&s&&(ko=!0);break;case 6:if(Ro(t,e),Uo(e),4&s){if(null===e.stateNode)throw Error(a(162));s=e.memoizedProps,n=e.stateNode;try{n.nodeValue=s}catch(f){md(e,e.return,f)}}break;case 3:if(Bu=null,r=Po,Po=Cu(t.containerInfo),Ro(t,e),Po=r,Uo(e),4&s&&null!==n&&n.memoizedState.isDehydrated)try{Sm(t.containerInfo)}catch(f){md(e,e.return,f)}ko&&(ko=!1,Lo(e));break;case 4:s=Po,Po=Cu(e.stateNode.containerInfo),Ro(t,e),Uo(e),Po=s;break;case 12:default:Ro(t,e),Uo(e);break;case 13:Ro(t,e),Uo(e),8192&e.child.flags&&null!==e.memoizedState!=(null!==n&&null!==n.memoizedState)&&(kc=ee()),4&s&&(null!==(s=e.updateQueue)&&(e.updateQueue=null,Oo(e,s)));break;case 22:r=null!==e.memoizedState;var c=null!==n&&null!==n.memoizedState,d=No,u=wo;if(No=d||r,wo=u||c,Ro(t,e),wo=u,No=d,Uo(e),8192&s)e:for(t=e.stateNode,t._visibility=r?-2&t._visibility:1|t._visibility,r&&(null===n||c||No||wo||Bo(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){c=n=t;try{if(i=c.stateNode,r)"function"==typeof(l=i.style).setProperty?l.setProperty("display","none","important"):l.display="none";else{o=c.stateNode;var m=c.memoizedProps.style,p=null!=m&&m.hasOwnProperty("display")?m.display:null;o.style.display=null==p||"boolean"==typeof p?"":(""+p).trim()}}catch(f){md(c,c.return,f)}}}else if(6===t.tag){if(null===n){c=t;try{c.stateNode.nodeValue=r?"":c.memoizedProps}catch(f){md(c,c.return,f)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&s&&(null!==(s=e.updateQueue)&&(null!==(n=s.retryQueue)&&(s.retryQueue=null,Oo(e,n))));break;case 19:Ro(t,e),Uo(e),4&s&&(null!==(s=e.updateQueue)&&(e.updateQueue=null,Oo(e,s)));case 30:case 21:}}function Uo(e){var t=e.flags;if(2&t){try{for(var n,s=e.return;null!==s;){if(go(s)){n=s;break}s=s.return}if(null==n)throw Error(a(160));switch(n.tag){case 27:var r=n.stateNode;bo(e,xo(e),r);break;case 5:var i=n.stateNode;32&n.flags&&(Et(i,""),n.flags&=-33),bo(e,xo(e),i);break;case 3:case 4:var l=n.stateNode.containerInfo;yo(e,xo(e),l);break;default:throw Error(a(161))}}catch(o){md(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Lo(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Lo(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Fo(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Co(e,t.alternate,t),t=t.sibling}function Bo(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:oo(4,t,t.return),Bo(t);break;case 1:po(t,t.return);var n=t.stateNode;"function"==typeof n.componentWillUnmount&&uo(t,t.return,n),Bo(t);break;case 27:ku(t.stateNode);case 26:case 5:po(t,t.return),Bo(t);break;case 22:null===t.memoizedState&&Bo(t);break;default:Bo(t)}e=e.sibling}}function $o(e,t,n){for(n=n&&!!(8772&t.subtreeFlags),t=t.child;null!==t;){var a=t.alternate,s=e,r=t,i=r.flags;switch(r.tag){case 0:case 11:case 15:$o(s,r,n),lo(4,r);break;case 1:if($o(s,r,n),"function"==typeof(s=(a=r).stateNode).componentDidMount)try{s.componentDidMount()}catch(c){md(a,a.return,c)}if(null!==(s=(a=r).updateQueue)){var l=a.stateNode;try{var o=s.shared.hiddenCallbacks;if(null!==o)for(s.shared.hiddenCallbacks=null,s=0;s<o.length;s++)pr(o[s],l)}catch(c){md(a,a.return,c)}}n&&64&i&&co(r),mo(r,r.return);break;case 27:vo(r);case 26:case 5:$o(s,r,n),n&&null===a&&4&i&&fo(r),mo(r,r.return);break;case 12:$o(s,r,n);break;case 13:$o(s,r,n),n&&4&i&&Do(s,r);break;case 22:null===r.memoizedState&&$o(s,r,n),mo(r,r.return);break;case 30:break;default:$o(s,r,n)}t=t.sibling}}function Go(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Ms(n))}function Vo(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Ms(e))}function zo(e,t,n,a){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)Wo(e,t,n,a),t=t.sibling}function Wo(e,t,n,a){var s=t.flags;switch(t.tag){case 0:case 11:case 15:zo(e,t,n,a),2048&s&&lo(9,t);break;case 1:case 13:default:zo(e,t,n,a);break;case 3:zo(e,t,n,a),2048&s&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Ms(e)));break;case 12:if(2048&s){zo(e,t,n,a),e=t.stateNode;try{var r=t.memoizedProps,i=r.id,l=r.onPostCommit;"function"==typeof l&&l(i,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(o){md(t,t.return,o)}}else zo(e,t,n,a);break;case 23:break;case 22:r=t.stateNode,i=t.alternate,null!==t.memoizedState?2&r._visibility?zo(e,t,n,a):Ho(e,t):2&r._visibility?zo(e,t,n,a):(r._visibility|=2,qo(e,t,n,a,!!(10256&t.subtreeFlags))),2048&s&&Go(i,t);break;case 24:zo(e,t,n,a),2048&s&&Vo(t.alternate,t)}}function qo(e,t,n,a,s){for(s=s&&!!(10256&t.subtreeFlags),t=t.child;null!==t;){var r=e,i=t,l=n,o=a,c=i.flags;switch(i.tag){case 0:case 11:case 15:qo(r,i,l,o,s),lo(8,i);break;case 23:break;case 22:var d=i.stateNode;null!==i.memoizedState?2&d._visibility?qo(r,i,l,o,s):Ho(r,i):(d._visibility|=2,qo(r,i,l,o,s)),s&&2048&c&&Go(i.alternate,i);break;case 24:qo(r,i,l,o,s),s&&2048&c&&Vo(i.alternate,i);break;default:qo(r,i,l,o,s)}t=t.sibling}}function Ho(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,a=t,s=a.flags;switch(a.tag){case 22:Ho(n,a),2048&s&&Go(a.alternate,a);break;case 24:Ho(n,a),2048&s&&Vo(a.alternate,a);break;default:Ho(n,a)}t=t.sibling}}var Ko=8192;function Yo(e){if(e.subtreeFlags&Ko)for(e=e.child;null!==e;)Jo(e),e=e.sibling}function Jo(e){switch(e.tag){case 26:Yo(e),e.flags&Ko&&null!==e.memoizedState&&function(e,t,n){if(null===zu)throw Error(a(475));var s=zu;if(!("stylesheet"!==t.type||"string"==typeof n.media&&!1===matchMedia(n.media).matches||4&t.state.loading)){if(null===t.instance){var r=Iu(n.href),i=e.querySelector(Du(r));if(i)return null!==(e=i._p)&&"object"==typeof e&&"function"==typeof e.then&&(s.count++,s=qu.bind(s),e.then(s,s)),t.state.loading|=4,t.instance=i,void We(i);i=e.ownerDocument||e,n=Ou(n),(r=Eu.get(r))&&Lu(n,r),We(i=i.createElement("link"));var l=i;l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),nu(i,"link",n),t.instance=i}null===s.stylesheets&&(s.stylesheets=new Map),s.stylesheets.set(t,e),(e=t.state.preload)&&!(3&t.state.loading)&&(s.count++,t=qu.bind(s),e.addEventListener("load",t),e.addEventListener("error",t))}}(Po,e.memoizedState,e.memoizedProps);break;case 5:default:Yo(e);break;case 3:case 4:var t=Po;Po=Cu(e.stateNode.containerInfo),Yo(e),Po=t;break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=Ko,Ko=16777216,Yo(e),Ko=t):Yo(e))}}function Zo(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function Qo(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var n=0;n<t.length;n++){var a=t[n];jo=a,tc(a,e)}Zo(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)Xo(e),e=e.sibling}function Xo(e){switch(e.tag){case 0:case 11:case 15:Qo(e),2048&e.flags&&oo(9,e,e.return);break;case 3:case 12:default:Qo(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,ec(e)):Qo(e)}}function ec(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var n=0;n<t.length;n++){var a=t[n];jo=a,tc(a,e)}Zo(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:oo(8,t,t.return),ec(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,ec(t));break;default:ec(t)}e=e.sibling}}function tc(e,t){for(;null!==jo;){var n=jo;switch(n.tag){case 0:case 11:case 15:oo(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var a=n.memoizedState.cachePool.pool;null!=a&&a.refCount++}break;case 24:Ms(n.memoizedState.cache)}if(null!==(a=n.child))a.return=n,jo=a;else e:for(n=e;null!==jo;){var s=(a=jo).sibling,r=a.return;if(_o(a),a===n){jo=null;break e}if(null!==s){s.return=r,jo=s;break e}jo=r}}}var nc={getCacheForType:function(e){var t=Ts(Rs),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n}},ac="function"==typeof WeakMap?WeakMap:Map,sc=0,rc=null,ic=null,lc=0,oc=0,cc=null,dc=!1,uc=!1,mc=!1,pc=0,fc=0,hc=0,gc=0,xc=0,yc=0,bc=0,vc=null,Nc=null,wc=!1,kc=0,Ec=1/0,jc=null,Cc=null,_c=0,Tc=null,Sc=null,Ac=0,Ic=0,Dc=null,Oc=null,Rc=0,Pc=null;function Mc(){if(2&sc&&0!==lc)return lc&-lc;if(null!==O.T){return 0!==Fs?Fs:Id()}return Se()}function Uc(){0===yc&&(yc=536870912&lc&&!ls?536870912:Ne());var e=rl.current;return null!==e&&(e.flags|=32),yc}function Lc(e,t,n){(e!==rc||2!==oc&&9!==oc)&&null===e.cancelPendingCommit||(Wc(e,0),Gc(e,lc,yc,!1)),Ee(e,n),2&sc&&e===rc||(e===rc&&(!(2&sc)&&(gc|=n),4===fc&&Gc(e,lc,yc,!1)),Ed(e))}function Fc(e,t,n){if(6&sc)throw Error(a(327));for(var s=!n&&!(124&t)&&0===(t&e.expiredLanes)||be(e,t),r=s?function(e,t){var n=sc;sc|=2;var s=Hc(),r=Kc();rc!==e||lc!==t?(jc=null,Ec=ee()+500,Wc(e,t)):uc=be(e,t);e:for(;;)try{if(0!==oc&&null!==ic){t=ic;var i=cc;t:switch(oc){case 1:oc=0,cc=null,td(e,t,i,1);break;case 2:case 9:if(Zs(i)){oc=0,cc=null,ed(t);break}t=function(){2!==oc&&9!==oc||rc!==e||(oc=7),Ed(e)},i.then(t,t);break e;case 3:oc=7;break e;case 4:oc=5;break e;case 7:Zs(i)?(oc=0,cc=null,ed(t)):(oc=0,cc=null,td(e,t,i,7));break;case 5:var l=null;switch(ic.tag){case 26:l=ic.memoizedState;case 5:case 27:var o=ic;if(!l||Vu(l)){oc=0,cc=null;var c=o.sibling;if(null!==c)ic=c;else{var d=o.return;null!==d?(ic=d,nd(d)):ic=null}break t}}oc=0,cc=null,td(e,t,i,5);break;case 6:oc=0,cc=null,td(e,t,i,6);break;case 8:zc(),fc=6;break e;default:throw Error(a(462))}}Qc();break}catch(u){qc(e,u)}return vs=bs=null,O.H=s,O.A=r,sc=n,null!==ic?0:(rc=null,lc=0,Aa(),fc)}(e,t):Jc(e,t,!0),i=s;;){if(0===r){uc&&!s&&Gc(e,t,0,!1);break}if(n=e.current.alternate,!i||$c(n)){if(2===r){if(i=t,e.errorRecoveryDisabledLanes&i)var l=0;else l=0!==(l=-536870913&e.pendingLanes)?l:536870912&l?536870912:0;if(0!==l){t=l;e:{var o=e;r=vc;var c=o.current.memoizedState.isDehydrated;if(c&&(Wc(o,l).flags|=256),2!==(l=Jc(o,l,!1))){if(mc&&!c){o.errorRecoveryDisabledLanes|=i,gc|=i,r=4;break e}i=Nc,Nc=r,null!==i&&(null===Nc?Nc=i:Nc.push.apply(Nc,i))}r=l}if(i=!1,2!==r)continue}}if(1===r){Wc(e,0),Gc(e,t,0,!0);break}e:{switch(s=e,i=r){case 0:case 1:throw Error(a(345));case 4:if((4194048&t)!==t)break;case 6:Gc(s,t,yc,!dc);break e;case 2:Nc=null;break;case 3:case 5:break;default:throw Error(a(329))}if((62914560&t)===t&&10<(r=kc+300-ee())){if(Gc(s,t,yc,!dc),0!==ye(s,0,!0))break e;s.timeoutHandle=du(Bc.bind(null,s,n,Nc,jc,wc,t,yc,gc,bc,dc,i,2,-0,0),r)}else Bc(s,n,Nc,jc,wc,t,yc,gc,bc,dc,i,0,-0,0)}break}r=Jc(e,t,!1),i=!1}Ed(e)}function Bc(e,t,n,s,r,i,l,o,c,d,u,m,p,f){if(e.timeoutHandle=-1,(8192&(m=t.subtreeFlags)||!(16785408&~m))&&(zu={stylesheets:null,count:0,unsuspend:Wu},Jo(t),null!==(m=function(){if(null===zu)throw Error(a(475));var e=zu;return e.stylesheets&&0===e.count&&Ku(e,e.stylesheets),0<e.count?function(t){var n=setTimeout(function(){if(e.stylesheets&&Ku(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}())))return e.cancelPendingCommit=m(sd.bind(null,e,t,i,n,s,r,l,o,c,u,1,p,f)),void Gc(e,i,l,!d);sd(e,t,i,n,s,r,l,o,c)}function $c(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var a=0;a<n.length;a++){var s=n[a],r=s.getSnapshot;s=s.value;try{if(!Zn(r(),s))return!1}catch(i){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Gc(e,t,n,a){t&=~xc,t&=~gc,e.suspendedLanes|=t,e.pingedLanes&=~t,a&&(e.warmLanes|=t),a=e.expirationTimes;for(var s=t;0<s;){var r=31-me(s),i=1<<r;a[r]=-1,s&=~i}0!==n&&je(e,n,t)}function Vc(){return!!(6&sc)||(jd(0),!1)}function zc(){if(null!==ic){if(0===oc)var e=ic.return;else vs=bs=null,Fr(e=ic),Ji=null,Zi=0,e=ic;for(;null!==e;)io(e.alternate,e),e=e.return;ic=null}}function Wc(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,uu(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),zc(),rc=e,ic=n=Ba(e.current,null),lc=t,oc=0,cc=null,dc=!1,uc=be(e,t),mc=!1,bc=yc=xc=gc=hc=fc=0,Nc=vc=null,wc=!1,8&t&&(t|=32&t);var a=e.entangledLanes;if(0!==a)for(e=e.entanglements,a&=t;0<a;){var s=31-me(a),r=1<<s;t|=e[s],a&=~r}return pc=t,Aa(),n}function qc(e,t){Nr=null,O.H=qi,t===Hs||t===Ys?(t=tr(),oc=3):t===Ks?(t=tr(),oc=4):oc=t===_l?8:null!==t&&"object"==typeof t&&"function"==typeof t.then?6:1,cc=t,null===ic&&(fc=1,wl(e,Ca(t,e.current)))}function Hc(){var e=O.H;return O.H=qi,null===e?qi:e}function Kc(){var e=O.A;return O.A=nc,e}function Yc(){fc=4,dc||(4194048&lc)!==lc&&null!==rl.current||(uc=!0),!(134217727&hc)&&!(134217727&gc)||null===rc||Gc(rc,lc,yc,!1)}function Jc(e,t,n){var a=sc;sc|=2;var s=Hc(),r=Kc();rc===e&&lc===t||(jc=null,Wc(e,t)),t=!1;var i=fc;e:for(;;)try{if(0!==oc&&null!==ic){var l=ic,o=cc;switch(oc){case 8:zc(),i=6;break e;case 3:case 2:case 9:case 6:null===rl.current&&(t=!0);var c=oc;if(oc=0,cc=null,td(e,l,o,c),n&&uc){i=0;break e}break;default:c=oc,oc=0,cc=null,td(e,l,o,c)}}Zc(),i=fc;break}catch(d){qc(e,d)}return t&&e.shellSuspendCounter++,vs=bs=null,sc=a,O.H=s,O.A=r,null===ic&&(rc=null,lc=0,Aa()),i}function Zc(){for(;null!==ic;)Xc(ic)}function Qc(){for(;null!==ic&&!Q();)Xc(ic)}function Xc(e){var t=Ql(e.alternate,e,pc);e.memoizedProps=e.pendingProps,null===t?nd(e):ic=t}function ed(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Ul(n,t,t.pendingProps,t.type,void 0,lc);break;case 11:t=Ul(n,t,t.pendingProps,t.type.render,t.ref,lc);break;case 5:Fr(t);default:io(n,t),t=Ql(n,t=ic=$a(t,pc),pc)}e.memoizedProps=e.pendingProps,null===t?nd(e):ic=t}function td(e,t,n,s){vs=bs=null,Fr(t),Ji=null,Zi=0;var r=t.return;try{if(function(e,t,n,s,r){if(n.flags|=32768,null!==s&&"object"==typeof s&&"function"==typeof s.then){if(null!==(t=n.alternate)&&js(t,n,r,!0),null!==(n=rl.current)){switch(n.tag){case 13:return null===il?Yc():null===n.alternate&&0===fc&&(fc=3),n.flags&=-257,n.flags|=65536,n.lanes=r,s===Js?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([s]):t.add(s),pd(e,s,r)),!1;case 22:return n.flags|=65536,s===Js?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([s])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([s]):n.add(s),pd(e,s,r)),!1}throw Error(a(435,n.tag))}return pd(e,s,r),Yc(),!1}if(ls)return null!==(t=rl.current)?(!(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=r,s!==ds&&xs(Ca(e=Error(a(422),{cause:s}),n))):(s!==ds&&xs(Ca(t=Error(a(423),{cause:s}),n)),(e=e.current.alternate).flags|=65536,r&=-r,e.lanes|=r,s=Ca(s,n),cr(e,r=El(e.stateNode,s,r)),4!==fc&&(fc=2)),!1;var i=Error(a(520),{cause:s});if(i=Ca(i,n),null===vc?vc=[i]:vc.push(i),4!==fc&&(fc=2),null===t)return!0;s=Ca(s,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=r&-r,n.lanes|=e,cr(n,e=El(n.stateNode,s,e)),!1;case 1:if(t=n.type,i=n.stateNode,!(128&n.flags||"function"!=typeof t.getDerivedStateFromError&&(null===i||"function"!=typeof i.componentDidCatch||null!==Cc&&Cc.has(i))))return n.flags|=65536,r&=-r,n.lanes|=r,Cl(r=jl(r),e,n,s),cr(n,r),!1}n=n.return}while(null!==n);return!1}(e,r,t,n,lc))return fc=1,wl(e,Ca(n,e.current)),void(ic=null)}catch(i){if(null!==r)throw ic=r,i;return fc=1,wl(e,Ca(n,e.current)),void(ic=null)}32768&t.flags?(ls||1===s?e=!0:uc||536870912&lc?e=!1:(dc=e=!0,(2===s||9===s||3===s||6===s)&&(null!==(s=rl.current)&&13===s.tag&&(s.flags|=16384))),ad(t,e)):nd(t)}function nd(e){var t=e;do{if(32768&t.flags)return void ad(t,dc);e=t.return;var n=so(t.alternate,t,pc);if(null!==n)return void(ic=n);if(null!==(t=t.sibling))return void(ic=t);ic=t=e}while(null!==t);0===fc&&(fc=5)}function ad(e,t){do{var n=ro(e.alternate,e);if(null!==n)return n.flags&=32767,void(ic=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(ic=e);ic=e=n}while(null!==e);fc=6,ic=null}function sd(e,t,n,s,r,i,l,o,c){e.cancelPendingCommit=null;do{cd()}while(0!==_c);if(6&sc)throw Error(a(327));if(null!==t){if(t===e.current)throw Error(a(177));if(i=t.lanes|t.childLanes,function(e,t,n,a,s,r){var i=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var l=e.entanglements,o=e.expirationTimes,c=e.hiddenUpdates;for(n=i&~n;0<n;){var d=31-me(n),u=1<<d;l[d]=0,o[d]=-1;var m=c[d];if(null!==m)for(c[d]=null,d=0;d<m.length;d++){var p=m[d];null!==p&&(p.lane&=-536870913)}n&=~u}0!==a&&je(e,a,0),0!==r&&0===s&&0!==e.tag&&(e.suspendedLanes|=r&~(i&~t))}(e,n,i|=Sa,l,o,c),e===rc&&(ic=rc=null,lc=0),Sc=t,Tc=e,Ac=n,Ic=i,Dc=r,Oc=s,10256&t.subtreeFlags||10256&t.flags?(e.callbackNode=null,e.callbackPriority=0,J(se,function(){return dd(),null})):(e.callbackNode=null,e.callbackPriority=0),s=!!(13878&t.flags),13878&t.subtreeFlags||s){s=O.T,O.T=null,r=R.p,R.p=2,l=sc,sc|=4;try{!function(e,t){if(e=e.containerInfo,au=sm,aa(e=na(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var s=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(s&&0!==s.rangeCount){n=s.anchorNode;var r=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{n.nodeType,i.nodeType}catch(g){n=null;break e}var l=0,o=-1,c=-1,d=0,u=0,m=e,p=null;t:for(;;){for(var f;m!==n||0!==r&&3!==m.nodeType||(o=l+r),m!==i||0!==s&&3!==m.nodeType||(c=l+s),3===m.nodeType&&(l+=m.nodeValue.length),null!==(f=m.firstChild);)p=m,m=f;for(;;){if(m===e)break t;if(p===n&&++d===r&&(o=l),p===i&&++u===s&&(c=l),null!==(f=m.nextSibling))break;p=(m=p).parentNode}m=f}n=-1===o||-1===c?null:{start:o,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(su={focusedElem:e,selectionRange:n},sm=!1,jo=t;null!==jo;)if(e=(t=jo).child,1024&t.subtreeFlags&&null!==e)e.return=t,jo=e;else for(;null!==jo;){switch(i=(t=jo).alternate,e=t.flags,t.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(1024&e&&null!==i){e=void 0,n=t,r=i.memoizedProps,i=i.memoizedState,s=n.stateNode;try{var h=xl(n.type,r,(n.elementType,n.type));e=s.getSnapshotBeforeUpdate(h,i),s.__reactInternalSnapshotBeforeUpdate=e}catch(x){md(n,n.return,x)}}break;case 3:if(1024&e)if(9===(n=(e=t.stateNode.containerInfo).nodeType))xu(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":xu(e);break;default:e.textContent=""}break;default:if(1024&e)throw Error(a(163))}if(null!==(e=t.sibling)){e.return=t.return,jo=e;break}jo=t.return}}(e,t)}finally{sc=l,R.p=r,O.T=s}}_c=1,rd(),id(),ld()}}function rd(){if(1===_c){_c=0;var e=Tc,t=Sc,n=!!(13878&t.flags);if(13878&t.subtreeFlags||n){n=O.T,O.T=null;var a=R.p;R.p=2;var s=sc;sc|=4;try{Mo(t,e);var r=su,i=na(e.containerInfo),l=r.focusedElem,o=r.selectionRange;if(i!==l&&l&&l.ownerDocument&&ta(l.ownerDocument.documentElement,l)){if(null!==o&&aa(l)){var c=o.start,d=o.end;if(void 0===d&&(d=c),"selectionStart"in l)l.selectionStart=c,l.selectionEnd=Math.min(d,l.value.length);else{var u=l.ownerDocument||document,m=u&&u.defaultView||window;if(m.getSelection){var p=m.getSelection(),f=l.textContent.length,h=Math.min(o.start,f),g=void 0===o.end?h:Math.min(o.end,f);!p.extend&&h>g&&(i=g,g=h,h=i);var x=ea(l,h),y=ea(l,g);if(x&&y&&(1!==p.rangeCount||p.anchorNode!==x.node||p.anchorOffset!==x.offset||p.focusNode!==y.node||p.focusOffset!==y.offset)){var b=u.createRange();b.setStart(x.node,x.offset),p.removeAllRanges(),h>g?(p.addRange(b),p.extend(y.node,y.offset)):(b.setEnd(y.node,y.offset),p.addRange(b))}}}}for(u=[],p=l;p=p.parentNode;)1===p.nodeType&&u.push({element:p,left:p.scrollLeft,top:p.scrollTop});for("function"==typeof l.focus&&l.focus(),l=0;l<u.length;l++){var v=u[l];v.element.scrollLeft=v.left,v.element.scrollTop=v.top}}sm=!!au,su=au=null}finally{sc=s,R.p=a,O.T=n}}e.current=t,_c=2}}function id(){if(2===_c){_c=0;var e=Tc,t=Sc,n=!!(8772&t.flags);if(8772&t.subtreeFlags||n){n=O.T,O.T=null;var a=R.p;R.p=2;var s=sc;sc|=4;try{Co(e,t.alternate,t)}finally{sc=s,R.p=a,O.T=n}}_c=3}}function ld(){if(4===_c||3===_c){_c=0,X();var e=Tc,t=Sc,n=Ac,a=Oc;10256&t.subtreeFlags||10256&t.flags?_c=5:(_c=0,Sc=Tc=null,od(e,e.pendingLanes));var s=e.pendingLanes;if(0===s&&(Cc=null),Te(n),t=t.stateNode,de&&"function"==typeof de.onCommitFiberRoot)try{de.onCommitFiberRoot(ce,t,void 0,!(128&~t.current.flags))}catch(o){}if(null!==a){t=O.T,s=R.p,R.p=2,O.T=null;try{for(var r=e.onRecoverableError,i=0;i<a.length;i++){var l=a[i];r(l.value,{componentStack:l.stack})}}finally{O.T=t,R.p=s}}3&Ac&&cd(),Ed(e),s=e.pendingLanes,4194090&n&&42&s?e===Pc?Rc++:(Rc=0,Pc=e):Rc=0,jd(0)}}function od(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Ms(t)))}function cd(e){return rd(),id(),ld(),dd()}function dd(){if(5!==_c)return!1;var e=Tc,t=Ic;Ic=0;var n=Te(Ac),s=O.T,r=R.p;try{R.p=32>n?32:n,O.T=null,n=Dc,Dc=null;var i=Tc,l=Ac;if(_c=0,Sc=Tc=null,Ac=0,6&sc)throw Error(a(331));var o=sc;if(sc|=4,Xo(i.current),Wo(i,i.current,l,n),sc=o,jd(0,!1),de&&"function"==typeof de.onPostCommitFiberRoot)try{de.onPostCommitFiberRoot(ce,i)}catch(c){}return!0}finally{R.p=r,O.T=s,od(e,t)}}function ud(e,t,n){t=Ca(n,t),null!==(e=lr(e,t=El(e.stateNode,t,2),2))&&(Ee(e,2),Ed(e))}function md(e,t,n){if(3===e.tag)ud(e,e,n);else for(;null!==t;){if(3===t.tag){ud(t,e,n);break}if(1===t.tag){var a=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof a.componentDidCatch&&(null===Cc||!Cc.has(a))){e=Ca(n,e),null!==(a=lr(t,n=jl(2),2))&&(Cl(n,a,t,e),Ee(a,2),Ed(a));break}}t=t.return}}function pd(e,t,n){var a=e.pingCache;if(null===a){a=e.pingCache=new ac;var s=new Set;a.set(t,s)}else void 0===(s=a.get(t))&&(s=new Set,a.set(t,s));s.has(n)||(mc=!0,s.add(n),e=fd.bind(null,e,t,n),t.then(e,e))}function fd(e,t,n){var a=e.pingCache;null!==a&&a.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,rc===e&&(lc&n)===n&&(4===fc||3===fc&&(62914560&lc)===lc&&300>ee()-kc?!(2&sc)&&Wc(e,0):xc|=n,bc===lc&&(bc=0)),Ed(e)}function hd(e,t){0===t&&(t=we()),null!==(e=Oa(e,t))&&(Ee(e,t),Ed(e))}function gd(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),hd(e,n)}function xd(e,t){var n=0;switch(e.tag){case 13:var s=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:s=e.stateNode;break;case 22:s=e.stateNode._retryCache;break;default:throw Error(a(314))}null!==s&&s.delete(t),hd(e,n)}var yd=null,bd=null,vd=!1,Nd=!1,wd=!1,kd=0;function Ed(e){e!==bd&&null===e.next&&(null===bd?yd=bd=e:bd=bd.next=e),Nd=!0,vd||(vd=!0,pu(function(){6&sc?J(ne,Cd):_d()}))}function jd(e,t){if(!wd&&Nd){wd=!0;do{for(var n=!1,a=yd;null!==a;){if(0!==e){var s=a.pendingLanes;if(0===s)var r=0;else{var i=a.suspendedLanes,l=a.pingedLanes;r=(1<<31-me(42|e)+1)-1,r=201326741&(r&=s&~(i&~l))?201326741&r|1:r?2|r:0}0!==r&&(n=!0,Ad(a,r))}else r=lc,!(3&(r=ye(a,a===rc?r:0,null!==a.cancelPendingCommit||-1!==a.timeoutHandle)))||be(a,r)||(n=!0,Ad(a,r));a=a.next}}while(n);wd=!1}}function Cd(){_d()}function _d(){Nd=vd=!1;var e=0;0!==kd&&(function(){var e=window.event;if(e&&"popstate"===e.type)return e!==cu&&(cu=e,!0);return cu=null,!1}()&&(e=kd),kd=0);for(var t=ee(),n=null,a=yd;null!==a;){var s=a.next,r=Td(a,t);0===r?(a.next=null,null===n?yd=s:n.next=s,null===s&&(bd=n)):(n=a,(0!==e||3&r)&&(Nd=!0)),a=s}jd(e)}function Td(e,t){for(var n=e.suspendedLanes,a=e.pingedLanes,s=e.expirationTimes,r=-62914561&e.pendingLanes;0<r;){var i=31-me(r),l=1<<i,o=s[i];-1===o?0!==(l&n)&&0===(l&a)||(s[i]=ve(l,t)):o<=t&&(e.expiredLanes|=l),r&=~l}if(n=lc,n=ye(e,e===(t=rc)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),a=e.callbackNode,0===n||e===t&&(2===oc||9===oc)||null!==e.cancelPendingCommit)return null!==a&&null!==a&&Z(a),e.callbackNode=null,e.callbackPriority=0;if(!(3&n)||be(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==a&&Z(a),Te(n)){case 2:case 8:n=ae;break;case 32:default:n=se;break;case 268435456:n=ie}return a=Sd.bind(null,e),n=J(n,a),e.callbackPriority=t,e.callbackNode=n,t}return null!==a&&null!==a&&Z(a),e.callbackPriority=2,e.callbackNode=null,2}function Sd(e,t){if(0!==_c&&5!==_c)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(cd()&&e.callbackNode!==n)return null;var a=lc;return 0===(a=ye(e,e===rc?a:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Fc(e,a,t),Td(e,ee()),null!=e.callbackNode&&e.callbackNode===n?Sd.bind(null,e):null)}function Ad(e,t){if(cd())return null;Fc(e,t,!0)}function Id(){return 0===kd&&(kd=Ne()),kd}function Dd(e){return null==e||"symbol"==typeof e||"boolean"==typeof e?null:"function"==typeof e?e:It(""+e)}function Od(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Rd=0;Rd<ka.length;Rd++){var Pd=ka[Rd];Ea(Pd.toLowerCase(),"on"+(Pd[0].toUpperCase()+Pd.slice(1)))}Ea(ha,"onAnimationEnd"),Ea(ga,"onAnimationIteration"),Ea(xa,"onAnimationStart"),Ea("dblclick","onDoubleClick"),Ea("focusin","onFocus"),Ea("focusout","onBlur"),Ea(ya,"onTransitionRun"),Ea(ba,"onTransitionStart"),Ea(va,"onTransitionCancel"),Ea(Na,"onTransitionEnd"),Ze("onMouseEnter",["mouseout","mouseover"]),Ze("onMouseLeave",["mouseout","mouseover"]),Ze("onPointerEnter",["pointerout","pointerover"]),Ze("onPointerLeave",["pointerout","pointerover"]),Ye("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ye("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ye("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ye("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ye("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ye("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Md="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ud=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Md));function Ld(e,t){t=!!(4&t);for(var n=0;n<e.length;n++){var a=e[n],s=a.event;a=a.listeners;e:{var r=void 0;if(t)for(var i=a.length-1;0<=i;i--){var l=a[i],o=l.instance,c=l.currentTarget;if(l=l.listener,o!==r&&s.isPropagationStopped())break e;r=l,s.currentTarget=c;try{r(s)}catch(d){yl(d)}s.currentTarget=null,r=o}else for(i=0;i<a.length;i++){if(o=(l=a[i]).instance,c=l.currentTarget,l=l.listener,o!==r&&s.isPropagationStopped())break e;r=l,s.currentTarget=c;try{r(s)}catch(d){yl(d)}s.currentTarget=null,r=o}}}}function Fd(e,t){var n=t[Re];void 0===n&&(n=t[Re]=new Set);var a=e+"__bubble";n.has(a)||(Vd(t,e,2,!1),n.add(a))}function Bd(e,t,n){var a=0;t&&(a|=4),Vd(n,e,a,t)}var $d="_reactListening"+Math.random().toString(36).slice(2);function Gd(e){if(!e[$d]){e[$d]=!0,qe.forEach(function(t){"selectionchange"!==t&&(Ud.has(t)||Bd(t,!1,e),Bd(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[$d]||(t[$d]=!0,Bd("selectionchange",!1,t))}}function Vd(e,t,n,a){switch(um(t)){case 2:var s=rm;break;case 8:s=im;break;default:s=lm}n=s.bind(null,t,n,e),s=void 0,!$t||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(s=!0),a?void 0!==s?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):void 0!==s?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function zd(e,t,n,a,s){var r=a;if(!(1&t||2&t||null===a))e:for(;;){if(null===a)return;var i=a.tag;if(3===i||4===i){var o=a.stateNode.containerInfo;if(o===s)break;if(4===i)for(i=a.return;null!==i;){var c=i.tag;if((3===c||4===c)&&i.stateNode.containerInfo===s)return;i=i.return}for(;null!==o;){if(null===(i=Be(o)))return;if(5===(c=i.tag)||6===c||26===c||27===c){a=r=i;continue e}o=o.parentNode}}a=a.return}Lt(function(){var a=r,s=Ot(n),i=[];e:{var o=wa.get(e);if(void 0!==o){var c=tn,d=e;switch(e){case"keypress":if(0===Ht(n))break e;case"keydown":case"keyup":c=xn;break;case"focusin":d="focus",c=on;break;case"focusout":d="blur",c=on;break;case"beforeblur":case"afterblur":c=on;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=rn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=ln;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=bn;break;case ha:case ga:case xa:c=cn;break;case Na:c=vn;break;case"scroll":case"scrollend":c=an;break;case"wheel":c=Nn;break;case"copy":case"cut":case"paste":c=dn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=yn;break;case"toggle":case"beforetoggle":c=wn}var u=!!(4&t),m=!u&&("scroll"===e||"scrollend"===e),p=u?null!==o?o+"Capture":null:o;u=[];for(var f,h=a;null!==h;){var g=h;if(f=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===f||null===p||null!=(g=Ft(h,p))&&u.push(Wd(h,g,f)),m)break;h=h.return}0<u.length&&(o=new c(o,d,null,n,s),i.push({event:o,listeners:u}))}}if(!(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===Dt||!(d=n.relatedTarget||n.fromElement)||!Be(d)&&!d[Oe])&&(c||o)&&(o=s.window===s?s:(o=s.ownerDocument)?o.defaultView||o.parentWindow:window,c?(c=a,null!==(d=(d=n.relatedTarget||n.toElement)?Be(d):null)&&(m=l(d),u=d.tag,d!==m||5!==u&&27!==u&&6!==u)&&(d=null)):(c=null,d=a),c!==d)){if(u=rn,g="onMouseLeave",p="onMouseEnter",h="mouse","pointerout"!==e&&"pointerover"!==e||(u=yn,g="onPointerLeave",p="onPointerEnter",h="pointer"),m=null==c?o:Ge(c),f=null==d?o:Ge(d),(o=new u(g,h+"leave",c,n,s)).target=m,o.relatedTarget=f,g=null,Be(s)===a&&((u=new u(p,h+"enter",d,n,s)).target=f,u.relatedTarget=m,g=u),m=g,c&&d)e:{for(p=d,h=0,f=u=c;f;f=Hd(f))h++;for(f=0,g=p;g;g=Hd(g))f++;for(;0<h-f;)u=Hd(u),h--;for(;0<f-h;)p=Hd(p),f--;for(;h--;){if(u===p||null!==p&&u===p.alternate)break e;u=Hd(u),p=Hd(p)}u=null}else u=null;null!==c&&Kd(i,o,c,u,!1),null!==d&&null!==m&&Kd(i,m,d,u,!0)}if("select"===(c=(o=a?Ge(a):window).nodeName&&o.nodeName.toLowerCase())||"input"===c&&"file"===o.type)var x=Bn;else if(Rn(o))if($n)x=Jn;else{x=Kn;var y=Hn}else!(c=o.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==o.type&&"radio"!==o.type?a&&Tt(a.elementType)&&(x=Bn):x=Yn;switch(x&&(x=x(e,a))?Pn(i,x,n,s):(y&&y(e,o,a),"focusout"===e&&a&&"number"===o.type&&null!=a.memoizedProps.value&&vt(o,"number",o.value)),y=a?Ge(a):window,e){case"focusin":(Rn(y)||"true"===y.contentEditable)&&(ra=y,ia=a,la=null);break;case"focusout":la=ia=ra=null;break;case"mousedown":oa=!0;break;case"contextmenu":case"mouseup":case"dragend":oa=!1,ca(i,n,s);break;case"selectionchange":if(sa)break;case"keydown":case"keyup":ca(i,n,s)}var b;if(En)e:{switch(e){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else Dn?An(e,n)&&(v="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(v="onCompositionStart");v&&(_n&&"ko"!==n.locale&&(Dn||"onCompositionStart"!==v?"onCompositionEnd"===v&&Dn&&(b=qt()):(zt="value"in(Vt=s)?Vt.value:Vt.textContent,Dn=!0)),0<(y=qd(a,v)).length&&(v=new un(v,e,null,n,s),i.push({event:v,listeners:y}),b?v.data=b:null!==(b=In(n))&&(v.data=b))),(b=Cn?function(e,t){switch(e){case"compositionend":return In(t);case"keypress":return 32!==t.which?null:(Sn=!0,Tn);case"textInput":return(e=t.data)===Tn&&Sn?null:e;default:return null}}(e,n):function(e,t){if(Dn)return"compositionend"===e||!En&&An(e,t)?(e=qt(),Wt=zt=Vt=null,Dn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return _n&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(v=qd(a,"onBeforeInput")).length&&(y=new un("onBeforeInput","beforeinput",null,n,s),i.push({event:y,listeners:v}),y.data=b)),function(e,t,n,a,s){if("submit"===t&&n&&n.stateNode===s){var r=Dd((s[De]||null).action),i=a.submitter;i&&null!==(t=(t=i[De]||null)?Dd(t.formAction):i.getAttribute("formAction"))&&(r=t,i=null);var l=new tn("action","action",null,a,s);e.push({event:l,listeners:[{instance:null,listener:function(){if(a.defaultPrevented){if(0!==kd){var e=i?Od(s,i):new FormData(s);Di(n,{pending:!0,data:e,method:s.method,action:r},null,e)}}else"function"==typeof r&&(l.preventDefault(),e=i?Od(s,i):new FormData(s),Di(n,{pending:!0,data:e,method:s.method,action:r},r,e))},currentTarget:s}]})}}(i,e,a,n,s)}Ld(i,t)})}function Wd(e,t,n){return{instance:e,listener:t,currentTarget:n}}function qd(e,t){for(var n=t+"Capture",a=[];null!==e;){var s=e,r=s.stateNode;if(5!==(s=s.tag)&&26!==s&&27!==s||null===r||(null!=(s=Ft(e,n))&&a.unshift(Wd(e,s,r)),null!=(s=Ft(e,t))&&a.push(Wd(e,s,r))),3===e.tag)return a;e=e.return}return[]}function Hd(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function Kd(e,t,n,a,s){for(var r=t._reactName,i=[];null!==n&&n!==a;){var l=n,o=l.alternate,c=l.stateNode;if(l=l.tag,null!==o&&o===a)break;5!==l&&26!==l&&27!==l||null===c||(o=c,s?null!=(c=Ft(n,r))&&i.unshift(Wd(n,c,o)):s||null!=(c=Ft(n,r))&&i.push(Wd(n,c,o))),n=n.return}0!==i.length&&e.push({event:t,listeners:i})}var Yd=/\r\n?/g,Jd=/\u0000|\uFFFD/g;function Zd(e){return("string"==typeof e?e:""+e).replace(Yd,"\n").replace(Jd,"")}function Qd(e,t){return t=Zd(t),Zd(e)===t}function Xd(){}function eu(e,t,n,s,r,i){switch(n){case"children":"string"==typeof s?"body"===t||"textarea"===t&&""===s||Et(e,s):("number"==typeof s||"bigint"==typeof s)&&"body"!==t&&Et(e,""+s);break;case"className":st(e,"class",s);break;case"tabIndex":st(e,"tabindex",s);break;case"dir":case"role":case"viewBox":case"width":case"height":st(e,n,s);break;case"style":_t(e,s,i);break;case"data":if("object"!==t){st(e,"data",s);break}case"src":case"href":if(""===s&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==s||"function"==typeof s||"symbol"==typeof s||"boolean"==typeof s){e.removeAttribute(n);break}s=It(""+s),e.setAttribute(n,s);break;case"action":case"formAction":if("function"==typeof s){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"==typeof i&&("formAction"===n?("input"!==t&&eu(e,t,"name",r.name,r,null),eu(e,t,"formEncType",r.formEncType,r,null),eu(e,t,"formMethod",r.formMethod,r,null),eu(e,t,"formTarget",r.formTarget,r,null)):(eu(e,t,"encType",r.encType,r,null),eu(e,t,"method",r.method,r,null),eu(e,t,"target",r.target,r,null))),null==s||"symbol"==typeof s||"boolean"==typeof s){e.removeAttribute(n);break}s=It(""+s),e.setAttribute(n,s);break;case"onClick":null!=s&&(e.onclick=Xd);break;case"onScroll":null!=s&&Fd("scroll",e);break;case"onScrollEnd":null!=s&&Fd("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=s){if("object"!=typeof s||!("__html"in s))throw Error(a(61));if(null!=(n=s.__html)){if(null!=r.children)throw Error(a(60));e.innerHTML=n}}break;case"multiple":e.multiple=s&&"function"!=typeof s&&"symbol"!=typeof s;break;case"muted":e.muted=s&&"function"!=typeof s&&"symbol"!=typeof s;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==s||"function"==typeof s||"boolean"==typeof s||"symbol"==typeof s){e.removeAttribute("xlink:href");break}n=It(""+s),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=s&&"function"!=typeof s&&"symbol"!=typeof s?e.setAttribute(n,""+s):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":s&&"function"!=typeof s&&"symbol"!=typeof s?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===s?e.setAttribute(n,""):!1!==s&&null!=s&&"function"!=typeof s&&"symbol"!=typeof s?e.setAttribute(n,s):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=s&&"function"!=typeof s&&"symbol"!=typeof s&&!isNaN(s)&&1<=s?e.setAttribute(n,s):e.removeAttribute(n);break;case"rowSpan":case"start":null==s||"function"==typeof s||"symbol"==typeof s||isNaN(s)?e.removeAttribute(n):e.setAttribute(n,s);break;case"popover":Fd("beforetoggle",e),Fd("toggle",e),at(e,"popover",s);break;case"xlinkActuate":rt(e,"http://www.w3.org/1999/xlink","xlink:actuate",s);break;case"xlinkArcrole":rt(e,"http://www.w3.org/1999/xlink","xlink:arcrole",s);break;case"xlinkRole":rt(e,"http://www.w3.org/1999/xlink","xlink:role",s);break;case"xlinkShow":rt(e,"http://www.w3.org/1999/xlink","xlink:show",s);break;case"xlinkTitle":rt(e,"http://www.w3.org/1999/xlink","xlink:title",s);break;case"xlinkType":rt(e,"http://www.w3.org/1999/xlink","xlink:type",s);break;case"xmlBase":rt(e,"http://www.w3.org/XML/1998/namespace","xml:base",s);break;case"xmlLang":rt(e,"http://www.w3.org/XML/1998/namespace","xml:lang",s);break;case"xmlSpace":rt(e,"http://www.w3.org/XML/1998/namespace","xml:space",s);break;case"is":at(e,"is",s);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&at(e,n=St.get(n)||n,s)}}function tu(e,t,n,s,r,i){switch(n){case"style":_t(e,s,i);break;case"dangerouslySetInnerHTML":if(null!=s){if("object"!=typeof s||!("__html"in s))throw Error(a(61));if(null!=(n=s.__html)){if(null!=r.children)throw Error(a(60));e.innerHTML=n}}break;case"children":"string"==typeof s?Et(e,s):("number"==typeof s||"bigint"==typeof s)&&Et(e,""+s);break;case"onScroll":null!=s&&Fd("scroll",e);break;case"onScrollEnd":null!=s&&Fd("scrollend",e);break;case"onClick":null!=s&&(e.onclick=Xd);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:Ke.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(r=n.endsWith("Capture"),t=n.slice(2,r?n.length-7:void 0),"function"==typeof(i=null!=(i=e[De]||null)?i[n]:null)&&e.removeEventListener(t,i,r),"function"!=typeof s)?n in e?e[n]=s:!0===s?e.setAttribute(n,""):at(e,n,s):("function"!=typeof i&&null!==i&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,s,r)))}}function nu(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Fd("error",e),Fd("load",e);var s,r=!1,i=!1;for(s in n)if(n.hasOwnProperty(s)){var l=n[s];if(null!=l)switch(s){case"src":r=!0;break;case"srcSet":i=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:eu(e,t,s,l,n,null)}}return i&&eu(e,t,"srcSet",n.srcSet,n,null),void(r&&eu(e,t,"src",n.src,n,null));case"input":Fd("invalid",e);var o=s=l=i=null,c=null,d=null;for(r in n)if(n.hasOwnProperty(r)){var u=n[r];if(null!=u)switch(r){case"name":i=u;break;case"type":l=u;break;case"checked":c=u;break;case"defaultChecked":d=u;break;case"value":s=u;break;case"defaultValue":o=u;break;case"children":case"dangerouslySetInnerHTML":if(null!=u)throw Error(a(137,t));break;default:eu(e,t,r,u,n,null)}}return bt(e,s,o,c,d,l,i,!1),void pt(e);case"select":for(i in Fd("invalid",e),r=l=s=null,n)if(n.hasOwnProperty(i)&&null!=(o=n[i]))switch(i){case"value":s=o;break;case"defaultValue":l=o;break;case"multiple":r=o;default:eu(e,t,i,o,n,null)}return t=s,n=l,e.multiple=!!r,void(null!=t?Nt(e,!!r,t,!1):null!=n&&Nt(e,!!r,n,!0));case"textarea":for(l in Fd("invalid",e),s=i=r=null,n)if(n.hasOwnProperty(l)&&null!=(o=n[l]))switch(l){case"value":r=o;break;case"defaultValue":i=o;break;case"children":s=o;break;case"dangerouslySetInnerHTML":if(null!=o)throw Error(a(91));break;default:eu(e,t,l,o,n,null)}return kt(e,r,i,s),void pt(e);case"option":for(c in n)if(n.hasOwnProperty(c)&&null!=(r=n[c]))if("selected"===c)e.selected=r&&"function"!=typeof r&&"symbol"!=typeof r;else eu(e,t,c,r,n,null);return;case"dialog":Fd("beforetoggle",e),Fd("toggle",e),Fd("cancel",e),Fd("close",e);break;case"iframe":case"object":Fd("load",e);break;case"video":case"audio":for(r=0;r<Md.length;r++)Fd(Md[r],e);break;case"image":Fd("error",e),Fd("load",e);break;case"details":Fd("toggle",e);break;case"embed":case"source":case"link":Fd("error",e),Fd("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(d in n)if(n.hasOwnProperty(d)&&null!=(r=n[d]))switch(d){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:eu(e,t,d,r,n,null)}return;default:if(Tt(t)){for(u in n)n.hasOwnProperty(u)&&(void 0!==(r=n[u])&&tu(e,t,u,r,n,void 0));return}}for(o in n)n.hasOwnProperty(o)&&(null!=(r=n[o])&&eu(e,t,o,r,n,null))}var au=null,su=null;function ru(e){return 9===e.nodeType?e:e.ownerDocument}function iu(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function lu(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function ou(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"bigint"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var cu=null;var du="function"==typeof setTimeout?setTimeout:void 0,uu="function"==typeof clearTimeout?clearTimeout:void 0,mu="function"==typeof Promise?Promise:void 0,pu="function"==typeof queueMicrotask?queueMicrotask:void 0!==mu?function(e){return mu.resolve(null).then(e).catch(fu)}:du;function fu(e){setTimeout(function(){throw e})}function hu(e){return"head"===e}function gu(e,t){var n=t,a=0,s=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0<a&&8>a){n=a;var i=e.ownerDocument;if(1&n&&ku(i.documentElement),2&n&&ku(i.body),4&n)for(ku(n=i.head),i=n.firstChild;i;){var l=i.nextSibling,o=i.nodeName;i[Le]||"SCRIPT"===o||"STYLE"===o||"LINK"===o&&"stylesheet"===i.rel.toLowerCase()||n.removeChild(i),i=l}}if(0===s)return e.removeChild(r),void Sm(t);s--}else"$"===n||"$?"===n||"$!"===n?s++:a=n.charCodeAt(0)-48;else a=0;n=r}while(n);Sm(t)}function xu(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":xu(n),Fe(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function yu(e){return"$!"===e.data||"$?"===e.data&&"complete"===e.ownerDocument.readyState}function bu(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"F!"===t||"F"===t)break;if("/$"===t)return null}}return e}var vu=null;function Nu(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}function wu(e,t,n){switch(t=ru(n),e){case"html":if(!(e=t.documentElement))throw Error(a(452));return e;case"head":if(!(e=t.head))throw Error(a(453));return e;case"body":if(!(e=t.body))throw Error(a(454));return e;default:throw Error(a(451))}}function ku(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Fe(e)}var Eu=new Map,ju=new Set;function Cu(e){return"function"==typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var _u=R.d;R.d={f:function(){var e=_u.f(),t=Vc();return e||t},r:function(e){var t=$e(e);null!==t&&5===t.tag&&"form"===t.type?Ri(t):_u.r(e)},D:function(e){_u.D(e),Su("dns-prefetch",e,null)},C:function(e,t){_u.C(e,t),Su("preconnect",e,t)},L:function(e,t,n){_u.L(e,t,n);var a=Tu;if(a&&e&&t){var s='link[rel="preload"][as="'+xt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(s+='[imagesrcset="'+xt(n.imageSrcSet)+'"]',"string"==typeof n.imageSizes&&(s+='[imagesizes="'+xt(n.imageSizes)+'"]')):s+='[href="'+xt(e)+'"]';var r=s;switch(t){case"style":r=Iu(e);break;case"script":r=Ru(e)}Eu.has(r)||(e=u({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),Eu.set(r,e),null!==a.querySelector(s)||"style"===t&&a.querySelector(Du(r))||"script"===t&&a.querySelector(Pu(r))||(nu(t=a.createElement("link"),"link",e),We(t),a.head.appendChild(t)))}},m:function(e,t){_u.m(e,t);var n=Tu;if(n&&e){var a=t&&"string"==typeof t.as?t.as:"script",s='link[rel="modulepreload"][as="'+xt(a)+'"][href="'+xt(e)+'"]',r=s;switch(a){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":r=Ru(e)}if(!Eu.has(r)&&(e=u({rel:"modulepreload",href:e},t),Eu.set(r,e),null===n.querySelector(s))){switch(a){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Pu(r)))return}nu(a=n.createElement("link"),"link",e),We(a),n.head.appendChild(a)}}},X:function(e,t){_u.X(e,t);var n=Tu;if(n&&e){var a=ze(n).hoistableScripts,s=Ru(e),r=a.get(s);r||((r=n.querySelector(Pu(s)))||(e=u({src:e,async:!0},t),(t=Eu.get(s))&&Fu(e,t),We(r=n.createElement("script")),nu(r,"link",e),n.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},a.set(s,r))}},S:function(e,t,n){_u.S(e,t,n);var a=Tu;if(a&&e){var s=ze(a).hoistableStyles,r=Iu(e);t=t||"default";var i=s.get(r);if(!i){var l={loading:0,preload:null};if(i=a.querySelector(Du(r)))l.loading=5;else{e=u({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Eu.get(r))&&Lu(e,n);var o=i=a.createElement("link");We(o),nu(o,"link",e),o._p=new Promise(function(e,t){o.onload=e,o.onerror=t}),o.addEventListener("load",function(){l.loading|=1}),o.addEventListener("error",function(){l.loading|=2}),l.loading|=4,Uu(i,t,a)}i={type:"stylesheet",instance:i,count:1,state:l},s.set(r,i)}}},M:function(e,t){_u.M(e,t);var n=Tu;if(n&&e){var a=ze(n).hoistableScripts,s=Ru(e),r=a.get(s);r||((r=n.querySelector(Pu(s)))||(e=u({src:e,async:!0,type:"module"},t),(t=Eu.get(s))&&Fu(e,t),We(r=n.createElement("script")),nu(r,"link",e),n.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},a.set(s,r))}}};var Tu="undefined"==typeof document?null:document;function Su(e,t,n){var a=Tu;if(a&&"string"==typeof t&&t){var s=xt(t);s='link[rel="'+e+'"][href="'+s+'"]',"string"==typeof n&&(s+='[crossorigin="'+n+'"]'),ju.has(s)||(ju.add(s),e={rel:e,crossOrigin:n,href:t},null===a.querySelector(s)&&(nu(t=a.createElement("link"),"link",e),We(t),a.head.appendChild(t)))}}function Au(e,t,n,s){var r,i,l,o,c=(c=V.current)?Cu(c):null;if(!c)throw Error(a(446));switch(e){case"meta":case"title":return null;case"style":return"string"==typeof n.precedence&&"string"==typeof n.href?(t=Iu(n.href),(s=(n=ze(c).hoistableStyles).get(t))||(s={type:"style",instance:null,count:0,state:null},n.set(t,s)),s):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"==typeof n.href&&"string"==typeof n.precedence){e=Iu(n.href);var d=ze(c).hoistableStyles,u=d.get(e);if(u||(c=c.ownerDocument||c,u={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},d.set(e,u),(d=c.querySelector(Du(e)))&&!d._p&&(u.instance=d,u.state.loading=5),Eu.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Eu.set(e,n),d||(r=c,i=e,l=n,o=u.state,r.querySelector('link[rel="preload"][as="style"]['+i+"]")?o.loading=1:(i=r.createElement("link"),o.preload=i,i.addEventListener("load",function(){return o.loading|=1}),i.addEventListener("error",function(){return o.loading|=2}),nu(i,"link",l),We(i),r.head.appendChild(i))))),t&&null===s)throw Error(a(528,""));return u}if(t&&null!==s)throw Error(a(529,""));return null;case"script":return t=n.async,"string"==typeof(n=n.src)&&t&&"function"!=typeof t&&"symbol"!=typeof t?(t=Ru(n),(s=(n=ze(c).hoistableScripts).get(t))||(s={type:"script",instance:null,count:0,state:null},n.set(t,s)),s):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,e))}}function Iu(e){return'href="'+xt(e)+'"'}function Du(e){return'link[rel="stylesheet"]['+e+"]"}function Ou(e){return u({},e,{"data-precedence":e.precedence,precedence:null})}function Ru(e){return'[src="'+xt(e)+'"]'}function Pu(e){return"script[async]"+e}function Mu(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var s=e.querySelector('style[data-href~="'+xt(n.href)+'"]');if(s)return t.instance=s,We(s),s;var r=u({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return We(s=(e.ownerDocument||e).createElement("style")),nu(s,"style",r),Uu(s,n.precedence,e),t.instance=s;case"stylesheet":r=Iu(n.href);var i=e.querySelector(Du(r));if(i)return t.state.loading|=4,t.instance=i,We(i),i;s=Ou(n),(r=Eu.get(r))&&Lu(s,r),We(i=(e.ownerDocument||e).createElement("link"));var l=i;return l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),nu(i,"link",s),t.state.loading|=4,Uu(i,n.precedence,e),t.instance=i;case"script":return i=Ru(n.src),(r=e.querySelector(Pu(i)))?(t.instance=r,We(r),r):(s=n,(r=Eu.get(i))&&Fu(s=u({},n),r),We(r=(e=e.ownerDocument||e).createElement("script")),nu(r,"link",s),e.head.appendChild(r),t.instance=r);case"void":return null;default:throw Error(a(443,t.type))}else"stylesheet"===t.type&&!(4&t.state.loading)&&(s=t.instance,t.state.loading|=4,Uu(s,n.precedence,e));return t.instance}function Uu(e,t,n){for(var a=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),s=a.length?a[a.length-1]:null,r=s,i=0;i<a.length;i++){var l=a[i];if(l.dataset.precedence===t)r=l;else if(r!==s)break}r?r.parentNode.insertBefore(e,r.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function Lu(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function Fu(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var Bu=null;function $u(e,t,n){if(null===Bu){var a=new Map,s=Bu=new Map;s.set(n,a)}else(a=(s=Bu).get(n))||(a=new Map,s.set(n,a));if(a.has(e))return a;for(a.set(e,null),n=n.getElementsByTagName(e),s=0;s<n.length;s++){var r=n[s];if(!(r[Le]||r[Ie]||"link"===e&&"stylesheet"===r.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==r.namespaceURI){var i=r.getAttribute(t)||"";i=e+i;var l=a.get(i);l?l.push(r):a.set(i,[r])}}return a}function Gu(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function Vu(e){return!!("stylesheet"!==e.type||3&e.state.loading)}var zu=null;function Wu(){}function qu(){if(this.count--,0===this.count)if(this.stylesheets)Ku(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var Hu=null;function Ku(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,Hu=new Map,t.forEach(Yu,e),Hu=null,qu.call(e))}function Yu(e,t){if(!(4&t.state.loading)){var n=Hu.get(e);if(n)var a=n.get(null);else{n=new Map,Hu.set(e,n);for(var s=e.querySelectorAll("link[data-precedence],style[data-precedence]"),r=0;r<s.length;r++){var i=s[r];"LINK"!==i.nodeName&&"not all"===i.getAttribute("media")||(n.set(i.dataset.precedence,i),a=i)}a&&n.set(null,a)}i=(s=t.instance).getAttribute("data-precedence"),(r=n.get(i)||a)===a&&n.set(null,s),n.set(i,s),this.count++,a=qu.bind(this),s.addEventListener("load",a),s.addEventListener("error",a),r?r.parentNode.insertBefore(s,r.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(s,e.firstChild),t.state.loading|=4}}var Ju={$$typeof:v,Provider:null,Consumer:null,_currentValue:P,_currentValue2:P,_threadCount:0};function Zu(e,t,n,a,s,r,i,l){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ke(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ke(0),this.hiddenUpdates=ke(null),this.identifierPrefix=a,this.onUncaughtError=s,this.onCaughtError=r,this.onRecoverableError=i,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=l,this.incompleteTransitions=new Map}function Qu(e,t,n,a,s,r,i,l,o,c,d,u){return e=new Zu(e,t,n,i,l,o,c,u),t=1,!0===r&&(t|=24),r=La(3,null,null,t),e.current=r,r.stateNode=e,(t=Ps()).refCount++,e.pooledCache=t,t.refCount++,r.memoizedState={element:a,isDehydrated:n,cache:t},sr(r),e}function Xu(e){return e?e=Ma:Ma}function em(e,t,n,a,s,r){s=Xu(s),null===a.context?a.context=s:a.pendingContext=s,(a=ir(t)).payload={element:n},null!==(r=void 0===r?null:r)&&(a.callback=r),null!==(n=lr(e,a,t))&&(Lc(n,0,t),or(n,e,t))}function tm(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function nm(e,t){tm(e,t),(e=e.alternate)&&tm(e,t)}function am(e){if(13===e.tag){var t=Oa(e,67108864);null!==t&&Lc(t,0,67108864),nm(e,67108864)}}var sm=!0;function rm(e,t,n,a){var s=O.T;O.T=null;var r=R.p;try{R.p=2,lm(e,t,n,a)}finally{R.p=r,O.T=s}}function im(e,t,n,a){var s=O.T;O.T=null;var r=R.p;try{R.p=8,lm(e,t,n,a)}finally{R.p=r,O.T=s}}function lm(e,t,n,a){if(sm){var s=om(a);if(null===s)zd(e,t,a,cm,n),vm(e,a);else if(function(e,t,n,a,s){switch(t){case"focusin":return pm=Nm(pm,e,t,n,a,s),!0;case"dragenter":return fm=Nm(fm,e,t,n,a,s),!0;case"mouseover":return hm=Nm(hm,e,t,n,a,s),!0;case"pointerover":var r=s.pointerId;return gm.set(r,Nm(gm.get(r)||null,e,t,n,a,s)),!0;case"gotpointercapture":return r=s.pointerId,xm.set(r,Nm(xm.get(r)||null,e,t,n,a,s)),!0}return!1}(s,e,t,n,a))a.stopPropagation();else if(vm(e,a),4&t&&-1<bm.indexOf(e)){for(;null!==s;){var r=$e(s);if(null!==r)switch(r.tag){case 3:if((r=r.stateNode).current.memoizedState.isDehydrated){var i=xe(r.pendingLanes);if(0!==i){var l=r;for(l.pendingLanes|=2,l.entangledLanes|=2;i;){var o=1<<31-me(i);l.entanglements[1]|=o,i&=~o}Ed(r),!(6&sc)&&(Ec=ee()+500,jd(0))}}break;case 13:null!==(l=Oa(r,2))&&Lc(l,0,2),Vc(),nm(r,2)}if(null===(r=om(a))&&zd(e,t,a,cm,n),r===s)break;s=r}null!==s&&a.stopPropagation()}else zd(e,t,a,null,n)}}function om(e){return dm(e=Ot(e))}var cm=null;function dm(e){if(cm=null,null!==(e=Be(e))){var t=l(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=o(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return cm=e,null}function um(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(te()){case ne:return 2;case ae:return 8;case se:case re:return 32;case ie:return 268435456;default:return 32}default:return 32}}var mm=!1,pm=null,fm=null,hm=null,gm=new Map,xm=new Map,ym=[],bm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function vm(e,t){switch(e){case"focusin":case"focusout":pm=null;break;case"dragenter":case"dragleave":fm=null;break;case"mouseover":case"mouseout":hm=null;break;case"pointerover":case"pointerout":gm.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":xm.delete(t.pointerId)}}function Nm(e,t,n,a,s,r){return null===e||e.nativeEvent!==r?(e={blockedOn:t,domEventName:n,eventSystemFlags:a,nativeEvent:r,targetContainers:[s]},null!==t&&(null!==(t=$e(t))&&am(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,null!==s&&-1===t.indexOf(s)&&t.push(s),e)}function wm(e){var t=Be(e.target);if(null!==t){var n=l(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=o(n)))return e.blockedOn=t,void function(e,t){var n=R.p;try{return R.p=e,t()}finally{R.p=n}}(e.priority,function(){if(13===n.tag){var e=Mc();e=_e(e);var t=Oa(n,e);null!==t&&Lc(t,0,e),nm(n,e)}})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function km(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=om(e.nativeEvent);if(null!==n)return null!==(t=$e(n))&&am(t),e.blockedOn=n,!1;var a=new(n=e.nativeEvent).constructor(n.type,n);Dt=a,n.target.dispatchEvent(a),Dt=null,t.shift()}return!0}function Em(e,t,n){km(e)&&n.delete(t)}function jm(){mm=!1,null!==pm&&km(pm)&&(pm=null),null!==fm&&km(fm)&&(fm=null),null!==hm&&km(hm)&&(hm=null),gm.forEach(Em),xm.forEach(Em)}function Cm(t,n){t.blockedOn===n&&(t.blockedOn=null,mm||(mm=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,jm)))}var _m=null;function Tm(t){_m!==t&&(_m=t,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){_m===t&&(_m=null);for(var e=0;e<t.length;e+=3){var n=t[e],a=t[e+1],s=t[e+2];if("function"!=typeof a){if(null===dm(a||n))continue;break}var r=$e(n);null!==r&&(t.splice(e,3),e-=3,Di(r,{pending:!0,data:s,method:n.method,action:a},a,s))}}))}function Sm(e){function t(t){return Cm(t,e)}null!==pm&&Cm(pm,e),null!==fm&&Cm(fm,e),null!==hm&&Cm(hm,e),gm.forEach(t),xm.forEach(t);for(var n=0;n<ym.length;n++){var a=ym[n];a.blockedOn===e&&(a.blockedOn=null)}for(;0<ym.length&&null===(n=ym[0]).blockedOn;)wm(n),null===n.blockedOn&&ym.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(a=0;a<n.length;a+=3){var s=n[a],r=n[a+1],i=s[De]||null;if("function"==typeof r)i||Tm(n);else if(i){var l=null;if(r&&r.hasAttribute("formAction")){if(s=r,i=r[De]||null)l=i.formAction;else if(null!==dm(s))continue}else l=i.action;"function"==typeof l?n[a+1]=l:(n.splice(a,3),a-=3),Tm(n)}}}function Am(e){this._internalRoot=e}function Im(e){this._internalRoot=e}Im.prototype.render=Am.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));em(t.current,Mc(),e,t,null,null)},Im.prototype.unmount=Am.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;em(e.current,2,null,e,null,null),Vc(),t[Oe]=null}},Im.prototype.unstable_scheduleHydration=function(e){if(e){var t=Se();e={blockedOn:null,target:e,priority:t};for(var n=0;n<ym.length&&0!==t&&t<ym[n].priority;n++);ym.splice(n,0,e),0===n&&wm(e)}};var Dm=t.version;if("19.1.1"!==Dm)throw Error(a(527,Dm,"19.1.1"));R.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,s=t;;){var r=n.return;if(null===r)break;var i=r.alternate;if(null===i){if(null!==(s=r.return)){n=s;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===n)return c(r),e;if(i===s)return c(r),t;i=i.sibling}throw Error(a(188))}if(n.return!==s.return)n=r,s=i;else{for(var o=!1,d=r.child;d;){if(d===n){o=!0,n=r,s=i;break}if(d===s){o=!0,s=r,n=i;break}d=d.sibling}if(!o){for(d=i.child;d;){if(d===n){o=!0,n=i,s=r;break}if(d===s){o=!0,s=i,n=r;break}d=d.sibling}if(!o)throw Error(a(189))}}if(n.alternate!==s)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?d(e):null)?null:e.stateNode};var Om={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:O,reconcilerVersion:"19.1.1"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Rm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Rm.isDisabled&&Rm.supportsFiber)try{ce=Rm.inject(Om),de=Rm}catch(Mm){}}return He.createRoot=function(e,t){if(!i(e))throw Error(a(299));var n=!1,s="",r=bl,l=vl,o=Nl;return null!=t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(s=t.identifierPrefix),void 0!==t.onUncaughtError&&(r=t.onUncaughtError),void 0!==t.onCaughtError&&(l=t.onCaughtError),void 0!==t.onRecoverableError&&(o=t.onRecoverableError),void 0!==t.unstable_transitionCallbacks&&t.unstable_transitionCallbacks),t=Qu(e,1,!1,null,0,n,s,r,l,o,0,null),e[Oe]=t.current,Gd(e),new Am(t)},He.hydrateRoot=function(e,t,n){if(!i(e))throw Error(a(299));var s=!1,r="",l=bl,o=vl,c=Nl,d=null;return null!=n&&(!0===n.unstable_strictMode&&(s=!0),void 0!==n.identifierPrefix&&(r=n.identifierPrefix),void 0!==n.onUncaughtError&&(l=n.onUncaughtError),void 0!==n.onCaughtError&&(o=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.unstable_transitionCallbacks&&n.unstable_transitionCallbacks,void 0!==n.formState&&(d=n.formState)),(t=Qu(e,1,!0,t,0,s,r,l,o,c,0,d)).context=Xu(null),n=t.current,(r=ir(s=_e(s=Mc()))).callback=null,lr(n,r,s),n=s,t.current.lanes=n,Ee(t,n),Ed(t),e[Oe]=t.current,Gd(e),new Im(t)},He.version="19.1.1",He}const Qe=i((ze||(ze=1,function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){}}(),qe.exports=Ze()),qe.exports));var Xe=(e=>(e.PLATFORM_ADMIN="PLATFORM_ADMIN",e.CAN_MANAGE_TENANTS="CAN_MANAGE_TENANTS",e.CAN_VIEW_ALL_TENANTS="CAN_VIEW_ALL_TENANTS",e.CAN_MANAGE_USERS="CAN_MANAGE_USERS",e.CAN_CREATE_USER="CAN_CREATE_USER",e.CAN_EDIT_USER="CAN_EDIT_USER",e.CAN_ARCHIVE_USER="CAN_ARCHIVE_USER",e.CAN_DELETE_ARCHIVED_USER="CAN_DELETE_ARCHIVED_USER",e.CAN_MANAGE_ROLES="CAN_MANAGE_ROLES",e.CAN_MANAGE_BUSINESS_UNITS="CAN_MANAGE_BUSINESS_UNITS",e.CAN_MANAGE_TEAM_TASKS="CAN_MANAGE_TEAM_TASKS",e.CAN_CREATE_PERSONAL_TASKS="CAN_CREATE_PERSONAL_TASKS",e.CAN_VIEW_OWN_TASKS="CAN_VIEW_OWN_TASKS",e.CAN_EDIT_ANY_TASK_STATUS="CAN_EDIT_ANY_TASK_STATUS",e.CAN_VIEW_OWN_REPORTS="CAN_VIEW_OWN_REPORTS",e.CAN_SUBMIT_OWN_EOD="CAN_SUBMIT_OWN_EOD",e.CAN_MANAGE_TEAM_REPORTS="CAN_MANAGE_TEAM_REPORTS",e.CAN_ACKNOWLEDGE_REPORTS="CAN_ACKNOWLEDGE_REPORTS",e.CAN_VIEW_ALL_REPORTS="CAN_VIEW_ALL_REPORTS",e.CAN_MANAGE_ALL_LEAVES="CAN_MANAGE_ALL_LEAVES",e.CAN_SUBMIT_OWN_LEAVE="CAN_SUBMIT_OWN_LEAVE",e.CAN_MANAGE_TEAM_MEETINGS="CAN_MANAGE_TEAM_MEETINGS",e.CAN_VIEW_OWN_MEETINGS="CAN_VIEW_OWN_MEETINGS",e.CAN_VIEW_OWN_CALENDAR="CAN_VIEW_OWN_CALENDAR",e.CAN_VIEW_TEAM_CALENDAR="CAN_VIEW_TEAM_CALENDAR",e.CAN_USE_PERFORMANCE_HUB="CAN_USE_PERFORMANCE_HUB",e.CAN_VIEW_LEADERBOARD="CAN_VIEW_LEADERBOARD",e.CAN_USE_GOOGLE_CALENDAR="CAN_USE_GOOGLE_CALENDAR",e.CAN_USE_TELEGRAM_BOT="CAN_USE_TELEGRAM_BOT",e.CAN_USE_GEMINI_AI="CAN_USE_GEMINI_AI",e.CAN_GRANT_LEAVE_ACCESS="CAN_GRANT_LEAVE_ACCESS",e.CAN_MANAGE_WEEKLY_OFF="CAN_MANAGE_WEEKLY_OFF",e.CAN_DEFINE_LEAVE_REVOKE_RULES="CAN_DEFINE_LEAVE_REVOKE_RULES",e.CAN_MANAGE_ANNOUNCEMENTS="CAN_MANAGE_ANNOUNCEMENTS",e.CAN_VIEW_TRIGGER_LOG="CAN_VIEW_TRIGGER_LOG",e))(Xe||{}),et=(e=>(e.ACTIVE="active",e.ARCHIVED="archived",e))(et||{}),tt=(e=>(e.PENDING_ACKNOWLEDGMENT="Pending Acknowledgment",e.ACKNOWLEDGED="Acknowledged",e))(tt||{}),nt=(e=>(e.High="High",e.Medium="Medium",e.Low="Low",e))(nt||{}),at=(e=>(e.NotStarted="Not Started",e.InProgress="In Progress",e.Completed="Completed",e.Blocked="Blocked",e))(at||{}),st=(e=>(e.Team="Team Task",e.Direct="Direct Assignment",e.Personal="Personal Task",e))(st||{}),rt=(e=>(e.ATTENDING="Attending",e.MAYBE="Maybe",e.DECLINED="Declined",e))(rt||{}),it=(e=>(e.APPROVED="Approved",e))(it||{}),lt=(e=>(e.STARTER="starter",e.PROFESSIONAL="professional",e.ENTERPRISE="enterprise",e))(lt||{}),ot=(e=>(e.ACTIVE="active",e.SUSPENDED="suspended",e.INACTIVE="inactive",e))(ot||{}),ct=(e=>(e.TEN_DAY_STREAK="TenDayStreak",e.TWENTY_DAY_STREAK="TwentyDayStreak",e.FULL_MONTH_FINISHER="FullMonthFinisher",e))(ct||{}),dt=(e=>(e.EOD_SUBMITTED="EOD_SUBMITTED",e.EOD_LATE_SUBMITTED="EOD_LATE_SUBMITTED",e.EOD_EDITED="EOD_EDITED",e.EOD_ACKNOWLEDGED="EOD_ACKNOWLEDGED",e.LEAVE_MARKED_BY_EMPLOYEE="LEAVE_MARKED_BY_EMPLOYEE",e.LEAVE_MARKED_BY_MANAGER="LEAVE_MARKED_BY_MANAGER",e.LEAVE_REVOKED_BY_EMPLOYEE="LEAVE_REVOKED_BY_EMPLOYEE",e.LEAVE_REVOKED_BY_MANAGER="LEAVE_REVOKED_BY_MANAGER",e.LEAVE_FUTURE_SCHEDULED_BY_EMPLOYEE="LEAVE_FUTURE_SCHEDULED_BY_EMPLOYEE",e.LEAVE_FUTURE_CANCELED_BY_EMPLOYEE="LEAVE_FUTURE_CANCELED_BY_EMPLOYEE",e.LEAVE_FUTURE_SCHEDULED_BY_MANAGER="LEAVE_FUTURE_SCHEDULED_BY_MANAGER",e.LEAVE_FUTURE_CANCELED_BY_MANAGER="LEAVE_FUTURE_CANCELED_BY_MANAGER",e.WEEKLY_OFF_AUTO="WEEKLY_OFF_AUTO",e.ROLE_CREATED="ROLE_CREATED",e.ROLE_UPDATED="ROLE_UPDATED",e.ROLE_DELETED="ROLE_DELETED",e.BUSINESS_UNIT_CREATED="BUSINESS_UNIT_CREATED",e.BUSINESS_UNIT_UPDATED="BUSINESS_UNIT_UPDATED",e.BUSINESS_UNIT_ARCHIVED="BUSINESS_UNIT_ARCHIVED",e.BUSINESS_UNIT_UNARCHIVED="BUSINESS_UNIT_UNARCHIVED",e.BUSINESS_UNIT_DELETED="BUSINESS_UNIT_DELETED",e.TASK_CREATED="TASK_CREATED",e.TASK_EDITED="TASK_EDITED",e.TASK_REASSIGNED="TASK_REASSIGNED",e.TASK_DUE_DATE_UPDATED="TASK_DUE_DATE_UPDATED",e.TASK_PRIORITY_CHANGED="TASK_PRIORITY_CHANGED",e.TASK_STATUS_CHANGED="TASK_STATUS_CHANGED",e.TASK_COMMENT_ADDED="TASK_COMMENT_ADDED",e.TASK_COMPLETED="TASK_COMPLETED",e.TASK_REOPENED="TASK_REOPENED",e.TASK_PINNED="TASK_PINNED",e.TASK_UNPINNED="TASK_UNPINNED",e.TASK_DELETED="TASK_DELETED",e.TASK_OVERDUE_REMINDER="TASK_OVERDUE_REMINDER",e.MEETING_SCHEDULED="MEETING_SCHEDULED",e.MEETING_CREATED="MEETING_CREATED",e.MEETING_EDITED="MEETING_EDITED",e.MEETING_RSVP="MEETING_RSVP",e.MEETING_OCCURRENCE_CANCELLED="MEETING_OCCURRENCE_CANCELLED",e.MEETING_ENDED="MEETING_ENDED",e.MEETING_UPDATE_POSTED="MEETING_UPDATE_POSTED",e.MEETING_CRUCIAL_UPDATE_POSTED="MEETING_CRUcial_UPDATE_POSTED",e.MEETING_STARTING_SOON="MEETING_STARTING_SOON",e.MEETING_FINALIZED="MEETING_FINALIZED",e.MEETING_ASYNCHRONOUS_UPDATE="MEETING_ASYNCHRONOUS_UPDATE",e.COMPLETION_LETTER_GENERATED="COMPLETION_LETTER_GENERATED",e.ANNOUNCEMENT_PUBLISHED="ANNOUNCEMENT_PUBLISHED",e.ANNOUNCEMENT_UPDATED="ANNOUNCEMENT_UPDATED",e.ANNOUNCEMENT_DELETED="ANNOUNCEMENT_DELETED",e.ANNOUNCEMENT_VIEWED="ANNOUNCEMENT_VIEWED",e.ANNOUNCEMENT_ACKNOWLEDGED="ANNOUNCEMENT_ACKNOWLEDGED",e.USER_CREATED="USER_CREATED",e.USER_ARCHIVED="USER_ARCHIVED",e.USER_UNARCHIVED="USER_UNARCHIVED",e.USER_PERMANENTLY_DELETED="USER_PERMANENTLY_DELETED",e.USER_ROLE_CHANGED="USER_ROLE_CHANGED",e.USER_NOTIFICATION_EMAIL_CHANGED="USER_NOTIFICATION_EMAIL_CHANGED",e.USER_LOGIN="USER_LOGIN",e))(dt||{});const ut="Syncly",mt="eod_users",pt="eod_reports",ft="eod_notifications",ht="eod_leave_records",gt="eod_trigger_log",xt="eod_user_badges",yt="eod_activity_log_",bt="eod_tasks",vt="eod_task_comments",Nt="eod_sent_scheduled_notifications",wt="eod_meetings",kt="eod_meeting_instances",Et="eod_sync_queue",jt="eod_announcements",Ct=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];Object.values(Xe);const _t={platformAdmin:{label:"Platform Administration (Syncly Owner Only)",permissions:[Xe.PLATFORM_ADMIN,Xe.CAN_MANAGE_TENANTS,Xe.CAN_VIEW_ALL_TENANTS]},userManagement:{label:"User Management",permissions:[Xe.CAN_MANAGE_USERS,Xe.CAN_CREATE_USER,Xe.CAN_EDIT_USER,Xe.CAN_ARCHIVE_USER,Xe.CAN_DELETE_ARCHIVED_USER]},roleManagement:{label:"Role & Permission Management",permissions:[Xe.CAN_MANAGE_ROLES]},businessUnitManagement:{label:"Business Unit Management",permissions:[Xe.CAN_MANAGE_BUSINESS_UNITS]},taskManagement:{label:"Task Management",permissions:[Xe.CAN_MANAGE_TEAM_TASKS,Xe.CAN_EDIT_ANY_TASK_STATUS,Xe.CAN_CREATE_PERSONAL_TASKS,Xe.CAN_VIEW_OWN_TASKS]},eodReportManagement:{label:"EOD Report Management",permissions:[Xe.CAN_VIEW_OWN_REPORTS,Xe.CAN_SUBMIT_OWN_EOD,Xe.CAN_MANAGE_TEAM_REPORTS,Xe.CAN_ACKNOWLEDGE_REPORTS,Xe.CAN_VIEW_ALL_REPORTS]},leaveManagement:{label:"Leave Management",permissions:[Xe.CAN_MANAGE_ALL_LEAVES,Xe.CAN_GRANT_LEAVE_ACCESS,Xe.CAN_MANAGE_WEEKLY_OFF,Xe.CAN_DEFINE_LEAVE_REVOKE_RULES]},meetingManagement:{label:"Meeting & Calendar Management",permissions:[Xe.CAN_MANAGE_TEAM_MEETINGS,Xe.CAN_VIEW_OWN_MEETINGS,Xe.CAN_VIEW_OWN_CALENDAR]},performanceHub:{label:"Performance & Analytics",permissions:[Xe.CAN_USE_PERFORMANCE_HUB]},integrationAccess:{label:"Integration Access",permissions:[Xe.CAN_USE_GOOGLE_CALENDAR,Xe.CAN_USE_TELEGRAM_BOT,Xe.CAN_USE_GEMINI_AI,Xe.CAN_MANAGE_ANNOUNCEMENTS]},communications:{label:"Communications & Culture",permissions:[Xe.CAN_MANAGE_ANNOUNCEMENTS,Xe.CAN_VIEW_LEADERBOARD]}},Tt=(new Date).getDay(),St=Ct[Tt],At=[{id:"bu_sales",name:"Sales & Marketing",status:"active"},{id:"bu_tech",name:"Technology & Engineering",status:"active"},{id:"bu_ops",name:"Operations & Logistics",status:"active"},{id:"bu_hr",name:"Human Resources & Admin",status:"active"},{id:"bu_finance",name:"Finance & Accounts",status:"active"}],It=["tenant_admin","manager","team_lead","employee","director","hr"],Dt=[{id:"tenant_admin",tenantId:"",name:"Tenant Admin",description:"Full control over tenant settings, users, roles, and all features. Cannot manage other tenants or platform settings.",permissions:[Xe.CAN_MANAGE_USERS,Xe.CAN_CREATE_USER,Xe.CAN_EDIT_USER,Xe.CAN_ARCHIVE_USER,Xe.CAN_DELETE_ARCHIVED_USER,Xe.CAN_MANAGE_ROLES,Xe.CAN_MANAGE_BUSINESS_UNITS,Xe.CAN_MANAGE_TEAM_TASKS,Xe.CAN_EDIT_ANY_TASK_STATUS,Xe.CAN_CREATE_PERSONAL_TASKS,Xe.CAN_VIEW_OWN_TASKS,Xe.CAN_VIEW_OWN_REPORTS,Xe.CAN_SUBMIT_OWN_EOD,Xe.CAN_MANAGE_TEAM_REPORTS,Xe.CAN_ACKNOWLEDGE_REPORTS,Xe.CAN_VIEW_ALL_REPORTS,Xe.CAN_MANAGE_ALL_LEAVES,Xe.CAN_GRANT_LEAVE_ACCESS,Xe.CAN_MANAGE_WEEKLY_OFF,Xe.CAN_DEFINE_LEAVE_REVOKE_RULES,Xe.CAN_MANAGE_TEAM_MEETINGS,Xe.CAN_VIEW_OWN_MEETINGS,Xe.CAN_VIEW_OWN_CALENDAR,Xe.CAN_USE_PERFORMANCE_HUB,Xe.CAN_USE_GOOGLE_CALENDAR,Xe.CAN_USE_TELEGRAM_BOT,Xe.CAN_USE_GEMINI_AI]},{id:"director",tenantId:"",name:"Director",description:"Company owner with cross-business unit visibility.",permissions:[Xe.CAN_VIEW_ALL_REPORTS,Xe.CAN_MANAGE_TEAM_REPORTS,Xe.CAN_ACKNOWLEDGE_REPORTS,Xe.CAN_VIEW_OWN_REPORTS,Xe.CAN_MANAGE_TEAM_TASKS,Xe.CAN_CREATE_PERSONAL_TASKS,Xe.CAN_EDIT_ANY_TASK_STATUS,Xe.CAN_MANAGE_ALL_LEAVES,Xe.CAN_GRANT_LEAVE_ACCESS,Xe.CAN_MANAGE_WEEKLY_OFF,Xe.CAN_SUBMIT_OWN_LEAVE,Xe.CAN_MANAGE_TEAM_MEETINGS,Xe.CAN_VIEW_OWN_MEETINGS,Xe.CAN_VIEW_LEADERBOARD,Xe.CAN_VIEW_TEAM_CALENDAR,Xe.CAN_VIEW_OWN_CALENDAR,Xe.CAN_USE_PERFORMANCE_HUB,Xe.CAN_VIEW_TRIGGER_LOG]},{id:"hr",tenantId:"",name:"HR",description:"People operations role focused on wellbeing, attendance, and organization-wide communication.",permissions:[Xe.CAN_SUBMIT_OWN_EOD,Xe.CAN_VIEW_OWN_REPORTS,Xe.CAN_VIEW_ALL_REPORTS,Xe.CAN_MANAGE_TEAM_REPORTS,Xe.CAN_ACKNOWLEDGE_REPORTS,Xe.CAN_USE_PERFORMANCE_HUB,Xe.CAN_VIEW_LEADERBOARD,Xe.CAN_MANAGE_ALL_LEAVES,Xe.CAN_GRANT_LEAVE_ACCESS,Xe.CAN_MANAGE_WEEKLY_OFF,Xe.CAN_DEFINE_LEAVE_REVOKE_RULES,Xe.CAN_SUBMIT_OWN_LEAVE,Xe.CAN_MANAGE_TEAM_TASKS,Xe.CAN_CREATE_PERSONAL_TASKS,Xe.CAN_VIEW_OWN_TASKS,Xe.CAN_MANAGE_TEAM_MEETINGS,Xe.CAN_VIEW_OWN_MEETINGS,Xe.CAN_VIEW_TEAM_CALENDAR,Xe.CAN_VIEW_OWN_CALENDAR,Xe.CAN_USE_GOOGLE_CALENDAR,Xe.CAN_MANAGE_ANNOUNCEMENTS]},{id:"manager",tenantId:"",name:"Manager",description:"Manages team members, approves leaves, acknowledges EODs, and oversees team tasks and meetings.",permissions:[Xe.CAN_MANAGE_TEAM_TASKS,Xe.CAN_EDIT_ANY_TASK_STATUS,Xe.CAN_CREATE_PERSONAL_TASKS,Xe.CAN_VIEW_OWN_TASKS,Xe.CAN_MANAGE_TEAM_REPORTS,Xe.CAN_ACKNOWLEDGE_REPORTS,Xe.CAN_SUBMIT_OWN_EOD,Xe.CAN_VIEW_OWN_REPORTS,Xe.CAN_MANAGE_ALL_LEAVES,Xe.CAN_GRANT_LEAVE_ACCESS,Xe.CAN_MANAGE_WEEKLY_OFF,Xe.CAN_MANAGE_TEAM_MEETINGS,Xe.CAN_VIEW_OWN_MEETINGS,Xe.CAN_VIEW_OWN_CALENDAR,Xe.CAN_USE_PERFORMANCE_HUB]},{id:"team_lead",tenantId:"",name:"Team Lead",description:"Coordinates team tasks and meetings, reviews EODs, but cannot approve leaves or manage users.",permissions:[Xe.CAN_MANAGE_TEAM_TASKS,Xe.CAN_CREATE_PERSONAL_TASKS,Xe.CAN_VIEW_OWN_TASKS,Xe.CAN_MANAGE_TEAM_REPORTS,Xe.CAN_SUBMIT_OWN_EOD,Xe.CAN_VIEW_OWN_REPORTS,Xe.CAN_MANAGE_TEAM_MEETINGS,Xe.CAN_VIEW_OWN_MEETINGS,Xe.CAN_VIEW_OWN_CALENDAR]},{id:"employee",tenantId:"",name:"Employee",description:"Standard employee with self-service capabilities for tasks, EODs, leave, and calendar.",permissions:[Xe.CAN_CREATE_PERSONAL_TASKS,Xe.CAN_VIEW_OWN_TASKS,Xe.CAN_SUBMIT_OWN_EOD,Xe.CAN_VIEW_OWN_REPORTS,Xe.CAN_VIEW_OWN_MEETINGS,Xe.CAN_VIEW_OWN_CALENDAR]}],Ot=St,Rt=[{email:"superadmin@mittaleod.com",notificationEmail:"superadmin@example.com",name:"Super Admin",roleId:"tenant_admin",status:et.ACTIVE},{email:"admin@mittaleod.com",notificationEmail:"raj.chauhan.admin@example.com",name:"Raj Chauhan (Admin)",roleId:"tenant_admin",status:et.ACTIVE},{email:"manager.sales@mittaleod.com",notificationEmail:"rajesh.k.manager@example.com",name:"Rajesh K.",roleId:"manager",designation:"Sales Manager",businessUnitId:"bu_sales",status:et.ACTIVE},{email:"manager.tech@mittaleod.com",notificationEmail:"anita.s.manager@example.com",name:"Anita S.",roleId:"manager",designation:"Tech Lead",businessUnitId:"bu_tech",status:et.ACTIVE},{email:"manager.ops@mittaleod.com",notificationEmail:"vikram.r.manager@example.com",name:"Vikram R.",roleId:"manager",designation:"Operations Head",businessUnitId:"bu_ops",status:et.ACTIVE},{email:"manager.hr@mittaleod.com",notificationEmail:"sunita.m.manager@example.com",name:"Sunita M.",roleId:"manager",designation:"HR Manager",businessUnitId:"bu_hr",status:et.ACTIVE},{email:"hr@mittaleod.com",notificationEmail:"peopleops@example.com",name:"Nisha P. (HR)",roleId:"hr",designation:"Lead HR Partner",businessUnitId:"bu_hr",status:et.ACTIVE},{email:"alok.sharma@mittaleod.com",notificationEmail:"alok.sharma@example.com",name:"Alok Sharma",roleId:"employee",designation:"Sales Lead",weeklyOffDay:"Sunday",businessUnitId:"bu_sales",status:et.ACTIVE},{email:"priya.mehta@mittaleod.com",notificationEmail:"priya.mehta@example.com",name:"Priya Mehta",roleId:"employee",designation:"Marketing Executive",weeklyOffDay:Ot,businessUnitId:"bu_sales",status:et.ACTIVE},{email:"rohan.singh@mittaleod.com",notificationEmail:"rohan.singh@example.com",name:"Rohan Singh",roleId:"employee",designation:"Sales Associate",weeklyOffDay:Ot,businessUnitId:"bu_sales",status:et.ACTIVE},{email:"neha.patel@mittaleod.com",notificationEmail:"neha.patel@example.com",name:"Neha Patel",roleId:"employee",designation:"Sales Associate",weeklyOffDay:Ot,businessUnitId:"bu_sales",status:et.ACTIVE},{email:"vivek.kumar@mittaleod.com",notificationEmail:"vivek.kumar@example.com",name:"Vivek Kumar",roleId:"employee",designation:"Marketing Analyst",weeklyOffDay:Ot,businessUnitId:"bu_sales",status:et.ACTIVE},{email:"sunidhi.chauhan@mittaleod.com",notificationEmail:"sunidhi.chauhan@example.com",name:"Sunidhi Chauhan",roleId:"employee",designation:"Sales Representative",weeklyOffDay:Ot,businessUnitId:"bu_sales",status:et.ACTIVE},{email:"arjun.reddy@mittaleod.com",notificationEmail:"arjun.reddy@example.com",name:"Arjun Reddy",roleId:"employee",designation:"Sales Specialist",weeklyOffDay:"Saturday",businessUnitId:"bu_sales",status:et.ACTIVE},{email:"kiara.advani@mittaleod.com",notificationEmail:"kiara.advani@example.com",name:"Kiara Advani",roleId:"employee",designation:"Marketing Coordinator",weeklyOffDay:"Sunday",businessUnitId:"bu_sales",status:et.ACTIVE},{email:"vijay.deverakonda@mittaleod.com",notificationEmail:"vijay.deverakonda@example.com",name:"Vijay Deverakonda",roleId:"employee",designation:"Business Development",weeklyOffDay:"Saturday",businessUnitId:"bu_sales",status:et.ACTIVE},{email:"ananya.pandey@mittaleod.com",notificationEmail:"ananya.pandey@example.com",name:"Ananya Pandey",roleId:"employee",designation:"Sales Intern",weeklyOffDay:"Sunday",businessUnitId:"bu_sales",status:et.ACTIVE},{email:"sandeep.g@mittaleod.com",notificationEmail:"sandeep.g@example.com",name:"Sandeep Gupta",roleId:"employee",designation:"Sales Associate",weeklyOffDay:"Monday",businessUnitId:"bu_sales",status:et.ACTIVE},{email:"shawn.mendes@mittaleod.com",notificationEmail:"shawn.mendes@example.com",name:"Shawn Mendes",roleId:"employee",designation:"Software Engineer",weeklyOffDay:"Sunday",businessUnitId:"bu_tech",status:et.ACTIVE}],Pt=[],Mt=[],Ut=[],Lt=[],Ft=[],Bt=[],$t=[],Gt=[],Vt={[dt.EOD_SUBMITTED]:"fas fa-paper-plane text-primary dark:text-sky-400",[dt.EOD_LATE_SUBMITTED]:"fas fa-clock text-orange-500 dark:text-orange-400",[dt.EOD_EDITED]:"fas fa-edit text-secondary dark:text-violet-400",[dt.EOD_ACKNOWLEDGED]:"fas fa-check-circle text-green-500 dark:text-emerald-400",[dt.LEAVE_MARKED_BY_EMPLOYEE]:"fas fa-plane-departure text-teal-500 dark:text-teal-400",[dt.LEAVE_MARKED_BY_MANAGER]:"fas fa-user-check text-indigo-500 dark:text-indigo-400",[dt.LEAVE_REVOKED_BY_EMPLOYEE]:"fas fa-undo text-gray-500 dark:text-slate-400",[dt.LEAVE_REVOKED_BY_MANAGER]:"fas fa-user-slash text-indigo-400 dark:text-indigo-300",[dt.LEAVE_FUTURE_SCHEDULED_BY_EMPLOYEE]:"fas fa-calendar-plus text-teal-500 dark:text-teal-400",[dt.LEAVE_FUTURE_CANCELED_BY_EMPLOYEE]:"fas fa-calendar-times text-gray-500 dark:text-slate-400",[dt.LEAVE_FUTURE_SCHEDULED_BY_MANAGER]:"fas fa-calendar-plus text-indigo-500 dark:text-indigo-400",[dt.LEAVE_FUTURE_CANCELED_BY_MANAGER]:"fas fa-calendar-minus text-indigo-400 dark:text-indigo-300",[dt.WEEKLY_OFF_AUTO]:"fas fa-bed text-indigo-500 dark:text-indigo-400",[dt.TASK_CREATED]:"fas fa-tasks text-primary dark:text-sky-400",[dt.TASK_EDITED]:"fas fa-pen text-secondary dark:text-violet-400",[dt.TASK_REASSIGNED]:"fas fa-users text-indigo-500 dark:text-indigo-400",[dt.TASK_DUE_DATE_UPDATED]:"fas fa-calendar-alt text-orange-500 dark:text-orange-400",[dt.TASK_PRIORITY_CHANGED]:"fas fa-exclamation text-yellow-500 dark:text-yellow-400",[dt.TASK_STATUS_CHANGED]:"fas fa-exchange-alt text-yellow-500 dark:text-yellow-400",[dt.TASK_COMMENT_ADDED]:"fas fa-comment text-gray-500 dark:text-slate-400",[dt.TASK_COMPLETED]:"fas fa-check-double text-green-500 dark:text-emerald-400",[dt.TASK_REOPENED]:"fas fa-folder-open text-primary dark:text-sky-400",[dt.TASK_PINNED]:"fas fa-thumbtack text-yellow-500 dark:text-yellow-400",[dt.TASK_UNPINNED]:"fas fa-thumbtack text-gray-500 dark:text-slate-400",[dt.TASK_DELETED]:"fas fa-trash-alt text-red-500 dark:text-red-400",[dt.TASK_OVERDUE_REMINDER]:"fas fa-bell text-red-500 dark:text-red-400",[dt.MEETING_CREATED]:"fas fa-users-crown text-secondary dark:text-violet-400",[dt.MEETING_EDITED]:"fas fa-edit text-indigo-500 dark:text-indigo-400",[dt.MEETING_RSVP]:"fas fa-user-check text-green-500 dark:text-emerald-400",[dt.MEETING_OCCURRENCE_CANCELLED]:"fas fa-calendar-times text-orange-500 dark:text-orange-400",[dt.MEETING_ENDED]:"fas fa-flag-checkered text-red-500 dark:text-red-400",[dt.MEETING_UPDATE_POSTED]:"fas fa-comment-alt text-gray-500 dark:text-slate-400",[dt.MEETING_CRUCIAL_UPDATE_POSTED]:"fas fa-bell text-amber-500 dark:text-amber-400",[dt.MEETING_STARTING_SOON]:"fas fa-hourglass-start text-accent dark:text-cyan-400",[dt.MEETING_FINALIZED]:"fas fa-gavel text-green-600 dark:text-emerald-400",[dt.MEETING_ASYNCHRONOUS_UPDATE]:"fas fa-comment-alt-edit text-blue-600 dark:text-sky-400",[dt.COMPLETION_LETTER_GENERATED]:"fas fa-file-award text-emerald-500 dark:text-emerald-400",[dt.USER_CREATED]:"fas fa-user-plus text-accent dark:text-cyan-400",[dt.USER_ARCHIVED]:"fas fa-user-lock text-gray-500 dark:text-slate-400",[dt.USER_UNARCHIVED]:"fas fa-user-unlock text-gray-500 dark:text-slate-400",[dt.USER_PERMANENTLY_DELETED]:"fas fa-user-slash text-red-700 dark:text-red-500",[dt.ANNOUNCEMENT_PUBLISHED]:"fas fa-bullhorn text-primary dark:text-sky-400",[dt.ANNOUNCEMENT_UPDATED]:"fas fa-bullhorn text-amber-500 dark:text-amber-400",[dt.ANNOUNCEMENT_DELETED]:"fas fa-bullhorn text-red-500 dark:text-red-400",[dt.ANNOUNCEMENT_VIEWED]:"fas fa-eye text-indigo-400 dark:text-indigo-300",[dt.ANNOUNCEMENT_ACKNOWLEDGED]:"fas fa-check-circle text-emerald-500 dark:text-emerald-400",[dt.USER_ROLE_CHANGED]:"fas fa-user-tag text-indigo-500 dark:text-indigo-400",[dt.USER_NOTIFICATION_EMAIL_CHANGED]:"fas fa-envelope text-blue-500 dark:text-blue-400",[dt.USER_LOGIN]:"fas fa-sign-in-alt text-green-500 dark:text-emerald-400"},zt={[ct.TEN_DAY_STREAK]:{icon:"",title:"10-Day Streak",defaultTooltip:"Submit reports for 10 consecutive working days to earn this!",earnedTooltipText:"Awesome! You submitted reports for 10 consecutive working days."},[ct.TWENTY_DAY_STREAK]:{icon:"",title:"20-Day Streak",defaultTooltip:"Submit reports for 20 consecutive working days for this achievement.",earnedTooltipText:"Incredible! You maintained a 20-day reporting streak."},[ct.FULL_MONTH_FINISHER]:{icon:"",title:"Full Month Finisher",defaultTooltip:"Submit reports for every working day in a calendar month.",earnedTooltipText:"Consistency King/Queen! You reported on every working day of a month."}},Wt=e=>{if(null==e||""===e)return"N/A";let t,n=!1;if("string"==typeof e&&/^\d{4}-\d{2}-\d{2}$/.test(e)){const a=e.split("-");t=new Date(Date.UTC(Number(a[0]),Number(a[1])-1,Number(a[2]))),n=!0}else t=new Date(e);if(isNaN(t.getTime())){if("string"!=typeof e)return"Invalid Date";{const a=new Date(e);if(isNaN(a.getTime()))return"Invalid Date";t=a,n=!1}}const a=String(n?t.getUTCDate():t.getDate()).padStart(2,"0"),s=n?t.getUTCMonth():t.getMonth(),r=n?t.getUTCFullYear():t.getFullYear();return`${a}-${new Date(Date.UTC(2e3,s,1)).toLocaleString("en-GB",{month:"short"})}-${r}`},qt=e=>{if(null==e||""===e)return"N/A";const t=new Date(e);if(isNaN(t.getTime()))return"Invalid Date";const n=String(t.getDate()).padStart(2,"0"),a=t.getMonth(),s=t.getFullYear(),r=new Date(2e3,a,1).toLocaleString("en-GB",{month:"short"});let i=t.getHours();const l=String(t.getMinutes()).padStart(2,"0"),o=i>=12?"PM":"AM";i%=12,i=i||12;return`${n}-${r}-${s} ${`${String(i).padStart(2,"0")}:${l} ${o}`}`},Ht=e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`,Kt=e=>{var t;if(!e.recurrenceRule||"none"===e.recurrenceRule){const t=new Date(e.meetingDateTime);return t>new Date?t:null}const n=new Date;let a=new Date(e.meetingDateTime),s=0;for(;a<n;){switch(s++,e.recurrenceRule){case"daily":a.setDate(a.getDate()+1);break;case"weekly":a.setDate(a.getDate()+7);break;case"monthly":a.setMonth(a.getMonth()+1)}if(e.recurrenceCount&&s>=e.recurrenceCount)return null}for(;;){const r=Ht(a);if(!(null==(t=e.cancelledOccurrences)?void 0:t.includes(r))&&a>=n)return e.recurrenceEndDate&&a.getTime()>e.recurrenceEndDate||e.recurrenceCount&&s>=e.recurrenceCount?null:a;switch(s++,e.recurrenceRule){case"daily":a.setDate(a.getDate()+1);break;case"weekly":a.setDate(a.getDate()+7);break;case"monthly":a.setMonth(a.getMonth()+1)}if(s>500)return null}},Yt=e=>{const t=new Date;return t.setDate(t.getDate()-e),Ht(t)},Jt=e=>{const t=new Date;return t.setDate(t.getDate()+e),Ht(t)},Zt=(e,t)=>{if(!t)return!1;const n=e.getDay();return Ct[n]===t},Qt="eod_sent_emails",Xt=(e,t,n)=>{const a=JSON.parse(localStorage.getItem(Qt)||"[]");a.unshift({to:e,subject:t,body:n,sentAt:(new Date).toISOString()}),a.length>50&&(a.length=50),localStorage.setItem(Qt,JSON.stringify(a))},en=(e,t)=>{const n=`Hi ${e.name},\n\nThis is a critical reminder from your manager, ${t.name}.\nYou have not submitted your daily EOD reports for the last 3 consecutive working days. This may affect your performance review.\n\nPlease act immediately and submit your pending reports.\n\nThank you,\nSyncly`;Xt(e.email,"3 Days of Missing EOD Reports",n)};const tn=new class{constructor(){a(this,"events",{})}on(e,t){return this.events[e]||(this.events[e]=[]),this.events[e].push(t),()=>this.off(e,t)}off(e,t){this.events[e]&&(this.events[e]=this.events[e].filter(e=>e!==t))}emit(e,t){this.events[e]&&this.events[e].forEach(e=>{try{e(t)}catch(n){}})}},nn=()=>{try{const e=localStorage.getItem(Et);return e?JSON.parse(e):[]}catch{return[]}},an=e=>{try{localStorage.setItem(Et,JSON.stringify(e))}catch(t){}},sn=e=>{"undefined"!=typeof navigator&&navigator.onLine;const t=nn(),n={...e,timestamp:Date.now()};t.push(n),an(t)},rn=async()=>{if("undefined"!=typeof navigator&&!navigator.onLine)return;const e=nn();0!==e.length&&(await new Promise(e=>setTimeout(e,1500)),e.forEach((e,t)=>{}),an([]),tn.emit("sync-complete"))},ln=e=>{const t=e.toLowerCase(),n=new Date;return"today"===t?Ht(n):"tomorrow"===t||"tmw"===t?(n.setDate(n.getDate()+1),Ht(n)):/^\d{4}-\d{2}-\d{2}$/.test(t)?t:(n.setDate(n.getDate()+3),Ht(n))},on=e=>{const t=e.toLowerCase();return"high"===t||"hi"===t?nt.High:"low"===t||"lo"===t?nt.Low:nt.Medium},cn=(e,t,n)=>{const a=[],s=e.split("\n"),r=/@\[([^\]]+)\]\(([^)]+)\)/g;for(const i of s){const e=i.trim();let t=null;if(e.toLowerCase().startsWith("/task ")?t=e.substring(5).trim():e.startsWith("/")&&!e.startsWith("//")&&(t=e.substring(1).trim()),null===t||""===t)continue;let s=[],l=Ht(new Date(Date.now()+2592e5)),o=nt.Medium;const c=[...t.matchAll(r)];c.length>0?(c.forEach(e=>{e[2]&&s.push(e[2])}),t=t.replace(r,"").trim()):n&&n.length>0&&(s=[...n]);const d=t.match(/(?:due:|on:)\s*(\S+)/i);d&&(l=ln(d[1]),t=t.replace(d[0],"").trim());const u=t.match(/(?:priority:|p:)\s*(\S+)/i);u&&(o=on(u[1]),t=t.replace(u[0],"").trim());const m=t.trim(),p="",f=[];m&&a.push({title:m,description:p,subTasks:f,assigneeIds:s,dueDate:l,priority:o})}return a};var dn,un,mn;(un=dn||(dn={})).assertEqual=e=>{},un.assertIs=function(e){},un.assertNever=function(e){throw new Error},un.arrayToEnum=e=>{const t={};for(const n of e)t[n]=n;return t},un.getValidEnumValues=e=>{const t=un.objectKeys(e).filter(t=>"number"!=typeof e[e[t]]),n={};for(const a of t)n[a]=e[a];return un.objectValues(n)},un.objectValues=e=>un.objectKeys(e).map(function(t){return e[t]}),un.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{const t=[];for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t},un.find=(e,t)=>{for(const n of e)if(t(n))return n},un.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&Number.isFinite(e)&&Math.floor(e)===e,un.joinValues=function(e,t=" | "){return e.map(e=>"string"==typeof e?`'${e}'`:e).join(t)},un.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t,(mn||(mn={})).mergeShapes=(e,t)=>({...e,...t});const pn=dn.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),fn=e=>{switch(typeof e){case"undefined":return pn.undefined;case"string":return pn.string;case"number":return Number.isNaN(e)?pn.nan:pn.number;case"boolean":return pn.boolean;case"function":return pn.function;case"bigint":return pn.bigint;case"symbol":return pn.symbol;case"object":return Array.isArray(e)?pn.array:null===e?pn.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?pn.promise:"undefined"!=typeof Map&&e instanceof Map?pn.map:"undefined"!=typeof Set&&e instanceof Set?pn.set:"undefined"!=typeof Date&&e instanceof Date?pn.date:pn.object;default:return pn.unknown}},hn=dn.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class gn extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(e){return e.message},n={_errors:[]},a=e=>{for(const s of e.issues)if("invalid_union"===s.code)s.unionErrors.map(a);else if("invalid_return_type"===s.code)a(s.returnTypeError);else if("invalid_arguments"===s.code)a(s.argumentsError);else if(0===s.path.length)n._errors.push(t(s));else{let e=n,a=0;for(;a<s.path.length;){const n=s.path[a];a===s.path.length-1?(e[n]=e[n]||{_errors:[]},e[n]._errors.push(t(s))):e[n]=e[n]||{_errors:[]},e=e[n],a++}}};return a(this),n}static assert(e){if(!(e instanceof gn))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,dn.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){const t={},n=[];for(const a of this.issues)if(a.path.length>0){const n=a.path[0];t[n]=t[n]||[],t[n].push(e(a))}else n.push(e(a));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}gn.create=e=>new gn(e);const xn=(e,t)=>{let n;switch(e.code){case hn.invalid_type:n=e.received===pn.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case hn.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,dn.jsonStringifyReplacer)}`;break;case hn.unrecognized_keys:n=`Unrecognized key(s) in object: ${dn.joinValues(e.keys,", ")}`;break;case hn.invalid_union:n="Invalid input";break;case hn.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${dn.joinValues(e.options)}`;break;case hn.invalid_enum_value:n=`Invalid enum value. Expected ${dn.joinValues(e.options)}, received '${e.received}'`;break;case hn.invalid_arguments:n="Invalid function arguments";break;case hn.invalid_return_type:n="Invalid function return type";break;case hn.invalid_date:n="Invalid date";break;case hn.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:dn.assertNever(e.validation):n="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case hn.too_small:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type||"bigint"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case hn.too_big:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case hn.custom:n="Invalid input";break;case hn.invalid_intersection_types:n="Intersection results could not be merged";break;case hn.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case hn.not_finite:n="Number must be finite";break;default:n=t.defaultError,dn.assertNever(e)}return{message:n}};let yn=xn;function bn(e,t){const n=yn,a=(e=>{const{data:t,path:n,errorMaps:a,issueData:s}=e,r=[...n,...s.path||[]],i={...s,path:r};if(void 0!==s.message)return{...s,path:r,message:s.message};let l="";const o=a.filter(e=>!!e).slice().reverse();for(const c of o)l=c(i,{data:t,defaultError:l}).message;return{...s,path:r,message:l}})({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===xn?void 0:xn].filter(e=>!!e)});e.common.issues.push(a)}class vn{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const a of t){if("aborted"===a.status)return Nn;"dirty"===a.status&&e.dirty(),n.push(a.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const a of t){const e=await a.key,t=await a.value;n.push({key:e,value:t})}return vn.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const a of t){const{key:t,value:s}=a;if("aborted"===t.status)return Nn;if("aborted"===s.status)return Nn;"dirty"===t.status&&e.dirty(),"dirty"===s.status&&e.dirty(),"__proto__"===t.value||void 0===s.value&&!a.alwaysSet||(n[t.value]=s.value)}return{status:e.value,value:n}}}const Nn=Object.freeze({status:"aborted"}),wn=e=>({status:"dirty",value:e}),kn=e=>({status:"valid",value:e}),En=e=>"aborted"===e.status,jn=e=>"dirty"===e.status,Cn=e=>"valid"===e.status,_n=e=>"undefined"!=typeof Promise&&e instanceof Promise;var Tn,Sn;(Sn=Tn||(Tn={})).errToObj=e=>"string"==typeof e?{message:e}:e||{},Sn.toString=e=>"string"==typeof e?e:null==e?void 0:e.message;class An{constructor(e,t,n,a){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const In=(e,t)=>{if(Cn(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new gn(e.common.issues);return this._error=t,this._error}}};function Dn(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:a,description:s}=e;if(t&&(n||a))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');if(t)return{errorMap:t,description:s};return{errorMap:(t,s)=>{const{message:r}=e;return"invalid_enum_value"===t.code?{message:r??s.defaultError}:void 0===s.data?{message:r??a??s.defaultError}:"invalid_type"!==t.code?{message:s.defaultError}:{message:r??n??s.defaultError}},description:s}}class On{get description(){return this._def.description}_getType(e){return fn(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:fn(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new vn,ctx:{common:e.parent.common,data:e.data,parsedType:fn(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(_n(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){const n={common:{issues:[],async:(null==t?void 0:t.async)??!1,contextualErrorMap:null==t?void 0:t.errorMap},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:fn(e)},a=this._parseSync({data:e,path:n.path,parent:n});return In(n,a)}"~validate"(e){var t,n;const a={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:fn(e)};if(!this["~standard"].async)try{const t=this._parseSync({data:e,path:[],parent:a});return Cn(t)?{value:t.value}:{issues:a.common.issues}}catch(s){(null==(n=null==(t=null==s?void 0:s.message)?void 0:t.toLowerCase())?void 0:n.includes("encountered"))&&(this["~standard"].async=!0),a.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:a}).then(e=>Cn(e)?{value:e.value}:{issues:a.common.issues})}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:null==t?void 0:t.errorMap,async:!0},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:fn(e)},a=this._parse({data:e,path:n.path,parent:n}),s=await(_n(a)?a:Promise.resolve(a));return In(n,s)}refine(e,t){const n=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement((t,a)=>{const s=e(t),r=()=>a.addIssue({code:hn.custom,...n(t)});return"undefined"!=typeof Promise&&s instanceof Promise?s.then(e=>!!e||(r(),!1)):!!s||(r(),!1)})}refinement(e,t){return this._refinement((n,a)=>!!e(n)||(a.addIssue("function"==typeof t?t(n,a):t),!1))}_refinement(e){return new Da({schema:this,typeName:$a.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return Oa.create(this,this._def)}nullable(){return Ra.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ga.create(this)}promise(){return Ia.create(this,this._def)}or(e){return ba.create([this,e],this._def)}and(e){return Na.create(this,e,this._def)}transform(e){return new Da({...Dn(this._def),schema:this,typeName:$a.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"==typeof e?e:()=>e;return new Pa({...Dn(this._def),innerType:this,defaultValue:t,typeName:$a.ZodDefault})}brand(){return new La({typeName:$a.ZodBranded,type:this,...Dn(this._def)})}catch(e){const t="function"==typeof e?e:()=>e;return new Ma({...Dn(this._def),innerType:this,catchValue:t,typeName:$a.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return Fa.create(this,e)}readonly(){return Ba.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Rn=/^c[^\s-]{8,}$/i,Pn=/^[0-9a-z]+$/,Mn=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Un=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Ln=/^[a-z0-9_-]{21}$/i,Fn=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Bn=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,$n=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let Gn;const Vn=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,zn=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Wn=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,qn=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Hn=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Kn=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Yn="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Jn=new RegExp(`^${Yn}$`);function Zn(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`);return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${e.precision?"+":"?"}`}function Qn(e){return new RegExp(`^${Zn(e)}$`)}function Xn(e){let t=`${Yn}T${Zn(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function ea(e,t){return!("v4"!==t&&t||!Vn.test(e))||!("v6"!==t&&t||!Wn.test(e))}function ta(e,t){if(!Fn.test(e))return!1;try{const[n]=e.split(".");if(!n)return!1;const a=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),s=JSON.parse(atob(a));return"object"==typeof s&&null!==s&&((!("typ"in s)||"JWT"===(null==s?void 0:s.typ))&&(!!s.alg&&(!t||s.alg===t)))}catch{return!1}}function na(e,t){return!("v4"!==t&&t||!zn.test(e))||!("v6"!==t&&t||!qn.test(e))}class aa extends On{_parse(e){this._def.coerce&&(e.data=String(e.data));if(this._getType(e)!==pn.string){const t=this._getOrReturnCtx(e);return bn(t,{code:hn.invalid_type,expected:pn.string,received:t.parsedType}),Nn}const t=new vn;let n;for(const a of this._def.checks)if("min"===a.kind)e.data.length<a.value&&(n=this._getOrReturnCtx(e,n),bn(n,{code:hn.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),t.dirty());else if("max"===a.kind)e.data.length>a.value&&(n=this._getOrReturnCtx(e,n),bn(n,{code:hn.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),t.dirty());else if("length"===a.kind){const s=e.data.length>a.value,r=e.data.length<a.value;(s||r)&&(n=this._getOrReturnCtx(e,n),s?bn(n,{code:hn.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):r&&bn(n,{code:hn.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),t.dirty())}else if("email"===a.kind)$n.test(e.data)||(n=this._getOrReturnCtx(e,n),bn(n,{validation:"email",code:hn.invalid_string,message:a.message}),t.dirty());else if("emoji"===a.kind)Gn||(Gn=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Gn.test(e.data)||(n=this._getOrReturnCtx(e,n),bn(n,{validation:"emoji",code:hn.invalid_string,message:a.message}),t.dirty());else if("uuid"===a.kind)Un.test(e.data)||(n=this._getOrReturnCtx(e,n),bn(n,{validation:"uuid",code:hn.invalid_string,message:a.message}),t.dirty());else if("nanoid"===a.kind)Ln.test(e.data)||(n=this._getOrReturnCtx(e,n),bn(n,{validation:"nanoid",code:hn.invalid_string,message:a.message}),t.dirty());else if("cuid"===a.kind)Rn.test(e.data)||(n=this._getOrReturnCtx(e,n),bn(n,{validation:"cuid",code:hn.invalid_string,message:a.message}),t.dirty());else if("cuid2"===a.kind)Pn.test(e.data)||(n=this._getOrReturnCtx(e,n),bn(n,{validation:"cuid2",code:hn.invalid_string,message:a.message}),t.dirty());else if("ulid"===a.kind)Mn.test(e.data)||(n=this._getOrReturnCtx(e,n),bn(n,{validation:"ulid",code:hn.invalid_string,message:a.message}),t.dirty());else if("url"===a.kind)try{new URL(e.data)}catch{n=this._getOrReturnCtx(e,n),bn(n,{validation:"url",code:hn.invalid_string,message:a.message}),t.dirty()}else if("regex"===a.kind){a.regex.lastIndex=0;a.regex.test(e.data)||(n=this._getOrReturnCtx(e,n),bn(n,{validation:"regex",code:hn.invalid_string,message:a.message}),t.dirty())}else if("trim"===a.kind)e.data=e.data.trim();else if("includes"===a.kind)e.data.includes(a.value,a.position)||(n=this._getOrReturnCtx(e,n),bn(n,{code:hn.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),t.dirty());else if("toLowerCase"===a.kind)e.data=e.data.toLowerCase();else if("toUpperCase"===a.kind)e.data=e.data.toUpperCase();else if("startsWith"===a.kind)e.data.startsWith(a.value)||(n=this._getOrReturnCtx(e,n),bn(n,{code:hn.invalid_string,validation:{startsWith:a.value},message:a.message}),t.dirty());else if("endsWith"===a.kind)e.data.endsWith(a.value)||(n=this._getOrReturnCtx(e,n),bn(n,{code:hn.invalid_string,validation:{endsWith:a.value},message:a.message}),t.dirty());else if("datetime"===a.kind){Xn(a).test(e.data)||(n=this._getOrReturnCtx(e,n),bn(n,{code:hn.invalid_string,validation:"datetime",message:a.message}),t.dirty())}else if("date"===a.kind){Jn.test(e.data)||(n=this._getOrReturnCtx(e,n),bn(n,{code:hn.invalid_string,validation:"date",message:a.message}),t.dirty())}else if("time"===a.kind){Qn(a).test(e.data)||(n=this._getOrReturnCtx(e,n),bn(n,{code:hn.invalid_string,validation:"time",message:a.message}),t.dirty())}else"duration"===a.kind?Bn.test(e.data)||(n=this._getOrReturnCtx(e,n),bn(n,{validation:"duration",code:hn.invalid_string,message:a.message}),t.dirty()):"ip"===a.kind?ea(e.data,a.version)||(n=this._getOrReturnCtx(e,n),bn(n,{validation:"ip",code:hn.invalid_string,message:a.message}),t.dirty()):"jwt"===a.kind?ta(e.data,a.alg)||(n=this._getOrReturnCtx(e,n),bn(n,{validation:"jwt",code:hn.invalid_string,message:a.message}),t.dirty()):"cidr"===a.kind?na(e.data,a.version)||(n=this._getOrReturnCtx(e,n),bn(n,{validation:"cidr",code:hn.invalid_string,message:a.message}),t.dirty()):"base64"===a.kind?Hn.test(e.data)||(n=this._getOrReturnCtx(e,n),bn(n,{validation:"base64",code:hn.invalid_string,message:a.message}),t.dirty()):"base64url"===a.kind?Kn.test(e.data)||(n=this._getOrReturnCtx(e,n),bn(n,{validation:"base64url",code:hn.invalid_string,message:a.message}),t.dirty()):dn.assertNever(a);return{status:t.value,value:e.data}}_regex(e,t,n){return this.refinement(t=>e.test(t),{validation:t,code:hn.invalid_string,...Tn.errToObj(n)})}_addCheck(e){return new aa({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Tn.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Tn.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Tn.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Tn.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...Tn.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Tn.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Tn.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Tn.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...Tn.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...Tn.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...Tn.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Tn.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...Tn.errToObj(e)})}datetime(e){return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,offset:(null==e?void 0:e.offset)??!1,local:(null==e?void 0:e.local)??!1,...Tn.errToObj(null==e?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,...Tn.errToObj(null==e?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...Tn.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...Tn.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null==t?void 0:t.position,...Tn.errToObj(null==t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...Tn.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...Tn.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...Tn.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...Tn.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...Tn.errToObj(t)})}nonempty(e){return this.min(1,Tn.errToObj(e))}trim(){return new aa({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new aa({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new aa({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>"datetime"===e.kind)}get isDate(){return!!this._def.checks.find(e=>"date"===e.kind)}get isTime(){return!!this._def.checks.find(e=>"time"===e.kind)}get isDuration(){return!!this._def.checks.find(e=>"duration"===e.kind)}get isEmail(){return!!this._def.checks.find(e=>"email"===e.kind)}get isURL(){return!!this._def.checks.find(e=>"url"===e.kind)}get isEmoji(){return!!this._def.checks.find(e=>"emoji"===e.kind)}get isUUID(){return!!this._def.checks.find(e=>"uuid"===e.kind)}get isNANOID(){return!!this._def.checks.find(e=>"nanoid"===e.kind)}get isCUID(){return!!this._def.checks.find(e=>"cuid"===e.kind)}get isCUID2(){return!!this._def.checks.find(e=>"cuid2"===e.kind)}get isULID(){return!!this._def.checks.find(e=>"ulid"===e.kind)}get isIP(){return!!this._def.checks.find(e=>"ip"===e.kind)}get isCIDR(){return!!this._def.checks.find(e=>"cidr"===e.kind)}get isBase64(){return!!this._def.checks.find(e=>"base64"===e.kind)}get isBase64url(){return!!this._def.checks.find(e=>"base64url"===e.kind)}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}function sa(e,t){const n=(e.toString().split(".")[1]||"").length,a=(t.toString().split(".")[1]||"").length,s=n>a?n:a;return Number.parseInt(e.toFixed(s).replace(".",""))%Number.parseInt(t.toFixed(s).replace(".",""))/10**s}aa.create=e=>new aa({checks:[],typeName:$a.ZodString,coerce:(null==e?void 0:e.coerce)??!1,...Dn(e)});class ra extends On{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){this._def.coerce&&(e.data=Number(e.data));if(this._getType(e)!==pn.number){const t=this._getOrReturnCtx(e);return bn(t,{code:hn.invalid_type,expected:pn.number,received:t.parsedType}),Nn}let t;const n=new vn;for(const a of this._def.checks)if("int"===a.kind)dn.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),bn(t,{code:hn.invalid_type,expected:"integer",received:"float",message:a.message}),n.dirty());else if("min"===a.kind){(a.inclusive?e.data<a.value:e.data<=a.value)&&(t=this._getOrReturnCtx(e,t),bn(t,{code:hn.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),n.dirty())}else if("max"===a.kind){(a.inclusive?e.data>a.value:e.data>=a.value)&&(t=this._getOrReturnCtx(e,t),bn(t,{code:hn.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),n.dirty())}else"multipleOf"===a.kind?0!==sa(e.data,a.value)&&(t=this._getOrReturnCtx(e,t),bn(t,{code:hn.not_multiple_of,multipleOf:a.value,message:a.message}),n.dirty()):"finite"===a.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),bn(t,{code:hn.not_finite,message:a.message}),n.dirty()):dn.assertNever(a);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,Tn.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Tn.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Tn.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Tn.toString(t))}setLimit(e,t,n,a){return new ra({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:Tn.toString(a)}]})}_addCheck(e){return new ra({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Tn.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Tn.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Tn.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Tn.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Tn.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Tn.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:Tn.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Tn.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Tn.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>"int"===e.kind||"multipleOf"===e.kind&&dn.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if("finite"===n.kind||"int"===n.kind||"multipleOf"===n.kind)return!0;"min"===n.kind?(null===t||n.value>t)&&(t=n.value):"max"===n.kind&&(null===e||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}ra.create=e=>new ra({checks:[],typeName:$a.ZodNumber,coerce:(null==e?void 0:e.coerce)||!1,...Dn(e)});class ia extends On{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==pn.bigint)return this._getInvalidInput(e);let t;const n=new vn;for(const a of this._def.checks)if("min"===a.kind){(a.inclusive?e.data<a.value:e.data<=a.value)&&(t=this._getOrReturnCtx(e,t),bn(t,{code:hn.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),n.dirty())}else if("max"===a.kind){(a.inclusive?e.data>a.value:e.data>=a.value)&&(t=this._getOrReturnCtx(e,t),bn(t,{code:hn.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),n.dirty())}else"multipleOf"===a.kind?e.data%a.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),bn(t,{code:hn.not_multiple_of,multipleOf:a.value,message:a.message}),n.dirty()):dn.assertNever(a);return{status:n.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return bn(t,{code:hn.invalid_type,expected:pn.bigint,received:t.parsedType}),Nn}gte(e,t){return this.setLimit("min",e,!0,Tn.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Tn.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Tn.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Tn.toString(t))}setLimit(e,t,n,a){return new ia({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:Tn.toString(a)}]})}_addCheck(e){return new ia({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Tn.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Tn.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Tn.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Tn.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Tn.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}ia.create=e=>new ia({checks:[],typeName:$a.ZodBigInt,coerce:(null==e?void 0:e.coerce)??!1,...Dn(e)});class la extends On{_parse(e){this._def.coerce&&(e.data=Boolean(e.data));if(this._getType(e)!==pn.boolean){const t=this._getOrReturnCtx(e);return bn(t,{code:hn.invalid_type,expected:pn.boolean,received:t.parsedType}),Nn}return kn(e.data)}}la.create=e=>new la({typeName:$a.ZodBoolean,coerce:(null==e?void 0:e.coerce)||!1,...Dn(e)});class oa extends On{_parse(e){this._def.coerce&&(e.data=new Date(e.data));if(this._getType(e)!==pn.date){const t=this._getOrReturnCtx(e);return bn(t,{code:hn.invalid_type,expected:pn.date,received:t.parsedType}),Nn}if(Number.isNaN(e.data.getTime())){return bn(this._getOrReturnCtx(e),{code:hn.invalid_date}),Nn}const t=new vn;let n;for(const a of this._def.checks)"min"===a.kind?e.data.getTime()<a.value&&(n=this._getOrReturnCtx(e,n),bn(n,{code:hn.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),t.dirty()):"max"===a.kind?e.data.getTime()>a.value&&(n=this._getOrReturnCtx(e,n),bn(n,{code:hn.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),t.dirty()):dn.assertNever(a);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new oa({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:Tn.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:Tn.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}oa.create=e=>new oa({checks:[],coerce:(null==e?void 0:e.coerce)||!1,typeName:$a.ZodDate,...Dn(e)});class ca extends On{_parse(e){if(this._getType(e)!==pn.symbol){const t=this._getOrReturnCtx(e);return bn(t,{code:hn.invalid_type,expected:pn.symbol,received:t.parsedType}),Nn}return kn(e.data)}}ca.create=e=>new ca({typeName:$a.ZodSymbol,...Dn(e)});class da extends On{_parse(e){if(this._getType(e)!==pn.undefined){const t=this._getOrReturnCtx(e);return bn(t,{code:hn.invalid_type,expected:pn.undefined,received:t.parsedType}),Nn}return kn(e.data)}}da.create=e=>new da({typeName:$a.ZodUndefined,...Dn(e)});class ua extends On{_parse(e){if(this._getType(e)!==pn.null){const t=this._getOrReturnCtx(e);return bn(t,{code:hn.invalid_type,expected:pn.null,received:t.parsedType}),Nn}return kn(e.data)}}ua.create=e=>new ua({typeName:$a.ZodNull,...Dn(e)});class ma extends On{constructor(){super(...arguments),this._any=!0}_parse(e){return kn(e.data)}}ma.create=e=>new ma({typeName:$a.ZodAny,...Dn(e)});class pa extends On{constructor(){super(...arguments),this._unknown=!0}_parse(e){return kn(e.data)}}pa.create=e=>new pa({typeName:$a.ZodUnknown,...Dn(e)});class fa extends On{_parse(e){const t=this._getOrReturnCtx(e);return bn(t,{code:hn.invalid_type,expected:pn.never,received:t.parsedType}),Nn}}fa.create=e=>new fa({typeName:$a.ZodNever,...Dn(e)});class ha extends On{_parse(e){if(this._getType(e)!==pn.undefined){const t=this._getOrReturnCtx(e);return bn(t,{code:hn.invalid_type,expected:pn.void,received:t.parsedType}),Nn}return kn(e.data)}}ha.create=e=>new ha({typeName:$a.ZodVoid,...Dn(e)});class ga extends On{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),a=this._def;if(t.parsedType!==pn.array)return bn(t,{code:hn.invalid_type,expected:pn.array,received:t.parsedType}),Nn;if(null!==a.exactLength){const e=t.data.length>a.exactLength.value,s=t.data.length<a.exactLength.value;(e||s)&&(bn(t,{code:e?hn.too_big:hn.too_small,minimum:s?a.exactLength.value:void 0,maximum:e?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),n.dirty())}if(null!==a.minLength&&t.data.length<a.minLength.value&&(bn(t,{code:hn.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),n.dirty()),null!==a.maxLength&&t.data.length>a.maxLength.value&&(bn(t,{code:hn.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((e,n)=>a.type._parseAsync(new An(t,e,t.path,n)))).then(e=>vn.mergeArray(n,e));const s=[...t.data].map((e,n)=>a.type._parseSync(new An(t,e,t.path,n)));return vn.mergeArray(n,s)}get element(){return this._def.type}min(e,t){return new ga({...this._def,minLength:{value:e,message:Tn.toString(t)}})}max(e,t){return new ga({...this._def,maxLength:{value:e,message:Tn.toString(t)}})}length(e,t){return new ga({...this._def,exactLength:{value:e,message:Tn.toString(t)}})}nonempty(e){return this.min(1,e)}}function xa(e){if(e instanceof ya){const t={};for(const n in e.shape){const a=e.shape[n];t[n]=Oa.create(xa(a))}return new ya({...e._def,shape:()=>t})}return e instanceof ga?new ga({...e._def,type:xa(e.element)}):e instanceof Oa?Oa.create(xa(e.unwrap())):e instanceof Ra?Ra.create(xa(e.unwrap())):e instanceof wa?wa.create(e.items.map(e=>xa(e))):e}ga.create=(e,t)=>new ga({type:e,minLength:null,maxLength:null,exactLength:null,typeName:$a.ZodArray,...Dn(t)});class ya extends On{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),t=dn.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==pn.object){const t=this._getOrReturnCtx(e);return bn(t,{code:hn.invalid_type,expected:pn.object,received:t.parsedType}),Nn}const{status:t,ctx:n}=this._processInputParams(e),{shape:a,keys:s}=this._getCached(),r=[];if(!(this._def.catchall instanceof fa&&"strip"===this._def.unknownKeys))for(const l in n.data)s.includes(l)||r.push(l);const i=[];for(const l of s){const e=a[l],t=n.data[l];i.push({key:{status:"valid",value:l},value:e._parse(new An(n,t,n.path,l)),alwaysSet:l in n.data})}if(this._def.catchall instanceof fa){const e=this._def.unknownKeys;if("passthrough"===e)for(const t of r)i.push({key:{status:"valid",value:t},value:{status:"valid",value:n.data[t]}});else if("strict"===e)r.length>0&&(bn(n,{code:hn.unrecognized_keys,keys:r}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const t of r){const a=n.data[t];i.push({key:{status:"valid",value:t},value:e._parse(new An(n,a,n.path,t)),alwaysSet:t in n.data})}}return n.common.async?Promise.resolve().then(async()=>{const e=[];for(const t of i){const n=await t.key,a=await t.value;e.push({key:n,value:a,alwaysSet:t.alwaysSet})}return e}).then(e=>vn.mergeObjectSync(t,e)):vn.mergeObjectSync(t,i)}get shape(){return this._def.shape()}strict(e){return Tn.errToObj,new ya({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,n)=>{var a,s;const r=(null==(s=(a=this._def).errorMap)?void 0:s.call(a,t,n).message)??n.defaultError;return"unrecognized_keys"===t.code?{message:Tn.errToObj(e).message??r}:{message:r}}}:{}})}strip(){return new ya({...this._def,unknownKeys:"strip"})}passthrough(){return new ya({...this._def,unknownKeys:"passthrough"})}extend(e){return new ya({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new ya({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:$a.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new ya({...this._def,catchall:e})}pick(e){const t={};for(const n of dn.objectKeys(e))e[n]&&this.shape[n]&&(t[n]=this.shape[n]);return new ya({...this._def,shape:()=>t})}omit(e){const t={};for(const n of dn.objectKeys(this.shape))e[n]||(t[n]=this.shape[n]);return new ya({...this._def,shape:()=>t})}deepPartial(){return xa(this)}partial(e){const t={};for(const n of dn.objectKeys(this.shape)){const a=this.shape[n];e&&!e[n]?t[n]=a:t[n]=a.optional()}return new ya({...this._def,shape:()=>t})}required(e){const t={};for(const n of dn.objectKeys(this.shape))if(e&&!e[n])t[n]=this.shape[n];else{let e=this.shape[n];for(;e instanceof Oa;)e=e._def.innerType;t[n]=e}return new ya({...this._def,shape:()=>t})}keyof(){return Ta(dn.objectKeys(this.shape))}}ya.create=(e,t)=>new ya({shape:()=>e,unknownKeys:"strip",catchall:fa.create(),typeName:$a.ZodObject,...Dn(t)}),ya.strictCreate=(e,t)=>new ya({shape:()=>e,unknownKeys:"strict",catchall:fa.create(),typeName:$a.ZodObject,...Dn(t)}),ya.lazycreate=(e,t)=>new ya({shape:e,unknownKeys:"strip",catchall:fa.create(),typeName:$a.ZodObject,...Dn(t)});class ba extends On{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;if(t.common.async)return Promise.all(n.map(async e=>{const n={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:n}),ctx:n}})).then(function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const a of e)if("dirty"===a.result.status)return t.common.issues.push(...a.ctx.common.issues),a.result;const n=e.map(e=>new gn(e.ctx.common.issues));return bn(t,{code:hn.invalid_union,unionErrors:n}),Nn});{let e;const a=[];for(const r of n){const n={...t,common:{...t.common,issues:[]},parent:null},s=r._parseSync({data:t.data,path:t.path,parent:n});if("valid"===s.status)return s;"dirty"!==s.status||e||(e={result:s,ctx:n}),n.common.issues.length&&a.push(n.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;const s=a.map(e=>new gn(e));return bn(t,{code:hn.invalid_union,unionErrors:s}),Nn}}get options(){return this._def.options}}function va(e,t){const n=fn(e),a=fn(t);if(e===t)return{valid:!0,data:e};if(n===pn.object&&a===pn.object){const n=dn.objectKeys(t),a=dn.objectKeys(e).filter(e=>-1!==n.indexOf(e)),s={...e,...t};for(const r of a){const n=va(e[r],t[r]);if(!n.valid)return{valid:!1};s[r]=n.data}return{valid:!0,data:s}}if(n===pn.array&&a===pn.array){if(e.length!==t.length)return{valid:!1};const n=[];for(let a=0;a<e.length;a++){const s=va(e[a],t[a]);if(!s.valid)return{valid:!1};n.push(s.data)}return{valid:!0,data:n}}return n===pn.date&&a===pn.date&&+e===+t?{valid:!0,data:e}:{valid:!1}}ba.create=(e,t)=>new ba({options:e,typeName:$a.ZodUnion,...Dn(t)});class Na extends On{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),a=(e,a)=>{if(En(e)||En(a))return Nn;const s=va(e.value,a.value);return s.valid?((jn(e)||jn(a))&&t.dirty(),{status:t.value,value:s.data}):(bn(n,{code:hn.invalid_intersection_types}),Nn)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([e,t])=>a(e,t)):a(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}Na.create=(e,t,n)=>new Na({left:e,right:t,typeName:$a.ZodIntersection,...Dn(n)});class wa extends On{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==pn.array)return bn(n,{code:hn.invalid_type,expected:pn.array,received:n.parsedType}),Nn;if(n.data.length<this._def.items.length)return bn(n,{code:hn.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Nn;!this._def.rest&&n.data.length>this._def.items.length&&(bn(n,{code:hn.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const a=[...n.data].map((e,t)=>{const a=this._def.items[t]||this._def.rest;return a?a._parse(new An(n,e,n.path,t)):null}).filter(e=>!!e);return n.common.async?Promise.all(a).then(e=>vn.mergeArray(t,e)):vn.mergeArray(t,a)}get items(){return this._def.items}rest(e){return new wa({...this._def,rest:e})}}wa.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new wa({items:e,typeName:$a.ZodTuple,rest:null,...Dn(t)})};class ka extends On{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==pn.object)return bn(n,{code:hn.invalid_type,expected:pn.object,received:n.parsedType}),Nn;const a=[],s=this._def.keyType,r=this._def.valueType;for(const i in n.data)a.push({key:s._parse(new An(n,i,n.path,i)),value:r._parse(new An(n,n.data[i],n.path,i)),alwaysSet:i in n.data});return n.common.async?vn.mergeObjectAsync(t,a):vn.mergeObjectSync(t,a)}get element(){return this._def.valueType}static create(e,t,n){return new ka(t instanceof On?{keyType:e,valueType:t,typeName:$a.ZodRecord,...Dn(n)}:{keyType:aa.create(),valueType:e,typeName:$a.ZodRecord,...Dn(t)})}}class Ea extends On{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==pn.map)return bn(n,{code:hn.invalid_type,expected:pn.map,received:n.parsedType}),Nn;const a=this._def.keyType,s=this._def.valueType,r=[...n.data.entries()].map(([e,t],r)=>({key:a._parse(new An(n,e,n.path,[r,"key"])),value:s._parse(new An(n,t,n.path,[r,"value"]))}));if(n.common.async){const e=new Map;return Promise.resolve().then(async()=>{for(const n of r){const a=await n.key,s=await n.value;if("aborted"===a.status||"aborted"===s.status)return Nn;"dirty"!==a.status&&"dirty"!==s.status||t.dirty(),e.set(a.value,s.value)}return{status:t.value,value:e}})}{const e=new Map;for(const n of r){const a=n.key,s=n.value;if("aborted"===a.status||"aborted"===s.status)return Nn;"dirty"!==a.status&&"dirty"!==s.status||t.dirty(),e.set(a.value,s.value)}return{status:t.value,value:e}}}}Ea.create=(e,t,n)=>new Ea({valueType:t,keyType:e,typeName:$a.ZodMap,...Dn(n)});class ja extends On{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==pn.set)return bn(n,{code:hn.invalid_type,expected:pn.set,received:n.parsedType}),Nn;const a=this._def;null!==a.minSize&&n.data.size<a.minSize.value&&(bn(n,{code:hn.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),t.dirty()),null!==a.maxSize&&n.data.size>a.maxSize.value&&(bn(n,{code:hn.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),t.dirty());const s=this._def.valueType;function r(e){const n=new Set;for(const a of e){if("aborted"===a.status)return Nn;"dirty"===a.status&&t.dirty(),n.add(a.value)}return{status:t.value,value:n}}const i=[...n.data.values()].map((e,t)=>s._parse(new An(n,e,n.path,t)));return n.common.async?Promise.all(i).then(e=>r(e)):r(i)}min(e,t){return new ja({...this._def,minSize:{value:e,message:Tn.toString(t)}})}max(e,t){return new ja({...this._def,maxSize:{value:e,message:Tn.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}ja.create=(e,t)=>new ja({valueType:e,minSize:null,maxSize:null,typeName:$a.ZodSet,...Dn(t)});class Ca extends On{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}Ca.create=(e,t)=>new Ca({getter:e,typeName:$a.ZodLazy,...Dn(t)});class _a extends On{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return bn(t,{received:t.data,code:hn.invalid_literal,expected:this._def.value}),Nn}return{status:"valid",value:e.data}}get value(){return this._def.value}}function Ta(e,t){return new Sa({values:e,typeName:$a.ZodEnum,...Dn(t)})}_a.create=(e,t)=>new _a({value:e,typeName:$a.ZodLiteral,...Dn(t)});class Sa extends On{_parse(e){if("string"!=typeof e.data){const t=this._getOrReturnCtx(e),n=this._def.values;return bn(t,{expected:dn.joinValues(n),received:t.parsedType,code:hn.invalid_type}),Nn}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const t=this._getOrReturnCtx(e),n=this._def.values;return bn(t,{received:t.data,code:hn.invalid_enum_value,options:n}),Nn}return kn(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Sa.create(e,{...this._def,...t})}exclude(e,t=this._def){return Sa.create(this.options.filter(t=>!e.includes(t)),{...this._def,...t})}}Sa.create=Ta;class Aa extends On{_parse(e){const t=dn.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==pn.string&&n.parsedType!==pn.number){const e=dn.objectValues(t);return bn(n,{expected:dn.joinValues(e),received:n.parsedType,code:hn.invalid_type}),Nn}if(this._cache||(this._cache=new Set(dn.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const e=dn.objectValues(t);return bn(n,{received:n.data,code:hn.invalid_enum_value,options:e}),Nn}return kn(e.data)}get enum(){return this._def.values}}Aa.create=(e,t)=>new Aa({values:e,typeName:$a.ZodNativeEnum,...Dn(t)});class Ia extends On{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==pn.promise&&!1===t.common.async)return bn(t,{code:hn.invalid_type,expected:pn.promise,received:t.parsedType}),Nn;const n=t.parsedType===pn.promise?t.data:Promise.resolve(t.data);return kn(n.then(e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap})))}}Ia.create=(e,t)=>new Ia({type:e,typeName:$a.ZodPromise,...Dn(t)});class Da extends On{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===$a.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),a=this._def.effect||null,s={addIssue:e=>{bn(n,e),e.fatal?t.abort():t.dirty()},get path(){return n.path}};if(s.addIssue=s.addIssue.bind(s),"preprocess"===a.type){const e=a.transform(n.data,s);if(n.common.async)return Promise.resolve(e).then(async e=>{if("aborted"===t.value)return Nn;const a=await this._def.schema._parseAsync({data:e,path:n.path,parent:n});return"aborted"===a.status?Nn:"dirty"===a.status||"dirty"===t.value?wn(a.value):a});{if("aborted"===t.value)return Nn;const a=this._def.schema._parseSync({data:e,path:n.path,parent:n});return"aborted"===a.status?Nn:"dirty"===a.status||"dirty"===t.value?wn(a.value):a}}if("refinement"===a.type){const e=e=>{const t=a.refinement(e,s);if(n.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===n.common.async){const a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===a.status?Nn:("dirty"===a.status&&t.dirty(),e(a.value),{status:t.value,value:a.value})}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(n=>"aborted"===n.status?Nn:("dirty"===n.status&&t.dirty(),e(n.value).then(()=>({status:t.value,value:n.value}))))}if("transform"===a.type){if(!1===n.common.async){const e=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Cn(e))return Nn;const r=a.transform(e.value,s);if(r instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:r}}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(e=>Cn(e)?Promise.resolve(a.transform(e.value,s)).then(e=>({status:t.value,value:e})):Nn)}dn.assertNever(a)}}Da.create=(e,t,n)=>new Da({schema:e,typeName:$a.ZodEffects,effect:t,...Dn(n)}),Da.createWithPreprocess=(e,t,n)=>new Da({schema:t,effect:{type:"preprocess",transform:e},typeName:$a.ZodEffects,...Dn(n)});class Oa extends On{_parse(e){return this._getType(e)===pn.undefined?kn(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Oa.create=(e,t)=>new Oa({innerType:e,typeName:$a.ZodOptional,...Dn(t)});class Ra extends On{_parse(e){return this._getType(e)===pn.null?kn(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ra.create=(e,t)=>new Ra({innerType:e,typeName:$a.ZodNullable,...Dn(t)});class Pa extends On{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===pn.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Pa.create=(e,t)=>new Pa({innerType:e,typeName:$a.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...Dn(t)});class Ma extends On{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},a=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return _n(a)?a.then(e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new gn(n.common.issues)},input:n.data})})):{status:"valid",value:"valid"===a.status?a.value:this._def.catchValue({get error(){return new gn(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}Ma.create=(e,t)=>new Ma({innerType:e,typeName:$a.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...Dn(t)});class Ua extends On{_parse(e){if(this._getType(e)!==pn.nan){const t=this._getOrReturnCtx(e);return bn(t,{code:hn.invalid_type,expected:pn.nan,received:t.parsedType}),Nn}return{status:"valid",value:e.data}}}Ua.create=e=>new Ua({typeName:$a.ZodNaN,...Dn(e)});class La extends On{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class Fa extends On{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async){return(async()=>{const e=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?Nn:"dirty"===e.status?(t.dirty(),wn(e.value)):this._def.out._parseAsync({data:e.value,path:n.path,parent:n})})()}{const e=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?Nn:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:n.path,parent:n})}}static create(e,t){return new Fa({in:e,out:t,typeName:$a.ZodPipeline})}}class Ba extends On{_parse(e){const t=this._def.innerType._parse(e),n=e=>(Cn(e)&&(e.value=Object.freeze(e.value)),e);return _n(t)?t.then(e=>n(e)):n(t)}unwrap(){return this._def.innerType}}var $a,Ga;Ba.create=(e,t)=>new Ba({innerType:e,typeName:$a.ZodReadonly,...Dn(t)}),(Ga=$a||($a={})).ZodString="ZodString",Ga.ZodNumber="ZodNumber",Ga.ZodNaN="ZodNaN",Ga.ZodBigInt="ZodBigInt",Ga.ZodBoolean="ZodBoolean",Ga.ZodDate="ZodDate",Ga.ZodSymbol="ZodSymbol",Ga.ZodUndefined="ZodUndefined",Ga.ZodNull="ZodNull",Ga.ZodAny="ZodAny",Ga.ZodUnknown="ZodUnknown",Ga.ZodNever="ZodNever",Ga.ZodVoid="ZodVoid",Ga.ZodArray="ZodArray",Ga.ZodObject="ZodObject",Ga.ZodUnion="ZodUnion",Ga.ZodDiscriminatedUnion="ZodDiscriminatedUnion",Ga.ZodIntersection="ZodIntersection",Ga.ZodTuple="ZodTuple",Ga.ZodRecord="ZodRecord",Ga.ZodMap="ZodMap",Ga.ZodSet="ZodSet",Ga.ZodFunction="ZodFunction",Ga.ZodLazy="ZodLazy",Ga.ZodLiteral="ZodLiteral",Ga.ZodEnum="ZodEnum",Ga.ZodEffects="ZodEffects",Ga.ZodNativeEnum="ZodNativeEnum",Ga.ZodOptional="ZodOptional",Ga.ZodNullable="ZodNullable",Ga.ZodDefault="ZodDefault",Ga.ZodCatch="ZodCatch",Ga.ZodPromise="ZodPromise",Ga.ZodBranded="ZodBranded",Ga.ZodPipeline="ZodPipeline",Ga.ZodReadonly="ZodReadonly";const Va=aa.create,za=ra.create;ia.create;const Wa=la.create;oa.create;const qa=pa.create;fa.create;const Ha=ga.create,Ka=ya.create,Ya=ba.create;Na.create,wa.create;const Ja=ka.create,Za=Ca.create,Qa=Sa.create;Ia.create,Oa.create,Ra.create;const Xa=e=>aa.create({...e,coerce:!0});
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let es,ts;function ns(e,t,n){var a,s,r;if(!(null===(a=e.httpOptions)||void 0===a?void 0:a.baseUrl)){const a={geminiUrl:es,vertexUrl:ts};return e.vertexai?null!==(s=a.vertexUrl)&&void 0!==s?s:t:null!==(r=a.geminiUrl)&&void 0!==r?r:n}return e.httpOptions.baseUrl}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class as{}function ss(e,t){return e.replace(/\{([^}]+)\}/g,(e,n)=>{if(Object.prototype.hasOwnProperty.call(t,n)){const e=t[n];return null!=e?String(e):""}throw new Error(`Key '${n}' not found in valueMap.`)})}function rs(e,t,n){for(let r=0;r<t.length-1;r++){const a=t[r];if(a.endsWith("[]")){const s=a.slice(0,-2);if(!(s in e)){if(!Array.isArray(n))throw new Error(`Value must be a list given an array path ${a}`);e[s]=Array.from({length:n.length},()=>({}))}if(Array.isArray(e[s])){const a=e[s];if(Array.isArray(n))for(let e=0;e<a.length;e++){rs(a[e],t.slice(r+1),n[e])}else for(const e of a)rs(e,t.slice(r+1),n)}return}if(a.endsWith("[0]")){const s=a.slice(0,-3);s in e||(e[s]=[{}]);return void rs(e[s][0],t.slice(r+1),n)}e[a]&&"object"==typeof e[a]||(e[a]={}),e=e[a]}const a=t[t.length-1],s=e[a];if(void 0!==s){if(!n||"object"==typeof n&&0===Object.keys(n).length)return;if(n===s)return;if("object"!=typeof s||"object"!=typeof n||null===s||null===n)throw new Error(`Cannot set value for an existing key. Key: ${a}`);Object.assign(s,n)}else e[a]=n}function is(e,t){try{if(1===t.length&&"_self"===t[0])return e;for(let n=0;n<t.length;n++){if("object"!=typeof e||null===e)return;const a=t[n];if(a.endsWith("[]")){const s=a.slice(0,-2);if(s in e){const a=e[s];if(!Array.isArray(a))return;return a.map(e=>is(e,t.slice(n+1)))}return}e=e[a]}return e}catch(n){if(n instanceof TypeError)return;throw n}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var ls,os,cs,ds,us,ms,ps,fs,hs,gs,xs,ys,bs,vs,Ns,ws,ks,Es,js,Cs,_s,Ts,Ss,As,Is,Ds,Os,Rs,Ps,Ms,Us,Ls,Fs,Bs,$s,Gs,Vs,zs,Ws,qs,Hs,Ks,Ys,Js,Zs,Qs,Xs,er,tr,nr,ar,sr,rr,ir,lr,or,cr,dr,ur,mr,pr,fr,hr,gr,xr,yr,br,vr,Nr,wr,kr,Er,jr,Cr,_r,Tr,Sr,Ar,Ir,Dr;(os=ls||(ls={})).OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",os.OUTCOME_OK="OUTCOME_OK",os.OUTCOME_FAILED="OUTCOME_FAILED",os.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED",(ds=cs||(cs={})).LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",ds.PYTHON="PYTHON",(ms=us||(us={})).TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",ms.STRING="STRING",ms.NUMBER="NUMBER",ms.INTEGER="INTEGER",ms.BOOLEAN="BOOLEAN",ms.ARRAY="ARRAY",ms.OBJECT="OBJECT",ms.NULL="NULL",(fs=ps||(ps={})).HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",fs.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",fs.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",fs.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",fs.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",fs.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",(gs=hs||(hs={})).HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",gs.SEVERITY="SEVERITY",gs.PROBABILITY="PROBABILITY",(ys=xs||(xs={})).HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",ys.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",ys.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",ys.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",ys.BLOCK_NONE="BLOCK_NONE",ys.OFF="OFF",(vs=bs||(bs={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",vs.MODE_DYNAMIC="MODE_DYNAMIC",(ws=Ns||(Ns={})).AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",ws.NO_AUTH="NO_AUTH",ws.API_KEY_AUTH="API_KEY_AUTH",ws.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",ws.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",ws.OAUTH="OAUTH",ws.OIDC_AUTH="OIDC_AUTH",(Es=ks||(ks={})).FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",Es.STOP="STOP",Es.MAX_TOKENS="MAX_TOKENS",Es.SAFETY="SAFETY",Es.RECITATION="RECITATION",Es.LANGUAGE="LANGUAGE",Es.OTHER="OTHER",Es.BLOCKLIST="BLOCKLIST",Es.PROHIBITED_CONTENT="PROHIBITED_CONTENT",Es.SPII="SPII",Es.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",Es.IMAGE_SAFETY="IMAGE_SAFETY",Es.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",(Cs=js||(js={})).HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",Cs.NEGLIGIBLE="NEGLIGIBLE",Cs.LOW="LOW",Cs.MEDIUM="MEDIUM",Cs.HIGH="HIGH",(Ts=_s||(_s={})).HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",Ts.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",Ts.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",Ts.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",Ts.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH",(As=Ss||(Ss={})).BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",As.SAFETY="SAFETY",As.OTHER="OTHER",As.BLOCKLIST="BLOCKLIST",As.PROHIBITED_CONTENT="PROHIBITED_CONTENT",(Ds=Is||(Is={})).TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",Ds.ON_DEMAND="ON_DEMAND",Ds.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT",(Rs=Os||(Os={})).MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",Rs.TEXT="TEXT",Rs.IMAGE="IMAGE",Rs.AUDIO="AUDIO",(Ms=Ps||(Ps={})).MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",Ms.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",Ms.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",Ms.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",(Ls=Us||(Us={})).JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",Ls.JOB_STATE_QUEUED="JOB_STATE_QUEUED",Ls.JOB_STATE_PENDING="JOB_STATE_PENDING",Ls.JOB_STATE_RUNNING="JOB_STATE_RUNNING",Ls.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",Ls.JOB_STATE_FAILED="JOB_STATE_FAILED",Ls.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",Ls.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",Ls.JOB_STATE_PAUSED="JOB_STATE_PAUSED",Ls.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",Ls.JOB_STATE_UPDATING="JOB_STATE_UPDATING",Ls.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED",(Bs=Fs||(Fs={})).ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",Bs.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",Bs.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",Bs.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",Bs.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",Bs.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",Bs.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO",(Gs=$s||($s={})).FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",Gs.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",Gs.BALANCED="BALANCED",Gs.PRIORITIZE_COST="PRIORITIZE_COST",(zs=Vs||(Vs={})).UNSPECIFIED="UNSPECIFIED",zs.BLOCKING="BLOCKING",zs.NON_BLOCKING="NON_BLOCKING",(qs=Ws||(Ws={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",qs.MODE_DYNAMIC="MODE_DYNAMIC",(Ks=Hs||(Hs={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",Ks.AUTO="AUTO",Ks.ANY="ANY",Ks.NONE="NONE",(Js=Ys||(Ys={})).URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",Js.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",Js.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",(Qs=Zs||(Zs={})).BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",Qs.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",Qs.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",Qs.BLOCK_NONE="BLOCK_NONE",(er=Xs||(Xs={})).DONT_ALLOW="DONT_ALLOW",er.ALLOW_ADULT="ALLOW_ADULT",er.ALLOW_ALL="ALLOW_ALL",(nr=tr||(tr={})).auto="auto",nr.en="en",nr.ja="ja",nr.ko="ko",nr.hi="hi",(sr=ar||(ar={})).MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",sr.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",sr.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",sr.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",sr.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC",(ir=rr||(rr={})).CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",ir.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",ir.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",ir.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH",(or=lr||(lr={})).SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",or.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",or.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",or.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT",(dr=cr||(cr={})).EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",dr.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",dr.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",dr.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",dr.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",dr.EDIT_MODE_STYLE="EDIT_MODE_STYLE",dr.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",dr.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE",(mr=ur||(ur={})).OPTIMIZED="OPTIMIZED",mr.LOSSLESS="LOSSLESS",(fr=pr||(pr={})).STATE_UNSPECIFIED="STATE_UNSPECIFIED",fr.PROCESSING="PROCESSING",fr.ACTIVE="ACTIVE",fr.FAILED="FAILED",(gr=hr||(hr={})).SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",gr.UPLOADED="UPLOADED",gr.GENERATED="GENERATED",(yr=xr||(xr={})).MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",yr.TEXT="TEXT",yr.IMAGE="IMAGE",yr.VIDEO="VIDEO",yr.AUDIO="AUDIO",yr.DOCUMENT="DOCUMENT",(vr=br||(br={})).START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",vr.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",vr.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW",(wr=Nr||(Nr={})).END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",wr.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",wr.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW",(Er=kr||(kr={})).ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",Er.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",Er.NO_INTERRUPTION="NO_INTERRUPTION",(Cr=jr||(jr={})).TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",Cr.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",Cr.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT",(Tr=_r||(_r={})).SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",Tr.SILENT="SILENT",Tr.WHEN_IDLE="WHEN_IDLE",Tr.INTERRUPT="INTERRUPT",(Ar=Sr||(Sr={})).SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",Ar.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",Ar.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",Ar.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",Ar.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",Ar.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",Ar.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",Ar.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",Ar.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",Ar.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",Ar.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",Ar.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",Ar.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR",(Dr=Ir||(Ir={})).PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",Dr.PLAY="PLAY",Dr.PAUSE="PAUSE",Dr.STOP="STOP",Dr.RESET_CONTEXT="RESET_CONTEXT";class Or{constructor(e){const t={};for(const n of e.headers.entries())t[n[0]]=n[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class Rr{get text(){var e,t,n,a,s,r,i,l;if(0===(null===(a=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===a?void 0:a.length))return;this.candidates&&this.candidates.length;let o="",c=!1;const d=[];for(const u of null!==(l=null===(i=null===(r=null===(s=this.candidates)||void 0===s?void 0:s[0])||void 0===r?void 0:r.content)||void 0===i?void 0:i.parts)&&void 0!==l?l:[]){for(const[e,t]of Object.entries(u))"text"===e||"thought"===e||null===t&&void 0===t||d.push(e);if("string"==typeof u.text){if("boolean"==typeof u.thought&&u.thought)continue;c=!0,o+=u.text}}return d.length,c?o:void 0}get data(){var e,t,n,a,s,r,i,l;if(0===(null===(a=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===a?void 0:a.length))return;this.candidates&&this.candidates.length;let o="";const c=[];for(const d of null!==(l=null===(i=null===(r=null===(s=this.candidates)||void 0===s?void 0:s[0])||void 0===r?void 0:r.content)||void 0===i?void 0:i.parts)&&void 0!==l?l:[]){for(const[e,t]of Object.entries(d))"inlineData"===e||null===t&&void 0===t||c.push(e);d.inlineData&&"string"==typeof d.inlineData.data&&(o+=atob(d.inlineData.data))}return c.length,o.length>0?btoa(o):void 0}get functionCalls(){var e,t,n,a,s,r,i,l;if(0===(null===(a=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===a?void 0:a.length))return;this.candidates&&this.candidates.length;const o=null===(l=null===(i=null===(r=null===(s=this.candidates)||void 0===s?void 0:s[0])||void 0===r?void 0:r.content)||void 0===i?void 0:i.parts)||void 0===l?void 0:l.filter(e=>e.functionCall).map(e=>e.functionCall).filter(e=>void 0!==e);return 0!==(null==o?void 0:o.length)?o:void 0}get executableCode(){var e,t,n,a,s,r,i,l,o;if(0===(null===(a=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===a?void 0:a.length))return;this.candidates&&this.candidates.length;const c=null===(l=null===(i=null===(r=null===(s=this.candidates)||void 0===s?void 0:s[0])||void 0===r?void 0:r.content)||void 0===i?void 0:i.parts)||void 0===l?void 0:l.filter(e=>e.executableCode).map(e=>e.executableCode).filter(e=>void 0!==e);return 0!==(null==c?void 0:c.length)?null===(o=null==c?void 0:c[0])||void 0===o?void 0:o.code:void 0}get codeExecutionResult(){var e,t,n,a,s,r,i,l,o;if(0===(null===(a=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===a?void 0:a.length))return;this.candidates&&this.candidates.length;const c=null===(l=null===(i=null===(r=null===(s=this.candidates)||void 0===s?void 0:s[0])||void 0===r?void 0:r.content)||void 0===i?void 0:i.parts)||void 0===l?void 0:l.filter(e=>e.codeExecutionResult).map(e=>e.codeExecutionResult).filter(e=>void 0!==e);return 0!==(null==c?void 0:c.length)?null===(o=null==c?void 0:c[0])||void 0===o?void 0:o.output:void 0}}class Pr{}class Mr{}class Ur{}class Lr{}class Fr{}class Br{}class $r{}class Gr{}class Vr{}class zr{}class Wr{}class qr{}class Hr{}class Kr{}class Yr{}class Jr{get text(){var e,t,n;let a="",s=!1;const r=[];for(const i of null!==(n=null===(t=null===(e=this.serverContent)||void 0===e?void 0:e.modelTurn)||void 0===t?void 0:t.parts)&&void 0!==n?n:[]){for(const[e,t]of Object.entries(i))"text"!==e&&"thought"!==e&&null!==t&&r.push(e);if("string"==typeof i.text){if("boolean"==typeof i.thought&&i.thought)continue;s=!0,a+=i.text}}return r.length,s?a:void 0}get data(){var e,t,n;let a="";const s=[];for(const r of null!==(n=null===(t=null===(e=this.serverContent)||void 0===e?void 0:e.modelTurn)||void 0===t?void 0:t.parts)&&void 0!==n?n:[]){for(const[e,t]of Object.entries(r))"inlineData"!==e&&null!==t&&s.push(e);r.inlineData&&"string"==typeof r.inlineData.data&&(a+=atob(r.inlineData.data))}return s.length,a.length>0?btoa(a):void 0}}class Zr{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Qr(e,t){if(!t||"string"!=typeof t)throw new Error("model is required and must be a string");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const e=t.split("/",2);return`publishers/${e[0]}/models/${e[1]}`}return`publishers/google/models/${t}`}return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function Xr(e,t){const n=Qr(e,t);return n?n.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:n.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${n}`:n:""}function ei(e){return Array.isArray(e)?e.map(e=>ti(e)):[ti(e)]}function ti(e){if("object"==typeof e&&null!==e)return e;throw new Error("Could not parse input as Blob. Unsupported blob type: "+typeof e)}function ni(e){if(null==e)throw new Error("PartUnion is required");if("object"==typeof e)return e;if("string"==typeof e)return{text:e};throw new Error("Unsupported part type: "+typeof e)}function ai(e){if(null==e||Array.isArray(e)&&0===e.length)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(e=>ni(e)):[ni(e)]}function si(e){return null!=e&&"object"==typeof e&&"parts"in e&&Array.isArray(e.parts)}function ri(e){return null!=e&&"object"==typeof e&&"functionCall"in e}function ii(e){return null!=e&&"object"==typeof e&&"functionResponse"in e}function li(e){if(null==e)throw new Error("ContentUnion is required");return si(e)?e:{role:"user",parts:ai(e)}}function oi(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(e=>{const t=li(e);return t.parts&&t.parts.length>0&&void 0!==t.parts[0].text?[t.parts[0].text]:[]});if(e.isVertexAI()){const e=li(t);return e.parts&&e.parts.length>0&&void 0!==e.parts[0].text?[e.parts[0].text]:[]}return Array.isArray(t)?t.map(e=>li(e)):[li(t)]}function ci(e){if(null==e||Array.isArray(e)&&0===e.length)throw new Error("contents are required");if(!Array.isArray(e)){if(ri(e)||ii(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[li(e)]}const t=[],n=[],a=si(e[0]);for(const s of e){const e=si(s);if(e!=a)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(e)t.push(s);else{if(ri(s)||ii(s))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(s)}}return a||t.push({role:"user",parts:ai(n)}),t}const di=new Set(["type","format","title","description","default","items","minItems","maxItems","enum","properties","required","minProperties","maxProperties","minimum","maximum","minLength","maxLength","pattern","anyOf","propertyOrdering"]),ui=Qa(["string","number","integer","object","array","boolean","null"]),mi=Ya([ui,Ha(ui)]);function pi(e){const t={},n=["items"],a=["anyOf"],s=["properties"];if(e.type&&e.anyOf)throw new Error("type and anyOf cannot be both populated.");const r=e.anyOf;null!=r&&2==r.length&&("null"===r[0].type?(t.nullable=!0,e=r[1]):"null"===r[1].type&&(t.nullable=!0,e=r[0])),e.type instanceof Array&&function(e,t){e.includes("null")&&(t.nullable=!0);const n=e.filter(e=>"null"!==e);if(1===n.length)t.type=Object.values(us).includes(n[0].toUpperCase())?n[0].toUpperCase():us.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const e of n)t.anyOf.push({type:Object.values(us).includes(e.toUpperCase())?e.toUpperCase():us.TYPE_UNSPECIFIED})}}(e.type,t);for(const[i,l]of Object.entries(e))if(null!=l)if("type"==i){if("null"===l)throw new Error("type: null can not be the only possible type for the field.");if(l instanceof Array)continue;t.type=Object.values(us).includes(l.toUpperCase())?l.toUpperCase():us.TYPE_UNSPECIFIED}else if(n.includes(i))t[i]=pi(l);else if(a.includes(i)){const e=[];for(const n of l)"null"!=n.type?e.push(pi(n)):t.nullable=!0;t[i]=e}else if(s.includes(i)){const e={};for(const[t,n]of Object.entries(l))e[t]=pi(n);t[i]=e}else{if("additionalProperties"===i)continue;t[i]=l}return t}function fi(e){if(Object.keys(e).includes("$schema")){delete e.$schema;return pi(function(e=!0){const t=Za(()=>{const n=Ka({type:mi.optional(),format:Va().optional(),title:Va().optional(),description:Va().optional(),default:qa().optional(),items:t.optional(),minItems:Xa().optional(),maxItems:Xa().optional(),enum:Ha(qa()).optional(),properties:Ja(Va(),t).optional(),required:Ha(Va()).optional(),minProperties:Xa().optional(),maxProperties:Xa().optional(),propertyOrdering:Ha(Va()).optional(),minimum:za().optional(),maximum:za().optional(),minLength:Xa().optional(),maxLength:Xa().optional(),pattern:Va().optional(),anyOf:Ha(t).optional(),additionalProperties:Wa().optional()});return e?n.strict():n});return t}().parse(e))}return pi(e)}function hi(e){if("object"==typeof e)return e;if("string"==typeof e)return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error("Unsupported speechConfig type: "+typeof e)}function gi(e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function xi(e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(t.parameters=fi(t.parameters)),t.response&&(t.response=fi(t.response));return e}function yi(e){if(null==e)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const n of e)t.push(n);return t}function bi(e,t){if("string"!=typeof t)throw new Error("name must be a string");return function(e,t,n,a=1){const s=!t.startsWith(`${n}/`)&&t.split("/").length===a;return e.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${e.getProject()}/${t}`:t.startsWith(`${n}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:s?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}/${t}`:t:s?`${n}/${t}`:t}(e,t,"cachedContents")}function vi(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function Ni(e){if("string"!=typeof e)throw new Error("fromImageBytes must be a string");return e}function wi(e){var t;let n;var a;if(null!=(a=e)&&"object"==typeof a&&"name"in a&&(n=e.name),!(function(e){return null!=e&&"object"==typeof e&&"uri"in e}(e)&&(n=e.uri,void 0===n)||function(e){return null!=e&&"object"==typeof e&&"video"in e}(e)&&(n=null===(t=e.video)||void 0===t?void 0:t.uri,void 0===n))){if("string"==typeof e&&(n=e),void 0===n)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const e=n.split("files/")[1].match(/[a-z0-9]+/);if(null===e)throw new Error(`Could not extract file name from URI ${n}`);n=e[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function ki(e,t){let n;return n=e.isVertexAI()?t?"publishers/google/models":"models":t?"models":"tunedModels",n}function Ei(e){for(const t of["models","tunedModels","publisherModels"])if(ji(e,t))return e[t];return[]}function ji(e,t){return null!==e&&"object"==typeof e&&t in e}function Ci(e,t={}){const n=e,a={name:n.name,description:n.description,parameters:pi(Si(n.inputSchema))};t.behavior&&(a.behavior=t.behavior);return{functionDeclarations:[a]}}function _i(e){const t=[];for(const n of e)t.push(Si(n));return t}function Ti(e){const t={};for(const[n,a]of Object.entries(e)){const e=a;t[n]=Si(e)}return t}function Si(e){const t=new Set(["items"]),n=new Set(["anyOf"]),a=new Set(["properties"]),s={};for(const[r,i]of Object.entries(e))if(t.has(r))s[r]=Si(i);else if(n.has(r))s[r]=_i(i);else if(a.has(r))s[r]=Ti(i);else if("type"===r){const e=i.toUpperCase();s[r]=Object.values(us).includes(e)?e:us.TYPE_UNSPECIFIED}else di.has(r)&&(s[r]=i);return s}function Ai(e,t){if("string"!=typeof t&&!Array.isArray(t)){if(e&&e.isVertexAI()){if(t.gcsUri&&t.bigqueryUri)throw new Error("Only one of `gcsUri` or `bigqueryUri` can be set.");if(!t.gcsUri&&!t.bigqueryUri)throw new Error("One of `gcsUri` or `bigqueryUri` must be set.")}else{if(t.inlinedRequests&&t.fileName)throw new Error("Only one of `inlinedRequests` or `fileName` can be set.");if(!t.inlinedRequests&&!t.fileName)throw new Error("One of `inlinedRequests` or `fileName` must be set.")}return t}if(Array.isArray(t))return{inlinedRequests:t};if("string"==typeof t){if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:[t]};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};if(t.startsWith("files/"))return{fileName:t}}throw new Error(`Unsupported source: ${t}`)}function Ii(e,t){const n=t;if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function Di(e){return"BATCH_STATE_UNSPECIFIED"===e?"JOB_STATE_UNSPECIFIED":"BATCH_STATE_PENDING"===e?"JOB_STATE_PENDING":"BATCH_STATE_SUCCEEDED"===e?"JOB_STATE_SUCCEEDED":"BATCH_STATE_FAILED"===e?"JOB_STATE_FAILED":"BATCH_STATE_CANCELLED"===e?"JOB_STATE_CANCELLED":e}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Oi(e){const t={},n=is(e,["videoMetadata"]);null!=n&&rs(t,["videoMetadata"],function(e){const t={},n=is(e,["fps"]);null!=n&&rs(t,["fps"],n);const a=is(e,["endOffset"]);null!=a&&rs(t,["endOffset"],a);const s=is(e,["startOffset"]);return null!=s&&rs(t,["startOffset"],s),t}(n));const a=is(e,["thought"]);null!=a&&rs(t,["thought"],a);const s=is(e,["inlineData"]);null!=s&&rs(t,["inlineData"],function(e){const t={};if(void 0!==is(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=is(e,["data"]);null!=n&&rs(t,["data"],n);const a=is(e,["mimeType"]);return null!=a&&rs(t,["mimeType"],a),t}(s));const r=is(e,["fileData"]);null!=r&&rs(t,["fileData"],function(e){const t={};if(void 0!==is(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=is(e,["fileUri"]);null!=n&&rs(t,["fileUri"],n);const a=is(e,["mimeType"]);return null!=a&&rs(t,["mimeType"],a),t}(r));const i=is(e,["thoughtSignature"]);null!=i&&rs(t,["thoughtSignature"],i);const l=is(e,["codeExecutionResult"]);null!=l&&rs(t,["codeExecutionResult"],l);const o=is(e,["executableCode"]);null!=o&&rs(t,["executableCode"],o);const c=is(e,["functionCall"]);null!=c&&rs(t,["functionCall"],c);const d=is(e,["functionResponse"]);null!=d&&rs(t,["functionResponse"],d);const u=is(e,["text"]);return null!=u&&rs(t,["text"],u),t}function Ri(e){const t={},n=is(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>Oi(e))),rs(t,["parts"],e)}const a=is(e,["role"]);return null!=a&&rs(t,["role"],a),t}function Pi(e){const t={},n=is(e,["timeRangeFilter"]);return null!=n&&rs(t,["timeRangeFilter"],function(e){const t={},n=is(e,["startTime"]);null!=n&&rs(t,["startTime"],n);const a=is(e,["endTime"]);return null!=a&&rs(t,["endTime"],a),t}(n)),t}function Mi(e){const t={},n=is(e,["dynamicRetrievalConfig"]);return null!=n&&rs(t,["dynamicRetrievalConfig"],function(e){const t={},n=is(e,["mode"]);null!=n&&rs(t,["mode"],n);const a=is(e,["dynamicThreshold"]);return null!=a&&rs(t,["dynamicThreshold"],a),t}(n)),t}function Ui(e){const t={},n=is(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=is(e,["behavior"]);null!=n&&rs(t,["behavior"],n);const a=is(e,["description"]);null!=a&&rs(t,["description"],a);const s=is(e,["name"]);null!=s&&rs(t,["name"],s);const r=is(e,["parameters"]);null!=r&&rs(t,["parameters"],r);const i=is(e,["parametersJsonSchema"]);null!=i&&rs(t,["parametersJsonSchema"],i);const l=is(e,["response"]);null!=l&&rs(t,["response"],l);const o=is(e,["responseJsonSchema"]);return null!=o&&rs(t,["responseJsonSchema"],o),t}(e))),rs(t,["functionDeclarations"],e)}if(void 0!==is(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const a=is(e,["googleSearch"]);null!=a&&rs(t,["googleSearch"],Pi(a));const s=is(e,["googleSearchRetrieval"]);if(null!=s&&rs(t,["googleSearchRetrieval"],Mi(s)),void 0!==is(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==is(e,["googleMaps"]))throw new Error("googleMaps parameter is not supported in Gemini API.");null!=is(e,["urlContext"])&&rs(t,["urlContext"],{});const r=is(e,["codeExecution"]);return null!=r&&rs(t,["codeExecution"],r),t}function Li(e){const t={},n=is(e,["latLng"]);null!=n&&rs(t,["latLng"],function(e){const t={},n=is(e,["latitude"]);null!=n&&rs(t,["latitude"],n);const a=is(e,["longitude"]);return null!=a&&rs(t,["longitude"],a),t}(n));const a=is(e,["languageCode"]);return null!=a&&rs(t,["languageCode"],a),t}function Fi(e){const t={},n=is(e,["functionCallingConfig"]);null!=n&&rs(t,["functionCallingConfig"],function(e){const t={},n=is(e,["mode"]);null!=n&&rs(t,["mode"],n);const a=is(e,["allowedFunctionNames"]);return null!=a&&rs(t,["allowedFunctionNames"],a),t}(n));const a=is(e,["retrievalConfig"]);return null!=a&&rs(t,["retrievalConfig"],Li(a)),t}function Bi(e){const t={},n=is(e,["prebuiltVoiceConfig"]);return null!=n&&rs(t,["prebuiltVoiceConfig"],function(e){const t={},n=is(e,["voiceName"]);return null!=n&&rs(t,["voiceName"],n),t}(n)),t}function $i(e){const t={},n=is(e,["speakerVoiceConfigs"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=is(e,["speaker"]);null!=n&&rs(t,["speaker"],n);const a=is(e,["voiceConfig"]);return null!=a&&rs(t,["voiceConfig"],Bi(a)),t}(e))),rs(t,["speakerVoiceConfigs"],e)}return t}function Gi(e,t,n){const a={},s=is(t,["systemInstruction"]);void 0!==n&&null!=s&&rs(n,["systemInstruction"],Ri(li(s)));const r=is(t,["temperature"]);null!=r&&rs(a,["temperature"],r);const i=is(t,["topP"]);null!=i&&rs(a,["topP"],i);const l=is(t,["topK"]);null!=l&&rs(a,["topK"],l);const o=is(t,["candidateCount"]);null!=o&&rs(a,["candidateCount"],o);const c=is(t,["maxOutputTokens"]);null!=c&&rs(a,["maxOutputTokens"],c);const d=is(t,["stopSequences"]);null!=d&&rs(a,["stopSequences"],d);const u=is(t,["responseLogprobs"]);null!=u&&rs(a,["responseLogprobs"],u);const m=is(t,["logprobs"]);null!=m&&rs(a,["logprobs"],m);const p=is(t,["presencePenalty"]);null!=p&&rs(a,["presencePenalty"],p);const f=is(t,["frequencyPenalty"]);null!=f&&rs(a,["frequencyPenalty"],f);const h=is(t,["seed"]);null!=h&&rs(a,["seed"],h);const g=is(t,["responseMimeType"]);null!=g&&rs(a,["responseMimeType"],g);const x=is(t,["responseSchema"]);null!=x&&rs(a,["responseSchema"],function(e){const t={},n=is(e,["anyOf"]);null!=n&&rs(t,["anyOf"],n);const a=is(e,["default"]);null!=a&&rs(t,["default"],a);const s=is(e,["description"]);null!=s&&rs(t,["description"],s);const r=is(e,["enum"]);null!=r&&rs(t,["enum"],r);const i=is(e,["example"]);null!=i&&rs(t,["example"],i);const l=is(e,["format"]);null!=l&&rs(t,["format"],l);const o=is(e,["items"]);null!=o&&rs(t,["items"],o);const c=is(e,["maxItems"]);null!=c&&rs(t,["maxItems"],c);const d=is(e,["maxLength"]);null!=d&&rs(t,["maxLength"],d);const u=is(e,["maxProperties"]);null!=u&&rs(t,["maxProperties"],u);const m=is(e,["maximum"]);null!=m&&rs(t,["maximum"],m);const p=is(e,["minItems"]);null!=p&&rs(t,["minItems"],p);const f=is(e,["minLength"]);null!=f&&rs(t,["minLength"],f);const h=is(e,["minProperties"]);null!=h&&rs(t,["minProperties"],h);const g=is(e,["minimum"]);null!=g&&rs(t,["minimum"],g);const x=is(e,["nullable"]);null!=x&&rs(t,["nullable"],x);const y=is(e,["pattern"]);null!=y&&rs(t,["pattern"],y);const b=is(e,["properties"]);null!=b&&rs(t,["properties"],b);const v=is(e,["propertyOrdering"]);null!=v&&rs(t,["propertyOrdering"],v);const N=is(e,["required"]);null!=N&&rs(t,["required"],N);const w=is(e,["title"]);null!=w&&rs(t,["title"],w);const k=is(e,["type"]);return null!=k&&rs(t,["type"],k),t}(fi(x)));const y=is(t,["responseJsonSchema"]);if(null!=y&&rs(a,["responseJsonSchema"],y),void 0!==is(t,["routingConfig"]))throw new Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==is(t,["modelSelectionConfig"]))throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const b=is(t,["safetySettings"]);if(void 0!==n&&null!=b){let e=b;Array.isArray(e)&&(e=e.map(e=>function(e){const t={};if(void 0!==is(e,["method"]))throw new Error("method parameter is not supported in Gemini API.");const n=is(e,["category"]);null!=n&&rs(t,["category"],n);const a=is(e,["threshold"]);return null!=a&&rs(t,["threshold"],a),t}(e))),rs(n,["safetySettings"],e)}const v=is(t,["tools"]);if(void 0!==n&&null!=v){let e=yi(v);Array.isArray(e)&&(e=e.map(e=>Ui(xi(e)))),rs(n,["tools"],e)}const N=is(t,["toolConfig"]);if(void 0!==n&&null!=N&&rs(n,["toolConfig"],Fi(N)),void 0!==is(t,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");const w=is(t,["cachedContent"]);void 0!==n&&null!=w&&rs(n,["cachedContent"],bi(e,w));const k=is(t,["responseModalities"]);null!=k&&rs(a,["responseModalities"],k);const E=is(t,["mediaResolution"]);null!=E&&rs(a,["mediaResolution"],E);const j=is(t,["speechConfig"]);if(null!=j&&rs(a,["speechConfig"],function(e){const t={},n=is(e,["voiceConfig"]);null!=n&&rs(t,["voiceConfig"],Bi(n));const a=is(e,["multiSpeakerVoiceConfig"]);null!=a&&rs(t,["multiSpeakerVoiceConfig"],$i(a));const s=is(e,["languageCode"]);return null!=s&&rs(t,["languageCode"],s),t}(hi(j))),void 0!==is(t,["audioTimestamp"]))throw new Error("audioTimestamp parameter is not supported in Gemini API.");const C=is(t,["thinkingConfig"]);return null!=C&&rs(a,["thinkingConfig"],function(e){const t={},n=is(e,["includeThoughts"]);null!=n&&rs(t,["includeThoughts"],n);const a=is(e,["thinkingBudget"]);return null!=a&&rs(t,["thinkingBudget"],a),t}(C)),a}function Vi(e,t){const n={};if(void 0!==is(t,["format"]))throw new Error("format parameter is not supported in Gemini API.");if(void 0!==is(t,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==is(t,["bigqueryUri"]))throw new Error("bigqueryUri parameter is not supported in Gemini API.");const a=is(t,["fileName"]);null!=a&&rs(n,["fileName"],a);const s=is(t,["inlinedRequests"]);if(null!=s){let t=s;Array.isArray(t)&&(t=t.map(t=>function(e,t){const n={},a=is(t,["model"]);null!=a&&rs(n,["request","model"],Qr(e,a));const s=is(t,["contents"]);if(null!=s){let e=ci(s);Array.isArray(e)&&(e=e.map(e=>Ri(e))),rs(n,["request","contents"],e)}const r=is(t,["config"]);return null!=r&&rs(n,["request","generationConfig"],Gi(e,r,n)),n}(e,t))),rs(n,["requests","requests"],t)}return n}function zi(e,t){const n={},a=is(t,["model"]);null!=a&&rs(n,["_url","model"],Qr(e,a));const s=is(t,["src"]);null!=s&&rs(n,["batch","inputConfig"],Vi(e,Ai(e,s)));const r=is(t,["config"]);return null!=r&&rs(n,["config"],function(e,t){const n=is(e,["displayName"]);if(void 0!==t&&null!=n&&rs(t,["batch","displayName"],n),void 0!==is(e,["dest"]))throw new Error("dest parameter is not supported in Gemini API.");return{}}(r,n)),n}function Wi(e){const t={},n=is(e,["config"]);return null!=n&&rs(t,["config"],function(e,t){const n=is(e,["pageSize"]);void 0!==t&&null!=n&&rs(t,["_query","pageSize"],n);const a=is(e,["pageToken"]);if(void 0!==t&&null!=a&&rs(t,["_query","pageToken"],a),void 0!==is(e,["filter"]))throw new Error("filter parameter is not supported in Gemini API.");return{}}(n,t)),t}function qi(e,t){const n=is(e,["displayName"]);void 0!==t&&null!=n&&rs(t,["displayName"],n);const a=is(e,["dest"]);return void 0!==t&&null!=a&&rs(t,["outputConfig"],function(e){const t={},n=is(e,["format"]);null!=n&&rs(t,["predictionsFormat"],n);const a=is(e,["gcsUri"]);null!=a&&rs(t,["gcsDestination","outputUriPrefix"],a);const s=is(e,["bigqueryUri"]);if(null!=s&&rs(t,["bigqueryDestination","outputUri"],s),void 0!==is(e,["fileName"]))throw new Error("fileName parameter is not supported in Vertex AI.");if(void 0!==is(e,["inlinedResponses"]))throw new Error("inlinedResponses parameter is not supported in Vertex AI.");return t}(function(e){const t=e;if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:t};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};throw new Error(`Unsupported destination: ${t}`)}(a))),{}}function Hi(e,t){const n={},a=is(t,["model"]);null!=a&&rs(n,["model"],Qr(e,a));const s=is(t,["src"]);null!=s&&rs(n,["inputConfig"],function(e){const t={},n=is(e,["format"]);null!=n&&rs(t,["instancesFormat"],n);const a=is(e,["gcsUri"]);null!=a&&rs(t,["gcsSource","uris"],a);const s=is(e,["bigqueryUri"]);if(null!=s&&rs(t,["bigquerySource","inputUri"],s),void 0!==is(e,["fileName"]))throw new Error("fileName parameter is not supported in Vertex AI.");if(void 0!==is(e,["inlinedRequests"]))throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return t}(Ai(e,s)));const r=is(t,["config"]);return null!=r&&rs(n,["config"],qi(r,n)),n}function Ki(e){const t={},n=is(e,["config"]);return null!=n&&rs(t,["config"],function(e,t){const n=is(e,["pageSize"]);void 0!==t&&null!=n&&rs(t,["_query","pageSize"],n);const a=is(e,["pageToken"]);void 0!==t&&null!=a&&rs(t,["_query","pageToken"],a);const s=is(e,["filter"]);return void 0!==t&&null!=s&&rs(t,["_query","filter"],s),{}}(n,t)),t}function Yi(e){const t={},n=is(e,["videoMetadata"]);null!=n&&rs(t,["videoMetadata"],function(e){const t={},n=is(e,["fps"]);null!=n&&rs(t,["fps"],n);const a=is(e,["endOffset"]);null!=a&&rs(t,["endOffset"],a);const s=is(e,["startOffset"]);return null!=s&&rs(t,["startOffset"],s),t}(n));const a=is(e,["thought"]);null!=a&&rs(t,["thought"],a);const s=is(e,["inlineData"]);null!=s&&rs(t,["inlineData"],function(e){const t={},n=is(e,["data"]);null!=n&&rs(t,["data"],n);const a=is(e,["mimeType"]);return null!=a&&rs(t,["mimeType"],a),t}(s));const r=is(e,["fileData"]);null!=r&&rs(t,["fileData"],function(e){const t={},n=is(e,["fileUri"]);null!=n&&rs(t,["fileUri"],n);const a=is(e,["mimeType"]);return null!=a&&rs(t,["mimeType"],a),t}(r));const i=is(e,["thoughtSignature"]);null!=i&&rs(t,["thoughtSignature"],i);const l=is(e,["codeExecutionResult"]);null!=l&&rs(t,["codeExecutionResult"],l);const o=is(e,["executableCode"]);null!=o&&rs(t,["executableCode"],o);const c=is(e,["functionCall"]);null!=c&&rs(t,["functionCall"],c);const d=is(e,["functionResponse"]);null!=d&&rs(t,["functionResponse"],d);const u=is(e,["text"]);return null!=u&&rs(t,["text"],u),t}function Ji(e){const t={},n=is(e,["urlMetadata"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=is(e,["retrievedUrl"]);null!=n&&rs(t,["retrievedUrl"],n);const a=is(e,["urlRetrievalStatus"]);return null!=a&&rs(t,["urlRetrievalStatus"],a),t}(e))),rs(t,["urlMetadata"],e)}return t}function Zi(e){const t={},n=is(e,["content"]);null!=n&&rs(t,["content"],function(e){const t={},n=is(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>Yi(e))),rs(t,["parts"],e)}const a=is(e,["role"]);return null!=a&&rs(t,["role"],a),t}(n));const a=is(e,["citationMetadata"]);null!=a&&rs(t,["citationMetadata"],function(e){const t={},n=is(e,["citationSources"]);return null!=n&&rs(t,["citations"],n),t}(a));const s=is(e,["tokenCount"]);null!=s&&rs(t,["tokenCount"],s);const r=is(e,["finishReason"]);null!=r&&rs(t,["finishReason"],r);const i=is(e,["urlContextMetadata"]);null!=i&&rs(t,["urlContextMetadata"],Ji(i));const l=is(e,["avgLogprobs"]);null!=l&&rs(t,["avgLogprobs"],l);const o=is(e,["groundingMetadata"]);null!=o&&rs(t,["groundingMetadata"],o);const c=is(e,["index"]);null!=c&&rs(t,["index"],c);const d=is(e,["logprobsResult"]);null!=d&&rs(t,["logprobsResult"],d);const u=is(e,["safetyRatings"]);return null!=u&&rs(t,["safetyRatings"],u),t}function Qi(e){const t={},n=is(e,["response"]);null!=n&&rs(t,["response"],function(e){const t={},n=is(e,["candidates"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>Zi(e))),rs(t,["candidates"],e)}const a=is(e,["modelVersion"]);null!=a&&rs(t,["modelVersion"],a);const s=is(e,["promptFeedback"]);null!=s&&rs(t,["promptFeedback"],s);const r=is(e,["usageMetadata"]);return null!=r&&rs(t,["usageMetadata"],r),t}(n));return null!=is(e,["error"])&&rs(t,["error"],{}),t}function Xi(e){const t={},n=is(e,["name"]);null!=n&&rs(t,["name"],n);const a=is(e,["metadata","displayName"]);null!=a&&rs(t,["displayName"],a);const s=is(e,["metadata","state"]);null!=s&&rs(t,["state"],Di(s));const r=is(e,["metadata","createTime"]);null!=r&&rs(t,["createTime"],r);const i=is(e,["metadata","endTime"]);null!=i&&rs(t,["endTime"],i);const l=is(e,["metadata","updateTime"]);null!=l&&rs(t,["updateTime"],l);const o=is(e,["metadata","model"]);null!=o&&rs(t,["model"],o);const c=is(e,["metadata","output"]);return null!=c&&rs(t,["dest"],function(e){const t={},n=is(e,["responsesFile"]);null!=n&&rs(t,["fileName"],n);const a=is(e,["inlinedResponses","inlinedResponses"]);if(null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>Qi(e))),rs(t,["inlinedResponses"],e)}return t}(c)),t}function el(e){const t={},n=is(e,["name"]);null!=n&&rs(t,["name"],n);const a=is(e,["displayName"]);null!=a&&rs(t,["displayName"],a);const s=is(e,["state"]);null!=s&&rs(t,["state"],Di(s));const r=is(e,["error"]);null!=r&&rs(t,["error"],function(e){const t={},n=is(e,["details"]);null!=n&&rs(t,["details"],n);const a=is(e,["code"]);null!=a&&rs(t,["code"],a);const s=is(e,["message"]);return null!=s&&rs(t,["message"],s),t}(r));const i=is(e,["createTime"]);null!=i&&rs(t,["createTime"],i);const l=is(e,["startTime"]);null!=l&&rs(t,["startTime"],l);const o=is(e,["endTime"]);null!=o&&rs(t,["endTime"],o);const c=is(e,["updateTime"]);null!=c&&rs(t,["updateTime"],c);const d=is(e,["model"]);null!=d&&rs(t,["model"],d);const u=is(e,["inputConfig"]);null!=u&&rs(t,["src"],function(e){const t={},n=is(e,["instancesFormat"]);null!=n&&rs(t,["format"],n);const a=is(e,["gcsSource","uris"]);null!=a&&rs(t,["gcsUri"],a);const s=is(e,["bigquerySource","inputUri"]);return null!=s&&rs(t,["bigqueryUri"],s),t}(u));const m=is(e,["outputConfig"]);return null!=m&&rs(t,["dest"],function(e){const t={},n=is(e,["predictionsFormat"]);null!=n&&rs(t,["format"],n);const a=is(e,["gcsDestination","outputUriPrefix"]);null!=a&&rs(t,["gcsUri"],a);const s=is(e,["bigqueryDestination","outputUri"]);return null!=s&&rs(t,["bigqueryUri"],s),t}(m)),t}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
var tl,nl;(nl=tl||(tl={})).PAGED_ITEM_BATCH_JOBS="batchJobs",nl.PAGED_ITEM_MODELS="models",nl.PAGED_ITEM_TUNING_JOBS="tuningJobs",nl.PAGED_ITEM_FILES="files",nl.PAGED_ITEM_CACHED_CONTENTS="cachedContents";class al{constructor(e,t,n,a){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,n,a)}init(e,t,n){var a,s;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let r={config:{}};r=n?"object"==typeof n?Object.assign({},n):n:{config:{}},r.config&&(r.config.pageToken=t.nextPageToken),this.paramsInternal=r,this.pageInternalSize=null!==(s=null===(a=r.config)||void 0===a?void 0:a.pageSize)&&void 0!==s?s:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength){if(!this.hasNextPage())return{value:void 0,done:!0};await this.nextPage()}const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return void 0!==(null===(e=this.params.config)||void 0===e?void 0:e.pageToken)}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sl extends as{constructor(e){super(),this.apiClient=e,this.create=async e=>{if(this.apiClient.isVertexAI()){if(Array.isArray(e.src))throw new Error("InlinedRequest[] is not supported in Vertex AI. Please use Google Cloud Storage URI or BigQuery URI instead.");if(e.config=e.config||{},void 0===e.config.displayName&&(e.config.displayName="genaiBatchJob_"),void 0===e.config.dest&&"string"==typeof e.src)if(e.src.startsWith("gs://")&&e.src.endsWith(".jsonl"))e.config.dest=`${e.src.slice(0,-6)}/dest`;else{if(!e.src.startsWith("bq://"))throw new Error("Unsupported source:"+e.src);e.config.dest=`${e.src}_dest_`}}return await this.createInternal(e)},this.list=async(e={})=>new al(tl.PAGED_ITEM_BATCH_JOBS,e=>this.listInternal(e),await this.listInternal(e),e)}async createInternal(e){var t,n,a,s;let r,i="",l={};if(this.apiClient.isVertexAI()){const a=Hi(this.apiClient,e);return i=ss("batchPredictionJobs",a._url),l=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>el(e))}{const t=zi(this.apiClient,e);return i=ss("{model}:batchGenerateContent",t._url),l=t._query,delete t.config,delete t._url,delete t._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(a=e.config)||void 0===a?void 0:a.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json()),r.then(e=>Xi(e))}}async get(e){var t,n,a,s;let r,i="",l={};if(this.apiClient.isVertexAI()){const a=function(e,t){const n={},a=is(t,["name"]);null!=a&&rs(n,["_url","name"],Ii(e,a));const s=is(t,["config"]);return null!=s&&rs(n,["config"],s),n}(this.apiClient,e);return i=ss("batchPredictionJobs/{name}",a._url),l=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>el(e))}{const t=function(e,t){const n={},a=is(t,["name"]);null!=a&&rs(n,["_url","name"],Ii(e,a));const s=is(t,["config"]);return null!=s&&rs(n,["config"],s),n}(this.apiClient,e);return i=ss("batches/{name}",t._url),l=t._query,delete t.config,delete t._url,delete t._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(a=e.config)||void 0===a?void 0:a.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json()),r.then(e=>Xi(e))}}async cancel(e){var t,n,a,s;let r="",i={};if(this.apiClient.isVertexAI()){const a=function(e,t){const n={},a=is(t,["name"]);null!=a&&rs(n,["_url","name"],Ii(e,a));const s=is(t,["config"]);return null!=s&&rs(n,["config"],s),n}(this.apiClient,e);r=ss("batchPredictionJobs/{name}:cancel",a._url),i=a._query,delete a.config,delete a._url,delete a._query,await this.apiClient.request({path:r,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal})}else{const t=function(e,t){const n={},a=is(t,["name"]);null!=a&&rs(n,["_url","name"],Ii(e,a));const s=is(t,["config"]);return null!=s&&rs(n,["config"],s),n}(this.apiClient,e);r=ss("batches/{name}:cancel",t._url),i=t._query,delete t.config,delete t._url,delete t._query,await this.apiClient.request({path:r,queryParams:i,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(a=e.config)||void 0===a?void 0:a.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal})}}async listInternal(e){var t,n,a,s;let r,i="",l={};if(this.apiClient.isVertexAI()){const a=Ki(e);return i=ss("batchPredictionJobs",a._url),l=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>{const t=function(e){const t={},n=is(e,["nextPageToken"]);null!=n&&rs(t,["nextPageToken"],n);const a=is(e,["batchPredictionJobs"]);if(null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>el(e))),rs(t,["batchJobs"],e)}return t}(e),n=new Yr;return Object.assign(n,t),n})}{const t=Wi(e);return i=ss("batches",t._url),l=t._query,delete t.config,delete t._url,delete t._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(a=e.config)||void 0===a?void 0:a.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json()),r.then(e=>{const t=function(e){const t={},n=is(e,["nextPageToken"]);null!=n&&rs(t,["nextPageToken"],n);const a=is(e,["operations"]);if(null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>Xi(e))),rs(t,["batchJobs"],e)}return t}(e),n=new Yr;return Object.assign(n,t),n})}}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rl(e){const t={},n=is(e,["videoMetadata"]);null!=n&&rs(t,["videoMetadata"],function(e){const t={},n=is(e,["fps"]);null!=n&&rs(t,["fps"],n);const a=is(e,["endOffset"]);null!=a&&rs(t,["endOffset"],a);const s=is(e,["startOffset"]);return null!=s&&rs(t,["startOffset"],s),t}(n));const a=is(e,["thought"]);null!=a&&rs(t,["thought"],a);const s=is(e,["inlineData"]);null!=s&&rs(t,["inlineData"],function(e){const t={};if(void 0!==is(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=is(e,["data"]);null!=n&&rs(t,["data"],n);const a=is(e,["mimeType"]);return null!=a&&rs(t,["mimeType"],a),t}(s));const r=is(e,["fileData"]);null!=r&&rs(t,["fileData"],function(e){const t={};if(void 0!==is(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=is(e,["fileUri"]);null!=n&&rs(t,["fileUri"],n);const a=is(e,["mimeType"]);return null!=a&&rs(t,["mimeType"],a),t}(r));const i=is(e,["thoughtSignature"]);null!=i&&rs(t,["thoughtSignature"],i);const l=is(e,["codeExecutionResult"]);null!=l&&rs(t,["codeExecutionResult"],l);const o=is(e,["executableCode"]);null!=o&&rs(t,["executableCode"],o);const c=is(e,["functionCall"]);null!=c&&rs(t,["functionCall"],c);const d=is(e,["functionResponse"]);null!=d&&rs(t,["functionResponse"],d);const u=is(e,["text"]);return null!=u&&rs(t,["text"],u),t}function il(e){const t={},n=is(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>rl(e))),rs(t,["parts"],e)}const a=is(e,["role"]);return null!=a&&rs(t,["role"],a),t}function ll(e){const t={},n=is(e,["timeRangeFilter"]);return null!=n&&rs(t,["timeRangeFilter"],function(e){const t={},n=is(e,["startTime"]);null!=n&&rs(t,["startTime"],n);const a=is(e,["endTime"]);return null!=a&&rs(t,["endTime"],a),t}(n)),t}function ol(e){const t={},n=is(e,["dynamicRetrievalConfig"]);return null!=n&&rs(t,["dynamicRetrievalConfig"],function(e){const t={},n=is(e,["mode"]);null!=n&&rs(t,["mode"],n);const a=is(e,["dynamicThreshold"]);return null!=a&&rs(t,["dynamicThreshold"],a),t}(n)),t}function cl(e){const t={},n=is(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=is(e,["behavior"]);null!=n&&rs(t,["behavior"],n);const a=is(e,["description"]);null!=a&&rs(t,["description"],a);const s=is(e,["name"]);null!=s&&rs(t,["name"],s);const r=is(e,["parameters"]);null!=r&&rs(t,["parameters"],r);const i=is(e,["parametersJsonSchema"]);null!=i&&rs(t,["parametersJsonSchema"],i);const l=is(e,["response"]);null!=l&&rs(t,["response"],l);const o=is(e,["responseJsonSchema"]);return null!=o&&rs(t,["responseJsonSchema"],o),t}(e))),rs(t,["functionDeclarations"],e)}if(void 0!==is(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const a=is(e,["googleSearch"]);null!=a&&rs(t,["googleSearch"],ll(a));const s=is(e,["googleSearchRetrieval"]);if(null!=s&&rs(t,["googleSearchRetrieval"],ol(s)),void 0!==is(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==is(e,["googleMaps"]))throw new Error("googleMaps parameter is not supported in Gemini API.");null!=is(e,["urlContext"])&&rs(t,["urlContext"],{});const r=is(e,["codeExecution"]);return null!=r&&rs(t,["codeExecution"],r),t}function dl(e){const t={},n=is(e,["latLng"]);null!=n&&rs(t,["latLng"],function(e){const t={},n=is(e,["latitude"]);null!=n&&rs(t,["latitude"],n);const a=is(e,["longitude"]);return null!=a&&rs(t,["longitude"],a),t}(n));const a=is(e,["languageCode"]);return null!=a&&rs(t,["languageCode"],a),t}function ul(e){const t={},n=is(e,["functionCallingConfig"]);null!=n&&rs(t,["functionCallingConfig"],function(e){const t={},n=is(e,["mode"]);null!=n&&rs(t,["mode"],n);const a=is(e,["allowedFunctionNames"]);return null!=a&&rs(t,["allowedFunctionNames"],a),t}(n));const a=is(e,["retrievalConfig"]);return null!=a&&rs(t,["retrievalConfig"],dl(a)),t}function ml(e,t){const n={},a=is(t,["model"]);null!=a&&rs(n,["model"],Xr(e,a));const s=is(t,["config"]);return null!=s&&rs(n,["config"],function(e,t){const n=is(e,["ttl"]);void 0!==t&&null!=n&&rs(t,["ttl"],n);const a=is(e,["expireTime"]);void 0!==t&&null!=a&&rs(t,["expireTime"],a);const s=is(e,["displayName"]);void 0!==t&&null!=s&&rs(t,["displayName"],s);const r=is(e,["contents"]);if(void 0!==t&&null!=r){let e=ci(r);Array.isArray(e)&&(e=e.map(e=>il(e))),rs(t,["contents"],e)}const i=is(e,["systemInstruction"]);void 0!==t&&null!=i&&rs(t,["systemInstruction"],il(li(i)));const l=is(e,["tools"]);if(void 0!==t&&null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>cl(e))),rs(t,["tools"],e)}const o=is(e,["toolConfig"]);if(void 0!==t&&null!=o&&rs(t,["toolConfig"],ul(o)),void 0!==is(e,["kmsKeyName"]))throw new Error("kmsKeyName parameter is not supported in Gemini API.");return{}}(s,n)),n}function pl(e,t){const n={},a=is(t,["name"]);null!=a&&rs(n,["_url","name"],bi(e,a));const s=is(t,["config"]);return null!=s&&rs(n,["config"],function(e,t){const n=is(e,["ttl"]);void 0!==t&&null!=n&&rs(t,["ttl"],n);const a=is(e,["expireTime"]);return void 0!==t&&null!=a&&rs(t,["expireTime"],a),{}}(s,n)),n}function fl(e){const t={},n=is(e,["config"]);return null!=n&&rs(t,["config"],function(e,t){const n=is(e,["pageSize"]);void 0!==t&&null!=n&&rs(t,["_query","pageSize"],n);const a=is(e,["pageToken"]);return void 0!==t&&null!=a&&rs(t,["_query","pageToken"],a),{}}(n,t)),t}function hl(e){const t={},n=is(e,["videoMetadata"]);null!=n&&rs(t,["videoMetadata"],function(e){const t={},n=is(e,["fps"]);null!=n&&rs(t,["fps"],n);const a=is(e,["endOffset"]);null!=a&&rs(t,["endOffset"],a);const s=is(e,["startOffset"]);return null!=s&&rs(t,["startOffset"],s),t}(n));const a=is(e,["thought"]);null!=a&&rs(t,["thought"],a);const s=is(e,["inlineData"]);null!=s&&rs(t,["inlineData"],function(e){const t={},n=is(e,["displayName"]);null!=n&&rs(t,["displayName"],n);const a=is(e,["data"]);null!=a&&rs(t,["data"],a);const s=is(e,["mimeType"]);return null!=s&&rs(t,["mimeType"],s),t}(s));const r=is(e,["fileData"]);null!=r&&rs(t,["fileData"],function(e){const t={},n=is(e,["displayName"]);null!=n&&rs(t,["displayName"],n);const a=is(e,["fileUri"]);null!=a&&rs(t,["fileUri"],a);const s=is(e,["mimeType"]);return null!=s&&rs(t,["mimeType"],s),t}(r));const i=is(e,["thoughtSignature"]);null!=i&&rs(t,["thoughtSignature"],i);const l=is(e,["codeExecutionResult"]);null!=l&&rs(t,["codeExecutionResult"],l);const o=is(e,["executableCode"]);null!=o&&rs(t,["executableCode"],o);const c=is(e,["functionCall"]);null!=c&&rs(t,["functionCall"],c);const d=is(e,["functionResponse"]);null!=d&&rs(t,["functionResponse"],d);const u=is(e,["text"]);return null!=u&&rs(t,["text"],u),t}function gl(e){const t={},n=is(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>hl(e))),rs(t,["parts"],e)}const a=is(e,["role"]);return null!=a&&rs(t,["role"],a),t}function xl(e){const t={},n=is(e,["timeRangeFilter"]);return null!=n&&rs(t,["timeRangeFilter"],function(e){const t={},n=is(e,["startTime"]);null!=n&&rs(t,["startTime"],n);const a=is(e,["endTime"]);return null!=a&&rs(t,["endTime"],a),t}(n)),t}function yl(e){const t={},n=is(e,["dynamicRetrievalConfig"]);return null!=n&&rs(t,["dynamicRetrievalConfig"],function(e){const t={},n=is(e,["mode"]);null!=n&&rs(t,["mode"],n);const a=is(e,["dynamicThreshold"]);return null!=a&&rs(t,["dynamicThreshold"],a),t}(n)),t}function bl(e){const t={},n=is(e,["apiKeyConfig"]);null!=n&&rs(t,["apiKeyConfig"],function(e){const t={},n=is(e,["apiKeyString"]);return null!=n&&rs(t,["apiKeyString"],n),t}(n));const a=is(e,["authType"]);null!=a&&rs(t,["authType"],a);const s=is(e,["googleServiceAccountConfig"]);null!=s&&rs(t,["googleServiceAccountConfig"],s);const r=is(e,["httpBasicAuthConfig"]);null!=r&&rs(t,["httpBasicAuthConfig"],r);const i=is(e,["oauthConfig"]);null!=i&&rs(t,["oauthConfig"],i);const l=is(e,["oidcConfig"]);return null!=l&&rs(t,["oidcConfig"],l),t}function vl(e){const t={},n=is(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={};if(void 0!==is(e,["behavior"]))throw new Error("behavior parameter is not supported in Vertex AI.");const n=is(e,["description"]);null!=n&&rs(t,["description"],n);const a=is(e,["name"]);null!=a&&rs(t,["name"],a);const s=is(e,["parameters"]);null!=s&&rs(t,["parameters"],s);const r=is(e,["parametersJsonSchema"]);null!=r&&rs(t,["parametersJsonSchema"],r);const i=is(e,["response"]);null!=i&&rs(t,["response"],i);const l=is(e,["responseJsonSchema"]);return null!=l&&rs(t,["responseJsonSchema"],l),t}(e))),rs(t,["functionDeclarations"],e)}const a=is(e,["retrieval"]);null!=a&&rs(t,["retrieval"],a);const s=is(e,["googleSearch"]);null!=s&&rs(t,["googleSearch"],xl(s));const r=is(e,["googleSearchRetrieval"]);null!=r&&rs(t,["googleSearchRetrieval"],yl(r));null!=is(e,["enterpriseWebSearch"])&&rs(t,["enterpriseWebSearch"],{});const i=is(e,["googleMaps"]);null!=i&&rs(t,["googleMaps"],function(e){const t={},n=is(e,["authConfig"]);return null!=n&&rs(t,["authConfig"],bl(n)),t}(i));null!=is(e,["urlContext"])&&rs(t,["urlContext"],{});const l=is(e,["codeExecution"]);return null!=l&&rs(t,["codeExecution"],l),t}function Nl(e){const t={},n=is(e,["latLng"]);null!=n&&rs(t,["latLng"],function(e){const t={},n=is(e,["latitude"]);null!=n&&rs(t,["latitude"],n);const a=is(e,["longitude"]);return null!=a&&rs(t,["longitude"],a),t}(n));const a=is(e,["languageCode"]);return null!=a&&rs(t,["languageCode"],a),t}function wl(e){const t={},n=is(e,["functionCallingConfig"]);null!=n&&rs(t,["functionCallingConfig"],function(e){const t={},n=is(e,["mode"]);null!=n&&rs(t,["mode"],n);const a=is(e,["allowedFunctionNames"]);return null!=a&&rs(t,["allowedFunctionNames"],a),t}(n));const a=is(e,["retrievalConfig"]);return null!=a&&rs(t,["retrievalConfig"],Nl(a)),t}function kl(e,t){const n={},a=is(t,["model"]);null!=a&&rs(n,["model"],Xr(e,a));const s=is(t,["config"]);return null!=s&&rs(n,["config"],function(e,t){const n=is(e,["ttl"]);void 0!==t&&null!=n&&rs(t,["ttl"],n);const a=is(e,["expireTime"]);void 0!==t&&null!=a&&rs(t,["expireTime"],a);const s=is(e,["displayName"]);void 0!==t&&null!=s&&rs(t,["displayName"],s);const r=is(e,["contents"]);if(void 0!==t&&null!=r){let e=ci(r);Array.isArray(e)&&(e=e.map(e=>gl(e))),rs(t,["contents"],e)}const i=is(e,["systemInstruction"]);void 0!==t&&null!=i&&rs(t,["systemInstruction"],gl(li(i)));const l=is(e,["tools"]);if(void 0!==t&&null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>vl(e))),rs(t,["tools"],e)}const o=is(e,["toolConfig"]);void 0!==t&&null!=o&&rs(t,["toolConfig"],wl(o));const c=is(e,["kmsKeyName"]);return void 0!==t&&null!=c&&rs(t,["encryption_spec","kmsKeyName"],c),{}}(s,n)),n}function El(e,t){const n={},a=is(t,["name"]);null!=a&&rs(n,["_url","name"],bi(e,a));const s=is(t,["config"]);return null!=s&&rs(n,["config"],function(e,t){const n=is(e,["ttl"]);void 0!==t&&null!=n&&rs(t,["ttl"],n);const a=is(e,["expireTime"]);return void 0!==t&&null!=a&&rs(t,["expireTime"],a),{}}(s,n)),n}function jl(e){const t={},n=is(e,["config"]);return null!=n&&rs(t,["config"],function(e,t){const n=is(e,["pageSize"]);void 0!==t&&null!=n&&rs(t,["_query","pageSize"],n);const a=is(e,["pageToken"]);return void 0!==t&&null!=a&&rs(t,["_query","pageToken"],a),{}}(n,t)),t}function Cl(e){const t={},n=is(e,["name"]);null!=n&&rs(t,["name"],n);const a=is(e,["displayName"]);null!=a&&rs(t,["displayName"],a);const s=is(e,["model"]);null!=s&&rs(t,["model"],s);const r=is(e,["createTime"]);null!=r&&rs(t,["createTime"],r);const i=is(e,["updateTime"]);null!=i&&rs(t,["updateTime"],i);const l=is(e,["expireTime"]);null!=l&&rs(t,["expireTime"],l);const o=is(e,["usageMetadata"]);return null!=o&&rs(t,["usageMetadata"],o),t}function _l(e){const t={},n=is(e,["name"]);null!=n&&rs(t,["name"],n);const a=is(e,["displayName"]);null!=a&&rs(t,["displayName"],a);const s=is(e,["model"]);null!=s&&rs(t,["model"],s);const r=is(e,["createTime"]);null!=r&&rs(t,["createTime"],r);const i=is(e,["updateTime"]);null!=i&&rs(t,["updateTime"],i);const l=is(e,["expireTime"]);null!=l&&rs(t,["expireTime"],l);const o=is(e,["usageMetadata"]);return null!=o&&rs(t,["usageMetadata"],o),t}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
class Tl extends as{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new al(tl.PAGED_ITEM_CACHED_CONTENTS,e=>this.listInternal(e),await this.listInternal(e),e)}async create(e){var t,n,a,s;let r,i="",l={};if(this.apiClient.isVertexAI()){const a=kl(this.apiClient,e);return i=ss("cachedContents",a._url),l=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>_l(e))}{const t=ml(this.apiClient,e);return i=ss("cachedContents",t._url),l=t._query,delete t.config,delete t._url,delete t._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(a=e.config)||void 0===a?void 0:a.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json()),r.then(e=>Cl(e))}}async get(e){var t,n,a,s;let r,i="",l={};if(this.apiClient.isVertexAI()){const a=function(e,t){const n={},a=is(t,["name"]);null!=a&&rs(n,["_url","name"],bi(e,a));const s=is(t,["config"]);return null!=s&&rs(n,["config"],s),n}(this.apiClient,e);return i=ss("{name}",a._url),l=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>_l(e))}{const t=function(e,t){const n={},a=is(t,["name"]);null!=a&&rs(n,["_url","name"],bi(e,a));const s=is(t,["config"]);return null!=s&&rs(n,["config"],s),n}(this.apiClient,e);return i=ss("{name}",t._url),l=t._query,delete t.config,delete t._url,delete t._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(a=e.config)||void 0===a?void 0:a.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json()),r.then(e=>Cl(e))}}async delete(e){var t,n,a,s;let r,i="",l={};if(this.apiClient.isVertexAI()){const a=function(e,t){const n={},a=is(t,["name"]);null!=a&&rs(n,["_url","name"],bi(e,a));const s=is(t,["config"]);return null!=s&&rs(n,["config"],s),n}(this.apiClient,e);return i=ss("{name}",a._url),l=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(()=>{const e={},t=new zr;return Object.assign(t,e),t})}{const t=function(e,t){const n={},a=is(t,["name"]);null!=a&&rs(n,["_url","name"],bi(e,a));const s=is(t,["config"]);return null!=s&&rs(n,["config"],s),n}(this.apiClient,e);return i=ss("{name}",t._url),l=t._query,delete t.config,delete t._url,delete t._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(a=e.config)||void 0===a?void 0:a.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json()),r.then(()=>{const e={},t=new zr;return Object.assign(t,e),t})}}async update(e){var t,n,a,s;let r,i="",l={};if(this.apiClient.isVertexAI()){const a=El(this.apiClient,e);return i=ss("{name}",a._url),l=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"PATCH",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>_l(e))}{const t=pl(this.apiClient,e);return i=ss("{name}",t._url),l=t._query,delete t.config,delete t._url,delete t._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(t),httpMethod:"PATCH",httpOptions:null===(a=e.config)||void 0===a?void 0:a.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json()),r.then(e=>Cl(e))}}async listInternal(e){var t,n,a,s;let r,i="",l={};if(this.apiClient.isVertexAI()){const a=jl(e);return i=ss("cachedContents",a._url),l=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>{const t=function(e){const t={},n=is(e,["nextPageToken"]);null!=n&&rs(t,["nextPageToken"],n);const a=is(e,["cachedContents"]);if(null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>_l(e))),rs(t,["cachedContents"],e)}return t}(e),n=new Wr;return Object.assign(n,t),n})}{const t=fl(e);return i=ss("cachedContents",t._url),l=t._query,delete t.config,delete t._url,delete t._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(a=e.config)||void 0===a?void 0:a.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json()),r.then(e=>{const t=function(e){const t={},n=is(e,["nextPageToken"]);null!=n&&rs(t,["nextPageToken"],n);const a=is(e,["cachedContents"]);if(null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>Cl(e))),rs(t,["cachedContents"],e)}return t}(e),n=new Wr;return Object.assign(n,t),n})}}}function Sl(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],a=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Al(e){return this instanceof Al?(this.v=e,this):new Al(e)}function Il(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a,s=n.apply(e,t||[]),r=[];return a=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),i("next"),i("throw"),i("return",function(e){return function(t){return Promise.resolve(t).then(e,c)}}),a[Symbol.asyncIterator]=function(){return this},a;function i(e,t){s[e]&&(a[e]=function(t){return new Promise(function(n,a){r.push([e,t,n,a])>1||l(e,t)})},t&&(a[e]=t(a[e])))}function l(e,t){try{(n=s[e](t)).value instanceof Al?Promise.resolve(n.value.v).then(o,c):d(r[0][2],n)}catch(a){d(r[0][3],a)}var n}function o(e){l("next",e)}function c(e){l("throw",e)}function d(e,t){e(t),r.shift(),r.length&&l(r[0][0],r[0][1])}}function Dl(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=Sl(e),t={},a("next"),a("throw"),a("return"),t[Symbol.asyncIterator]=function(){return this},t);function a(n){t[n]=e[n]&&function(t){return new Promise(function(a,s){(function(e,t,n,a){Promise.resolve(a).then(function(t){e({value:t,done:n})},t)})(a,s,(t=e[n](t)).done,t.value)})}}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
function Ol(e){var t;if(null==e.candidates||0===e.candidates.length)return!1;const n=null===(t=e.candidates[0])||void 0===t?void 0:t.content;return void 0!==n&&Rl(n)}function Rl(e){if(void 0===e.parts||0===e.parts.length)return!1;for(const t of e.parts){if(void 0===t||0===Object.keys(t).length)return!1;if(!t.thought&&void 0!==t.text&&""===t.text)return!1}return!0}function Pl(e){if(void 0===e||0===e.length)return[];const t=[],n=e.length;let a=0;for(;a<n;)if("user"===e[a].role)t.push(e[a]),a++;else{const s=[];let r=!0;for(;a<n&&"model"===e[a].role;)s.push(e[a]),r&&!Rl(e[a])&&(r=!1),a++;r?t.push(...s):t.pop()}return t}"function"==typeof SuppressedError&&SuppressedError;class Ml{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new Ul(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class Ul{constructor(e,t,n,a={},s=[]){this.apiClient=e,this.modelsModule=t,this.model=n,this.config=a,this.history=s,this.sendPromise=Promise.resolve(),function(e){if(0!==e.length)for(const t of e)if("user"!==t.role&&"model"!==t.role)throw new Error(`Role must be user or model, but got ${t.role}.`)}(s)}async sendMessage(e){var t;await this.sendPromise;const n=li(e.message),a=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:null!==(t=e.config)&&void 0!==t?t:this.config});return this.sendPromise=(async()=>{var e,t,s;const r=await a,i=null===(t=null===(e=r.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content,l=r.automaticFunctionCallingHistory,o=this.getHistory(!0).length;let c=[];null!=l&&(c=null!==(s=l.slice(o))&&void 0!==s?s:[]);const d=i?[i]:[];this.recordHistory(n,d,c)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),a}async sendMessageStream(e){var t;await this.sendPromise;const n=li(e.message),a=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:null!==(t=e.config)&&void 0!==t?t:this.config});this.sendPromise=a.then(()=>{}).catch(()=>{});const s=await a;return this.processStreamResponse(s,n)}getHistory(e=!1){const t=e?Pl(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var n,a;return Il(this,arguments,function*(){var s,r,i,l;const o=[];try{for(var c,d=!0,u=Dl(e);!(s=(c=yield Al(u.next())).done);d=!0){l=c.value,d=!1;const e=l;if(Ol(e)){const t=null===(a=null===(n=e.candidates)||void 0===n?void 0:n[0])||void 0===a?void 0:a.content;void 0!==t&&o.push(t)}yield yield Al(e)}}catch(m){r={error:m}}finally{try{d||s||!(i=u.return)||(yield Al(i.call(u)))}finally{if(r)throw r.error}}this.recordHistory(t,o)})}recordHistory(e,t,n){let a=[];t.length>0&&t.every(e=>void 0!==e.role)?a=t:a.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...Pl(n)):this.history.push(e),this.history.push(...a)}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ll extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Ll.prototype)}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Fl(e){const t={},n=is(e,["config"]);return null!=n&&rs(t,["config"],function(e,t){const n=is(e,["pageSize"]);void 0!==t&&null!=n&&rs(t,["_query","pageSize"],n);const a=is(e,["pageToken"]);return void 0!==t&&null!=a&&rs(t,["_query","pageToken"],a),{}}(n,t)),t}function Bl(e){const t={},n=is(e,["name"]);null!=n&&rs(t,["name"],n);const a=is(e,["displayName"]);null!=a&&rs(t,["displayName"],a);const s=is(e,["mimeType"]);null!=s&&rs(t,["mimeType"],s);const r=is(e,["sizeBytes"]);null!=r&&rs(t,["sizeBytes"],r);const i=is(e,["createTime"]);null!=i&&rs(t,["createTime"],i);const l=is(e,["expirationTime"]);null!=l&&rs(t,["expirationTime"],l);const o=is(e,["updateTime"]);null!=o&&rs(t,["updateTime"],o);const c=is(e,["sha256Hash"]);null!=c&&rs(t,["sha256Hash"],c);const d=is(e,["uri"]);null!=d&&rs(t,["uri"],d);const u=is(e,["downloadUri"]);null!=u&&rs(t,["downloadUri"],u);const m=is(e,["state"]);null!=m&&rs(t,["state"],m);const p=is(e,["source"]);null!=p&&rs(t,["source"],p);const f=is(e,["videoMetadata"]);null!=f&&rs(t,["videoMetadata"],f);const h=is(e,["error"]);return null!=h&&rs(t,["error"],function(e){const t={},n=is(e,["details"]);null!=n&&rs(t,["details"],n);const a=is(e,["message"]);null!=a&&rs(t,["message"],a);const s=is(e,["code"]);return null!=s&&rs(t,["code"],s),t}(h)),t}function $l(e){const t={},n=is(e,["name"]);null!=n&&rs(t,["name"],n);const a=is(e,["displayName"]);null!=a&&rs(t,["displayName"],a);const s=is(e,["mimeType"]);null!=s&&rs(t,["mimeType"],s);const r=is(e,["sizeBytes"]);null!=r&&rs(t,["sizeBytes"],r);const i=is(e,["createTime"]);null!=i&&rs(t,["createTime"],i);const l=is(e,["expirationTime"]);null!=l&&rs(t,["expirationTime"],l);const o=is(e,["updateTime"]);null!=o&&rs(t,["updateTime"],o);const c=is(e,["sha256Hash"]);null!=c&&rs(t,["sha256Hash"],c);const d=is(e,["uri"]);null!=d&&rs(t,["uri"],d);const u=is(e,["downloadUri"]);null!=u&&rs(t,["downloadUri"],u);const m=is(e,["state"]);null!=m&&rs(t,["state"],m);const p=is(e,["source"]);null!=p&&rs(t,["source"],p);const f=is(e,["videoMetadata"]);null!=f&&rs(t,["videoMetadata"],f);const h=is(e,["error"]);return null!=h&&rs(t,["error"],function(e){const t={},n=is(e,["details"]);null!=n&&rs(t,["details"],n);const a=is(e,["message"]);null!=a&&rs(t,["message"],a);const s=is(e,["code"]);return null!=s&&rs(t,["code"],s),t}(h)),t}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
class Gl extends as{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new al(tl.PAGED_ITEM_FILES,e=>this.listInternal(e),await this.listInternal(e),e)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(e=>$l(e))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,n;let a,s="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const i=Fl(e);return s=ss("files",i._url),r=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),a.then(e=>{const t=function(e){const t={},n=is(e,["nextPageToken"]);null!=n&&rs(t,["nextPageToken"],n);const a=is(e,["files"]);if(null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>$l(e))),rs(t,["files"],e)}return t}(e),n=new qr;return Object.assign(n,t),n})}}async createInternal(e){var t,n;let a,s="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const i=function(e){const t={},n=is(e,["file"]);null!=n&&rs(t,["file"],Bl(n));const a=is(e,["config"]);return null!=a&&rs(t,["config"],a),t}(e);return s=ss("upload/v1beta/files",i._url),r=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),a.then(()=>{const e={},t=new Hr;return Object.assign(t,e),t})}}async get(e){var t,n;let a,s="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const i=function(e){const t={},n=is(e,["name"]);null!=n&&rs(t,["_url","file"],wi(n));const a=is(e,["config"]);return null!=a&&rs(t,["config"],a),t}(e);return s=ss("files/{file}",i._url),r=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),a.then(e=>$l(e))}}async delete(e){var t,n;let a,s="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const i=function(e){const t={},n=is(e,["name"]);null!=n&&rs(t,["_url","file"],wi(n));const a=is(e,["config"]);return null!=a&&rs(t,["config"],a),t}(e);return s=ss("files/{file}",i._url),r=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(i),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),a.then(()=>{const e={},t=new Kr;return Object.assign(t,e),t})}}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Vl(e){const t={},n=is(e,["prebuiltVoiceConfig"]);return null!=n&&rs(t,["prebuiltVoiceConfig"],function(e){const t={},n=is(e,["voiceName"]);return null!=n&&rs(t,["voiceName"],n),t}(n)),t}function zl(e){const t={},n=is(e,["prebuiltVoiceConfig"]);return null!=n&&rs(t,["prebuiltVoiceConfig"],function(e){const t={},n=is(e,["voiceName"]);return null!=n&&rs(t,["voiceName"],n),t}(n)),t}function Wl(e){const t={},n=is(e,["speakerVoiceConfigs"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=is(e,["speaker"]);null!=n&&rs(t,["speaker"],n);const a=is(e,["voiceConfig"]);return null!=a&&rs(t,["voiceConfig"],Vl(a)),t}(e))),rs(t,["speakerVoiceConfigs"],e)}return t}function ql(e){const t={},n=is(e,["videoMetadata"]);null!=n&&rs(t,["videoMetadata"],function(e){const t={},n=is(e,["fps"]);null!=n&&rs(t,["fps"],n);const a=is(e,["endOffset"]);null!=a&&rs(t,["endOffset"],a);const s=is(e,["startOffset"]);return null!=s&&rs(t,["startOffset"],s),t}(n));const a=is(e,["thought"]);null!=a&&rs(t,["thought"],a);const s=is(e,["inlineData"]);null!=s&&rs(t,["inlineData"],function(e){const t={};if(void 0!==is(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=is(e,["data"]);null!=n&&rs(t,["data"],n);const a=is(e,["mimeType"]);return null!=a&&rs(t,["mimeType"],a),t}(s));const r=is(e,["fileData"]);null!=r&&rs(t,["fileData"],function(e){const t={};if(void 0!==is(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=is(e,["fileUri"]);null!=n&&rs(t,["fileUri"],n);const a=is(e,["mimeType"]);return null!=a&&rs(t,["mimeType"],a),t}(r));const i=is(e,["thoughtSignature"]);null!=i&&rs(t,["thoughtSignature"],i);const l=is(e,["codeExecutionResult"]);null!=l&&rs(t,["codeExecutionResult"],l);const o=is(e,["executableCode"]);null!=o&&rs(t,["executableCode"],o);const c=is(e,["functionCall"]);null!=c&&rs(t,["functionCall"],c);const d=is(e,["functionResponse"]);null!=d&&rs(t,["functionResponse"],d);const u=is(e,["text"]);return null!=u&&rs(t,["text"],u),t}function Hl(e){const t={},n=is(e,["videoMetadata"]);null!=n&&rs(t,["videoMetadata"],function(e){const t={},n=is(e,["fps"]);null!=n&&rs(t,["fps"],n);const a=is(e,["endOffset"]);null!=a&&rs(t,["endOffset"],a);const s=is(e,["startOffset"]);return null!=s&&rs(t,["startOffset"],s),t}(n));const a=is(e,["thought"]);null!=a&&rs(t,["thought"],a);const s=is(e,["inlineData"]);null!=s&&rs(t,["inlineData"],function(e){const t={},n=is(e,["displayName"]);null!=n&&rs(t,["displayName"],n);const a=is(e,["data"]);null!=a&&rs(t,["data"],a);const s=is(e,["mimeType"]);return null!=s&&rs(t,["mimeType"],s),t}(s));const r=is(e,["fileData"]);null!=r&&rs(t,["fileData"],function(e){const t={},n=is(e,["displayName"]);null!=n&&rs(t,["displayName"],n);const a=is(e,["fileUri"]);null!=a&&rs(t,["fileUri"],a);const s=is(e,["mimeType"]);return null!=s&&rs(t,["mimeType"],s),t}(r));const i=is(e,["thoughtSignature"]);null!=i&&rs(t,["thoughtSignature"],i);const l=is(e,["codeExecutionResult"]);null!=l&&rs(t,["codeExecutionResult"],l);const o=is(e,["executableCode"]);null!=o&&rs(t,["executableCode"],o);const c=is(e,["functionCall"]);null!=c&&rs(t,["functionCall"],c);const d=is(e,["functionResponse"]);null!=d&&rs(t,["functionResponse"],d);const u=is(e,["text"]);return null!=u&&rs(t,["text"],u),t}function Kl(e){const t={},n=is(e,["timeRangeFilter"]);return null!=n&&rs(t,["timeRangeFilter"],function(e){const t={},n=is(e,["startTime"]);null!=n&&rs(t,["startTime"],n);const a=is(e,["endTime"]);return null!=a&&rs(t,["endTime"],a),t}(n)),t}function Yl(e){const t={},n=is(e,["timeRangeFilter"]);return null!=n&&rs(t,["timeRangeFilter"],function(e){const t={},n=is(e,["startTime"]);null!=n&&rs(t,["startTime"],n);const a=is(e,["endTime"]);return null!=a&&rs(t,["endTime"],a),t}(n)),t}function Jl(e){const t={},n=is(e,["dynamicRetrievalConfig"]);return null!=n&&rs(t,["dynamicRetrievalConfig"],function(e){const t={},n=is(e,["mode"]);null!=n&&rs(t,["mode"],n);const a=is(e,["dynamicThreshold"]);return null!=a&&rs(t,["dynamicThreshold"],a),t}(n)),t}function Zl(e){const t={},n=is(e,["dynamicRetrievalConfig"]);return null!=n&&rs(t,["dynamicRetrievalConfig"],function(e){const t={},n=is(e,["mode"]);null!=n&&rs(t,["mode"],n);const a=is(e,["dynamicThreshold"]);return null!=a&&rs(t,["dynamicThreshold"],a),t}(n)),t}function Ql(e){const t={},n=is(e,["apiKeyConfig"]);null!=n&&rs(t,["apiKeyConfig"],function(e){const t={},n=is(e,["apiKeyString"]);return null!=n&&rs(t,["apiKeyString"],n),t}(n));const a=is(e,["authType"]);null!=a&&rs(t,["authType"],a);const s=is(e,["googleServiceAccountConfig"]);null!=s&&rs(t,["googleServiceAccountConfig"],s);const r=is(e,["httpBasicAuthConfig"]);null!=r&&rs(t,["httpBasicAuthConfig"],r);const i=is(e,["oauthConfig"]);null!=i&&rs(t,["oauthConfig"],i);const l=is(e,["oidcConfig"]);return null!=l&&rs(t,["oidcConfig"],l),t}function Xl(e){const t={},n=is(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=is(e,["behavior"]);null!=n&&rs(t,["behavior"],n);const a=is(e,["description"]);null!=a&&rs(t,["description"],a);const s=is(e,["name"]);null!=s&&rs(t,["name"],s);const r=is(e,["parameters"]);null!=r&&rs(t,["parameters"],r);const i=is(e,["parametersJsonSchema"]);null!=i&&rs(t,["parametersJsonSchema"],i);const l=is(e,["response"]);null!=l&&rs(t,["response"],l);const o=is(e,["responseJsonSchema"]);return null!=o&&rs(t,["responseJsonSchema"],o),t}(e))),rs(t,["functionDeclarations"],e)}if(void 0!==is(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const a=is(e,["googleSearch"]);null!=a&&rs(t,["googleSearch"],Kl(a));const s=is(e,["googleSearchRetrieval"]);if(null!=s&&rs(t,["googleSearchRetrieval"],Jl(s)),void 0!==is(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==is(e,["googleMaps"]))throw new Error("googleMaps parameter is not supported in Gemini API.");null!=is(e,["urlContext"])&&rs(t,["urlContext"],{});const r=is(e,["codeExecution"]);return null!=r&&rs(t,["codeExecution"],r),t}function eo(e){const t={},n=is(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={};if(void 0!==is(e,["behavior"]))throw new Error("behavior parameter is not supported in Vertex AI.");const n=is(e,["description"]);null!=n&&rs(t,["description"],n);const a=is(e,["name"]);null!=a&&rs(t,["name"],a);const s=is(e,["parameters"]);null!=s&&rs(t,["parameters"],s);const r=is(e,["parametersJsonSchema"]);null!=r&&rs(t,["parametersJsonSchema"],r);const i=is(e,["response"]);null!=i&&rs(t,["response"],i);const l=is(e,["responseJsonSchema"]);return null!=l&&rs(t,["responseJsonSchema"],l),t}(e))),rs(t,["functionDeclarations"],e)}const a=is(e,["retrieval"]);null!=a&&rs(t,["retrieval"],a);const s=is(e,["googleSearch"]);null!=s&&rs(t,["googleSearch"],Yl(s));const r=is(e,["googleSearchRetrieval"]);null!=r&&rs(t,["googleSearchRetrieval"],Zl(r));null!=is(e,["enterpriseWebSearch"])&&rs(t,["enterpriseWebSearch"],{});const i=is(e,["googleMaps"]);null!=i&&rs(t,["googleMaps"],function(e){const t={},n=is(e,["authConfig"]);return null!=n&&rs(t,["authConfig"],Ql(n)),t}(i));null!=is(e,["urlContext"])&&rs(t,["urlContext"],{});const l=is(e,["codeExecution"]);return null!=l&&rs(t,["codeExecution"],l),t}function to(e){const t={},n=is(e,["automaticActivityDetection"]);null!=n&&rs(t,["automaticActivityDetection"],function(e){const t={},n=is(e,["disabled"]);null!=n&&rs(t,["disabled"],n);const a=is(e,["startOfSpeechSensitivity"]);null!=a&&rs(t,["startOfSpeechSensitivity"],a);const s=is(e,["endOfSpeechSensitivity"]);null!=s&&rs(t,["endOfSpeechSensitivity"],s);const r=is(e,["prefixPaddingMs"]);null!=r&&rs(t,["prefixPaddingMs"],r);const i=is(e,["silenceDurationMs"]);return null!=i&&rs(t,["silenceDurationMs"],i),t}(n));const a=is(e,["activityHandling"]);null!=a&&rs(t,["activityHandling"],a);const s=is(e,["turnCoverage"]);return null!=s&&rs(t,["turnCoverage"],s),t}function no(e){const t={},n=is(e,["automaticActivityDetection"]);null!=n&&rs(t,["automaticActivityDetection"],function(e){const t={},n=is(e,["disabled"]);null!=n&&rs(t,["disabled"],n);const a=is(e,["startOfSpeechSensitivity"]);null!=a&&rs(t,["startOfSpeechSensitivity"],a);const s=is(e,["endOfSpeechSensitivity"]);null!=s&&rs(t,["endOfSpeechSensitivity"],s);const r=is(e,["prefixPaddingMs"]);null!=r&&rs(t,["prefixPaddingMs"],r);const i=is(e,["silenceDurationMs"]);return null!=i&&rs(t,["silenceDurationMs"],i),t}(n));const a=is(e,["activityHandling"]);null!=a&&rs(t,["activityHandling"],a);const s=is(e,["turnCoverage"]);return null!=s&&rs(t,["turnCoverage"],s),t}function ao(e){const t={},n=is(e,["triggerTokens"]);null!=n&&rs(t,["triggerTokens"],n);const a=is(e,["slidingWindow"]);return null!=a&&rs(t,["slidingWindow"],function(e){const t={},n=is(e,["targetTokens"]);return null!=n&&rs(t,["targetTokens"],n),t}(a)),t}function so(e){const t={},n=is(e,["triggerTokens"]);null!=n&&rs(t,["triggerTokens"],n);const a=is(e,["slidingWindow"]);return null!=a&&rs(t,["slidingWindow"],function(e){const t={},n=is(e,["targetTokens"]);return null!=n&&rs(t,["targetTokens"],n),t}(a)),t}function ro(e,t){const n=is(e,["generationConfig"]);void 0!==t&&null!=n&&rs(t,["setup","generationConfig"],n);const a=is(e,["responseModalities"]);void 0!==t&&null!=a&&rs(t,["setup","generationConfig","responseModalities"],a);const s=is(e,["temperature"]);void 0!==t&&null!=s&&rs(t,["setup","generationConfig","temperature"],s);const r=is(e,["topP"]);void 0!==t&&null!=r&&rs(t,["setup","generationConfig","topP"],r);const i=is(e,["topK"]);void 0!==t&&null!=i&&rs(t,["setup","generationConfig","topK"],i);const l=is(e,["maxOutputTokens"]);void 0!==t&&null!=l&&rs(t,["setup","generationConfig","maxOutputTokens"],l);const o=is(e,["mediaResolution"]);void 0!==t&&null!=o&&rs(t,["setup","generationConfig","mediaResolution"],o);const c=is(e,["seed"]);void 0!==t&&null!=c&&rs(t,["setup","generationConfig","seed"],c);const d=is(e,["speechConfig"]);void 0!==t&&null!=d&&rs(t,["setup","generationConfig","speechConfig"],function(e){const t={},n=is(e,["voiceConfig"]);null!=n&&rs(t,["voiceConfig"],Vl(n));const a=is(e,["multiSpeakerVoiceConfig"]);null!=a&&rs(t,["multiSpeakerVoiceConfig"],Wl(a));const s=is(e,["languageCode"]);return null!=s&&rs(t,["languageCode"],s),t}(gi(d)));const u=is(e,["enableAffectiveDialog"]);void 0!==t&&null!=u&&rs(t,["setup","generationConfig","enableAffectiveDialog"],u);const m=is(e,["systemInstruction"]);void 0!==t&&null!=m&&rs(t,["setup","systemInstruction"],function(e){const t={},n=is(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>ql(e))),rs(t,["parts"],e)}const a=is(e,["role"]);return null!=a&&rs(t,["role"],a),t}(li(m)));const p=is(e,["tools"]);if(void 0!==t&&null!=p){let e=yi(p);Array.isArray(e)&&(e=e.map(e=>Xl(xi(e)))),rs(t,["setup","tools"],e)}const f=is(e,["sessionResumption"]);void 0!==t&&null!=f&&rs(t,["setup","sessionResumption"],function(e){const t={},n=is(e,["handle"]);if(null!=n&&rs(t,["handle"],n),void 0!==is(e,["transparent"]))throw new Error("transparent parameter is not supported in Gemini API.");return t}(f));const h=is(e,["inputAudioTranscription"]);void 0!==t&&null!=h&&rs(t,["setup","inputAudioTranscription"],{});const g=is(e,["outputAudioTranscription"]);void 0!==t&&null!=g&&rs(t,["setup","outputAudioTranscription"],{});const x=is(e,["realtimeInputConfig"]);void 0!==t&&null!=x&&rs(t,["setup","realtimeInputConfig"],to(x));const y=is(e,["contextWindowCompression"]);void 0!==t&&null!=y&&rs(t,["setup","contextWindowCompression"],ao(y));const b=is(e,["proactivity"]);return void 0!==t&&null!=b&&rs(t,["setup","proactivity"],function(e){const t={},n=is(e,["proactiveAudio"]);return null!=n&&rs(t,["proactiveAudio"],n),t}(b)),{}}function io(e,t){const n=is(e,["generationConfig"]);void 0!==t&&null!=n&&rs(t,["setup","generationConfig"],n);const a=is(e,["responseModalities"]);void 0!==t&&null!=a&&rs(t,["setup","generationConfig","responseModalities"],a);const s=is(e,["temperature"]);void 0!==t&&null!=s&&rs(t,["setup","generationConfig","temperature"],s);const r=is(e,["topP"]);void 0!==t&&null!=r&&rs(t,["setup","generationConfig","topP"],r);const i=is(e,["topK"]);void 0!==t&&null!=i&&rs(t,["setup","generationConfig","topK"],i);const l=is(e,["maxOutputTokens"]);void 0!==t&&null!=l&&rs(t,["setup","generationConfig","maxOutputTokens"],l);const o=is(e,["mediaResolution"]);void 0!==t&&null!=o&&rs(t,["setup","generationConfig","mediaResolution"],o);const c=is(e,["seed"]);void 0!==t&&null!=c&&rs(t,["setup","generationConfig","seed"],c);const d=is(e,["speechConfig"]);void 0!==t&&null!=d&&rs(t,["setup","generationConfig","speechConfig"],function(e){const t={},n=is(e,["voiceConfig"]);if(null!=n&&rs(t,["voiceConfig"],zl(n)),void 0!==is(e,["multiSpeakerVoiceConfig"]))throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const a=is(e,["languageCode"]);return null!=a&&rs(t,["languageCode"],a),t}(gi(d)));const u=is(e,["enableAffectiveDialog"]);void 0!==t&&null!=u&&rs(t,["setup","generationConfig","enableAffectiveDialog"],u);const m=is(e,["systemInstruction"]);void 0!==t&&null!=m&&rs(t,["setup","systemInstruction"],function(e){const t={},n=is(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>Hl(e))),rs(t,["parts"],e)}const a=is(e,["role"]);return null!=a&&rs(t,["role"],a),t}(li(m)));const p=is(e,["tools"]);if(void 0!==t&&null!=p){let e=yi(p);Array.isArray(e)&&(e=e.map(e=>eo(xi(e)))),rs(t,["setup","tools"],e)}const f=is(e,["sessionResumption"]);void 0!==t&&null!=f&&rs(t,["setup","sessionResumption"],function(e){const t={},n=is(e,["handle"]);null!=n&&rs(t,["handle"],n);const a=is(e,["transparent"]);return null!=a&&rs(t,["transparent"],a),t}(f));const h=is(e,["inputAudioTranscription"]);void 0!==t&&null!=h&&rs(t,["setup","inputAudioTranscription"],{});const g=is(e,["outputAudioTranscription"]);void 0!==t&&null!=g&&rs(t,["setup","outputAudioTranscription"],{});const x=is(e,["realtimeInputConfig"]);void 0!==t&&null!=x&&rs(t,["setup","realtimeInputConfig"],no(x));const y=is(e,["contextWindowCompression"]);void 0!==t&&null!=y&&rs(t,["setup","contextWindowCompression"],so(y));const b=is(e,["proactivity"]);return void 0!==t&&null!=b&&rs(t,["setup","proactivity"],function(e){const t={},n=is(e,["proactiveAudio"]);return null!=n&&rs(t,["proactiveAudio"],n),t}(b)),{}}function lo(e){const t={},n=is(e,["media"]);null!=n&&rs(t,["mediaChunks"],ei(n));const a=is(e,["audio"]);null!=a&&rs(t,["audio"],function(e){const t=ti(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}(a));const s=is(e,["audioStreamEnd"]);null!=s&&rs(t,["audioStreamEnd"],s);const r=is(e,["video"]);null!=r&&rs(t,["video"],function(e){const t=ti(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}(r));const i=is(e,["text"]);null!=i&&rs(t,["text"],i);null!=is(e,["activityStart"])&&rs(t,["activityStart"],{});return null!=is(e,["activityEnd"])&&rs(t,["activityEnd"],{}),t}function oo(e){const t={},n=is(e,["media"]);if(null!=n&&rs(t,["mediaChunks"],ei(n)),void 0!==is(e,["audio"]))throw new Error("audio parameter is not supported in Vertex AI.");const a=is(e,["audioStreamEnd"]);if(null!=a&&rs(t,["audioStreamEnd"],a),void 0!==is(e,["video"]))throw new Error("video parameter is not supported in Vertex AI.");if(void 0!==is(e,["text"]))throw new Error("text parameter is not supported in Vertex AI.");null!=is(e,["activityStart"])&&rs(t,["activityStart"],{});return null!=is(e,["activityEnd"])&&rs(t,["activityEnd"],{}),t}function co(e){const t={},n=is(e,["text"]);null!=n&&rs(t,["text"],n);const a=is(e,["weight"]);return null!=a&&rs(t,["weight"],a),t}function uo(e){const t={},n=is(e,["temperature"]);null!=n&&rs(t,["temperature"],n);const a=is(e,["topK"]);null!=a&&rs(t,["topK"],a);const s=is(e,["seed"]);null!=s&&rs(t,["seed"],s);const r=is(e,["guidance"]);null!=r&&rs(t,["guidance"],r);const i=is(e,["bpm"]);null!=i&&rs(t,["bpm"],i);const l=is(e,["density"]);null!=l&&rs(t,["density"],l);const o=is(e,["brightness"]);null!=o&&rs(t,["brightness"],o);const c=is(e,["scale"]);null!=c&&rs(t,["scale"],c);const d=is(e,["muteBass"]);null!=d&&rs(t,["muteBass"],d);const u=is(e,["muteDrums"]);null!=u&&rs(t,["muteDrums"],u);const m=is(e,["onlyBassAndDrums"]);return null!=m&&rs(t,["onlyBassAndDrums"],m),t}function mo(e){const t={},n=is(e,["model"]);return null!=n&&rs(t,["model"],n),t}function po(e){const t={},n=is(e,["weightedPrompts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>co(e))),rs(t,["weightedPrompts"],e)}return t}function fo(e){const t={},n=is(e,["setup"]);null!=n&&rs(t,["setup"],mo(n));const a=is(e,["clientContent"]);null!=a&&rs(t,["clientContent"],po(a));const s=is(e,["musicGenerationConfig"]);null!=s&&rs(t,["musicGenerationConfig"],uo(s));const r=is(e,["playbackControl"]);return null!=r&&rs(t,["playbackControl"],r),t}function ho(e){const t={},n=is(e,["videoMetadata"]);null!=n&&rs(t,["videoMetadata"],function(e){const t={},n=is(e,["fps"]);null!=n&&rs(t,["fps"],n);const a=is(e,["endOffset"]);null!=a&&rs(t,["endOffset"],a);const s=is(e,["startOffset"]);return null!=s&&rs(t,["startOffset"],s),t}(n));const a=is(e,["thought"]);null!=a&&rs(t,["thought"],a);const s=is(e,["inlineData"]);null!=s&&rs(t,["inlineData"],function(e){const t={},n=is(e,["data"]);null!=n&&rs(t,["data"],n);const a=is(e,["mimeType"]);return null!=a&&rs(t,["mimeType"],a),t}(s));const r=is(e,["fileData"]);null!=r&&rs(t,["fileData"],function(e){const t={},n=is(e,["fileUri"]);null!=n&&rs(t,["fileUri"],n);const a=is(e,["mimeType"]);return null!=a&&rs(t,["mimeType"],a),t}(r));const i=is(e,["thoughtSignature"]);null!=i&&rs(t,["thoughtSignature"],i);const l=is(e,["codeExecutionResult"]);null!=l&&rs(t,["codeExecutionResult"],l);const o=is(e,["executableCode"]);null!=o&&rs(t,["executableCode"],o);const c=is(e,["functionCall"]);null!=c&&rs(t,["functionCall"],c);const d=is(e,["functionResponse"]);null!=d&&rs(t,["functionResponse"],d);const u=is(e,["text"]);return null!=u&&rs(t,["text"],u),t}function go(e){const t={},n=is(e,["videoMetadata"]);null!=n&&rs(t,["videoMetadata"],function(e){const t={},n=is(e,["fps"]);null!=n&&rs(t,["fps"],n);const a=is(e,["endOffset"]);null!=a&&rs(t,["endOffset"],a);const s=is(e,["startOffset"]);return null!=s&&rs(t,["startOffset"],s),t}(n));const a=is(e,["thought"]);null!=a&&rs(t,["thought"],a);const s=is(e,["inlineData"]);null!=s&&rs(t,["inlineData"],function(e){const t={},n=is(e,["displayName"]);null!=n&&rs(t,["displayName"],n);const a=is(e,["data"]);null!=a&&rs(t,["data"],a);const s=is(e,["mimeType"]);return null!=s&&rs(t,["mimeType"],s),t}(s));const r=is(e,["fileData"]);null!=r&&rs(t,["fileData"],function(e){const t={},n=is(e,["displayName"]);null!=n&&rs(t,["displayName"],n);const a=is(e,["fileUri"]);null!=a&&rs(t,["fileUri"],a);const s=is(e,["mimeType"]);return null!=s&&rs(t,["mimeType"],s),t}(r));const i=is(e,["thoughtSignature"]);null!=i&&rs(t,["thoughtSignature"],i);const l=is(e,["codeExecutionResult"]);null!=l&&rs(t,["codeExecutionResult"],l);const o=is(e,["executableCode"]);null!=o&&rs(t,["executableCode"],o);const c=is(e,["functionCall"]);null!=c&&rs(t,["functionCall"],c);const d=is(e,["functionResponse"]);null!=d&&rs(t,["functionResponse"],d);const u=is(e,["text"]);return null!=u&&rs(t,["text"],u),t}function xo(e){const t={},n=is(e,["text"]);null!=n&&rs(t,["text"],n);const a=is(e,["finished"]);return null!=a&&rs(t,["finished"],a),t}function yo(e){const t={},n=is(e,["text"]);null!=n&&rs(t,["text"],n);const a=is(e,["finished"]);return null!=a&&rs(t,["finished"],a),t}function bo(e){const t={},n=is(e,["urlMetadata"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=is(e,["retrievedUrl"]);null!=n&&rs(t,["retrievedUrl"],n);const a=is(e,["urlRetrievalStatus"]);return null!=a&&rs(t,["urlRetrievalStatus"],a),t}(e))),rs(t,["urlMetadata"],e)}return t}function vo(e){const t={},n=is(e,["modelTurn"]);null!=n&&rs(t,["modelTurn"],function(e){const t={},n=is(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>ho(e))),rs(t,["parts"],e)}const a=is(e,["role"]);return null!=a&&rs(t,["role"],a),t}(n));const a=is(e,["turnComplete"]);null!=a&&rs(t,["turnComplete"],a);const s=is(e,["interrupted"]);null!=s&&rs(t,["interrupted"],s);const r=is(e,["groundingMetadata"]);null!=r&&rs(t,["groundingMetadata"],r);const i=is(e,["generationComplete"]);null!=i&&rs(t,["generationComplete"],i);const l=is(e,["inputTranscription"]);null!=l&&rs(t,["inputTranscription"],xo(l));const o=is(e,["outputTranscription"]);null!=o&&rs(t,["outputTranscription"],xo(o));const c=is(e,["urlContextMetadata"]);return null!=c&&rs(t,["urlContextMetadata"],bo(c)),t}function No(e){const t={},n=is(e,["modelTurn"]);null!=n&&rs(t,["modelTurn"],function(e){const t={},n=is(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>go(e))),rs(t,["parts"],e)}const a=is(e,["role"]);return null!=a&&rs(t,["role"],a),t}(n));const a=is(e,["turnComplete"]);null!=a&&rs(t,["turnComplete"],a);const s=is(e,["interrupted"]);null!=s&&rs(t,["interrupted"],s);const r=is(e,["groundingMetadata"]);null!=r&&rs(t,["groundingMetadata"],r);const i=is(e,["generationComplete"]);null!=i&&rs(t,["generationComplete"],i);const l=is(e,["inputTranscription"]);null!=l&&rs(t,["inputTranscription"],yo(l));const o=is(e,["outputTranscription"]);return null!=o&&rs(t,["outputTranscription"],yo(o)),t}function wo(e){const t={},n=is(e,["functionCalls"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=is(e,["id"]);null!=n&&rs(t,["id"],n);const a=is(e,["args"]);null!=a&&rs(t,["args"],a);const s=is(e,["name"]);return null!=s&&rs(t,["name"],s),t}(e))),rs(t,["functionCalls"],e)}return t}function ko(e){const t={},n=is(e,["functionCalls"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=is(e,["args"]);null!=n&&rs(t,["args"],n);const a=is(e,["name"]);return null!=a&&rs(t,["name"],a),t}(e))),rs(t,["functionCalls"],e)}return t}function Eo(e){const t={},n=is(e,["modality"]);null!=n&&rs(t,["modality"],n);const a=is(e,["tokenCount"]);return null!=a&&rs(t,["tokenCount"],a),t}function jo(e){const t={},n=is(e,["modality"]);null!=n&&rs(t,["modality"],n);const a=is(e,["tokenCount"]);return null!=a&&rs(t,["tokenCount"],a),t}function Co(e){const t={};null!=is(e,["setupComplete"])&&rs(t,["setupComplete"],{});const n=is(e,["serverContent"]);null!=n&&rs(t,["serverContent"],vo(n));const a=is(e,["toolCall"]);null!=a&&rs(t,["toolCall"],wo(a));const s=is(e,["toolCallCancellation"]);null!=s&&rs(t,["toolCallCancellation"],function(e){const t={},n=is(e,["ids"]);return null!=n&&rs(t,["ids"],n),t}(s));const r=is(e,["usageMetadata"]);null!=r&&rs(t,["usageMetadata"],function(e){const t={},n=is(e,["promptTokenCount"]);null!=n&&rs(t,["promptTokenCount"],n);const a=is(e,["cachedContentTokenCount"]);null!=a&&rs(t,["cachedContentTokenCount"],a);const s=is(e,["responseTokenCount"]);null!=s&&rs(t,["responseTokenCount"],s);const r=is(e,["toolUsePromptTokenCount"]);null!=r&&rs(t,["toolUsePromptTokenCount"],r);const i=is(e,["thoughtsTokenCount"]);null!=i&&rs(t,["thoughtsTokenCount"],i);const l=is(e,["totalTokenCount"]);null!=l&&rs(t,["totalTokenCount"],l);const o=is(e,["promptTokensDetails"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>Eo(e))),rs(t,["promptTokensDetails"],e)}const c=is(e,["cacheTokensDetails"]);if(null!=c){let e=c;Array.isArray(e)&&(e=e.map(e=>Eo(e))),rs(t,["cacheTokensDetails"],e)}const d=is(e,["responseTokensDetails"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>Eo(e))),rs(t,["responseTokensDetails"],e)}const u=is(e,["toolUsePromptTokensDetails"]);if(null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>Eo(e))),rs(t,["toolUsePromptTokensDetails"],e)}return t}(r));const i=is(e,["goAway"]);null!=i&&rs(t,["goAway"],function(e){const t={},n=is(e,["timeLeft"]);return null!=n&&rs(t,["timeLeft"],n),t}(i));const l=is(e,["sessionResumptionUpdate"]);return null!=l&&rs(t,["sessionResumptionUpdate"],function(e){const t={},n=is(e,["newHandle"]);null!=n&&rs(t,["newHandle"],n);const a=is(e,["resumable"]);null!=a&&rs(t,["resumable"],a);const s=is(e,["lastConsumedClientMessageIndex"]);return null!=s&&rs(t,["lastConsumedClientMessageIndex"],s),t}(l)),t}function _o(e){const t={};null!=is(e,["setupComplete"])&&rs(t,["setupComplete"],{});const n=is(e,["serverContent"]);null!=n&&rs(t,["serverContent"],No(n));const a=is(e,["toolCall"]);null!=a&&rs(t,["toolCall"],ko(a));const s=is(e,["toolCallCancellation"]);null!=s&&rs(t,["toolCallCancellation"],function(e){const t={},n=is(e,["ids"]);return null!=n&&rs(t,["ids"],n),t}(s));const r=is(e,["usageMetadata"]);null!=r&&rs(t,["usageMetadata"],function(e){const t={},n=is(e,["promptTokenCount"]);null!=n&&rs(t,["promptTokenCount"],n);const a=is(e,["cachedContentTokenCount"]);null!=a&&rs(t,["cachedContentTokenCount"],a);const s=is(e,["candidatesTokenCount"]);null!=s&&rs(t,["responseTokenCount"],s);const r=is(e,["toolUsePromptTokenCount"]);null!=r&&rs(t,["toolUsePromptTokenCount"],r);const i=is(e,["thoughtsTokenCount"]);null!=i&&rs(t,["thoughtsTokenCount"],i);const l=is(e,["totalTokenCount"]);null!=l&&rs(t,["totalTokenCount"],l);const o=is(e,["promptTokensDetails"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>jo(e))),rs(t,["promptTokensDetails"],e)}const c=is(e,["cacheTokensDetails"]);if(null!=c){let e=c;Array.isArray(e)&&(e=e.map(e=>jo(e))),rs(t,["cacheTokensDetails"],e)}const d=is(e,["candidatesTokensDetails"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>jo(e))),rs(t,["responseTokensDetails"],e)}const u=is(e,["toolUsePromptTokensDetails"]);if(null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>jo(e))),rs(t,["toolUsePromptTokensDetails"],e)}const m=is(e,["trafficType"]);return null!=m&&rs(t,["trafficType"],m),t}(r));const i=is(e,["goAway"]);null!=i&&rs(t,["goAway"],function(e){const t={},n=is(e,["timeLeft"]);return null!=n&&rs(t,["timeLeft"],n),t}(i));const l=is(e,["sessionResumptionUpdate"]);return null!=l&&rs(t,["sessionResumptionUpdate"],function(e){const t={},n=is(e,["newHandle"]);null!=n&&rs(t,["newHandle"],n);const a=is(e,["resumable"]);null!=a&&rs(t,["resumable"],a);const s=is(e,["lastConsumedClientMessageIndex"]);return null!=s&&rs(t,["lastConsumedClientMessageIndex"],s),t}(l)),t}function To(e){const t={},n=is(e,["weightedPrompts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=is(e,["text"]);null!=n&&rs(t,["text"],n);const a=is(e,["weight"]);return null!=a&&rs(t,["weight"],a),t}(e))),rs(t,["weightedPrompts"],e)}return t}function So(e){const t={},n=is(e,["clientContent"]);null!=n&&rs(t,["clientContent"],To(n));const a=is(e,["musicGenerationConfig"]);return null!=a&&rs(t,["musicGenerationConfig"],function(e){const t={},n=is(e,["temperature"]);null!=n&&rs(t,["temperature"],n);const a=is(e,["topK"]);null!=a&&rs(t,["topK"],a);const s=is(e,["seed"]);null!=s&&rs(t,["seed"],s);const r=is(e,["guidance"]);null!=r&&rs(t,["guidance"],r);const i=is(e,["bpm"]);null!=i&&rs(t,["bpm"],i);const l=is(e,["density"]);null!=l&&rs(t,["density"],l);const o=is(e,["brightness"]);null!=o&&rs(t,["brightness"],o);const c=is(e,["scale"]);null!=c&&rs(t,["scale"],c);const d=is(e,["muteBass"]);null!=d&&rs(t,["muteBass"],d);const u=is(e,["muteDrums"]);null!=u&&rs(t,["muteDrums"],u);const m=is(e,["onlyBassAndDrums"]);return null!=m&&rs(t,["onlyBassAndDrums"],m),t}(a)),t}function Ao(e){const t={},n=is(e,["audioChunks"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=is(e,["data"]);null!=n&&rs(t,["data"],n);const a=is(e,["mimeType"]);null!=a&&rs(t,["mimeType"],a);const s=is(e,["sourceMetadata"]);return null!=s&&rs(t,["sourceMetadata"],So(s)),t}(e))),rs(t,["audioChunks"],e)}return t}function Io(e){const t={};null!=is(e,["setupComplete"])&&rs(t,["setupComplete"],{});const n=is(e,["serverContent"]);null!=n&&rs(t,["serverContent"],Ao(n));const a=is(e,["filteredPrompt"]);return null!=a&&rs(t,["filteredPrompt"],function(e){const t={},n=is(e,["text"]);null!=n&&rs(t,["text"],n);const a=is(e,["filteredReason"]);return null!=a&&rs(t,["filteredReason"],a),t}(a)),t}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Do(e){const t={},n=is(e,["videoMetadata"]);null!=n&&rs(t,["videoMetadata"],function(e){const t={},n=is(e,["fps"]);null!=n&&rs(t,["fps"],n);const a=is(e,["endOffset"]);null!=a&&rs(t,["endOffset"],a);const s=is(e,["startOffset"]);return null!=s&&rs(t,["startOffset"],s),t}(n));const a=is(e,["thought"]);null!=a&&rs(t,["thought"],a);const s=is(e,["inlineData"]);null!=s&&rs(t,["inlineData"],function(e){const t={};if(void 0!==is(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=is(e,["data"]);null!=n&&rs(t,["data"],n);const a=is(e,["mimeType"]);return null!=a&&rs(t,["mimeType"],a),t}(s));const r=is(e,["fileData"]);null!=r&&rs(t,["fileData"],function(e){const t={};if(void 0!==is(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=is(e,["fileUri"]);null!=n&&rs(t,["fileUri"],n);const a=is(e,["mimeType"]);return null!=a&&rs(t,["mimeType"],a),t}(r));const i=is(e,["thoughtSignature"]);null!=i&&rs(t,["thoughtSignature"],i);const l=is(e,["codeExecutionResult"]);null!=l&&rs(t,["codeExecutionResult"],l);const o=is(e,["executableCode"]);null!=o&&rs(t,["executableCode"],o);const c=is(e,["functionCall"]);null!=c&&rs(t,["functionCall"],c);const d=is(e,["functionResponse"]);null!=d&&rs(t,["functionResponse"],d);const u=is(e,["text"]);return null!=u&&rs(t,["text"],u),t}function Oo(e){const t={},n=is(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>Do(e))),rs(t,["parts"],e)}const a=is(e,["role"]);return null!=a&&rs(t,["role"],a),t}function Ro(e){const t={},n=is(e,["timeRangeFilter"]);return null!=n&&rs(t,["timeRangeFilter"],function(e){const t={},n=is(e,["startTime"]);null!=n&&rs(t,["startTime"],n);const a=is(e,["endTime"]);return null!=a&&rs(t,["endTime"],a),t}(n)),t}function Po(e){const t={},n=is(e,["dynamicRetrievalConfig"]);return null!=n&&rs(t,["dynamicRetrievalConfig"],function(e){const t={},n=is(e,["mode"]);null!=n&&rs(t,["mode"],n);const a=is(e,["dynamicThreshold"]);return null!=a&&rs(t,["dynamicThreshold"],a),t}(n)),t}function Mo(e){const t={},n=is(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=is(e,["behavior"]);null!=n&&rs(t,["behavior"],n);const a=is(e,["description"]);null!=a&&rs(t,["description"],a);const s=is(e,["name"]);null!=s&&rs(t,["name"],s);const r=is(e,["parameters"]);null!=r&&rs(t,["parameters"],r);const i=is(e,["parametersJsonSchema"]);null!=i&&rs(t,["parametersJsonSchema"],i);const l=is(e,["response"]);null!=l&&rs(t,["response"],l);const o=is(e,["responseJsonSchema"]);return null!=o&&rs(t,["responseJsonSchema"],o),t}(e))),rs(t,["functionDeclarations"],e)}if(void 0!==is(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const a=is(e,["googleSearch"]);null!=a&&rs(t,["googleSearch"],Ro(a));const s=is(e,["googleSearchRetrieval"]);if(null!=s&&rs(t,["googleSearchRetrieval"],Po(s)),void 0!==is(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==is(e,["googleMaps"]))throw new Error("googleMaps parameter is not supported in Gemini API.");null!=is(e,["urlContext"])&&rs(t,["urlContext"],{});const r=is(e,["codeExecution"]);return null!=r&&rs(t,["codeExecution"],r),t}function Uo(e){const t={},n=is(e,["latLng"]);null!=n&&rs(t,["latLng"],function(e){const t={},n=is(e,["latitude"]);null!=n&&rs(t,["latitude"],n);const a=is(e,["longitude"]);return null!=a&&rs(t,["longitude"],a),t}(n));const a=is(e,["languageCode"]);return null!=a&&rs(t,["languageCode"],a),t}function Lo(e){const t={},n=is(e,["functionCallingConfig"]);null!=n&&rs(t,["functionCallingConfig"],function(e){const t={},n=is(e,["mode"]);null!=n&&rs(t,["mode"],n);const a=is(e,["allowedFunctionNames"]);return null!=a&&rs(t,["allowedFunctionNames"],a),t}(n));const a=is(e,["retrievalConfig"]);return null!=a&&rs(t,["retrievalConfig"],Uo(a)),t}function Fo(e){const t={},n=is(e,["prebuiltVoiceConfig"]);return null!=n&&rs(t,["prebuiltVoiceConfig"],function(e){const t={},n=is(e,["voiceName"]);return null!=n&&rs(t,["voiceName"],n),t}(n)),t}function Bo(e){const t={},n=is(e,["speakerVoiceConfigs"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=is(e,["speaker"]);null!=n&&rs(t,["speaker"],n);const a=is(e,["voiceConfig"]);return null!=a&&rs(t,["voiceConfig"],Fo(a)),t}(e))),rs(t,["speakerVoiceConfigs"],e)}return t}function $o(e,t,n){const a={},s=is(t,["systemInstruction"]);void 0!==n&&null!=s&&rs(n,["systemInstruction"],Oo(li(s)));const r=is(t,["temperature"]);null!=r&&rs(a,["temperature"],r);const i=is(t,["topP"]);null!=i&&rs(a,["topP"],i);const l=is(t,["topK"]);null!=l&&rs(a,["topK"],l);const o=is(t,["candidateCount"]);null!=o&&rs(a,["candidateCount"],o);const c=is(t,["maxOutputTokens"]);null!=c&&rs(a,["maxOutputTokens"],c);const d=is(t,["stopSequences"]);null!=d&&rs(a,["stopSequences"],d);const u=is(t,["responseLogprobs"]);null!=u&&rs(a,["responseLogprobs"],u);const m=is(t,["logprobs"]);null!=m&&rs(a,["logprobs"],m);const p=is(t,["presencePenalty"]);null!=p&&rs(a,["presencePenalty"],p);const f=is(t,["frequencyPenalty"]);null!=f&&rs(a,["frequencyPenalty"],f);const h=is(t,["seed"]);null!=h&&rs(a,["seed"],h);const g=is(t,["responseMimeType"]);null!=g&&rs(a,["responseMimeType"],g);const x=is(t,["responseSchema"]);null!=x&&rs(a,["responseSchema"],function(e){const t={},n=is(e,["anyOf"]);null!=n&&rs(t,["anyOf"],n);const a=is(e,["default"]);null!=a&&rs(t,["default"],a);const s=is(e,["description"]);null!=s&&rs(t,["description"],s);const r=is(e,["enum"]);null!=r&&rs(t,["enum"],r);const i=is(e,["example"]);null!=i&&rs(t,["example"],i);const l=is(e,["format"]);null!=l&&rs(t,["format"],l);const o=is(e,["items"]);null!=o&&rs(t,["items"],o);const c=is(e,["maxItems"]);null!=c&&rs(t,["maxItems"],c);const d=is(e,["maxLength"]);null!=d&&rs(t,["maxLength"],d);const u=is(e,["maxProperties"]);null!=u&&rs(t,["maxProperties"],u);const m=is(e,["maximum"]);null!=m&&rs(t,["maximum"],m);const p=is(e,["minItems"]);null!=p&&rs(t,["minItems"],p);const f=is(e,["minLength"]);null!=f&&rs(t,["minLength"],f);const h=is(e,["minProperties"]);null!=h&&rs(t,["minProperties"],h);const g=is(e,["minimum"]);null!=g&&rs(t,["minimum"],g);const x=is(e,["nullable"]);null!=x&&rs(t,["nullable"],x);const y=is(e,["pattern"]);null!=y&&rs(t,["pattern"],y);const b=is(e,["properties"]);null!=b&&rs(t,["properties"],b);const v=is(e,["propertyOrdering"]);null!=v&&rs(t,["propertyOrdering"],v);const N=is(e,["required"]);null!=N&&rs(t,["required"],N);const w=is(e,["title"]);null!=w&&rs(t,["title"],w);const k=is(e,["type"]);return null!=k&&rs(t,["type"],k),t}(fi(x)));const y=is(t,["responseJsonSchema"]);if(null!=y&&rs(a,["responseJsonSchema"],y),void 0!==is(t,["routingConfig"]))throw new Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==is(t,["modelSelectionConfig"]))throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const b=is(t,["safetySettings"]);if(void 0!==n&&null!=b){let e=b;Array.isArray(e)&&(e=e.map(e=>function(e){const t={};if(void 0!==is(e,["method"]))throw new Error("method parameter is not supported in Gemini API.");const n=is(e,["category"]);null!=n&&rs(t,["category"],n);const a=is(e,["threshold"]);return null!=a&&rs(t,["threshold"],a),t}(e))),rs(n,["safetySettings"],e)}const v=is(t,["tools"]);if(void 0!==n&&null!=v){let e=yi(v);Array.isArray(e)&&(e=e.map(e=>Mo(xi(e)))),rs(n,["tools"],e)}const N=is(t,["toolConfig"]);if(void 0!==n&&null!=N&&rs(n,["toolConfig"],Lo(N)),void 0!==is(t,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");const w=is(t,["cachedContent"]);void 0!==n&&null!=w&&rs(n,["cachedContent"],bi(e,w));const k=is(t,["responseModalities"]);null!=k&&rs(a,["responseModalities"],k);const E=is(t,["mediaResolution"]);null!=E&&rs(a,["mediaResolution"],E);const j=is(t,["speechConfig"]);if(null!=j&&rs(a,["speechConfig"],function(e){const t={},n=is(e,["voiceConfig"]);null!=n&&rs(t,["voiceConfig"],Fo(n));const a=is(e,["multiSpeakerVoiceConfig"]);null!=a&&rs(t,["multiSpeakerVoiceConfig"],Bo(a));const s=is(e,["languageCode"]);return null!=s&&rs(t,["languageCode"],s),t}(hi(j))),void 0!==is(t,["audioTimestamp"]))throw new Error("audioTimestamp parameter is not supported in Gemini API.");const C=is(t,["thinkingConfig"]);return null!=C&&rs(a,["thinkingConfig"],function(e){const t={},n=is(e,["includeThoughts"]);null!=n&&rs(t,["includeThoughts"],n);const a=is(e,["thinkingBudget"]);return null!=a&&rs(t,["thinkingBudget"],a),t}(C)),a}function Go(e,t){const n={},a=is(t,["model"]);null!=a&&rs(n,["_url","model"],Qr(e,a));const s=is(t,["contents"]);if(null!=s){let e=ci(s);Array.isArray(e)&&(e=e.map(e=>Oo(e))),rs(n,["contents"],e)}const r=is(t,["config"]);return null!=r&&rs(n,["generationConfig"],$o(e,r,n)),n}function Vo(e,t){const n={},a=is(t,["model"]);null!=a&&rs(n,["_url","model"],Qr(e,a));const s=is(t,["contents"]);null!=s&&rs(n,["requests[]","content"],oi(e,s));const r=is(t,["config"]);null!=r&&rs(n,["config"],function(e,t){const n=is(e,["taskType"]);void 0!==t&&null!=n&&rs(t,["requests[]","taskType"],n);const a=is(e,["title"]);void 0!==t&&null!=a&&rs(t,["requests[]","title"],a);const s=is(e,["outputDimensionality"]);if(void 0!==t&&null!=s&&rs(t,["requests[]","outputDimensionality"],s),void 0!==is(e,["mimeType"]))throw new Error("mimeType parameter is not supported in Gemini API.");if(void 0!==is(e,["autoTruncate"]))throw new Error("autoTruncate parameter is not supported in Gemini API.");return{}}(r,n));const i=is(t,["model"]);return void 0!==i&&rs(n,["requests[]","model"],Qr(e,i)),n}function zo(e,t){const n={},a=is(t,["model"]);null!=a&&rs(n,["_url","model"],Qr(e,a));const s=is(t,["prompt"]);null!=s&&rs(n,["instances[0]","prompt"],s);const r=is(t,["config"]);return null!=r&&rs(n,["config"],function(e,t){if(void 0!==is(e,["outputGcsUri"]))throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==is(e,["negativePrompt"]))throw new Error("negativePrompt parameter is not supported in Gemini API.");const n=is(e,["numberOfImages"]);void 0!==t&&null!=n&&rs(t,["parameters","sampleCount"],n);const a=is(e,["aspectRatio"]);void 0!==t&&null!=a&&rs(t,["parameters","aspectRatio"],a);const s=is(e,["guidanceScale"]);if(void 0!==t&&null!=s&&rs(t,["parameters","guidanceScale"],s),void 0!==is(e,["seed"]))throw new Error("seed parameter is not supported in Gemini API.");const r=is(e,["safetyFilterLevel"]);void 0!==t&&null!=r&&rs(t,["parameters","safetySetting"],r);const i=is(e,["personGeneration"]);void 0!==t&&null!=i&&rs(t,["parameters","personGeneration"],i);const l=is(e,["includeSafetyAttributes"]);void 0!==t&&null!=l&&rs(t,["parameters","includeSafetyAttributes"],l);const o=is(e,["includeRaiReason"]);void 0!==t&&null!=o&&rs(t,["parameters","includeRaiReason"],o);const c=is(e,["language"]);void 0!==t&&null!=c&&rs(t,["parameters","language"],c);const d=is(e,["outputMimeType"]);void 0!==t&&null!=d&&rs(t,["parameters","outputOptions","mimeType"],d);const u=is(e,["outputCompressionQuality"]);if(void 0!==t&&null!=u&&rs(t,["parameters","outputOptions","compressionQuality"],u),void 0!==is(e,["addWatermark"]))throw new Error("addWatermark parameter is not supported in Gemini API.");if(void 0!==is(e,["enhancePrompt"]))throw new Error("enhancePrompt parameter is not supported in Gemini API.");return{}}(r,n)),n}function Wo(e,t){const n={},a=is(t,["config"]);return null!=a&&rs(n,["config"],function(e,t,n){const a=is(t,["pageSize"]);void 0!==n&&null!=a&&rs(n,["_query","pageSize"],a);const s=is(t,["pageToken"]);void 0!==n&&null!=s&&rs(n,["_query","pageToken"],s);const r=is(t,["filter"]);void 0!==n&&null!=r&&rs(n,["_query","filter"],r);const i=is(t,["queryBase"]);return void 0!==n&&null!=i&&rs(n,["_url","models_url"],ki(e,i)),{}}(e,a,n)),n}function qo(e,t){const n={},a=is(t,["model"]);null!=a&&rs(n,["_url","name"],Qr(e,a));const s=is(t,["config"]);return null!=s&&rs(n,["config"],function(e,t){const n=is(e,["displayName"]);void 0!==t&&null!=n&&rs(t,["displayName"],n);const a=is(e,["description"]);void 0!==t&&null!=a&&rs(t,["description"],a);const s=is(e,["defaultCheckpointId"]);return void 0!==t&&null!=s&&rs(t,["defaultCheckpointId"],s),{}}(s,n)),n}function Ho(e,t){const n={},a=is(t,["model"]);null!=a&&rs(n,["_url","model"],Qr(e,a));const s=is(t,["contents"]);if(null!=s){let e=ci(s);Array.isArray(e)&&(e=e.map(e=>Oo(e))),rs(n,["contents"],e)}const r=is(t,["config"]);return null!=r&&rs(n,["config"],function(e){if(void 0!==is(e,["systemInstruction"]))throw new Error("systemInstruction parameter is not supported in Gemini API.");if(void 0!==is(e,["tools"]))throw new Error("tools parameter is not supported in Gemini API.");if(void 0!==is(e,["generationConfig"]))throw new Error("generationConfig parameter is not supported in Gemini API.");return{}}(r)),n}function Ko(e,t){const n={},a=is(t,["model"]);null!=a&&rs(n,["_url","model"],Qr(e,a));const s=is(t,["prompt"]);null!=s&&rs(n,["instances[0]","prompt"],s);const r=is(t,["image"]);if(null!=r&&rs(n,["instances[0]","image"],function(e){const t={};if(void 0!==is(e,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");const n=is(e,["imageBytes"]);null!=n&&rs(t,["bytesBase64Encoded"],Ni(n));const a=is(e,["mimeType"]);return null!=a&&rs(t,["mimeType"],a),t}(r)),void 0!==is(t,["video"]))throw new Error("video parameter is not supported in Gemini API.");const i=is(t,["config"]);return null!=i&&rs(n,["config"],function(e,t){const n=is(e,["numberOfVideos"]);if(void 0!==t&&null!=n&&rs(t,["parameters","sampleCount"],n),void 0!==is(e,["outputGcsUri"]))throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==is(e,["fps"]))throw new Error("fps parameter is not supported in Gemini API.");const a=is(e,["durationSeconds"]);if(void 0!==t&&null!=a&&rs(t,["parameters","durationSeconds"],a),void 0!==is(e,["seed"]))throw new Error("seed parameter is not supported in Gemini API.");const s=is(e,["aspectRatio"]);if(void 0!==t&&null!=s&&rs(t,["parameters","aspectRatio"],s),void 0!==is(e,["resolution"]))throw new Error("resolution parameter is not supported in Gemini API.");const r=is(e,["personGeneration"]);if(void 0!==t&&null!=r&&rs(t,["parameters","personGeneration"],r),void 0!==is(e,["pubsubTopic"]))throw new Error("pubsubTopic parameter is not supported in Gemini API.");const i=is(e,["negativePrompt"]);void 0!==t&&null!=i&&rs(t,["parameters","negativePrompt"],i);const l=is(e,["enhancePrompt"]);if(void 0!==t&&null!=l&&rs(t,["parameters","enhancePrompt"],l),void 0!==is(e,["generateAudio"]))throw new Error("generateAudio parameter is not supported in Gemini API.");if(void 0!==is(e,["lastFrame"]))throw new Error("lastFrame parameter is not supported in Gemini API.");if(void 0!==is(e,["compressionQuality"]))throw new Error("compressionQuality parameter is not supported in Gemini API.");return{}}(i,n)),n}function Yo(e){const t={},n=is(e,["videoMetadata"]);null!=n&&rs(t,["videoMetadata"],function(e){const t={},n=is(e,["fps"]);null!=n&&rs(t,["fps"],n);const a=is(e,["endOffset"]);null!=a&&rs(t,["endOffset"],a);const s=is(e,["startOffset"]);return null!=s&&rs(t,["startOffset"],s),t}(n));const a=is(e,["thought"]);null!=a&&rs(t,["thought"],a);const s=is(e,["inlineData"]);null!=s&&rs(t,["inlineData"],function(e){const t={},n=is(e,["displayName"]);null!=n&&rs(t,["displayName"],n);const a=is(e,["data"]);null!=a&&rs(t,["data"],a);const s=is(e,["mimeType"]);return null!=s&&rs(t,["mimeType"],s),t}(s));const r=is(e,["fileData"]);null!=r&&rs(t,["fileData"],function(e){const t={},n=is(e,["displayName"]);null!=n&&rs(t,["displayName"],n);const a=is(e,["fileUri"]);null!=a&&rs(t,["fileUri"],a);const s=is(e,["mimeType"]);return null!=s&&rs(t,["mimeType"],s),t}(r));const i=is(e,["thoughtSignature"]);null!=i&&rs(t,["thoughtSignature"],i);const l=is(e,["codeExecutionResult"]);null!=l&&rs(t,["codeExecutionResult"],l);const o=is(e,["executableCode"]);null!=o&&rs(t,["executableCode"],o);const c=is(e,["functionCall"]);null!=c&&rs(t,["functionCall"],c);const d=is(e,["functionResponse"]);null!=d&&rs(t,["functionResponse"],d);const u=is(e,["text"]);return null!=u&&rs(t,["text"],u),t}function Jo(e){const t={},n=is(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>Yo(e))),rs(t,["parts"],e)}const a=is(e,["role"]);return null!=a&&rs(t,["role"],a),t}function Zo(e){const t={},n=is(e,["timeRangeFilter"]);return null!=n&&rs(t,["timeRangeFilter"],function(e){const t={},n=is(e,["startTime"]);null!=n&&rs(t,["startTime"],n);const a=is(e,["endTime"]);return null!=a&&rs(t,["endTime"],a),t}(n)),t}function Qo(e){const t={},n=is(e,["dynamicRetrievalConfig"]);return null!=n&&rs(t,["dynamicRetrievalConfig"],function(e){const t={},n=is(e,["mode"]);null!=n&&rs(t,["mode"],n);const a=is(e,["dynamicThreshold"]);return null!=a&&rs(t,["dynamicThreshold"],a),t}(n)),t}function Xo(e){const t={},n=is(e,["apiKeyConfig"]);null!=n&&rs(t,["apiKeyConfig"],function(e){const t={},n=is(e,["apiKeyString"]);return null!=n&&rs(t,["apiKeyString"],n),t}(n));const a=is(e,["authType"]);null!=a&&rs(t,["authType"],a);const s=is(e,["googleServiceAccountConfig"]);null!=s&&rs(t,["googleServiceAccountConfig"],s);const r=is(e,["httpBasicAuthConfig"]);null!=r&&rs(t,["httpBasicAuthConfig"],r);const i=is(e,["oauthConfig"]);null!=i&&rs(t,["oauthConfig"],i);const l=is(e,["oidcConfig"]);return null!=l&&rs(t,["oidcConfig"],l),t}function ec(e){const t={},n=is(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={};if(void 0!==is(e,["behavior"]))throw new Error("behavior parameter is not supported in Vertex AI.");const n=is(e,["description"]);null!=n&&rs(t,["description"],n);const a=is(e,["name"]);null!=a&&rs(t,["name"],a);const s=is(e,["parameters"]);null!=s&&rs(t,["parameters"],s);const r=is(e,["parametersJsonSchema"]);null!=r&&rs(t,["parametersJsonSchema"],r);const i=is(e,["response"]);null!=i&&rs(t,["response"],i);const l=is(e,["responseJsonSchema"]);return null!=l&&rs(t,["responseJsonSchema"],l),t}(e))),rs(t,["functionDeclarations"],e)}const a=is(e,["retrieval"]);null!=a&&rs(t,["retrieval"],a);const s=is(e,["googleSearch"]);null!=s&&rs(t,["googleSearch"],Zo(s));const r=is(e,["googleSearchRetrieval"]);null!=r&&rs(t,["googleSearchRetrieval"],Qo(r));null!=is(e,["enterpriseWebSearch"])&&rs(t,["enterpriseWebSearch"],{});const i=is(e,["googleMaps"]);null!=i&&rs(t,["googleMaps"],function(e){const t={},n=is(e,["authConfig"]);return null!=n&&rs(t,["authConfig"],Xo(n)),t}(i));null!=is(e,["urlContext"])&&rs(t,["urlContext"],{});const l=is(e,["codeExecution"]);return null!=l&&rs(t,["codeExecution"],l),t}function tc(e){const t={},n=is(e,["latLng"]);null!=n&&rs(t,["latLng"],function(e){const t={},n=is(e,["latitude"]);null!=n&&rs(t,["latitude"],n);const a=is(e,["longitude"]);return null!=a&&rs(t,["longitude"],a),t}(n));const a=is(e,["languageCode"]);return null!=a&&rs(t,["languageCode"],a),t}function nc(e){const t={},n=is(e,["functionCallingConfig"]);null!=n&&rs(t,["functionCallingConfig"],function(e){const t={},n=is(e,["mode"]);null!=n&&rs(t,["mode"],n);const a=is(e,["allowedFunctionNames"]);return null!=a&&rs(t,["allowedFunctionNames"],a),t}(n));const a=is(e,["retrievalConfig"]);return null!=a&&rs(t,["retrievalConfig"],tc(a)),t}function ac(e){const t={},n=is(e,["prebuiltVoiceConfig"]);return null!=n&&rs(t,["prebuiltVoiceConfig"],function(e){const t={},n=is(e,["voiceName"]);return null!=n&&rs(t,["voiceName"],n),t}(n)),t}function sc(e,t,n){const a={},s=is(t,["systemInstruction"]);void 0!==n&&null!=s&&rs(n,["systemInstruction"],Jo(li(s)));const r=is(t,["temperature"]);null!=r&&rs(a,["temperature"],r);const i=is(t,["topP"]);null!=i&&rs(a,["topP"],i);const l=is(t,["topK"]);null!=l&&rs(a,["topK"],l);const o=is(t,["candidateCount"]);null!=o&&rs(a,["candidateCount"],o);const c=is(t,["maxOutputTokens"]);null!=c&&rs(a,["maxOutputTokens"],c);const d=is(t,["stopSequences"]);null!=d&&rs(a,["stopSequences"],d);const u=is(t,["responseLogprobs"]);null!=u&&rs(a,["responseLogprobs"],u);const m=is(t,["logprobs"]);null!=m&&rs(a,["logprobs"],m);const p=is(t,["presencePenalty"]);null!=p&&rs(a,["presencePenalty"],p);const f=is(t,["frequencyPenalty"]);null!=f&&rs(a,["frequencyPenalty"],f);const h=is(t,["seed"]);null!=h&&rs(a,["seed"],h);const g=is(t,["responseMimeType"]);null!=g&&rs(a,["responseMimeType"],g);const x=is(t,["responseSchema"]);null!=x&&rs(a,["responseSchema"],function(e){const t={},n=is(e,["anyOf"]);null!=n&&rs(t,["anyOf"],n);const a=is(e,["default"]);null!=a&&rs(t,["default"],a);const s=is(e,["description"]);null!=s&&rs(t,["description"],s);const r=is(e,["enum"]);null!=r&&rs(t,["enum"],r);const i=is(e,["example"]);null!=i&&rs(t,["example"],i);const l=is(e,["format"]);null!=l&&rs(t,["format"],l);const o=is(e,["items"]);null!=o&&rs(t,["items"],o);const c=is(e,["maxItems"]);null!=c&&rs(t,["maxItems"],c);const d=is(e,["maxLength"]);null!=d&&rs(t,["maxLength"],d);const u=is(e,["maxProperties"]);null!=u&&rs(t,["maxProperties"],u);const m=is(e,["maximum"]);null!=m&&rs(t,["maximum"],m);const p=is(e,["minItems"]);null!=p&&rs(t,["minItems"],p);const f=is(e,["minLength"]);null!=f&&rs(t,["minLength"],f);const h=is(e,["minProperties"]);null!=h&&rs(t,["minProperties"],h);const g=is(e,["minimum"]);null!=g&&rs(t,["minimum"],g);const x=is(e,["nullable"]);null!=x&&rs(t,["nullable"],x);const y=is(e,["pattern"]);null!=y&&rs(t,["pattern"],y);const b=is(e,["properties"]);null!=b&&rs(t,["properties"],b);const v=is(e,["propertyOrdering"]);null!=v&&rs(t,["propertyOrdering"],v);const N=is(e,["required"]);null!=N&&rs(t,["required"],N);const w=is(e,["title"]);null!=w&&rs(t,["title"],w);const k=is(e,["type"]);return null!=k&&rs(t,["type"],k),t}(fi(x)));const y=is(t,["responseJsonSchema"]);null!=y&&rs(a,["responseJsonSchema"],y);const b=is(t,["routingConfig"]);null!=b&&rs(a,["routingConfig"],b);const v=is(t,["modelSelectionConfig"]);null!=v&&rs(a,["modelConfig"],function(e){const t={},n=is(e,["featureSelectionPreference"]);return null!=n&&rs(t,["featureSelectionPreference"],n),t}(v));const N=is(t,["safetySettings"]);if(void 0!==n&&null!=N){let e=N;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=is(e,["method"]);null!=n&&rs(t,["method"],n);const a=is(e,["category"]);null!=a&&rs(t,["category"],a);const s=is(e,["threshold"]);return null!=s&&rs(t,["threshold"],s),t}(e))),rs(n,["safetySettings"],e)}const w=is(t,["tools"]);if(void 0!==n&&null!=w){let e=yi(w);Array.isArray(e)&&(e=e.map(e=>ec(xi(e)))),rs(n,["tools"],e)}const k=is(t,["toolConfig"]);void 0!==n&&null!=k&&rs(n,["toolConfig"],nc(k));const E=is(t,["labels"]);void 0!==n&&null!=E&&rs(n,["labels"],E);const j=is(t,["cachedContent"]);void 0!==n&&null!=j&&rs(n,["cachedContent"],bi(e,j));const C=is(t,["responseModalities"]);null!=C&&rs(a,["responseModalities"],C);const _=is(t,["mediaResolution"]);null!=_&&rs(a,["mediaResolution"],_);const T=is(t,["speechConfig"]);null!=T&&rs(a,["speechConfig"],function(e){const t={},n=is(e,["voiceConfig"]);if(null!=n&&rs(t,["voiceConfig"],ac(n)),void 0!==is(e,["multiSpeakerVoiceConfig"]))throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const a=is(e,["languageCode"]);return null!=a&&rs(t,["languageCode"],a),t}(hi(T)));const S=is(t,["audioTimestamp"]);null!=S&&rs(a,["audioTimestamp"],S);const A=is(t,["thinkingConfig"]);return null!=A&&rs(a,["thinkingConfig"],function(e){const t={},n=is(e,["includeThoughts"]);null!=n&&rs(t,["includeThoughts"],n);const a=is(e,["thinkingBudget"]);return null!=a&&rs(t,["thinkingBudget"],a),t}(A)),a}function rc(e,t){const n={},a=is(t,["model"]);null!=a&&rs(n,["_url","model"],Qr(e,a));const s=is(t,["contents"]);if(null!=s){let e=ci(s);Array.isArray(e)&&(e=e.map(e=>Jo(e))),rs(n,["contents"],e)}const r=is(t,["config"]);return null!=r&&rs(n,["generationConfig"],sc(e,r,n)),n}function ic(e,t){const n={},a=is(t,["model"]);null!=a&&rs(n,["_url","model"],Qr(e,a));const s=is(t,["contents"]);null!=s&&rs(n,["instances[]","content"],oi(e,s));const r=is(t,["config"]);return null!=r&&rs(n,["config"],function(e,t){const n=is(e,["taskType"]);void 0!==t&&null!=n&&rs(t,["instances[]","task_type"],n);const a=is(e,["title"]);void 0!==t&&null!=a&&rs(t,["instances[]","title"],a);const s=is(e,["outputDimensionality"]);void 0!==t&&null!=s&&rs(t,["parameters","outputDimensionality"],s);const r=is(e,["mimeType"]);void 0!==t&&null!=r&&rs(t,["instances[]","mimeType"],r);const i=is(e,["autoTruncate"]);return void 0!==t&&null!=i&&rs(t,["parameters","autoTruncate"],i),{}}(r,n)),n}function lc(e,t){const n={},a=is(t,["model"]);null!=a&&rs(n,["_url","model"],Qr(e,a));const s=is(t,["prompt"]);null!=s&&rs(n,["instances[0]","prompt"],s);const r=is(t,["config"]);return null!=r&&rs(n,["config"],function(e,t){const n=is(e,["outputGcsUri"]);void 0!==t&&null!=n&&rs(t,["parameters","storageUri"],n);const a=is(e,["negativePrompt"]);void 0!==t&&null!=a&&rs(t,["parameters","negativePrompt"],a);const s=is(e,["numberOfImages"]);void 0!==t&&null!=s&&rs(t,["parameters","sampleCount"],s);const r=is(e,["aspectRatio"]);void 0!==t&&null!=r&&rs(t,["parameters","aspectRatio"],r);const i=is(e,["guidanceScale"]);void 0!==t&&null!=i&&rs(t,["parameters","guidanceScale"],i);const l=is(e,["seed"]);void 0!==t&&null!=l&&rs(t,["parameters","seed"],l);const o=is(e,["safetyFilterLevel"]);void 0!==t&&null!=o&&rs(t,["parameters","safetySetting"],o);const c=is(e,["personGeneration"]);void 0!==t&&null!=c&&rs(t,["parameters","personGeneration"],c);const d=is(e,["includeSafetyAttributes"]);void 0!==t&&null!=d&&rs(t,["parameters","includeSafetyAttributes"],d);const u=is(e,["includeRaiReason"]);void 0!==t&&null!=u&&rs(t,["parameters","includeRaiReason"],u);const m=is(e,["language"]);void 0!==t&&null!=m&&rs(t,["parameters","language"],m);const p=is(e,["outputMimeType"]);void 0!==t&&null!=p&&rs(t,["parameters","outputOptions","mimeType"],p);const f=is(e,["outputCompressionQuality"]);void 0!==t&&null!=f&&rs(t,["parameters","outputOptions","compressionQuality"],f);const h=is(e,["addWatermark"]);void 0!==t&&null!=h&&rs(t,["parameters","addWatermark"],h);const g=is(e,["enhancePrompt"]);return void 0!==t&&null!=g&&rs(t,["parameters","enhancePrompt"],g),{}}(r,n)),n}function oc(e){const t={},n=is(e,["gcsUri"]);null!=n&&rs(t,["gcsUri"],n);const a=is(e,["imageBytes"]);null!=a&&rs(t,["bytesBase64Encoded"],Ni(a));const s=is(e,["mimeType"]);return null!=s&&rs(t,["mimeType"],s),t}function cc(e){const t={},n=is(e,["referenceImage"]);null!=n&&rs(t,["referenceImage"],oc(n));const a=is(e,["referenceId"]);null!=a&&rs(t,["referenceId"],a);const s=is(e,["referenceType"]);null!=s&&rs(t,["referenceType"],s);const r=is(e,["maskImageConfig"]);null!=r&&rs(t,["maskImageConfig"],function(e){const t={},n=is(e,["maskMode"]);null!=n&&rs(t,["maskMode"],n);const a=is(e,["segmentationClasses"]);null!=a&&rs(t,["maskClasses"],a);const s=is(e,["maskDilation"]);return null!=s&&rs(t,["dilation"],s),t}(r));const i=is(e,["controlImageConfig"]);null!=i&&rs(t,["controlImageConfig"],function(e){const t={},n=is(e,["controlType"]);null!=n&&rs(t,["controlType"],n);const a=is(e,["enableControlImageComputation"]);return null!=a&&rs(t,["computeControl"],a),t}(i));const l=is(e,["styleImageConfig"]);null!=l&&rs(t,["styleImageConfig"],function(e){const t={},n=is(e,["styleDescription"]);return null!=n&&rs(t,["styleDescription"],n),t}(l));const o=is(e,["subjectImageConfig"]);return null!=o&&rs(t,["subjectImageConfig"],function(e){const t={},n=is(e,["subjectType"]);null!=n&&rs(t,["subjectType"],n);const a=is(e,["subjectDescription"]);return null!=a&&rs(t,["subjectDescription"],a),t}(o)),t}function dc(e,t){const n={},a=is(t,["model"]);null!=a&&rs(n,["_url","model"],Qr(e,a));const s=is(t,["prompt"]);null!=s&&rs(n,["instances[0]","prompt"],s);const r=is(t,["referenceImages"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>cc(e))),rs(n,["instances[0]","referenceImages"],e)}const i=is(t,["config"]);return null!=i&&rs(n,["config"],function(e,t){const n=is(e,["outputGcsUri"]);void 0!==t&&null!=n&&rs(t,["parameters","storageUri"],n);const a=is(e,["negativePrompt"]);void 0!==t&&null!=a&&rs(t,["parameters","negativePrompt"],a);const s=is(e,["numberOfImages"]);void 0!==t&&null!=s&&rs(t,["parameters","sampleCount"],s);const r=is(e,["aspectRatio"]);void 0!==t&&null!=r&&rs(t,["parameters","aspectRatio"],r);const i=is(e,["guidanceScale"]);void 0!==t&&null!=i&&rs(t,["parameters","guidanceScale"],i);const l=is(e,["seed"]);void 0!==t&&null!=l&&rs(t,["parameters","seed"],l);const o=is(e,["safetyFilterLevel"]);void 0!==t&&null!=o&&rs(t,["parameters","safetySetting"],o);const c=is(e,["personGeneration"]);void 0!==t&&null!=c&&rs(t,["parameters","personGeneration"],c);const d=is(e,["includeSafetyAttributes"]);void 0!==t&&null!=d&&rs(t,["parameters","includeSafetyAttributes"],d);const u=is(e,["includeRaiReason"]);void 0!==t&&null!=u&&rs(t,["parameters","includeRaiReason"],u);const m=is(e,["language"]);void 0!==t&&null!=m&&rs(t,["parameters","language"],m);const p=is(e,["outputMimeType"]);void 0!==t&&null!=p&&rs(t,["parameters","outputOptions","mimeType"],p);const f=is(e,["outputCompressionQuality"]);void 0!==t&&null!=f&&rs(t,["parameters","outputOptions","compressionQuality"],f);const h=is(e,["editMode"]);void 0!==t&&null!=h&&rs(t,["parameters","editMode"],h);const g=is(e,["baseSteps"]);return void 0!==t&&null!=g&&rs(t,["parameters","editConfig","baseSteps"],g),{}}(i,n)),n}function uc(e,t){const n={},a=is(t,["model"]);null!=a&&rs(n,["_url","model"],Qr(e,a));const s=is(t,["image"]);null!=s&&rs(n,["instances[0]","image"],oc(s));const r=is(t,["upscaleFactor"]);null!=r&&rs(n,["parameters","upscaleConfig","upscaleFactor"],r);const i=is(t,["config"]);return null!=i&&rs(n,["config"],function(e,t){const n=is(e,["includeRaiReason"]);void 0!==t&&null!=n&&rs(t,["parameters","includeRaiReason"],n);const a=is(e,["outputMimeType"]);void 0!==t&&null!=a&&rs(t,["parameters","outputOptions","mimeType"],a);const s=is(e,["outputCompressionQuality"]);void 0!==t&&null!=s&&rs(t,["parameters","outputOptions","compressionQuality"],s);const r=is(e,["enhanceInputImage"]);void 0!==t&&null!=r&&rs(t,["parameters","upscaleConfig","enhanceInputImage"],r);const i=is(e,["imagePreservationFactor"]);void 0!==t&&null!=i&&rs(t,["parameters","upscaleConfig","imagePreservationFactor"],i);const l=is(e,["numberOfImages"]);void 0!==t&&null!=l&&rs(t,["parameters","sampleCount"],l);const o=is(e,["mode"]);return void 0!==t&&null!=o&&rs(t,["parameters","mode"],o),{}}(i,n)),n}function mc(e,t){const n={},a=is(t,["config"]);return null!=a&&rs(n,["config"],function(e,t,n){const a=is(t,["pageSize"]);void 0!==n&&null!=a&&rs(n,["_query","pageSize"],a);const s=is(t,["pageToken"]);void 0!==n&&null!=s&&rs(n,["_query","pageToken"],s);const r=is(t,["filter"]);void 0!==n&&null!=r&&rs(n,["_query","filter"],r);const i=is(t,["queryBase"]);return void 0!==n&&null!=i&&rs(n,["_url","models_url"],ki(e,i)),{}}(e,a,n)),n}function pc(e,t){const n={},a=is(t,["model"]);null!=a&&rs(n,["_url","model"],Qr(e,a));const s=is(t,["config"]);return null!=s&&rs(n,["config"],function(e,t){const n=is(e,["displayName"]);void 0!==t&&null!=n&&rs(t,["displayName"],n);const a=is(e,["description"]);void 0!==t&&null!=a&&rs(t,["description"],a);const s=is(e,["defaultCheckpointId"]);return void 0!==t&&null!=s&&rs(t,["defaultCheckpointId"],s),{}}(s,n)),n}function fc(e,t){const n={},a=is(t,["model"]);null!=a&&rs(n,["_url","model"],Qr(e,a));const s=is(t,["contents"]);if(null!=s){let e=ci(s);Array.isArray(e)&&(e=e.map(e=>Jo(e))),rs(n,["contents"],e)}const r=is(t,["config"]);return null!=r&&rs(n,["config"],function(e,t){const n=is(e,["systemInstruction"]);void 0!==t&&null!=n&&rs(t,["systemInstruction"],Jo(li(n)));const a=is(e,["tools"]);if(void 0!==t&&null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>ec(e))),rs(t,["tools"],e)}const s=is(e,["generationConfig"]);return void 0!==t&&null!=s&&rs(t,["generationConfig"],s),{}}(r,n)),n}function hc(e,t){const n={},a=is(t,["model"]);null!=a&&rs(n,["_url","model"],Qr(e,a));const s=is(t,["prompt"]);null!=s&&rs(n,["instances[0]","prompt"],s);const r=is(t,["image"]);null!=r&&rs(n,["instances[0]","image"],oc(r));const i=is(t,["video"]);null!=i&&rs(n,["instances[0]","video"],function(e){const t={},n=is(e,["uri"]);null!=n&&rs(t,["gcsUri"],n);const a=is(e,["videoBytes"]);null!=a&&rs(t,["bytesBase64Encoded"],Ni(a));const s=is(e,["mimeType"]);return null!=s&&rs(t,["mimeType"],s),t}(i));const l=is(t,["config"]);return null!=l&&rs(n,["config"],function(e,t){const n=is(e,["numberOfVideos"]);void 0!==t&&null!=n&&rs(t,["parameters","sampleCount"],n);const a=is(e,["outputGcsUri"]);void 0!==t&&null!=a&&rs(t,["parameters","storageUri"],a);const s=is(e,["fps"]);void 0!==t&&null!=s&&rs(t,["parameters","fps"],s);const r=is(e,["durationSeconds"]);void 0!==t&&null!=r&&rs(t,["parameters","durationSeconds"],r);const i=is(e,["seed"]);void 0!==t&&null!=i&&rs(t,["parameters","seed"],i);const l=is(e,["aspectRatio"]);void 0!==t&&null!=l&&rs(t,["parameters","aspectRatio"],l);const o=is(e,["resolution"]);void 0!==t&&null!=o&&rs(t,["parameters","resolution"],o);const c=is(e,["personGeneration"]);void 0!==t&&null!=c&&rs(t,["parameters","personGeneration"],c);const d=is(e,["pubsubTopic"]);void 0!==t&&null!=d&&rs(t,["parameters","pubsubTopic"],d);const u=is(e,["negativePrompt"]);void 0!==t&&null!=u&&rs(t,["parameters","negativePrompt"],u);const m=is(e,["enhancePrompt"]);void 0!==t&&null!=m&&rs(t,["parameters","enhancePrompt"],m);const p=is(e,["generateAudio"]);void 0!==t&&null!=p&&rs(t,["parameters","generateAudio"],p);const f=is(e,["lastFrame"]);void 0!==t&&null!=f&&rs(t,["instances[0]","lastFrame"],oc(f));const h=is(e,["compressionQuality"]);return void 0!==t&&null!=h&&rs(t,["parameters","compressionQuality"],h),{}}(l,n)),n}function gc(e){const t={},n=is(e,["videoMetadata"]);null!=n&&rs(t,["videoMetadata"],function(e){const t={},n=is(e,["fps"]);null!=n&&rs(t,["fps"],n);const a=is(e,["endOffset"]);null!=a&&rs(t,["endOffset"],a);const s=is(e,["startOffset"]);return null!=s&&rs(t,["startOffset"],s),t}(n));const a=is(e,["thought"]);null!=a&&rs(t,["thought"],a);const s=is(e,["inlineData"]);null!=s&&rs(t,["inlineData"],function(e){const t={},n=is(e,["data"]);null!=n&&rs(t,["data"],n);const a=is(e,["mimeType"]);return null!=a&&rs(t,["mimeType"],a),t}(s));const r=is(e,["fileData"]);null!=r&&rs(t,["fileData"],function(e){const t={},n=is(e,["fileUri"]);null!=n&&rs(t,["fileUri"],n);const a=is(e,["mimeType"]);return null!=a&&rs(t,["mimeType"],a),t}(r));const i=is(e,["thoughtSignature"]);null!=i&&rs(t,["thoughtSignature"],i);const l=is(e,["codeExecutionResult"]);null!=l&&rs(t,["codeExecutionResult"],l);const o=is(e,["executableCode"]);null!=o&&rs(t,["executableCode"],o);const c=is(e,["functionCall"]);null!=c&&rs(t,["functionCall"],c);const d=is(e,["functionResponse"]);null!=d&&rs(t,["functionResponse"],d);const u=is(e,["text"]);return null!=u&&rs(t,["text"],u),t}function xc(e){const t={},n=is(e,["urlMetadata"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=is(e,["retrievedUrl"]);null!=n&&rs(t,["retrievedUrl"],n);const a=is(e,["urlRetrievalStatus"]);return null!=a&&rs(t,["urlRetrievalStatus"],a),t}(e))),rs(t,["urlMetadata"],e)}return t}function yc(e){const t={},n=is(e,["content"]);null!=n&&rs(t,["content"],function(e){const t={},n=is(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>gc(e))),rs(t,["parts"],e)}const a=is(e,["role"]);return null!=a&&rs(t,["role"],a),t}(n));const a=is(e,["citationMetadata"]);null!=a&&rs(t,["citationMetadata"],function(e){const t={},n=is(e,["citationSources"]);return null!=n&&rs(t,["citations"],n),t}(a));const s=is(e,["tokenCount"]);null!=s&&rs(t,["tokenCount"],s);const r=is(e,["finishReason"]);null!=r&&rs(t,["finishReason"],r);const i=is(e,["urlContextMetadata"]);null!=i&&rs(t,["urlContextMetadata"],xc(i));const l=is(e,["avgLogprobs"]);null!=l&&rs(t,["avgLogprobs"],l);const o=is(e,["groundingMetadata"]);null!=o&&rs(t,["groundingMetadata"],o);const c=is(e,["index"]);null!=c&&rs(t,["index"],c);const d=is(e,["logprobsResult"]);null!=d&&rs(t,["logprobsResult"],d);const u=is(e,["safetyRatings"]);return null!=u&&rs(t,["safetyRatings"],u),t}function bc(e){const t={},n=is(e,["candidates"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>yc(e))),rs(t,["candidates"],e)}const a=is(e,["modelVersion"]);null!=a&&rs(t,["modelVersion"],a);const s=is(e,["promptFeedback"]);null!=s&&rs(t,["promptFeedback"],s);const r=is(e,["usageMetadata"]);return null!=r&&rs(t,["usageMetadata"],r),t}function vc(e){const t={},n=is(e,["embeddings"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=is(e,["values"]);return null!=n&&rs(t,["values"],n),t}(e))),rs(t,["embeddings"],e)}return null!=is(e,["metadata"])&&rs(t,["metadata"],{}),t}function Nc(e){const t={},n=is(e,["safetyAttributes","categories"]);null!=n&&rs(t,["categories"],n);const a=is(e,["safetyAttributes","scores"]);null!=a&&rs(t,["scores"],a);const s=is(e,["contentType"]);return null!=s&&rs(t,["contentType"],s),t}function wc(e){const t={},n=is(e,["_self"]);null!=n&&rs(t,["image"],function(e){const t={},n=is(e,["bytesBase64Encoded"]);null!=n&&rs(t,["imageBytes"],Ni(n));const a=is(e,["mimeType"]);return null!=a&&rs(t,["mimeType"],a),t}(n));const a=is(e,["raiFilteredReason"]);null!=a&&rs(t,["raiFilteredReason"],a);const s=is(e,["_self"]);return null!=s&&rs(t,["safetyAttributes"],Nc(s)),t}function kc(e){const t={},n=is(e,["name"]);null!=n&&rs(t,["name"],n);const a=is(e,["displayName"]);null!=a&&rs(t,["displayName"],a);const s=is(e,["description"]);null!=s&&rs(t,["description"],s);const r=is(e,["version"]);null!=r&&rs(t,["version"],r);const i=is(e,["_self"]);null!=i&&rs(t,["tunedModelInfo"],function(e){const t={},n=is(e,["baseModel"]);null!=n&&rs(t,["baseModel"],n);const a=is(e,["createTime"]);null!=a&&rs(t,["createTime"],a);const s=is(e,["updateTime"]);return null!=s&&rs(t,["updateTime"],s),t}(i));const l=is(e,["inputTokenLimit"]);null!=l&&rs(t,["inputTokenLimit"],l);const o=is(e,["outputTokenLimit"]);null!=o&&rs(t,["outputTokenLimit"],o);const c=is(e,["supportedGenerationMethods"]);return null!=c&&rs(t,["supportedActions"],c),t}function Ec(e){const t={},n=is(e,["_self"]);return null!=n&&rs(t,["video"],function(e){const t={},n=is(e,["video","uri"]);null!=n&&rs(t,["uri"],n);const a=is(e,["video","encodedVideo"]);null!=a&&rs(t,["videoBytes"],Ni(a));const s=is(e,["encoding"]);return null!=s&&rs(t,["mimeType"],s),t}(n)),t}function jc(e){const t={},n=is(e,["name"]);null!=n&&rs(t,["name"],n);const a=is(e,["metadata"]);null!=a&&rs(t,["metadata"],a);const s=is(e,["done"]);null!=s&&rs(t,["done"],s);const r=is(e,["error"]);null!=r&&rs(t,["error"],r);const i=is(e,["response","generateVideoResponse"]);return null!=i&&rs(t,["response"],function(e){const t={},n=is(e,["generatedSamples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>Ec(e))),rs(t,["generatedVideos"],e)}const a=is(e,["raiMediaFilteredCount"]);null!=a&&rs(t,["raiMediaFilteredCount"],a);const s=is(e,["raiMediaFilteredReasons"]);return null!=s&&rs(t,["raiMediaFilteredReasons"],s),t}(i)),t}function Cc(e){const t={},n=is(e,["videoMetadata"]);null!=n&&rs(t,["videoMetadata"],function(e){const t={},n=is(e,["fps"]);null!=n&&rs(t,["fps"],n);const a=is(e,["endOffset"]);null!=a&&rs(t,["endOffset"],a);const s=is(e,["startOffset"]);return null!=s&&rs(t,["startOffset"],s),t}(n));const a=is(e,["thought"]);null!=a&&rs(t,["thought"],a);const s=is(e,["inlineData"]);null!=s&&rs(t,["inlineData"],function(e){const t={},n=is(e,["displayName"]);null!=n&&rs(t,["displayName"],n);const a=is(e,["data"]);null!=a&&rs(t,["data"],a);const s=is(e,["mimeType"]);return null!=s&&rs(t,["mimeType"],s),t}(s));const r=is(e,["fileData"]);null!=r&&rs(t,["fileData"],function(e){const t={},n=is(e,["displayName"]);null!=n&&rs(t,["displayName"],n);const a=is(e,["fileUri"]);null!=a&&rs(t,["fileUri"],a);const s=is(e,["mimeType"]);return null!=s&&rs(t,["mimeType"],s),t}(r));const i=is(e,["thoughtSignature"]);null!=i&&rs(t,["thoughtSignature"],i);const l=is(e,["codeExecutionResult"]);null!=l&&rs(t,["codeExecutionResult"],l);const o=is(e,["executableCode"]);null!=o&&rs(t,["executableCode"],o);const c=is(e,["functionCall"]);null!=c&&rs(t,["functionCall"],c);const d=is(e,["functionResponse"]);null!=d&&rs(t,["functionResponse"],d);const u=is(e,["text"]);return null!=u&&rs(t,["text"],u),t}function _c(e){const t={},n=is(e,["urlMetadata"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=is(e,["retrievedUrl"]);null!=n&&rs(t,["retrievedUrl"],n);const a=is(e,["urlRetrievalStatus"]);return null!=a&&rs(t,["urlRetrievalStatus"],a),t}(e))),rs(t,["urlMetadata"],e)}return t}function Tc(e){const t={},n=is(e,["content"]);null!=n&&rs(t,["content"],function(e){const t={},n=is(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>Cc(e))),rs(t,["parts"],e)}const a=is(e,["role"]);return null!=a&&rs(t,["role"],a),t}(n));const a=is(e,["citationMetadata"]);null!=a&&rs(t,["citationMetadata"],function(e){const t={},n=is(e,["citations"]);return null!=n&&rs(t,["citations"],n),t}(a));const s=is(e,["finishMessage"]);null!=s&&rs(t,["finishMessage"],s);const r=is(e,["finishReason"]);null!=r&&rs(t,["finishReason"],r);const i=is(e,["urlContextMetadata"]);null!=i&&rs(t,["urlContextMetadata"],_c(i));const l=is(e,["avgLogprobs"]);null!=l&&rs(t,["avgLogprobs"],l);const o=is(e,["groundingMetadata"]);null!=o&&rs(t,["groundingMetadata"],o);const c=is(e,["index"]);null!=c&&rs(t,["index"],c);const d=is(e,["logprobsResult"]);null!=d&&rs(t,["logprobsResult"],d);const u=is(e,["safetyRatings"]);return null!=u&&rs(t,["safetyRatings"],u),t}function Sc(e){const t={},n=is(e,["candidates"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>Tc(e))),rs(t,["candidates"],e)}const a=is(e,["createTime"]);null!=a&&rs(t,["createTime"],a);const s=is(e,["responseId"]);null!=s&&rs(t,["responseId"],s);const r=is(e,["modelVersion"]);null!=r&&rs(t,["modelVersion"],r);const i=is(e,["promptFeedback"]);null!=i&&rs(t,["promptFeedback"],i);const l=is(e,["usageMetadata"]);return null!=l&&rs(t,["usageMetadata"],l),t}function Ac(e){const t={},n=is(e,["values"]);null!=n&&rs(t,["values"],n);const a=is(e,["statistics"]);return null!=a&&rs(t,["statistics"],function(e){const t={},n=is(e,["truncated"]);null!=n&&rs(t,["truncated"],n);const a=is(e,["token_count"]);return null!=a&&rs(t,["tokenCount"],a),t}(a)),t}function Ic(e){const t={},n=is(e,["predictions[]","embeddings"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>Ac(e))),rs(t,["embeddings"],e)}const a=is(e,["metadata"]);return null!=a&&rs(t,["metadata"],function(e){const t={},n=is(e,["billableCharacterCount"]);return null!=n&&rs(t,["billableCharacterCount"],n),t}(a)),t}function Dc(e){const t={},n=is(e,["safetyAttributes","categories"]);null!=n&&rs(t,["categories"],n);const a=is(e,["safetyAttributes","scores"]);null!=a&&rs(t,["scores"],a);const s=is(e,["contentType"]);return null!=s&&rs(t,["contentType"],s),t}function Oc(e){const t={},n=is(e,["_self"]);null!=n&&rs(t,["image"],function(e){const t={},n=is(e,["gcsUri"]);null!=n&&rs(t,["gcsUri"],n);const a=is(e,["bytesBase64Encoded"]);null!=a&&rs(t,["imageBytes"],Ni(a));const s=is(e,["mimeType"]);return null!=s&&rs(t,["mimeType"],s),t}(n));const a=is(e,["raiFilteredReason"]);null!=a&&rs(t,["raiFilteredReason"],a);const s=is(e,["_self"]);null!=s&&rs(t,["safetyAttributes"],Dc(s));const r=is(e,["prompt"]);return null!=r&&rs(t,["enhancedPrompt"],r),t}function Rc(e){const t={},n=is(e,["name"]);null!=n&&rs(t,["name"],n);const a=is(e,["displayName"]);null!=a&&rs(t,["displayName"],a);const s=is(e,["description"]);null!=s&&rs(t,["description"],s);const r=is(e,["versionId"]);null!=r&&rs(t,["version"],r);const i=is(e,["deployedModels"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=is(e,["endpoint"]);null!=n&&rs(t,["name"],n);const a=is(e,["deployedModelId"]);return null!=a&&rs(t,["deployedModelId"],a),t}(e))),rs(t,["endpoints"],e)}const l=is(e,["labels"]);null!=l&&rs(t,["labels"],l);const o=is(e,["_self"]);null!=o&&rs(t,["tunedModelInfo"],function(e){const t={},n=is(e,["labels","google-vertex-llm-tuning-base-model-id"]);null!=n&&rs(t,["baseModel"],n);const a=is(e,["createTime"]);null!=a&&rs(t,["createTime"],a);const s=is(e,["updateTime"]);return null!=s&&rs(t,["updateTime"],s),t}(o));const c=is(e,["defaultCheckpointId"]);null!=c&&rs(t,["defaultCheckpointId"],c);const d=is(e,["checkpoints"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=is(e,["checkpointId"]);null!=n&&rs(t,["checkpointId"],n);const a=is(e,["epoch"]);null!=a&&rs(t,["epoch"],a);const s=is(e,["step"]);return null!=s&&rs(t,["step"],s),t}(e))),rs(t,["checkpoints"],e)}return t}function Pc(e){const t={},n=is(e,["_self"]);return null!=n&&rs(t,["video"],function(e){const t={},n=is(e,["gcsUri"]);null!=n&&rs(t,["uri"],n);const a=is(e,["bytesBase64Encoded"]);null!=a&&rs(t,["videoBytes"],Ni(a));const s=is(e,["mimeType"]);return null!=s&&rs(t,["mimeType"],s),t}(n)),t}function Mc(e){const t={},n=is(e,["name"]);null!=n&&rs(t,["name"],n);const a=is(e,["metadata"]);null!=a&&rs(t,["metadata"],a);const s=is(e,["done"]);null!=s&&rs(t,["done"],s);const r=is(e,["error"]);null!=r&&rs(t,["error"],r);const i=is(e,["response"]);return null!=i&&rs(t,["response"],function(e){const t={},n=is(e,["videos"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>Pc(e))),rs(t,["generatedVideos"],e)}const a=is(e,["raiMediaFilteredCount"]);null!=a&&rs(t,["raiMediaFilteredCount"],a);const s=is(e,["raiMediaFilteredReasons"]);return null!=s&&rs(t,["raiMediaFilteredReasons"],s),t}(i)),t}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Uc="x-goog-api-client",Lc=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class Fc{constructor(e){var t,n;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const a={};this.clientOptions.vertexai?(a.apiVersion=null!==(t=this.clientOptions.apiVersion)&&void 0!==t?t:"v1beta1",a.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(a.apiVersion=null!==(n=this.clientOptions.apiVersion)&&void 0!==n?n:"v1beta",a.baseUrl="https://generativelanguage.googleapis.com/"),a.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=a,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(a,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&"global"!==this.clientOptions.location?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:(this.clientOptions.project=void 0,this.clientOptions.location=void 0)}isVertexAI(){var e;return null!==(e=this.clientOptions.vertexai)&&void 0!==e&&e}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.apiVersion)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.baseUrl)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.headers)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||void 0===e.baseUrl||void 0===e.apiVersion)throw new Error("HTTP options are not correctly set.");const t=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&""!==e.apiVersion&&t.push(e.apiVersion),t.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol="http:"==t.protocol?"ws":"wss",t.toString()}setBaseUrl(e){if(!this.clientOptions.httpOptions)throw new Error("HTTP options are not correctly set.");this.clientOptions.httpOptions.baseUrl=e}constructUrl(e,t,n){const a=[this.getRequestUrlInternal(t)];n&&a.push(this.getBaseResourcePath()),""!==e&&a.push(e);return new URL(`${a.join("/")}`)}shouldPrependVertexProjectPath(e){return!this.clientOptions.apiKey&&(!!this.clientOptions.vertexai&&(!e.path.startsWith("projects/")&&("GET"!==e.httpMethod||!e.path.startsWith("publishers/google/models"))))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),a=this.constructUrl(e.path,t,n);if(e.queryParams)for(const[r,i]of Object.entries(e.queryParams))a.searchParams.append(r,String(i));let s={};if("GET"===e.httpMethod){if(e.body&&"{}"!==e.body)throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=e.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,t,e.abortSignal),this.unaryApiCall(a,s,e.httpMethod)}patchHttpOptions(e,t){const n=JSON.parse(JSON.stringify(e));for(const[a,s]of Object.entries(t))"object"==typeof s?n[a]=Object.assign(Object.assign({},n[a]),s):void 0!==s&&(n[a]=s);return n}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),a=this.constructUrl(e.path,t,n);a.searchParams.has("alt")&&"sse"===a.searchParams.get("alt")||a.searchParams.set("alt","sse");let s={};return s.body=e.body,s=await this.includeExtraHttpOptionsToRequestInit(s,t,e.abortSignal),this.streamApiCall(a,s,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,n){if(t&&t.timeout||n){const a=new AbortController,s=a.signal;t.timeout&&(null==t?void 0:t.timeout)>0&&setTimeout(()=>a.abort(),t.timeout),n&&n.addEventListener("abort",()=>{a.abort()}),e.signal=s}return t&&null!==t.extraBody&&function(e,t){if(!t||0===Object.keys(t).length)return;if(e.body instanceof Blob)return;let n={};if("string"==typeof e.body&&e.body.length>0)try{const t=JSON.parse(e.body);if("object"!=typeof t||null===t||Array.isArray(t))return;n=t}catch(r){return}function a(e,t){const n=Object.assign({},e);for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)){const e=t[s],r=n[s];e&&"object"==typeof e&&!Array.isArray(e)&&r&&"object"==typeof r&&!Array.isArray(r)?n[s]=a(r,e):n[s]=e}return n}const s=a(n,t);e.body=JSON.stringify(s)}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */(e,t.extraBody),e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async e=>(await Bc(e),new Or(e))).catch(e=>{throw e instanceof Error?e:new Error(JSON.stringify(e))})}async streamApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async e=>(await Bc(e),this.processStreamResponse(e))).catch(e=>{throw e instanceof Error?e:new Error(JSON.stringify(e))})}processStreamResponse(e){var t;return Il(this,arguments,function*(){const n=null===(t=null==e?void 0:e.body)||void 0===t?void 0:t.getReader(),a=new TextDecoder("utf-8");if(!n)throw new Error("Response body is empty");try{let t="";for(;;){const{done:r,value:i}=yield Al(n.read());if(r){if(t.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const l=a.decode(i);try{const e=JSON.parse(l);if("error"in e){const t=JSON.parse(JSON.stringify(e.error)),n=t.status,a=t.code,s=`got status: ${n}. ${JSON.stringify(e)}`;if(a>=400&&a<600){throw new Ll({message:s,status:a})}}}catch(s){if("ApiError"===s.name)throw s}t+=l;let o=t.match(Lc);for(;o;){const n=o[1];try{const a=new Response(n,{headers:null==e?void 0:e.headers,status:null==e?void 0:e.status,statusText:null==e?void 0:e.statusText});yield yield Al(new Or(a)),t=t.slice(o[0].length),o=t.match(Lc)}catch(s){throw new Error(`exception parsing stream chunk ${n}. ${s}`)}}}}finally{n.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(e=>{throw new Error(`exception ${e} sending request`)})}getDefaultHeaders(){const e={},t="google-genai-sdk/1.7.0 "+this.clientOptions.userAgentExtra;return e["User-Agent"]=t,e[Uc]=t,e["Content-Type"]="application/json",e}async getHeadersInternal(e){const t=new Headers;if(e&&e.headers){for(const[n,a]of Object.entries(e.headers))t.append(n,a);e.timeout&&e.timeout>0&&t.append("X-Server-Timeout",String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var n;const a={};null!=t&&(a.mimeType=t.mimeType,a.name=t.name,a.displayName=t.displayName),a.name&&!a.name.startsWith("files/")&&(a.name=`files/${a.name}`);const s=this.clientOptions.uploader,r=await s.stat(e);a.sizeBytes=String(r.size);const i=null!==(n=null==t?void 0:t.mimeType)&&void 0!==n?n:r.type;if(void 0===i||""===i)throw new Error("Can not determine mimeType. Please provide mimeType in the config.");a.mimeType=i;const l=await this.fetchUploadUrl(a,t);return s.upload(e,l,this)}async downloadFile(e){const t=this.clientOptions.downloader;await t.download(e,this)}async fetchUploadUrl(e,t){var n;let a={};a=(null==t?void 0:t.httpOptions)?t.httpOptions:{apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const s={file:e},r=await this.request({path:ss("upload/v1beta/files",s._url),body:JSON.stringify(s),httpMethod:"POST",httpOptions:a});if(!r||!(null==r?void 0:r.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const i=null===(n=null==r?void 0:r.headers)||void 0===n?void 0:n["x-goog-upload-url"];if(void 0===i)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return i}}async function Bc(e){var t;if(void 0===e)throw new Error("response is undefined");if(!e.ok){const n=e.status;let a;a=(null===(t=e.headers.get("content-type"))||void 0===t?void 0:t.includes("application/json"))?await e.json():{error:{message:await e.text(),code:e.status,status:e.statusText}};const s=JSON.stringify(a);if(n>=400&&n<600){throw new Ll({message:s,status:n})}throw new Error(s)}}function $c(e){for(const t of e){if(Vc(t))return!0;if("object"==typeof t&&"inputSchema"in t)return!0}return!1}function Gc(e){var t;const n=null!==(t=e[Uc])&&void 0!==t?t:"";e[Uc]=(n+" mcp_used/unknown").trimStart()}function Vc(e){return null!==e&&"object"==typeof e&&e instanceof Wc}function zc(e,t=100){return Il(this,arguments,function*(){let n,a=0;for(;a<t;){const t=yield Al(e.listTools({cursor:n}));for(const e of t.tools)yield yield Al(e),a++;if(!t.nextCursor)break;n=t.nextCursor}})}class Wc{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new Wc(e,t)}async initialize(){var e,t,n,a;if(this.mcpTools.length>0)return;const s={},r=[];for(const d of this.mcpClients)try{for(var i,l=!0,o=(t=void 0,Dl(zc(d)));!(e=(i=await o.next()).done);l=!0){a=i.value,l=!1;const e=a;r.push(e);const t=e.name;if(s[t])throw new Error(`Duplicate function name ${t} found in MCP tools. Please ensure function names are unique.`);s[t]=d}}catch(c){t={error:c}}finally{try{l||e||!(n=o.return)||await n.call(o)}finally{if(t)throw t.error}}this.mcpTools=r,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),function(e,t={}){const n=[],a=new Set;for(const s of e){const e=s.name;if(a.has(e))throw new Error(`Duplicate function name ${e} found in MCP tools. Please ensure function names are unique.`);a.add(e);const r=Ci(s,t);r.functionDeclarations&&n.push(...r.functionDeclarations)}return{functionDeclarations:n}}(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const n of e)if(n.name in this.functionNameToMcpClient){const e=this.functionNameToMcpClient[n.name];let a;this.config.timeout&&(a={timeout:this.config.timeout});const s=await e.callTool({name:n.name,arguments:n.args},void 0,a);t.push({functionResponse:{name:n.name,response:s.isError?{error:s}:s}})}return t}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class qc{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n}async connect(e){var t,n;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");const a=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),r=function(e){const t=new Headers;for(const[n,a]of Object.entries(e))t.append(n,a);return t}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */(this.apiClient.getDefaultHeaders()),i=`${a}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${this.apiClient.getApiKey()}`;let l=()=>{};const o=new Promise(e=>{l=e}),c=e.callbacks,d=(this.apiClient,{onopen:function(){l({})},onmessage:e=>{!async function(e,t,n){const a=new Zr;let s;s=n.data instanceof Blob?JSON.parse(await n.data.text()):JSON.parse(n.data);const r=Io(s);Object.assign(a,r),t(a)}(0,c.onmessage,e)},onerror:null!==(t=null==c?void 0:c.onerror)&&void 0!==t?t:function(e){},onclose:null!==(n=null==c?void 0:c.onclose)&&void 0!==n?n:function(e){}}),u=this.webSocketFactory.create(i,function(e){const t={};return e.forEach((e,n)=>{t[n]=e}),t}(r),d);u.connect(),await o;const m=fo({setup:mo({model:Qr(this.apiClient,e.model)})});return u.send(JSON.stringify(m)),new Hc(u,this.apiClient)}}class Hc{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||0===Object.keys(e.weightedPrompts).length)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=po(function(e){const t={},n=is(e,["weightedPrompts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>co(e))),rs(t,["weightedPrompts"],e)}return t}(e));this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=fo(function(e){const t={},n=is(e,["musicGenerationConfig"]);return null!=n&&rs(t,["musicGenerationConfig"],uo(n)),t}(e));this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t=fo({playbackControl:e});this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Ir.PLAY)}pause(){this.sendPlaybackControl(Ir.PAUSE)}stop(){this.sendPlaybackControl(Ir.STOP)}resetContext(){this.sendPlaybackControl(Ir.RESET_CONTEXT)}close(){this.conn.close()}}class Kc{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n,this.music=new qc(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,n,a,s,r,i;const l=this.apiClient.getWebsocketBaseUrl(),o=this.apiClient.getApiVersion();let c;const d=this.apiClient.getDefaultHeaders();e.config&&e.config.tools&&$c(e.config.tools)&&Gc(d);const u=function(e){const t=new Headers;for(const[n,a]of Object.entries(e))t.append(n,a);return t}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */(d);if(this.apiClient.isVertexAI())c=`${l}/ws/google.cloud.aiplatform.${o}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(u);else{const e=this.apiClient.getApiKey();let t="BidiGenerateContent",n="key";(null==e?void 0:e.startsWith("auth_tokens/"))&&(t="BidiGenerateContentConstrained",n="access_token"),c=`${l}/ws/google.ai.generativelanguage.${o}.GenerativeService.${t}?${n}=${e}`}let m=()=>{};const p=new Promise(e=>{m=e}),f=e.callbacks,h=this.apiClient,g={onopen:function(){var e;null===(e=null==f?void 0:f.onopen)||void 0===e||e.call(f),m({})},onmessage:e=>{!async function(e,t,n){const a=new Jr;let s;s=n.data instanceof Blob?await n.data.text():n.data instanceof ArrayBuffer?(new TextDecoder).decode(n.data):n.data;const r=JSON.parse(s);if(e.isVertexAI()){const e=_o(r);Object.assign(a,e)}else{const e=Co(r);Object.assign(a,e)}t(a)}(h,f.onmessage,e)},onerror:null!==(t=null==f?void 0:f.onerror)&&void 0!==t?t:function(e){},onclose:null!==(n=null==f?void 0:f.onclose)&&void 0!==n?n:function(e){}},x=this.webSocketFactory.create(c,function(e){const t={};return e.forEach((e,n)=>{t[n]=e}),t}(u),g);x.connect(),await p;let y=Qr(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&y.startsWith("publishers/")){y=`projects/${this.apiClient.getProject()}/locations/${this.apiClient.getLocation()}/`+y}let b={};this.apiClient.isVertexAI()&&void 0===(null===(a=e.config)||void 0===a?void 0:a.responseModalities)&&(void 0===e.config?e.config={responseModalities:[Os.AUDIO]}:e.config.responseModalities=[Os.AUDIO]),null===(s=e.config)||void 0===s||s.generationConfig;const v=null!==(i=null===(r=e.config)||void 0===r?void 0:r.tools)&&void 0!==i?i:[],N=[];for(const k of v)if(this.isCallableTool(k)){const e=k;N.push(await e.tool())}else N.push(k);N.length>0&&(e.config.tools=N);const w={model:y,config:e.config,callbacks:e.callbacks};return b=this.apiClient.isVertexAI()?function(e,t){const n={},a=is(t,["model"]);null!=a&&rs(n,["setup","model"],Qr(e,a));const s=is(t,["config"]);return null!=s&&rs(n,["config"],io(s,n)),n}(this.apiClient,w):function(e,t){const n={},a=is(t,["model"]);null!=a&&rs(n,["setup","model"],Qr(e,a));const s=is(t,["config"]);return null!=s&&rs(n,["config"],ro(s,n)),n}(this.apiClient,w),delete b.config,x.send(JSON.stringify(b)),new Jc(x,this.apiClient)}isCallableTool(e){return"callTool"in e&&"function"==typeof e.callTool}}const Yc={turnComplete:!0};class Jc{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(null!==t.turns&&void 0!==t.turns){let a=[];try{a=ci(t.turns),a=e.isVertexAI()?a.map(e=>Jo(e)):a.map(e=>Oo(e))}catch(n){throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:a,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let n=[];if(null==t.functionResponses)throw new Error("functionResponses is required.");if(n=Array.isArray(t.functionResponses)?t.functionResponses:[t.functionResponses],0===n.length)throw new Error("functionResponses is required.");for(const a of n){if("object"!=typeof a||null===a||!("name"in a)||!("response"in a))throw new Error(`Could not parse function response, type '${typeof a}'.`);if(!e.isVertexAI()&&!("id"in a))throw new Error("FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.")}return{toolResponse:{functionResponses:n}}}sendClientContent(e){e=Object.assign(Object.assign({},Yc),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};t=this.apiClient.isVertexAI()?{realtimeInput:oo(e)}:{realtimeInput:lo(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(null==e.functionResponses)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function Zc(e){var t,n,a;if(null===(t=null==e?void 0:e.automaticFunctionCalling)||void 0===t?void 0:t.disable)return!0;let s=!1;for(const i of null!==(n=null==e?void 0:e.tools)&&void 0!==n?n:[])if(Qc(i)){s=!0;break}if(!s)return!0;const r=null===(a=null==e?void 0:e.automaticFunctionCalling)||void 0===a?void 0:a.maximumRemoteCalls;return!!(r&&(r<0||!Number.isInteger(r))||0==r)}function Qc(e){return"callTool"in e&&"function"==typeof e.callTool}function Xc(e){var t;return!(null===(t=null==e?void 0:e.automaticFunctionCalling)||void 0===t?void 0:t.ignoreCallHistory)}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ed extends as{constructor(e){super(),this.apiClient=e,this.generateContent=async e=>{var t,n,a,s,r;const i=await this.processParamsForMcpUsage(e);if(!function(e){var t,n,a;return null!==(a=null===(n=null===(t=e.config)||void 0===t?void 0:t.tools)||void 0===n?void 0:n.some(e=>Vc(e)))&&void 0!==a&&a}(e)||Zc(e.config))return await this.generateContentInternal(i);if(function(e){var t,n,a;return null!==(a=null===(n=null===(t=e.config)||void 0===t?void 0:t.tools)||void 0===n?void 0:n.some(e=>!Vc(e)))&&void 0!==a&&a}(e))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let l,o;const c=ci(i.contents),d=null!==(a=null===(n=null===(t=i.config)||void 0===t?void 0:t.automaticFunctionCalling)||void 0===n?void 0:n.maximumRemoteCalls)&&void 0!==a?a:10;let u=0;for(;u<d&&(l=await this.generateContentInternal(i),l.functionCalls&&0!==l.functionCalls.length);){const t=l.candidates[0].content,n=[];for(const a of null!==(r=null===(s=e.config)||void 0===s?void 0:s.tools)&&void 0!==r?r:[])if(Qc(a)){const e=a,t=await e.callTool(l.functionCalls);n.push(...t)}u++,o={role:"user",parts:n},i.contents=ci(i.contents),i.contents.push(t),i.contents.push(o),Xc(i.config)&&(c.push(t),c.push(o))}return Xc(i.config)&&(l.automaticFunctionCallingHistory=c),l},this.generateContentStream=async e=>{if(Zc(e.config)){const t=await this.processParamsForMcpUsage(e);return await this.generateContentStreamInternal(t)}return await this.processAfcStream(e)},this.generateImages=async e=>await this.generateImagesInternal(e).then(e=>{var t;let n;const a=[];if(null==e?void 0:e.generatedImages)for(const r of e.generatedImages)r&&(null==r?void 0:r.safetyAttributes)&&"Positive Prompt"===(null===(t=null==r?void 0:r.safetyAttributes)||void 0===t?void 0:t.contentType)?n=null==r?void 0:r.safetyAttributes:a.push(r);let s;return s=n?{generatedImages:a,positivePromptSafetyAttributes:n}:{generatedImages:a},s}),this.list=async e=>{var t;const n={config:Object.assign(Object.assign({},{queryBase:!0}),null==e?void 0:e.config)};if(this.apiClient.isVertexAI()&&!n.config.queryBase){if(null===(t=n.config)||void 0===t?void 0:t.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");n.config.filter="labels.tune-type:*"}return new al(tl.PAGED_ITEM_MODELS,e=>this.listInternal(e),await this.listInternal(n),n)},this.editImage=async e=>{const t={model:e.model,prompt:e.prompt,referenceImages:[],config:e.config};return e.referenceImages&&e.referenceImages&&(t.referenceImages=e.referenceImages.map(e=>e.toReferenceImageAPI())),await this.editImageInternal(t)},this.upscaleImage=async e=>{let t={numberOfImages:1,mode:"upscale"};e.config&&(t=Object.assign(Object.assign({},t),e.config));const n={model:e.model,image:e.image,upscaleFactor:e.upscaleFactor,config:t};return await this.upscaleImageInternal(n)}}async processParamsForMcpUsage(e){var t,n,a;const s=null===(t=e.config)||void 0===t?void 0:t.tools;if(!s)return e;const r=await Promise.all(s.map(async e=>{if(Qc(e)){const t=e;return await t.tool()}return e})),i={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:r})};if(i.config.tools=r,e.config&&e.config.tools&&$c(e.config.tools)){const t=null!==(a=null===(n=e.config.httpOptions)||void 0===n?void 0:n.headers)&&void 0!==a?a:{};let s=Object.assign({},t);0===Object.keys(s).length&&(s=this.apiClient.getDefaultHeaders()),Gc(s),i.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:s})}return i}async initAfcToolsMap(e){var t,n,a;const s=new Map;for(const r of null!==(n=null===(t=e.config)||void 0===t?void 0:t.tools)&&void 0!==n?n:[])if(Qc(r)){const e=r,t=await e.tool();for(const n of null!==(a=t.functionDeclarations)&&void 0!==a?a:[]){if(!n.name)throw new Error("Function declaration name is required.");if(s.has(n.name))throw new Error(`Duplicate tool declaration name: ${n.name}`);s.set(n.name,e)}}return s}async processAfcStream(e){var t,n,a;const s=null!==(a=null===(n=null===(t=e.config)||void 0===t?void 0:t.automaticFunctionCalling)||void 0===n?void 0:n.maximumRemoteCalls)&&void 0!==a?a:10;let r=!1,i=0;return function(e,t,n){var a,l;return Il(this,arguments,function*(){for(var o,c,d,u;i<s;){r&&(i++,r=!1);const g=yield Al(e.processParamsForMcpUsage(n)),x=yield Al(e.generateContentStreamInternal(g)),y=[],b=[];try{for(var m,p=!0,f=(c=void 0,Dl(x));!(o=(m=yield Al(f.next())).done);p=!0){u=m.value,p=!1;const e=u;if(yield yield Al(e),e.candidates&&(null===(a=e.candidates[0])||void 0===a?void 0:a.content)){b.push(e.candidates[0].content);for(const n of null!==(l=e.candidates[0].content.parts)&&void 0!==l?l:[])if(i<s&&n.functionCall){if(!n.functionCall.name)throw new Error("Function call name was not returned by the model.");if(!t.has(n.functionCall.name))throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${t.keys()}, mising tool: ${n.functionCall.name}`);{const e=yield Al(t.get(n.functionCall.name).callTool([n.functionCall]));y.push(...e)}}}}}catch(h){c={error:h}}finally{try{p||o||!(d=f.return)||(yield Al(d.call(f)))}finally{if(c)throw c.error}}if(!(y.length>0))break;{r=!0;const e=new Rr;e.candidates=[{content:{role:"user",parts:y}}],yield yield Al(e);const t=[];t.push(...b),t.push({role:"user",parts:y});const a=ci(n.contents).concat(t);n.contents=a}}})}(this,await this.initAfcToolsMap(e),e)}async generateContentInternal(e){var t,n,a,s;let r,i="",l={};if(this.apiClient.isVertexAI()){const a=rc(this.apiClient,e);return i=ss("{model}:generateContent",a._url),l=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>{const t=Sc(e),n=new Rr;return Object.assign(n,t),n})}{const t=Go(this.apiClient,e);return i=ss("{model}:generateContent",t._url),l=t._query,delete t.config,delete t._url,delete t._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(a=e.config)||void 0===a?void 0:a.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json()),r.then(e=>{const t=bc(e),n=new Rr;return Object.assign(n,t),n})}}async generateContentStreamInternal(e){var t,n,a,s;let r,i="",l={};if(this.apiClient.isVertexAI()){const a=rc(this.apiClient,e);i=ss("{model}:streamGenerateContent?alt=sse",a._url),l=a._query,delete a.config,delete a._url,delete a._query;return r=this.apiClient.requestStream({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}),r.then(function(e){return Il(this,arguments,function*(){var t,n,a,s;try{for(var r,i=!0,l=Dl(e);!(t=(r=yield Al(l.next())).done);i=!0){s=r.value,i=!1;const e=s,t=Sc(yield Al(e.json())),n=new Rr;Object.assign(n,t),yield yield Al(n)}}catch(o){n={error:o}}finally{try{i||t||!(a=l.return)||(yield Al(a.call(l)))}finally{if(n)throw n.error}}})})}{const t=Go(this.apiClient,e);i=ss("{model}:streamGenerateContent?alt=sse",t._url),l=t._query,delete t.config,delete t._url,delete t._query;return r=this.apiClient.requestStream({path:i,queryParams:l,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(a=e.config)||void 0===a?void 0:a.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}),r.then(function(e){return Il(this,arguments,function*(){var t,n,a,s;try{for(var r,i=!0,l=Dl(e);!(t=(r=yield Al(l.next())).done);i=!0){s=r.value,i=!1;const e=s,t=bc(yield Al(e.json())),n=new Rr;Object.assign(n,t),yield yield Al(n)}}catch(o){n={error:o}}finally{try{i||t||!(a=l.return)||(yield Al(a.call(l)))}finally{if(n)throw n.error}}})})}}async embedContent(e){var t,n,a,s;let r,i="",l={};if(this.apiClient.isVertexAI()){const a=ic(this.apiClient,e);return i=ss("{model}:predict",a._url),l=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>{const t=Ic(e),n=new Pr;return Object.assign(n,t),n})}{const t=Vo(this.apiClient,e);return i=ss("{model}:batchEmbedContents",t._url),l=t._query,delete t.config,delete t._url,delete t._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(a=e.config)||void 0===a?void 0:a.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json()),r.then(e=>{const t=vc(e),n=new Pr;return Object.assign(n,t),n})}}async generateImagesInternal(e){var t,n,a,s;let r,i="",l={};if(this.apiClient.isVertexAI()){const a=lc(this.apiClient,e);return i=ss("{model}:predict",a._url),l=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>{const t=function(e){const t={},n=is(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>Oc(e))),rs(t,["generatedImages"],e)}const a=is(e,["positivePromptSafetyAttributes"]);return null!=a&&rs(t,["positivePromptSafetyAttributes"],Dc(a)),t}(e),n=new Mr;return Object.assign(n,t),n})}{const t=zo(this.apiClient,e);return i=ss("{model}:predict",t._url),l=t._query,delete t.config,delete t._url,delete t._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(a=e.config)||void 0===a?void 0:a.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json()),r.then(e=>{const t=function(e){const t={},n=is(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>wc(e))),rs(t,["generatedImages"],e)}const a=is(e,["positivePromptSafetyAttributes"]);return null!=a&&rs(t,["positivePromptSafetyAttributes"],Nc(a)),t}(e),n=new Mr;return Object.assign(n,t),n})}}async editImageInternal(e){var t,n;let a,s="",r={};if(this.apiClient.isVertexAI()){const i=dc(this.apiClient,e);return s=ss("{model}:predict",i._url),r=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),a.then(e=>{const t=function(e){const t={},n=is(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>Oc(e))),rs(t,["generatedImages"],e)}return t}(e),n=new Ur;return Object.assign(n,t),n})}throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,n;let a,s="",r={};if(this.apiClient.isVertexAI()){const i=uc(this.apiClient,e);return s=ss("{model}:predict",i._url),r=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),a.then(e=>{const t=function(e){const t={},n=is(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>Oc(e))),rs(t,["generatedImages"],e)}return t}(e),n=new Lr;return Object.assign(n,t),n})}throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,n,a,s;let r,i="",l={};if(this.apiClient.isVertexAI()){const a=function(e,t){const n={},a=is(t,["model"]);null!=a&&rs(n,["_url","name"],Qr(e,a));const s=is(t,["config"]);return null!=s&&rs(n,["config"],s),n}(this.apiClient,e);return i=ss("{name}",a._url),l=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>Rc(e))}{const t=function(e,t){const n={},a=is(t,["model"]);null!=a&&rs(n,["_url","name"],Qr(e,a));const s=is(t,["config"]);return null!=s&&rs(n,["config"],s),n}(this.apiClient,e);return i=ss("{name}",t._url),l=t._query,delete t.config,delete t._url,delete t._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(a=e.config)||void 0===a?void 0:a.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json()),r.then(e=>kc(e))}}async listInternal(e){var t,n,a,s;let r,i="",l={};if(this.apiClient.isVertexAI()){const a=mc(this.apiClient,e);return i=ss("{models_url}",a._url),l=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>{const t=function(e,t){const n={},a=is(t,["nextPageToken"]);null!=a&&rs(n,["nextPageToken"],a);const s=is(t,["_self"]);if(null!=s){let e=Ei(s);Array.isArray(e)&&(e=e.map(e=>Rc(e))),rs(n,["models"],e)}return n}(this.apiClient,e),n=new Fr;return Object.assign(n,t),n})}{const t=Wo(this.apiClient,e);return i=ss("{models_url}",t._url),l=t._query,delete t.config,delete t._url,delete t._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(a=e.config)||void 0===a?void 0:a.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json()),r.then(e=>{const t=function(e,t){const n={},a=is(t,["nextPageToken"]);null!=a&&rs(n,["nextPageToken"],a);const s=is(t,["_self"]);if(null!=s){let e=Ei(s);Array.isArray(e)&&(e=e.map(e=>kc(e))),rs(n,["models"],e)}return n}(this.apiClient,e),n=new Fr;return Object.assign(n,t),n})}}async update(e){var t,n,a,s;let r,i="",l={};if(this.apiClient.isVertexAI()){const a=pc(this.apiClient,e);return i=ss("{model}",a._url),l=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"PATCH",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>Rc(e))}{const t=qo(this.apiClient,e);return i=ss("{name}",t._url),l=t._query,delete t.config,delete t._url,delete t._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(t),httpMethod:"PATCH",httpOptions:null===(a=e.config)||void 0===a?void 0:a.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json()),r.then(e=>kc(e))}}async delete(e){var t,n,a,s;let r,i="",l={};if(this.apiClient.isVertexAI()){const a=function(e,t){const n={},a=is(t,["model"]);null!=a&&rs(n,["_url","name"],Qr(e,a));const s=is(t,["config"]);return null!=s&&rs(n,["config"],s),n}(this.apiClient,e);return i=ss("{name}",a._url),l=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(()=>{const e={},t=new Br;return Object.assign(t,e),t})}{const t=function(e,t){const n={},a=is(t,["model"]);null!=a&&rs(n,["_url","name"],Qr(e,a));const s=is(t,["config"]);return null!=s&&rs(n,["config"],s),n}(this.apiClient,e);return i=ss("{name}",t._url),l=t._query,delete t.config,delete t._url,delete t._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(a=e.config)||void 0===a?void 0:a.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json()),r.then(()=>{const e={},t=new Br;return Object.assign(t,e),t})}}async countTokens(e){var t,n,a,s;let r,i="",l={};if(this.apiClient.isVertexAI()){const a=fc(this.apiClient,e);return i=ss("{model}:countTokens",a._url),l=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>{const t=function(e){const t={},n=is(e,["totalTokens"]);return null!=n&&rs(t,["totalTokens"],n),t}(e),n=new $r;return Object.assign(n,t),n})}{const t=Ho(this.apiClient,e);return i=ss("{model}:countTokens",t._url),l=t._query,delete t.config,delete t._url,delete t._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(a=e.config)||void 0===a?void 0:a.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json()),r.then(e=>{const t=function(e){const t={},n=is(e,["totalTokens"]);null!=n&&rs(t,["totalTokens"],n);const a=is(e,["cachedContentTokenCount"]);return null!=a&&rs(t,["cachedContentTokenCount"],a),t}(e),n=new $r;return Object.assign(n,t),n})}}async computeTokens(e){var t,n;let a,s="",r={};if(this.apiClient.isVertexAI()){const i=function(e,t){const n={},a=is(t,["model"]);null!=a&&rs(n,["_url","model"],Qr(e,a));const s=is(t,["contents"]);if(null!=s){let e=ci(s);Array.isArray(e)&&(e=e.map(e=>Jo(e))),rs(n,["contents"],e)}const r=is(t,["config"]);return null!=r&&rs(n,["config"],r),n}(this.apiClient,e);return s=ss("{model}:computeTokens",i._url),r=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),a.then(e=>{const t=function(e){const t={},n=is(e,["tokensInfo"]);return null!=n&&rs(t,["tokensInfo"],n),t}(e),n=new Gr;return Object.assign(n,t),n})}throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var t,n,a,s;let r,i="",l={};if(this.apiClient.isVertexAI()){const a=hc(this.apiClient,e);return i=ss("{model}:predictLongRunning",a._url),l=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>Mc(e))}{const t=Ko(this.apiClient,e);return i=ss("{model}:predictLongRunning",t._url),l=t._query,delete t.config,delete t._url,delete t._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(a=e.config)||void 0===a?void 0:a.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json()),r.then(e=>jc(e))}}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function td(e){const t={},n=is(e,["_self"]);return null!=n&&rs(t,["video"],function(e){const t={},n=is(e,["video","uri"]);null!=n&&rs(t,["uri"],n);const a=is(e,["video","encodedVideo"]);null!=a&&rs(t,["videoBytes"],Ni(a));const s=is(e,["encoding"]);return null!=s&&rs(t,["mimeType"],s),t}(n)),t}function nd(e){const t={},n=is(e,["name"]);null!=n&&rs(t,["name"],n);const a=is(e,["metadata"]);null!=a&&rs(t,["metadata"],a);const s=is(e,["done"]);null!=s&&rs(t,["done"],s);const r=is(e,["error"]);null!=r&&rs(t,["error"],r);const i=is(e,["response","generateVideoResponse"]);return null!=i&&rs(t,["response"],function(e){const t={},n=is(e,["generatedSamples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>td(e))),rs(t,["generatedVideos"],e)}const a=is(e,["raiMediaFilteredCount"]);null!=a&&rs(t,["raiMediaFilteredCount"],a);const s=is(e,["raiMediaFilteredReasons"]);return null!=s&&rs(t,["raiMediaFilteredReasons"],s),t}(i)),t}function ad(e){const t={},n=is(e,["_self"]);return null!=n&&rs(t,["video"],function(e){const t={},n=is(e,["gcsUri"]);null!=n&&rs(t,["uri"],n);const a=is(e,["bytesBase64Encoded"]);null!=a&&rs(t,["videoBytes"],Ni(a));const s=is(e,["mimeType"]);return null!=s&&rs(t,["mimeType"],s),t}(n)),t}function sd(e){const t={},n=is(e,["name"]);null!=n&&rs(t,["name"],n);const a=is(e,["metadata"]);null!=a&&rs(t,["metadata"],a);const s=is(e,["done"]);null!=s&&rs(t,["done"],s);const r=is(e,["error"]);null!=r&&rs(t,["error"],r);const i=is(e,["response"]);return null!=i&&rs(t,["response"],function(e){const t={},n=is(e,["videos"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>ad(e))),rs(t,["generatedVideos"],e)}const a=is(e,["raiMediaFilteredCount"]);null!=a&&rs(t,["raiMediaFilteredCount"],a);const s=is(e,["raiMediaFilteredReasons"]);return null!=s&&rs(t,["raiMediaFilteredReasons"],s),t}(i)),t}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class rd extends as{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,n=e.config;if(void 0===t.name||""===t.name)throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const e=t.name.split("/operations/")[0];let a;return n&&"httpOptions"in n&&(a=n.httpOptions),this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:e,config:{httpOptions:a}})}return this.getVideosOperationInternal({operationName:t.name,config:n})}async getVideosOperationInternal(e){var t,n,a,s;let r,i="",l={};if(this.apiClient.isVertexAI()){const a=function(e){const t={},n=is(e,["operationName"]);null!=n&&rs(t,["_url","operationName"],n);const a=is(e,["config"]);return null!=a&&rs(t,["config"],a),t}(e);return i=ss("{operationName}",a._url),l=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>sd(e))}{const t=function(e){const t={},n=is(e,["operationName"]);null!=n&&rs(t,["_url","operationName"],n);const a=is(e,["config"]);return null!=a&&rs(t,["config"],a),t}(e);return i=ss("{operationName}",t._url),l=t._query,delete t.config,delete t._url,delete t._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(a=e.config)||void 0===a?void 0:a.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json()),r.then(e=>nd(e))}}async fetchPredictVideosOperationInternal(e){var t,n;let a,s="",r={};if(this.apiClient.isVertexAI()){const i=function(e){const t={},n=is(e,["operationName"]);null!=n&&rs(t,["operationName"],n);const a=is(e,["resourceName"]);null!=a&&rs(t,["_url","resourceName"],a);const s=is(e,["config"]);return null!=s&&rs(t,["config"],s),t}(e);return s=ss("{resourceName}:fetchPredictOperation",i._url),r=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),a.then(e=>sd(e))}throw new Error("This method is only supported by the Vertex AI.")}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function id(e){const t={},n=is(e,["prebuiltVoiceConfig"]);return null!=n&&rs(t,["prebuiltVoiceConfig"],function(e){const t={},n=is(e,["voiceName"]);return null!=n&&rs(t,["voiceName"],n),t}(n)),t}function ld(e){const t={},n=is(e,["speakerVoiceConfigs"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=is(e,["speaker"]);null!=n&&rs(t,["speaker"],n);const a=is(e,["voiceConfig"]);return null!=a&&rs(t,["voiceConfig"],id(a)),t}(e))),rs(t,["speakerVoiceConfigs"],e)}return t}function od(e){const t={},n=is(e,["videoMetadata"]);null!=n&&rs(t,["videoMetadata"],function(e){const t={},n=is(e,["fps"]);null!=n&&rs(t,["fps"],n);const a=is(e,["endOffset"]);null!=a&&rs(t,["endOffset"],a);const s=is(e,["startOffset"]);return null!=s&&rs(t,["startOffset"],s),t}(n));const a=is(e,["thought"]);null!=a&&rs(t,["thought"],a);const s=is(e,["inlineData"]);null!=s&&rs(t,["inlineData"],function(e){const t={};if(void 0!==is(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=is(e,["data"]);null!=n&&rs(t,["data"],n);const a=is(e,["mimeType"]);return null!=a&&rs(t,["mimeType"],a),t}(s));const r=is(e,["fileData"]);null!=r&&rs(t,["fileData"],function(e){const t={};if(void 0!==is(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=is(e,["fileUri"]);null!=n&&rs(t,["fileUri"],n);const a=is(e,["mimeType"]);return null!=a&&rs(t,["mimeType"],a),t}(r));const i=is(e,["thoughtSignature"]);null!=i&&rs(t,["thoughtSignature"],i);const l=is(e,["codeExecutionResult"]);null!=l&&rs(t,["codeExecutionResult"],l);const o=is(e,["executableCode"]);null!=o&&rs(t,["executableCode"],o);const c=is(e,["functionCall"]);null!=c&&rs(t,["functionCall"],c);const d=is(e,["functionResponse"]);null!=d&&rs(t,["functionResponse"],d);const u=is(e,["text"]);return null!=u&&rs(t,["text"],u),t}function cd(e){const t={},n=is(e,["timeRangeFilter"]);return null!=n&&rs(t,["timeRangeFilter"],function(e){const t={},n=is(e,["startTime"]);null!=n&&rs(t,["startTime"],n);const a=is(e,["endTime"]);return null!=a&&rs(t,["endTime"],a),t}(n)),t}function dd(e){const t={},n=is(e,["dynamicRetrievalConfig"]);return null!=n&&rs(t,["dynamicRetrievalConfig"],function(e){const t={},n=is(e,["mode"]);null!=n&&rs(t,["mode"],n);const a=is(e,["dynamicThreshold"]);return null!=a&&rs(t,["dynamicThreshold"],a),t}(n)),t}function ud(e){const t={},n=is(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=is(e,["behavior"]);null!=n&&rs(t,["behavior"],n);const a=is(e,["description"]);null!=a&&rs(t,["description"],a);const s=is(e,["name"]);null!=s&&rs(t,["name"],s);const r=is(e,["parameters"]);null!=r&&rs(t,["parameters"],r);const i=is(e,["parametersJsonSchema"]);null!=i&&rs(t,["parametersJsonSchema"],i);const l=is(e,["response"]);null!=l&&rs(t,["response"],l);const o=is(e,["responseJsonSchema"]);return null!=o&&rs(t,["responseJsonSchema"],o),t}(e))),rs(t,["functionDeclarations"],e)}if(void 0!==is(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const a=is(e,["googleSearch"]);null!=a&&rs(t,["googleSearch"],cd(a));const s=is(e,["googleSearchRetrieval"]);if(null!=s&&rs(t,["googleSearchRetrieval"],dd(s)),void 0!==is(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==is(e,["googleMaps"]))throw new Error("googleMaps parameter is not supported in Gemini API.");null!=is(e,["urlContext"])&&rs(t,["urlContext"],{});const r=is(e,["codeExecution"]);return null!=r&&rs(t,["codeExecution"],r),t}function md(e){const t={},n=is(e,["automaticActivityDetection"]);null!=n&&rs(t,["automaticActivityDetection"],function(e){const t={},n=is(e,["disabled"]);null!=n&&rs(t,["disabled"],n);const a=is(e,["startOfSpeechSensitivity"]);null!=a&&rs(t,["startOfSpeechSensitivity"],a);const s=is(e,["endOfSpeechSensitivity"]);null!=s&&rs(t,["endOfSpeechSensitivity"],s);const r=is(e,["prefixPaddingMs"]);null!=r&&rs(t,["prefixPaddingMs"],r);const i=is(e,["silenceDurationMs"]);return null!=i&&rs(t,["silenceDurationMs"],i),t}(n));const a=is(e,["activityHandling"]);null!=a&&rs(t,["activityHandling"],a);const s=is(e,["turnCoverage"]);return null!=s&&rs(t,["turnCoverage"],s),t}function pd(e){const t={},n=is(e,["triggerTokens"]);null!=n&&rs(t,["triggerTokens"],n);const a=is(e,["slidingWindow"]);return null!=a&&rs(t,["slidingWindow"],function(e){const t={},n=is(e,["targetTokens"]);return null!=n&&rs(t,["targetTokens"],n),t}(a)),t}function fd(e,t){const n=is(e,["generationConfig"]);void 0!==t&&null!=n&&rs(t,["setup","generationConfig"],n);const a=is(e,["responseModalities"]);void 0!==t&&null!=a&&rs(t,["setup","generationConfig","responseModalities"],a);const s=is(e,["temperature"]);void 0!==t&&null!=s&&rs(t,["setup","generationConfig","temperature"],s);const r=is(e,["topP"]);void 0!==t&&null!=r&&rs(t,["setup","generationConfig","topP"],r);const i=is(e,["topK"]);void 0!==t&&null!=i&&rs(t,["setup","generationConfig","topK"],i);const l=is(e,["maxOutputTokens"]);void 0!==t&&null!=l&&rs(t,["setup","generationConfig","maxOutputTokens"],l);const o=is(e,["mediaResolution"]);void 0!==t&&null!=o&&rs(t,["setup","generationConfig","mediaResolution"],o);const c=is(e,["seed"]);void 0!==t&&null!=c&&rs(t,["setup","generationConfig","seed"],c);const d=is(e,["speechConfig"]);void 0!==t&&null!=d&&rs(t,["setup","generationConfig","speechConfig"],function(e){const t={},n=is(e,["voiceConfig"]);null!=n&&rs(t,["voiceConfig"],id(n));const a=is(e,["multiSpeakerVoiceConfig"]);null!=a&&rs(t,["multiSpeakerVoiceConfig"],ld(a));const s=is(e,["languageCode"]);return null!=s&&rs(t,["languageCode"],s),t}(gi(d)));const u=is(e,["enableAffectiveDialog"]);void 0!==t&&null!=u&&rs(t,["setup","generationConfig","enableAffectiveDialog"],u);const m=is(e,["systemInstruction"]);void 0!==t&&null!=m&&rs(t,["setup","systemInstruction"],function(e){const t={},n=is(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>od(e))),rs(t,["parts"],e)}const a=is(e,["role"]);return null!=a&&rs(t,["role"],a),t}(li(m)));const p=is(e,["tools"]);if(void 0!==t&&null!=p){let e=yi(p);Array.isArray(e)&&(e=e.map(e=>ud(xi(e)))),rs(t,["setup","tools"],e)}const f=is(e,["sessionResumption"]);void 0!==t&&null!=f&&rs(t,["setup","sessionResumption"],function(e){const t={},n=is(e,["handle"]);if(null!=n&&rs(t,["handle"],n),void 0!==is(e,["transparent"]))throw new Error("transparent parameter is not supported in Gemini API.");return t}(f));const h=is(e,["inputAudioTranscription"]);void 0!==t&&null!=h&&rs(t,["setup","inputAudioTranscription"],{});const g=is(e,["outputAudioTranscription"]);void 0!==t&&null!=g&&rs(t,["setup","outputAudioTranscription"],{});const x=is(e,["realtimeInputConfig"]);void 0!==t&&null!=x&&rs(t,["setup","realtimeInputConfig"],md(x));const y=is(e,["contextWindowCompression"]);void 0!==t&&null!=y&&rs(t,["setup","contextWindowCompression"],pd(y));const b=is(e,["proactivity"]);return void 0!==t&&null!=b&&rs(t,["setup","proactivity"],function(e){const t={},n=is(e,["proactiveAudio"]);return null!=n&&rs(t,["proactiveAudio"],n),t}(b)),{}}function hd(e,t,n){const a=is(t,["expireTime"]);void 0!==n&&null!=a&&rs(n,["expireTime"],a);const s=is(t,["newSessionExpireTime"]);void 0!==n&&null!=s&&rs(n,["newSessionExpireTime"],s);const r=is(t,["uses"]);void 0!==n&&null!=r&&rs(n,["uses"],r);const i=is(t,["liveConnectConstraints"]);void 0!==n&&null!=i&&rs(n,["bidiGenerateContentSetup"],function(e,t){const n={},a=is(t,["model"]);null!=a&&rs(n,["setup","model"],Qr(e,a));const s=is(t,["config"]);return null!=s&&rs(n,["config"],fd(s,n)),n}(e,i));const l=is(t,["lockAdditionalFields"]);return void 0!==n&&null!=l&&rs(n,["fieldMask"],l),{}}function gd(e,t){let n=null;const a=e.bidiGenerateContentSetup;if("object"==typeof a&&null!==a&&"setup"in a){const t=a.setup;"object"==typeof t&&null!==t?(e.bidiGenerateContentSetup=t,n=t):delete e.bidiGenerateContentSetup}else void 0!==a&&delete e.bidiGenerateContentSetup;const s=e.fieldMask;if(n){const a=
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
function(e){const t=[];for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const a=e[n];if("object"==typeof a&&null!=a&&Object.keys(a).length>0){const e=Object.keys(a).map(e=>`${n}.${e}`);t.push(...e)}else t.push(n)}return t.join(",")}(n);if(Array.isArray(null==t?void 0:t.lockAdditionalFields)&&0===(null==t?void 0:t.lockAdditionalFields.length))a?e.fieldMask=a:delete e.fieldMask;else if((null==t?void 0:t.lockAdditionalFields)&&t.lockAdditionalFields.length>0&&null!==s&&Array.isArray(s)&&s.length>0){const t=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let n=[];s.length>0&&(n=s.map(e=>t.includes(e)?`generationConfig.${e}`:e));const r=[];a&&r.push(a),n.length>0&&r.push(...n),r.length>0?e.fieldMask=r.join(","):delete e.fieldMask}else delete e.fieldMask}else null!==s&&Array.isArray(s)&&s.length>0?e.fieldMask=s.join(","):delete e.fieldMask;return e}class xd extends as{constructor(e){super(),this.apiClient=e}async create(e){var t,n;let a,s="",r={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const i=function(e,t){const n={},a=is(t,["config"]);return null!=a&&rs(n,["config"],hd(e,a,n)),n}(this.apiClient,e);s=ss("auth_tokens",i._url),r=i._query,delete i.config,delete i._url,delete i._query;const l=gd(i,e.config);return a=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),a.then(e=>function(e){const t={},n=is(e,["name"]);return null!=n&&rs(t,["name"],n),t}(e))}}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function yd(e){const t={},n=is(e,["config"]);return null!=n&&rs(t,["config"],function(e,t){const n=is(e,["pageSize"]);void 0!==t&&null!=n&&rs(t,["_query","pageSize"],n);const a=is(e,["pageToken"]);void 0!==t&&null!=a&&rs(t,["_query","pageToken"],a);const s=is(e,["filter"]);return void 0!==t&&null!=s&&rs(t,["_query","filter"],s),{}}(n,t)),t}function bd(e){const t={};if(void 0!==is(e,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");const n=is(e,["examples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=is(e,["textInput"]);null!=n&&rs(t,["textInput"],n);const a=is(e,["output"]);return null!=a&&rs(t,["output"],a),t}(e))),rs(t,["examples","examples"],e)}return t}function vd(e){const t={},n=is(e,["baseModel"]);null!=n&&rs(t,["baseModel"],n);const a=is(e,["trainingDataset"]);null!=a&&rs(t,["tuningTask","trainingData"],bd(a));const s=is(e,["config"]);return null!=s&&rs(t,["config"],function(e,t){const n={};if(void 0!==is(e,["validationDataset"]))throw new Error("validationDataset parameter is not supported in Gemini API.");const a=is(e,["tunedModelDisplayName"]);if(void 0!==t&&null!=a&&rs(t,["displayName"],a),void 0!==is(e,["description"]))throw new Error("description parameter is not supported in Gemini API.");const s=is(e,["epochCount"]);void 0!==t&&null!=s&&rs(t,["tuningTask","hyperparameters","epochCount"],s);const r=is(e,["learningRateMultiplier"]);if(null!=r&&rs(n,["tuningTask","hyperparameters","learningRateMultiplier"],r),void 0!==is(e,["exportLastCheckpointOnly"]))throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(void 0!==is(e,["adapterSize"]))throw new Error("adapterSize parameter is not supported in Gemini API.");const i=is(e,["batchSize"]);void 0!==t&&null!=i&&rs(t,["tuningTask","hyperparameters","batchSize"],i);const l=is(e,["learningRate"]);return void 0!==t&&null!=l&&rs(t,["tuningTask","hyperparameters","learningRate"],l),n}(s,t)),t}function Nd(e){const t={},n=is(e,["config"]);return null!=n&&rs(t,["config"],function(e,t){const n=is(e,["pageSize"]);void 0!==t&&null!=n&&rs(t,["_query","pageSize"],n);const a=is(e,["pageToken"]);void 0!==t&&null!=a&&rs(t,["_query","pageToken"],a);const s=is(e,["filter"]);return void 0!==t&&null!=s&&rs(t,["_query","filter"],s),{}}(n,t)),t}function wd(e,t){const n=is(e,["validationDataset"]);void 0!==t&&null!=n&&rs(t,["supervisedTuningSpec"],function(e){const t={},n=is(e,["gcsUri"]);return null!=n&&rs(t,["validationDatasetUri"],n),t}(n));const a=is(e,["tunedModelDisplayName"]);void 0!==t&&null!=a&&rs(t,["tunedModelDisplayName"],a);const s=is(e,["description"]);void 0!==t&&null!=s&&rs(t,["description"],s);const r=is(e,["epochCount"]);void 0!==t&&null!=r&&rs(t,["supervisedTuningSpec","hyperParameters","epochCount"],r);const i=is(e,["learningRateMultiplier"]);void 0!==t&&null!=i&&rs(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],i);const l=is(e,["exportLastCheckpointOnly"]);void 0!==t&&null!=l&&rs(t,["supervisedTuningSpec","exportLastCheckpointOnly"],l);const o=is(e,["adapterSize"]);if(void 0!==t&&null!=o&&rs(t,["supervisedTuningSpec","hyperParameters","adapterSize"],o),void 0!==is(e,["batchSize"]))throw new Error("batchSize parameter is not supported in Vertex AI.");if(void 0!==is(e,["learningRate"]))throw new Error("learningRate parameter is not supported in Vertex AI.");return{}}function kd(e){const t={},n=is(e,["baseModel"]);null!=n&&rs(t,["baseModel"],n);const a=is(e,["trainingDataset"]);null!=a&&rs(t,["supervisedTuningSpec","trainingDatasetUri"],function(e,t){const n=is(e,["gcsUri"]);if(void 0!==t&&null!=n&&rs(t,["supervisedTuningSpec","trainingDatasetUri"],n),void 0!==is(e,["examples"]))throw new Error("examples parameter is not supported in Vertex AI.");return{}}(a,t));const s=is(e,["config"]);return null!=s&&rs(t,["config"],wd(s,t)),t}function Ed(e){const t={},n=is(e,["name"]);null!=n&&rs(t,["name"],n);const a=is(e,["state"]);null!=a&&rs(t,["state"],vi(a));const s=is(e,["createTime"]);null!=s&&rs(t,["createTime"],s);const r=is(e,["tuningTask","startTime"]);null!=r&&rs(t,["startTime"],r);const i=is(e,["tuningTask","completeTime"]);null!=i&&rs(t,["endTime"],i);const l=is(e,["updateTime"]);null!=l&&rs(t,["updateTime"],l);const o=is(e,["description"]);null!=o&&rs(t,["description"],o);const c=is(e,["baseModel"]);null!=c&&rs(t,["baseModel"],c);const d=is(e,["_self"]);null!=d&&rs(t,["tunedModel"],function(e){const t={},n=is(e,["name"]);null!=n&&rs(t,["model"],n);const a=is(e,["name"]);return null!=a&&rs(t,["endpoint"],a),t}(d));const u=is(e,["distillationSpec"]);null!=u&&rs(t,["distillationSpec"],u);const m=is(e,["experiment"]);null!=m&&rs(t,["experiment"],m);const p=is(e,["labels"]);null!=p&&rs(t,["labels"],p);const f=is(e,["pipelineJob"]);null!=f&&rs(t,["pipelineJob"],f);const h=is(e,["serviceAccount"]);null!=h&&rs(t,["serviceAccount"],h);const g=is(e,["tunedModelDisplayName"]);return null!=g&&rs(t,["tunedModelDisplayName"],g),t}function jd(e){const t={},n=is(e,["model"]);null!=n&&rs(t,["model"],n);const a=is(e,["endpoint"]);null!=a&&rs(t,["endpoint"],a);const s=is(e,["checkpoints"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=is(e,["checkpointId"]);null!=n&&rs(t,["checkpointId"],n);const a=is(e,["epoch"]);null!=a&&rs(t,["epoch"],a);const s=is(e,["step"]);null!=s&&rs(t,["step"],s);const r=is(e,["endpoint"]);return null!=r&&rs(t,["endpoint"],r),t}(e))),rs(t,["checkpoints"],e)}return t}function Cd(e){const t={},n=is(e,["name"]);null!=n&&rs(t,["name"],n);const a=is(e,["state"]);null!=a&&rs(t,["state"],vi(a));const s=is(e,["createTime"]);null!=s&&rs(t,["createTime"],s);const r=is(e,["startTime"]);null!=r&&rs(t,["startTime"],r);const i=is(e,["endTime"]);null!=i&&rs(t,["endTime"],i);const l=is(e,["updateTime"]);null!=l&&rs(t,["updateTime"],l);const o=is(e,["error"]);null!=o&&rs(t,["error"],o);const c=is(e,["description"]);null!=c&&rs(t,["description"],c);const d=is(e,["baseModel"]);null!=d&&rs(t,["baseModel"],d);const u=is(e,["tunedModel"]);null!=u&&rs(t,["tunedModel"],jd(u));const m=is(e,["supervisedTuningSpec"]);null!=m&&rs(t,["supervisedTuningSpec"],m);const p=is(e,["tuningDataStats"]);null!=p&&rs(t,["tuningDataStats"],p);const f=is(e,["encryptionSpec"]);null!=f&&rs(t,["encryptionSpec"],f);const h=is(e,["partnerModelTuningSpec"]);null!=h&&rs(t,["partnerModelTuningSpec"],h);const g=is(e,["distillationSpec"]);null!=g&&rs(t,["distillationSpec"],g);const x=is(e,["experiment"]);null!=x&&rs(t,["experiment"],x);const y=is(e,["labels"]);null!=y&&rs(t,["labels"],y);const b=is(e,["pipelineJob"]);null!=b&&rs(t,["pipelineJob"],b);const v=is(e,["serviceAccount"]);null!=v&&rs(t,["serviceAccount"],v);const N=is(e,["tunedModelDisplayName"]);return null!=N&&rs(t,["tunedModelDisplayName"],N),t}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
class _d extends as{constructor(e){super(),this.apiClient=e,this.get=async e=>await this.getInternal(e),this.list=async(e={})=>new al(tl.PAGED_ITEM_TUNING_JOBS,e=>this.listInternal(e),await this.listInternal(e),e),this.tune=async e=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(e);{const t=await this.tuneMldevInternal(e);let n="";void 0!==t.metadata&&void 0!==t.metadata.tunedModel?n=t.metadata.tunedModel:void 0!==t.name&&t.name.includes("/operations/")&&(n=t.name.split("/operations/")[0]);return{name:n,state:Us.JOB_STATE_QUEUED}}}}async getInternal(e){var t,n,a,s;let r,i="",l={};if(this.apiClient.isVertexAI()){const a=function(e){const t={},n=is(e,["name"]);null!=n&&rs(t,["_url","name"],n);const a=is(e,["config"]);return null!=a&&rs(t,["config"],a),t}(e);return i=ss("{name}",a._url),l=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>Cd(e))}{const t=function(e){const t={},n=is(e,["name"]);null!=n&&rs(t,["_url","name"],n);const a=is(e,["config"]);return null!=a&&rs(t,["config"],a),t}(e);return i=ss("{name}",t._url),l=t._query,delete t.config,delete t._url,delete t._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(a=e.config)||void 0===a?void 0:a.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json()),r.then(e=>Ed(e))}}async listInternal(e){var t,n,a,s;let r,i="",l={};if(this.apiClient.isVertexAI()){const a=Nd(e);return i=ss("tuningJobs",a._url),l=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),r.then(e=>{const t=function(e){const t={},n=is(e,["nextPageToken"]);null!=n&&rs(t,["nextPageToken"],n);const a=is(e,["tuningJobs"]);if(null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>Cd(e))),rs(t,["tuningJobs"],e)}return t}(e),n=new Vr;return Object.assign(n,t),n})}{const t=yd(e);return i=ss("tunedModels",t._url),l=t._query,delete t.config,delete t._url,delete t._query,r=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(a=e.config)||void 0===a?void 0:a.httpOptions,abortSignal:null===(s=e.config)||void 0===s?void 0:s.abortSignal}).then(e=>e.json()),r.then(e=>{const t=function(e){const t={},n=is(e,["nextPageToken"]);null!=n&&rs(t,["nextPageToken"],n);const a=is(e,["tunedModels"]);if(null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>Ed(e))),rs(t,["tuningJobs"],e)}return t}(e),n=new Vr;return Object.assign(n,t),n})}}async tuneInternal(e){var t,n;let a,s="",r={};if(this.apiClient.isVertexAI()){const i=kd(e);return s=ss("tuningJobs",i._url),r=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),a.then(e=>Cd(e))}throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,n;let a,s="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const i=vd(e);return s=ss("tunedModels",i._url),r=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),a.then(e=>function(e){const t={},n=is(e,["name"]);null!=n&&rs(t,["name"],n);const a=is(e,["metadata"]);null!=a&&rs(t,["metadata"],a);const s=is(e,["done"]);null!=s&&rs(t,["done"],s);const r=is(e,["error"]);return null!=r&&rs(t,["error"],r),t}(e))}}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Td{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const Sd="x-goog-upload-status";function Ad(e){return new Promise(t=>setTimeout(t,e))}class Id{async upload(e,t,n){if("string"==typeof e)throw new Error("File path is not supported in browser uploader.");return await async function(e,t,n){var a,s,r;let i=0,l=0,o=new Or(new Response),c="upload";for(i=e.size;l<i;){const r=Math.min(8388608,i-l),d=e.slice(l,l+r);l+r>=i&&(c+=", finalize");let u=0,m=1e3;for(;u<3&&(o=await n.request({path:"",body:d,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":c,"X-Goog-Upload-Offset":String(l),"Content-Length":String(r)}}}),!(null===(a=null==o?void 0:o.headers)||void 0===a?void 0:a[Sd]));)u++,await Ad(m),m*=2;if(l+=r,"active"!==(null===(s=null==o?void 0:o.headers)||void 0===s?void 0:s[Sd]))break;if(i<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const d=await(null==o?void 0:o.json());if("final"!==(null===(r=null==o?void 0:o.headers)||void 0===r?void 0:r[Sd]))throw new Error("Failed to upload file: Upload status is not finalized.");return d.file}(e,t,n)}async stat(e){if("string"==typeof e)throw new Error("File path is not supported in browser uploader.");return await async function(e){return{size:e.size,type:e.type}}(e)}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Dd{create(e,t,n){return new Od(e,t,n)}}class Od{constructor(e,t,n){this.url=e,this.headers=t,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(void 0===this.ws)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(void 0===this.ws)throw new Error("WebSocket is not connected");this.ws.close()}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Rd="x-goog-api-key";class Pd{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(null===e.get(Rd)){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(Rd,this.apiKey)}}}
/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Md{constructor(e){var t;if(null==e.apiKey)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=null!==(t=e.vertexai)&&void 0!==t&&t,this.apiKey=e.apiKey;const n=ns(e,void 0,void 0);n&&(e.httpOptions?e.httpOptions.baseUrl=n:e.httpOptions={baseUrl:n}),this.apiVersion=e.apiVersion;const a=new Pd(this.apiKey);this.apiClient=new Fc({auth:a,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:"gl-node/web",uploader:new Id,downloader:new Td}),this.models=new ed(this.apiClient),this.live=new Kc(this.apiClient,a,new Dd),this.batches=new sl(this.apiClient),this.chats=new Ml(this.models,this.apiClient),this.caches=new Tl(this.apiClient),this.files=new Gl(this.apiClient),this.operations=new rd(this.apiClient),this.authTokens=new xd(this.apiClient),this.tunings=new _d(this.apiClient)}}let Ud=null,Ld=null;const Fd=()=>{Ud&&Ud.requestAccessToken({})},Bd=()=>{const e=gapi.client.getToken();null!==e&&google.accounts.oauth2.revoke(e.access_token,()=>{gapi.client.setToken(null),Ld&&Ld(!1)})},$d=e=>null===gapi.client.getToken()?Promise.reject("User not signed in to Google Calendar."):gapi.client.calendar.events.insert({calendarId:"primary",resource:e,sendUpdates:"all"}),Gd=(e,t)=>gapi.client.calendar.events.patch({calendarId:"primary",eventId:e,resource:t,sendUpdates:"all"}),Vd=/@\[([^\]]+)\]\(([^)]+)\)/g,zd=e=>{if(!e)return[];if("string"!=typeof e)return[];const t=e.matchAll(Vd),n=new Set;for(const a of t)a[2]&&n.add(a[2]);return Array.from(n)},Wd=(e,t)=>{if(!e)return null;if("string"!=typeof e)return We.jsx("span",{className:"italic text-red-500",children:"Invalid content provided"});try{const n=e.split(Vd);if(1===n.length)return We.jsx(We.Fragment,{children:n[0]});const a=[];let s=0;for(;s<n.length;)if(n[s]&&a.push(We.jsx("span",{children:n[s]},`text-${s}`)),s++,s<n.length){const e=n[s],r=n[s+1],i=t.find(e=>e.id===r);a.push(We.jsxs("span",{className:"bg-primary-light text-primary font-semibold px-1.5 py-0.5 rounded-md mx-px",children:["@",i?i.name:e]},`mention-${r}-${s}`)),s+=2}return We.jsx("span",{children:a})}catch(n){return We.jsx("span",{className:"italic text-red-500",children:"Invalid mention content"})}},qd=(e,t,n)=>{if(Zt(e,t.weeklyOffDay))return!1;const a=Ht(e);return!n.some(e=>e.employeeId===t.id&&e.date===a)},Hd="firebasestorage.googleapis.com",Kd="storageBucket";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Yd extends A{constructor(e,t,n=0){super(eu(e),`Firebase Storage: ${t} (${eu(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Yd.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return eu(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}var Jd,Zd,Qd,Xd;function eu(e){return"storage/"+e}function tu(){return new Yd(Jd.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function nu(e){return new Yd(Jd.INVALID_ARGUMENT,e)}function au(){return new Yd(Jd.APP_DELETED,"The Firebase app was deleted.")}function su(e,t){return new Yd(Jd.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function ru(e){throw new Yd(Jd.INTERNAL_ERROR,"Internal error: "+e)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(Zd=Jd||(Jd={})).UNKNOWN="unknown",Zd.OBJECT_NOT_FOUND="object-not-found",Zd.BUCKET_NOT_FOUND="bucket-not-found",Zd.PROJECT_NOT_FOUND="project-not-found",Zd.QUOTA_EXCEEDED="quota-exceeded",Zd.UNAUTHENTICATED="unauthenticated",Zd.UNAUTHORIZED="unauthorized",Zd.UNAUTHORIZED_APP="unauthorized-app",Zd.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",Zd.INVALID_CHECKSUM="invalid-checksum",Zd.CANCELED="canceled",Zd.INVALID_EVENT_NAME="invalid-event-name",Zd.INVALID_URL="invalid-url",Zd.INVALID_DEFAULT_BUCKET="invalid-default-bucket",Zd.NO_DEFAULT_BUCKET="no-default-bucket",Zd.CANNOT_SLICE_BLOB="cannot-slice-blob",Zd.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",Zd.NO_DOWNLOAD_URL="no-download-url",Zd.INVALID_ARGUMENT="invalid-argument",Zd.INVALID_ARGUMENT_COUNT="invalid-argument-count",Zd.APP_DELETED="app-deleted",Zd.INVALID_ROOT_OPERATION="invalid-root-operation",Zd.INVALID_FORMAT="invalid-format",Zd.INTERNAL_ERROR="internal-error",Zd.UNSUPPORTED_ENVIRONMENT="unsupported-environment";class iu{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=iu.makeFromUrl(e,t)}catch(s){return new iu(e,"")}if(""===n.path)return n;throw a=e,new Yd(Jd.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+a+"'.");var a}static makeFromUrl(e,t){let n=null;const a="([A-Za-z0-9.\\-_]+)";const s=new RegExp("^gs://"+a+"(/(.*))?$","i");function r(e){e.path_=decodeURIComponent(e.path)}const i=t.replace(/[.]/g,"\\."),l=[{regex:s,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${i}/v[A-Za-z0-9_]+/b/${a}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:r},{regex:new RegExp(`^https?://${t===Hd?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${a}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:r}];for(let o=0;o<l.length;o++){const t=l[o],a=t.regex.exec(e);if(a){const e=a[t.indices.bucket];let s=a[t.indices.path];s||(s=""),n=new iu(e,s),t.postModify(n);break}}if(null==n)throw function(e){return new Yd(Jd.INVALID_URL,"Invalid URL '"+e+"'.")}(e);return n}}class lu{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ou(e){return"string"==typeof e||e instanceof String}function cu(e){return du()&&e instanceof Blob}function du(){return"undefined"!=typeof Blob}function uu(e,t,n,a){if(a<t)throw nu(`Invalid value for '${e}'. Expected ${t} or greater.`);if(a>n)throw nu(`Invalid value for '${e}'. Expected ${n} or less.`)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mu(e,t,n){let a=t;return null==n&&(a=`https://${t}`),`${n}://${a}/v0${e}`}function pu(e){const t=encodeURIComponent;let n="?";for(const a in e)if(e.hasOwnProperty(a)){n=n+(t(a)+"="+t(e[a]))+"&"}return n=n.slice(0,-1),n}(Xd=Qd||(Qd={}))[Xd.NO_ERROR=0]="NO_ERROR",Xd[Xd.NETWORK_ERROR=1]="NETWORK_ERROR",Xd[Xd.ABORT=2]="ABORT";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class fu{constructor(e,t,n,a,s,r,i,l,o,c,d,u=!0,m=!1){this.url_=e,this.method_=t,this.headers_=n,this.body_=a,this.successCodes_=s,this.additionalRetryCodes_=r,this.callback_=i,this.errorCallback_=l,this.timeout_=o,this.progressCallback_=c,this.connectionFactory_=d,this.retry=u,this.isUsingEmulator=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()})}start_(){const e=(e,t)=>{if(t)return void e(!1,new hu(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const a=e=>{const t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(a),n.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(a),this.pendingConnection_=null;const t=n.getErrorCode()===Qd.NO_ERROR,s=n.getStatus();if(!t||
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e,t){const n=e>=500&&e<600,a=-1!==[408,429].indexOf(e),s=-1!==t.indexOf(e);return n||a||s}(s,this.additionalRetryCodes_)&&this.retry){const t=n.getErrorCode()===Qd.ABORT;return void e(!1,new hu(!1,null,t))}const r=-1!==this.successCodes_.indexOf(s);e(!0,new hu(r,n))})},t=(e,t)=>{const n=this.resolve_,a=this.reject_,s=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(s,s.getResponse());void 0!==e?n(e):n()}catch(r){a(r)}else if(null!==s){const e=tu();e.serverResponse=s.getErrorText(),this.errorCallback_?a(this.errorCallback_(s,e)):a(e)}else if(t.canceled){a(this.appDelete_?au():new Yd(Jd.CANCELED,"User canceled the upload/download."))}else{a(new Yd(Jd.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again."))}};this.canceled_?t(0,new hu(!1,null,!0)):this.backoffId_=function(e,t,n){let a=1,s=null,r=null,i=!1,l=0;function o(){return 2===l}let c=!1;function d(...e){c||(c=!0,t.apply(null,e))}function u(t){s=setTimeout(()=>{s=null,e(p,o())},t)}function m(){r&&clearTimeout(r)}function p(e,...t){if(c)return void m();if(e)return m(),void d.call(null,e,...t);if(o()||i)return m(),void d.call(null,e,...t);let n;a<64&&(a*=2),1===l?(l=2,n=0):n=1e3*(a+Math.random()),u(n)}let f=!1;function h(e){f||(f=!0,m(),c||(null!==s?(e||(l=2),clearTimeout(s),u(0)):e||(l=1)))}return u(0),r=setTimeout(()=>{i=!0,h(!0)},n),h}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class hu{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function gu(...e){const t="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0;if(void 0!==t){const n=new t;for(let t=0;t<e.length;t++)n.append(e[t]);return n.getBlob()}if(du())return new Blob(e);throw new Yd(Jd.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function xu(e){if("undefined"==typeof atob)throw t="base-64",new Yd(Jd.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`);var t;return atob(e)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yu="raw",bu="base64",vu="base64url",Nu="data_url";class wu{constructor(e,t){this.data=e,this.contentType=t||null}}function ku(e,t){switch(e){case yu:return new wu(Eu(t));case bu:case vu:return new wu(ju(e,t));case Nu:return new wu(function(e){const t=new Cu(e);return t.base64?ju(bu,t.rest):function(e){let t;try{t=decodeURIComponent(e)}catch(n){throw su(Nu,"Malformed data URL.")}return Eu(t)}(t.rest)}(t),new Cu(t).contentType)}throw tu()}function Eu(e){const t=[];for(let n=0;n<e.length;n++){let a=e.charCodeAt(n);if(a<=127)t.push(a);else if(a<=2047)t.push(192|a>>6,128|63&a);else if(55296==(64512&a)){if(n<e.length-1&&56320==(64512&e.charCodeAt(n+1))){a=65536|(1023&a)<<10|1023&e.charCodeAt(++n),t.push(240|a>>18,128|a>>12&63,128|a>>6&63,128|63&a)}else t.push(239,191,189)}else 56320==(64512&a)?t.push(239,191,189):t.push(224|a>>12,128|a>>6&63,128|63&a)}return new Uint8Array(t)}function ju(e,t){switch(e){case bu:{const n=-1!==t.indexOf("-"),a=-1!==t.indexOf("_");if(n||a){throw su(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?")}break}case vu:{const n=-1!==t.indexOf("+"),a=-1!==t.indexOf("/");if(n||a){throw su(e,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?")}t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=xu(t)}catch(s){if(s.message.includes("polyfill"))throw s;throw su(e,"Invalid character found")}const a=new Uint8Array(n.length);for(let r=0;r<n.length;r++)a[r]=n.charCodeAt(r);return a}class Cu{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw su(Nu,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;null!=n&&(this.base64=function(e,t){if(!(e.length>=t.length))return!1;return e.substring(e.length-t.length)===t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}class _u{constructor(e,t){let n=0,a="";cu(e)?(this.data_=e,n=e.size,a=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=a}size(){return this.size_}type(){return this.type_}slice(e,t){if(cu(this.data_)){const r=this.data_,i=(a=e,s=t,(n=r).webkitSlice?n.webkitSlice(a,s):n.mozSlice?n.mozSlice(a,s):n.slice?n.slice(a,s):null);return null===i?null:new _u(i)}{const n=new Uint8Array(this.data_.buffer,e,t-e);return new _u(n,!0)}var n,a,s}static getBlob(...e){if(du()){const t=e.map(e=>e instanceof _u?e.data_:e);return new _u(gu.apply(null,t))}{const t=e.map(e=>ou(e)?ku(yu,e).data:e.data_);let n=0;t.forEach(e=>{n+=e.byteLength});const a=new Uint8Array(n);let s=0;return t.forEach(e=>{for(let t=0;t<e.length;t++)a[s++]=e[t]}),new _u(a,!0)}}uploadData(){return this.data_}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tu(e){let t;try{t=JSON.parse(e)}catch(a){return null}return"object"!=typeof(n=t)||Array.isArray(n)?null:t;var n}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Su(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Au(e,t){return t}class Iu{constructor(e,t,n,a){this.server=e,this.local=t||e,this.writable=!!n,this.xform=a||Au}}let Du=null;function Ou(){if(Du)return Du;const e=[];e.push(new Iu("bucket")),e.push(new Iu("generation")),e.push(new Iu("metageneration")),e.push(new Iu("name","fullPath",!0));const t=new Iu("name");t.xform=function(e,t){return function(e){return!ou(e)||e.length<2?e:Su(e)}(t)},e.push(t);const n=new Iu("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new Iu("timeCreated")),e.push(new Iu("updated")),e.push(new Iu("md5Hash",null,!0)),e.push(new Iu("cacheControl",null,!0)),e.push(new Iu("contentDisposition",null,!0)),e.push(new Iu("contentEncoding",null,!0)),e.push(new Iu("contentLanguage",null,!0)),e.push(new Iu("contentType",null,!0)),e.push(new Iu("metadata","customMetadata",!0)),Du=e,Du}function Ru(e,t,n){const a={type:"file"},s=n.length;for(let r=0;r<s;r++){const e=n[r];a[e.local]=e.xform(a,t[e.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){const n=e.bucket,a=e.fullPath,s=new iu(n,a);return t._makeStorageReference(s)}})}(a,e),a}function Pu(e,t,n){const a=Tu(t);if(null===a)return null;return Ru(e,a,n)}class Mu{constructor(e,t,n,a){this.url=e,this.method=t,this.handler=n,this.timeout=a,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uu(e){if(!e)throw tu()}function Lu(e,t){return function(n,a){const s=Pu(e,a,t);return Uu(null!==s),function(e,t,n,a){const s=Tu(t);if(null===s)return null;if(!ou(s.downloadTokens))return null;const r=s.downloadTokens;if(0===r.length)return null;const i=encodeURIComponent;return r.split(",").map(t=>{const s=e.bucket,r=e.fullPath;return mu("/b/"+i(s)+"/o/"+i(r),n,a)+pu({alt:"media",token:t})})[0]}(s,a,e.host,e._protocol)}}function Fu(e){return function(t,n){let a;var s,r;return 401===t.getStatus()?a=t.getErrorText().includes("Firebase App Check token is invalid")?new Yd(Jd.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project."):new Yd(Jd.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(r=e.bucket,a=new Yd(Jd.QUOTA_EXCEEDED,"Quota for bucket '"+r+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(s=e.path,a=new Yd(Jd.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")):a=n,a.status=t.getStatus(),a.serverResponse=n.serverResponse,a}}function Bu(e){const t=Fu(e);return function(n,a){let s=t(n,a);var r;return 404===n.getStatus()&&(r=e.path,s=new Yd(Jd.OBJECT_NOT_FOUND,"Object '"+r+"' does not exist.")),s.serverResponse=a.serverResponse,s}}function $u(e,t,n,a,s){const r=t.bucketOnlyServerUrl(),i={"X-Goog-Upload-Protocol":"multipart"};const l=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();i["Content-Type"]="multipart/related; boundary="+l;const o=function(e,t,n){const a=Object.assign({},n);return a.fullPath=e.path,a.size=t.size(),a.contentType||(a.contentType=function(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}(null,t)),a}(t,a,s),c=function(e,t){const n={},a=t.length;for(let s=0;s<a;s++){const a=t[s];a.writable&&(n[a.server]=e[a.local])}return JSON.stringify(n)}(o,n),d="--"+l+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+c+"\r\n--"+l+"\r\nContent-Type: "+o.contentType+"\r\n\r\n",u="\r\n--"+l+"--",m=_u.getBlob(d,a,u);if(null===m)throw new Yd(Jd.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.");const p={name:o.fullPath},f=mu(r,e.host,e._protocol),h=e.maxUploadRetryTime,g=new Mu(f,"POST",function(e,t){return function(n,a){const s=Pu(e,a,t);return Uu(null!==s),s}}(e,n),h);return g.urlParams=p,g.headers=i,g.body=m.uploadData(),g.errorHandler=Fu(t),g}class Gu{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Qd.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Qd.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Qd.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,n,a,s){if(this.sent_)throw ru("cannot .send() more than once");if(P(e)&&n&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==s)for(const r in s)s.hasOwnProperty(r)&&this.xhr_.setRequestHeader(r,s[r].toString());return void 0!==a?this.xhr_.send(a):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw ru("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw ru("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}getResponse(){if(!this.sent_)throw ru("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw ru("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class Vu extends Gu{initXhr(){this.xhr_.responseType="text"}}function zu(){return new Vu}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wu{constructor(e,t){this._service=e,this._location=t instanceof iu?t:iu.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Wu(e,t)}get root(){const e=new iu(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Su(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new iu(this._location.bucket,e);return new Wu(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new Yd(Jd.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function qu(e){e._throwIfRoot("getDownloadURL");const t=function(e,t,n){const a=mu(t.fullServerUrl(),e.host,e._protocol),s=e.maxOperationRetryTime,r=new Mu(a,"GET",Lu(e,n),s);return r.errorHandler=Bu(t),r}(e.storage,e._location,Ou());return e.storage.makeRequestWithTokens(t,zu).then(e=>{if(null===e)throw new Yd(Jd.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return e})}function Hu(e,t){if(e instanceof Ju){const n=e;if(null==n._bucket)throw new Yd(Jd.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Kd+"' property when initializing the app?");const a=new Wu(n,n._bucket);return null!=t?Hu(a,t):a}return void 0!==t?function(e,t){const n=function(e,t){const n=t.split("/").filter(e=>e.length>0).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),a=new iu(e._location.bucket,n);return new Wu(e.storage,a)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,t):e}function Ku(e,t){if(t&&/^[A-Za-z]+:\/\//.test(t)){if(e instanceof Ju)return new Wu(e,t);throw nu("To use ref(service, url), the first argument must be a Storage instance.")}return Hu(e,t)}function Yu(e,t){const n=null==t?void 0:t[Kd];return null==n?null:iu.makeFromBucketSpec(n,e)}class Ju{constructor(e,t,n,a,s,r=!1){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=a,this._firebaseVersion=s,this._isUsingEmulator=r,this._bucket=null,this._host=Hd,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=a?iu.makeFromBucketSpec(a,this._host):Yu(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=iu.makeFromBucketSpec(this._url,e):this._bucket=Yu(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){uu("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){uu("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){if(S(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});if(e){return(await e.getToken()).token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Wu(this,e)}_makeRequest(e,t,n,a,s=!0){if(this._deleted)return new lu(au());{const r=function(e,t,n,a,s,r,i=!0,l=!1){const o=pu(e.urlParams),c=e.url+o,d=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(d,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(d,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}(d,r),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(d,a),new fu(c,e.method,d,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,s,i,l)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,this._appId,n,a,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(r),r.getPromise().then(()=>this._requests.delete(r),()=>this._requests.delete(r)),r}}async makeRequestWithTokens(e,t){const[n,a]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,a).getPromise()}}const Zu="@firebase/storage",Qu="0.14.0",Xu="storage";function em(e,t,n){return function(e,t,n){e._throwIfRoot("uploadBytes");const a=$u(e.storage,e._location,Ou(),new _u(t,!0),n);return e.storage.makeRequestWithTokens(a,zu).then(t=>({metadata:t,ref:e}))}(e=D(e),t,n)}function tm(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),a=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return new Ju(n,a,s,t,T)}j(new C(Xu,tm,"PUBLIC").setMultipleInstances(!0)),_(Zu,Qu,""),_(Zu,Qu,"esm2020");const nm=F({apiKey:"AIzaSyCIf9vsmwS3WAxKM9QAPdOLH_Gi8AfrhA0",authDomain:"syncly-473404.firebaseapp.com",projectId:"syncly-473404",storageBucket:"syncly-473404.firebasestorage.app",messagingSenderId:"790117665889",appId:"1:790117665889:web:5800c96820c9519ac22e20",measurementId:"G-6SZNDMZ6RT"}),am=B(nm);new $;const sm=G(nm),rm=V(nm),im=function(e=I(),t){e=D(e);const n=O(e,Xu).getImmediate({identifier:t}),a=R("storage");return a&&function(e,t,n,a={}){!function(e,t,n,a={}){e.host=`${t}:${n}`;const s=P(t);s&&(M(`https://${e.host}/b`),U("Storage",!0)),e._isUsingEmulator=!0,e._protocol=s?"https":"http";const{mockUserToken:r}=a;r&&(e._overrideAuthToken="string"==typeof r?r:L(r,e.app.options.projectId))}(e,t,n,a)}(n,...a),n}(nm),lm=Object.freeze(Object.defineProperty({__proto__:null,app:nm,auth:am,db:sm,functions:rm,serverTimestamp:H,storage:im},Symbol.toStringTag,{value:"Module"})),om={TENANTS:"tenants",USERS:"users",ROLES:"roles",BUSINESS_UNITS:"businessUnits",REPORTS:"reports",TASKS:"tasks",TASK_COMMENTS:"taskComments",LEAVE_RECORDS:"leaveRecords",USER_BADGES:"userBadges",MEETINGS:"meetings",MEETING_INSTANCES:"meetingInstances",MEETING_UPDATES:"meetingUpdates",NOTIFICATIONS:"notifications",TRIGGER_LOG:"triggerLogs",ACTIVITY_LOG:"activityLogs",SYNC_QUEUE:"syncQueue",ANNOUNCEMENTS:"announcements",ANNOUNCEMENT_VIEWS:"announcementViews"},cm=e=>`${e}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;async function dm(e,t){try{const n=z(sm,e,t),a=await Y(n);return a.exists()?{id:a.id,...a.data()}:null}catch(n){throw n}}async function um(e,...t){var n;try{const n=ee(sm,e),a=t.length>0?Q(n,...t):n;return(await te(a)).docs.map(e=>({id:e.id,...e.data()}))}catch(a){throw null==(n=null==a?void 0:a.message)||n.includes("index"),a}}async function mm(e,t,n){try{const a=z(sm,e,t),s=Object.entries(n).reduce((e,[t,n])=>(void 0!==n&&(e[t]=n),e),{});await K(a,{...s,updatedAt:H()})}catch(a){throw a}}async function pm(e,t,n){try{const a=z(sm,e,t),s=Object.entries(n).reduce((e,[t,n])=>(void 0!==n&&(e[t]=n),e),{});await q(a,{...s,updatedAt:H()})}catch(a){throw a}}async function fm(e,t){try{const n=z(sm,e,t);await W(n)}catch(n){throw n}}const hm=e=>dm(om.USERS,e),gm=async(e,t)=>{const{getCurrentTenantId:n}=await v(async()=>{const{getCurrentTenantId:e}=await Promise.resolve().then(()=>Lp);return{getCurrentTenantId:e}},void 0),a=n();if(!a)return null;return(await um(om.USERS,J("tenantId","==",a),J("email","==",e.toLowerCase()),Z(1)))[0]||null},xm=(e,t)=>mm(om.USERS,e,t),ym=(e,t)=>pm(om.USERS,e,t),bm=e=>fm(om.USERS,e),vm=()=>um(om.TENANTS),Nm=e=>dm(om.TENANTS,e),wm=(e,t)=>mm(om.TENANTS,e,t),km=(e,t)=>pm(om.TENANTS,e,t),Em=e=>fm(om.TENANTS,e),jm=async e=>{const{auth:t}=await v(async()=>{const{auth:e}=await Promise.resolve().then(()=>lm);return{auth:e}},void 0);if(t.currentUser){await t.currentUser.getIdTokenResult()}return um(om.ROLES,J("tenantId","==",e))},Cm=e=>dm(om.ROLES,e),_m=(e,t)=>mm(om.ROLES,e,t),Tm=(e,t)=>pm(om.ROLES,e,t),Sm=e=>fm(om.ROLES,e),Am=e=>um(om.BUSINESS_UNITS,J("tenantId","==",e)),Im=e=>dm(om.BUSINESS_UNITS,e),Dm=(e,t)=>mm(om.BUSINESS_UNITS,e,t),Om=(e,t)=>pm(om.BUSINESS_UNITS,e,t),Rm=e=>fm(om.BUSINESS_UNITS,e),Pm=e=>um(om.REPORTS,J("tenantId","==",e),X("date","desc")),Mm=e=>dm(om.REPORTS,e),Um=async e=>{const{getCurrentTenantId:t}=await v(async()=>{const{getCurrentTenantId:e}=await Promise.resolve().then(()=>Lp);return{getCurrentTenantId:e}},void 0),n=t();return n?um(om.REPORTS,J("tenantId","==",n),J("employeeId","==",e),X("date","desc")):[]},Lm=async(e,t)=>{const{getCurrentTenantId:n}=await v(async()=>{const{getCurrentTenantId:e}=await Promise.resolve().then(()=>Lp);return{getCurrentTenantId:e}},void 0),a=n(),s={...t,tenantId:t.tenantId||a};if(!s.tenantId)throw new Error("Cannot create report without tenantId");return mm(om.REPORTS,e,s)},Fm=(e,t)=>pm(om.REPORTS,e,t),Bm=e=>fm(om.REPORTS,e),$m=e=>um(om.TASKS,J("tenantId","==",e)),Gm=e=>dm(om.TASKS,e),Vm=async e=>{const{requireTenantId:t}=await v(async()=>{const{requireTenantId:e}=await Promise.resolve().then(()=>Lp);return{requireTenantId:e}},void 0),n=t();return um(om.TASKS,J("tenantId","==",n),J("assignedTo","array-contains",e))},zm=(e,t)=>mm(om.TASKS,e,t),Wm=(e,t)=>pm(om.TASKS,e,t),qm=e=>fm(om.TASKS,e),Hm=async e=>{const{requireTenantId:t}=await v(async()=>{const{requireTenantId:e}=await Promise.resolve().then(()=>Lp);return{requireTenantId:e}},void 0),n=t();return um(om.TASK_COMMENTS,J("tenantId","==",n),J("taskId","==",e),X("createdOn","asc"))},Km=(e,t)=>mm(om.TASK_COMMENTS,e,t),Ym=e=>um(om.LEAVE_RECORDS,J("tenantId","==",e)),Jm=async e=>{const{requireTenantId:t}=await v(async()=>{const{requireTenantId:e}=await Promise.resolve().then(()=>Lp);return{requireTenantId:e}},void 0),n=t();return um(om.LEAVE_RECORDS,J("tenantId","==",n),J("employeeId","==",e))},Zm=e=>dm(om.LEAVE_RECORDS,e),Qm=(e,t)=>mm(om.LEAVE_RECORDS,e,t),Xm=(e,t)=>pm(om.LEAVE_RECORDS,e,t),ep=e=>fm(om.LEAVE_RECORDS,e),tp=e=>um(om.MEETINGS,J("tenantId","==",e)),np=e=>dm(om.MEETINGS,e),ap=(e,t)=>mm(om.MEETINGS,e,t),sp=(e,t)=>pm(om.MEETINGS,e,t),rp=e=>fm(om.MEETINGS,e),ip=e=>dm(om.MEETING_INSTANCES,e),lp=async e=>{const{requireTenantId:t}=await v(async()=>{const{requireTenantId:e}=await Promise.resolve().then(()=>Lp);return{requireTenantId:e}},void 0),n=t();return um(om.MEETING_INSTANCES,J("tenantId","==",n),J("seriesId","==",e))},op=(e,t)=>mm(om.MEETING_INSTANCES,e,t),cp=async e=>{const{requireTenantId:t}=await v(async()=>{const{requireTenantId:e}=await Promise.resolve().then(()=>Lp);return{requireTenantId:e}},void 0),n=t();return um(om.MEETING_UPDATES,J("tenantId","==",n),J("meetingId","==",e),X("createdOn","desc"))},dp=(e,t)=>mm(om.MEETING_UPDATES,e,t),up=async e=>{const{requireTenantId:t}=await v(async()=>{const{requireTenantId:e}=await Promise.resolve().then(()=>Lp);return{requireTenantId:e}},void 0),n=t();return um(om.USER_BADGES,J("tenantId","==",n),J("userId","==",e))},mp=(e,t)=>mm(om.USER_BADGES,e,t),pp=async e=>{const{requireTenantId:t}=await v(async()=>{const{requireTenantId:e}=await Promise.resolve().then(()=>Lp);return{requireTenantId:e}},void 0),n=t();return um(om.NOTIFICATIONS,J("tenantId","==",n),J("userId","==",e),X("timestamp","desc"))},fp=(e,t)=>mm(om.NOTIFICATIONS,e,t),hp=(e,t)=>pm(om.NOTIFICATIONS,e,t),gp=e=>fm(om.NOTIFICATIONS,e),xp=async()=>{const{requireTenantId:e}=await v(async()=>{const{requireTenantId:e}=await Promise.resolve().then(()=>Lp);return{requireTenantId:e}},void 0),t=e();return um(om.ANNOUNCEMENTS,J("tenantId","==",t),X("startsAt","desc"))},yp=(e,t)=>mm(om.ANNOUNCEMENTS,e,t),bp=(e,t)=>pm(om.ANNOUNCEMENTS,e,t),vp=e=>fm(om.ANNOUNCEMENTS,e),Np=async e=>{const{requireTenantId:t}=await v(async()=>{const{requireTenantId:e}=await Promise.resolve().then(()=>Lp);return{requireTenantId:e}},void 0),n=t();return um(om.ANNOUNCEMENT_VIEWS,J("tenantId","==",n),J("announcementId","==",e))},wp=async(e,t)=>{const{requireTenantId:n}=await v(async()=>{const{requireTenantId:e}=await Promise.resolve().then(()=>Lp);return{requireTenantId:e}},void 0),a=n();return(await um(om.ANNOUNCEMENT_VIEWS,J("tenantId","==",a),J("announcementId","==",e),J("userId","==",t),Z(1)))[0]||null},kp=async e=>{const{requireTenantId:t}=await v(async()=>{const{requireTenantId:e}=await Promise.resolve().then(()=>Lp);return{requireTenantId:e}},void 0),n=t();return um(om.ANNOUNCEMENT_VIEWS,J("tenantId","==",n),J("userId","==",e))},Ep=(e,t)=>mm(om.ANNOUNCEMENT_VIEWS,e,t),jp=async e=>{const{requireTenantId:t}=await v(async()=>{const{requireTenantId:e}=await Promise.resolve().then(()=>Lp);return{requireTenantId:e}},void 0),n=t();return um(om.ACTIVITY_LOG,J("tenantId","==",n),J("actorId","==",e),X("timestamp","desc"),Z(200))},Cp=e=>um(om.ACTIVITY_LOG,J("tenantId","==",e),X("timestamp","desc"),Z(500)),_p=(e,t)=>mm(om.ACTIVITY_LOG,e,t),Tp=e=>um(om.TRIGGER_LOG,J("tenantId","==",e),X("timestamp","desc")),Sp=async(e,t)=>{const{getCurrentTenantId:n}=await v(async()=>{const{getCurrentTenantId:e}=await Promise.resolve().then(()=>Lp);return{getCurrentTenantId:e}},void 0),a=n(),s={...t,tenantId:t.tenantId||a};if(!s.tenantId)throw new Error("Cannot create trigger log without tenantId");return mm(om.TRIGGER_LOG,e,s)},Ap=Object.freeze(Object.defineProperty({__proto__:null,COLLECTIONS:om,createActivityLog:_p,createAnnouncement:yp,createBusinessUnit:Dm,createLeaveRecord:Qm,createMeeting:ap,createMeetingInstance:op,createMeetingUpdate:dp,createNotification:fp,createReport:Lm,createRole:_m,createTask:zm,createTaskComment:Km,createTenant:wm,createTriggerLog:Sp,createUser:xm,createUserBadge:mp,deleteAnnouncement:vp,deleteBusinessUnit:Rm,deleteDocument:fm,deleteLeaveRecord:ep,deleteMeeting:rp,deleteNotification:gp,deleteReport:Bm,deleteRole:Sm,deleteTask:qm,deleteTenant:Em,deleteUser:bm,generateFirestoreId:cm,getActivityLogByUser:jp,getAllActivityLogs:Cp,getAllBusinessUnits:Am,getAllDocuments:um,getAllLeaveRecords:Ym,getAllMeetings:tp,getAllReports:Pm,getAllRoles:jm,getAllTasks:$m,getAllTenants:vm,getAllTriggerLogs:Tp,getAnnouncementViewByUser:wp,getAnnouncementViewsByAnnouncement:Np,getAnnouncementViewsForUser:kp,getAnnouncementsByTenant:xp,getBusinessUnitById:Im,getDocument:dm,getLeaveRecordById:Zm,getLeaveRecordsByEmployee:Jm,getMeetingById:np,getMeetingInstanceById:ip,getMeetingInstancesBySeriesId:lp,getMeetingUpdates:cp,getNotificationsByUser:pp,getReportById:Mm,getReportsByEmployee:Um,getRoleById:Cm,getTaskById:Gm,getTaskComments:Hm,getTasksByAssignee:Vm,getTenantById:Nm,getUserBadges:up,getUserByEmail:gm,getUserById:hm,getUsersByTenantId:async e=>{const t=Q(ee(sm,om.USERS),J("tenantId","==",e),J("isDeleted","==",!1),X("createdAt","desc"));return(await te(t)).docs.map(e=>({id:e.id,...e.data()}))},getUsersInCurrentTenant:async()=>{var e,t;const{getCurrentTenantId:n}=await v(async()=>{const{getCurrentTenantId:e}=await Promise.resolve().then(()=>Lp);return{getCurrentTenantId:e}},void 0),{auth:a}=await v(async()=>{const{auth:e}=await Promise.resolve().then(()=>lm);return{auth:e}},void 0);await(null==(e=a.currentUser)?void 0:e.getIdToken(!0));await(null==(t=a.currentUser)?void 0:t.getIdTokenResult());try{await Y(z(sm,om.USERS,a.currentUser.uid))}catch(i){}const s=n();if(!s)throw new Error("getUsersInCurrentTenant: tenantId missing. User must be logged in as tenant admin.");const r=Q(ee(sm,om.USERS),J("tenantId","==",s),J("isDeleted","==",!1),X("createdAt","desc"));return(await te(r)).docs.map(e=>({id:e.id,...e.data()}))},setDocument:mm,updateAnnouncement:bp,updateBusinessUnit:Om,updateDocument:pm,updateLeaveRecord:Xm,updateMeeting:sp,updateNotification:hp,updateReport:Fm,updateRole:Tm,updateTask:Wm,updateTenant:km,updateUser:ym,upsertAnnouncementView:Ep},Symbol.toStringTag,{value:"Module"}));let Ip=null,Dp=!1;const Op=e=>{Ip=e},Rp=e=>{Dp=e},Pp=()=>{if(Dp)return!0;try{const e=localStorage.getItem("eod_current_user");if(e){const t=JSON.parse(e);if(t&&"object"==typeof t)return Dp=t.isPlatformAdmin||!1,Dp}}catch(e){}return!1},Mp=()=>{if(Pp())return null;if(Ip)return Ip;try{const e=localStorage.getItem("eod_current_user");if(e){const t=JSON.parse(e);if(t&&"object"==typeof t)return Ip=t.tenantId||null,Ip}}catch(e){}return null},Up=()=>{if(Pp())throw new Error("Platform admin should not require tenantId");const e=Mp();if(!e)throw new Error("No tenant context available. User must be logged in.");return e},Lp=Object.freeze(Object.defineProperty({__proto__:null,checkIsPlatformAdmin:Pp,getCurrentTenantId:Mp,requireTenantId:Up,setCurrentTenantId:Op,setIsPlatformAdmin:Rp},Symbol.toStringTag,{value:"Module"})),Fp={BASE_URL:"/",DEV:!1,GEMINI_API_KEY:"AIzaSyCSlTtB-U_t-LIGBL06Z-pbQqQEFcM0xLE",MODE:"production",PROD:!0,SSR:!1,VITE_FIREBASE_API_KEY:"AIzaSyCIf9vsmwS3WAxKM9QAPdOLH_Gi8AfrhA0",VITE_FIREBASE_APP_ID:"1:790117665889:web:5800c96820c9519ac22e20",VITE_FIREBASE_AUTH_DOMAIN:"syncly-473404.firebaseapp.com",VITE_FIREBASE_MEASUREMENT_ID:"G-6SZNDMZ6RT",VITE_FIREBASE_MESSAGING_SENDER_ID:"790117665889",VITE_FIREBASE_PROJECT_ID:"syncly-473404",VITE_FIREBASE_STORAGE_BUCKET:"syncly-473404.firebasestorage.app",VITE_GOOGLE_CLIENT_ID:"790117665889-8mfsqenv4lcimef1728ikoj5pi1lrvi1.apps.googleusercontent.com",VITE_JAY_PROXY_URL:"https://us-central1-syncly-473404.cloudfunctions.net/jayAssistantProxy"};var Bp={};const $p=e=>{try{if(void 0!==import.meta&&Fp){const t=Fp[e];if("string"==typeof t)return t}}catch{}return null},Gp=e=>{if("undefined"==typeof process)return null;const t=null==Bp?void 0:Bp[e];return"string"==typeof t?t:null},Vp=e=>{if("string"!=typeof e)return null;const t=e.trim();return t.length>0?t:null},zp=(...e)=>{for(const t of e){const e=Vp($p(t));if(e)return e;const n=Vp(Gp(t));if(n)return n}return null},Wp={tenants:null,users:{},roles:{},businessUnits:{},reports:{},tasks:{},meetings:{},lastFetch:{}};function qp(e){const t=Wp.lastFetch[e];return Boolean(t&&Date.now()-t<6e4)}function Hp(e){Wp.lastFetch[e]=0}const Kp={async getAll(){if(qp("tenants")&&Wp.tenants)return Wp.tenants;const e=await vm();return Wp.tenants=e,Wp.lastFetch.tenants=Date.now(),e},async getById(e){if(Wp.tenants){const t=Wp.tenants.find(t=>t.id===e);if(t)return t}return await Nm(e)},async create(e,t){await wm(e,t),Hp("tenants")},async update(e,t){await km(e,t),Hp("tenants")},async delete(e){await Em(e),Hp("tenants")}},Yp={async getAll(e,t=!1){var n,a;const s=`users_${e}`;if(!t&&qp(s)&&Wp.users[e])return Wp.users[e];const{getUsersByTenantId:r,getUsersInCurrentTenant:i}=await v(async()=>{const{getUsersByTenantId:e,getUsersInCurrentTenant:t}=await Promise.resolve().then(()=>Ap);return{getUsersByTenantId:e,getUsersInCurrentTenant:t}},void 0),{auth:l}=await v(async()=>{const{auth:e}=await Promise.resolve().then(()=>lm);return{auth:e}},void 0),o=await(null==(n=l.currentUser)?void 0:n.getIdTokenResult()),c=!0===(null==(a=null==o?void 0:o.claims)?void 0:a.isPlatformAdmin)?await r(e):await i();return Wp.users[e]=c,Wp.lastFetch[s]=Date.now(),c},async getById(e){for(const t of Object.values(Wp.users)){const n=t.find(t=>t.id===e);if(n)return n}return await hm(e)},async getByEmail(e){for(const t of Object.values(Wp.users)){const n=t.find(t=>t.email.toLowerCase()===e.toLowerCase());if(n)return n}return await gm(e)},async create(e,t){await xm(e,t);const n=t.tenantId;if(n){const e=`users_${n}`;delete Wp.users[n],delete Wp.lastFetch[e]}},async update(e,t){await ym(e,t),Wp.users={}},async delete(e){await bm(e),Wp.users={}}},Jp={async getAll(e){const t=`roles_${e}`;if(qp(t)&&Wp.roles[e])return Wp.roles[e];const n=await jm(e);return Wp.roles[e]=n,Wp.lastFetch[t]=Date.now(),n},async getById(e){for(const t of Object.values(Wp.roles)){const n=t.find(t=>t.id===e);if(n)return n}return await Cm(e)},async create(e,t){await _m(e,t),Wp.roles={}},async update(e,t){await Tm(e,t),Wp.roles={}},async delete(e){await Sm(e),Wp.roles={}}},Zp={async getAll(e){const t=`businessUnits_${e}`;if(qp(t)&&Wp.businessUnits[e])return Wp.businessUnits[e];const n=await Am(e);return Wp.businessUnits[e]=n,Wp.lastFetch[t]=Date.now(),n},async getById(e){for(const t of Object.values(Wp.businessUnits)){const n=t.find(t=>t.id===e);if(n)return n}return await Im(e)},async create(e,t){await Dm(e,t),Wp.businessUnits={}},async update(e,t){await Om(e,t),Wp.businessUnits={}},async delete(e){await Rm(e),Wp.businessUnits={}}},Qp={async getAll(e){var t;const n=`reports_${e}`;if(qp(n)&&Wp.reports[e])return Wp.reports[e];const{auth:a}=await v(async()=>{const{auth:e}=await Promise.resolve().then(()=>lm);return{auth:e}},void 0);await(null==(t=a.currentUser)?void 0:t.getIdToken(!0));const s=await Pm(e);return Wp.reports[e]=s,Wp.lastFetch[n]=Date.now(),s},getById:async e=>await Mm(e),async getByEmployee(e){var t;const{auth:n}=await v(async()=>{const{auth:e}=await Promise.resolve().then(()=>lm);return{auth:e}},void 0);return await(null==(t=n.currentUser)?void 0:t.getIdToken(!0)),await Um(e)},async create(e,t){await Lm(e,t),Wp.reports={}},async update(e,t){await Fm(e,t),Wp.reports={}},async delete(e){await Bm(e),Wp.reports={}}},Xp={async getAll(e){const t=`tasks_${e}`;if(qp(t)&&Wp.tasks[e])return Wp.tasks[e];const n=await $m(e);return Wp.tasks[e]=n,Wp.lastFetch[t]=Date.now(),n},getById:async e=>await Gm(e),getByAssignee:async e=>await Vm(e),async create(e,t){await zm(e,t),Wp.tasks={}},async update(e,t){await Wm(e,t),Wp.tasks={}},async delete(e){await qm(e),Wp.tasks={}},getComments:async e=>await Hm(e),async addComment(e,t){await Km(e,t)}},ef={getAll:async e=>await Ym(e),getById:async e=>await Zm(e),getByEmployee:async e=>await Jm(e),async create(e,t){await Qm(e,t)},async update(e,t){await Xm(e,t)},async delete(e){await ep(e)}},tf={async getAll(e){const t=`meetings_${e}`;if(qp(t)&&Wp.meetings[e])return Wp.meetings[e];const n=await tp(e);return Wp.meetings[e]=n,Wp.lastFetch[t]=Date.now(),n},getById:async e=>await np(e),async create(e,t){await ap(e,t),Wp.meetings={}},async update(e,t){await sp(e,t),Wp.meetings={}},async delete(e){await rp(e),Wp.meetings={}},getInstance:async e=>await ip(e),getInstancesBySeries:async e=>await lp(e),async createInstance(e,t){await op(e,t)},getUpdates:async e=>await cp(e),async createUpdate(e,t){await dp(e,t)}},nf={getByUser:async e=>await pp(e),async create(e,t){await fp(e,t)},async update(e,t){await hp(e,t)},async delete(e){await gp(e)}},af={getAll:async()=>await xp(),async create(e,t){await yp(e,t)},async update(e,t){await bp(e,t)},async delete(e){await vp(e)}},sf={getByAnnouncement:async e=>await Np(e),getByUserId:async e=>await kp(e),getByUser:async(e,t)=>await wp(e,t),async upsert(e,t){await Ep(e,t)}},rf={async getAll(e){const t=`activityLogs_${e}`;qp(t)&&Wp.lastFetch[t];const n=await Cp(e);return Wp.lastFetch[t]=Date.now(),n},getByUser:async e=>await jp(e),async create(e,t){await _p(e,t),Object.keys(Wp.lastFetch).filter(e=>e.startsWith("activityLogs_")).forEach(e=>Hp(e))}},lf={getAll:async e=>await Tp(e),async create(e,t){await Sp(e,t)}},of={getByUser:async e=>await up(e),async create(e,t){await mp(e,t)}},cf=Object.freeze(Object.defineProperty({__proto__:null,activityLogRepository:rf,announcementRepository:af,announcementViewRepository:sf,badgeRepository:of,businessUnitRepository:Zp,clearUserCache:function(){Wp.users={},Wp.roles={},Wp.businessUnits={},Wp.reports={},Wp.tasks={},Wp.meetings={},Object.keys(Wp.lastFetch).forEach(e=>{(e.startsWith("users_")||e.startsWith("roles_")||e.startsWith("businessUnits_")||e.startsWith("reports_")||e.startsWith("tasks_")||e.startsWith("meetings_"))&&delete Wp.lastFetch[e]})},generateId:cm,leaveRepository:ef,meetingRepository:tf,notificationRepository:nf,reportRepository:Qp,roleRepository:Jp,taskRepository:Xp,tenantRepository:Kp,triggerLogRepository:lf,userRepository:Yp},Symbol.toStringTag,{value:"Module"})),df=(e,t)=>{try{const n=window.localStorage.getItem(e),a=JSON.stringify(t);window.localStorage.setItem(e,a),window.dispatchEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:a,storageArea:window.localStorage})),tn.emit("appDataChanged",{keyChanged:e})}catch(n){}},uf=()=>{try{tn.emit("appDataChanged",{keyChanged:jt})}catch(e){}},mf=(e,t=Date.now())=>t<e.startsAt?"scheduled":t>e.endsAt?"expired":"active",pf=e=>({...e,status:mf(e)}),ff=e=>{var t,n;return{...e,targetBusinessUnitIds:(null==(t=e.targetBusinessUnitIds)?void 0:t.filter(Boolean))||[],targetUserIds:(null==(n=e.targetUserIds)?void 0:n.filter(Boolean))||[]}},hf="GEMINI_API_KEY",gf="syncly:gemini-key-updated",xf="AI features are not configured yet. Open your profile menu -> Manage AI API Key to paste a Google Gemini key.",yf=e=>{if("undefined"!=typeof window)try{window.dispatchEvent(new CustomEvent(gf,{detail:{value:e}}))}catch(t){}},bf=()=>{var e,t,n;if("undefined"!=typeof window){try{const t=null==(e=window.localStorage)?void 0:e.getItem(hf);if(t)return t}catch(s){}try{const e=null==(t=window.sessionStorage)?void 0:t.getItem(hf);if(e){try{null==(n=window.localStorage)||n.setItem(hf,e),yf(e)}catch{}return e}}catch(s){}}const a=zp("VITE_GEMINI_API_KEY","GEMINI_API_KEY","API_KEY");return a||null},vf=()=>!!bf(),Nf=()=>bf(),wf=e=>{if("undefined"==typeof window)return()=>{};const t=t=>{var n;if(t instanceof CustomEvent&&t.type===gf)e((null==(n=t.detail)?void 0:n.value)??null);else if("storage"===t.type){const n=t;n.key===hf&&e(n.newValue)}};return window.addEventListener(gf,t),window.addEventListener("storage",t),()=>{window.removeEventListener(gf,t),window.removeEventListener("storage",t)}},kf=e=>{var t,n;const a="string"==typeof(null==e?void 0:e.message)?e.message:"string"==typeof(null==(t=null==e?void 0:e.error)?void 0:t.message)?e.error.message:"function"==typeof(null==e?void 0:e.toString)?e.toString():"An unexpected error occurred while communicating with Google Gemini.";return/429/.test(a)||/RESOURCE_EXHAUSTED/i.test(a)||/quota/i.test(a)||429===(null==e?void 0:e.code)||429===(null==e?void 0:e.status)||429===(null==(n=null==e?void 0:e.error)?void 0:n.code)?new Error("Google Gemini rate limit reached. Please wait a moment or use a different API key."):new Error(a)},Ef=async e=>{const t=e.tenantId||Up(),n=cm("act"),a=e.actorAuthUid||e.actorId,s={...e,id:n,tenantId:t,actorAuthUid:a};if(!s.tenantId)throw new Error("activityLogs write missing tenantId - cannot create activity log without tenant isolation");if(!s.actorAuthUid)throw new Error("activityLogs write missing actorAuthUid - Firestore security rules require Firebase Auth UID for validation");await rf.create(n,s)},jf=async e=>await rf.getByUser(e),Cf=async e=>{const t=Up(),n=await Yp.getAll(t),a=await Sf(),s=await If();return n.map(e=>{var t,n;return{...e,roleName:(null==(t=a.find(t=>t.id===e.roleId))?void 0:t.name)||"N/A",businessUnitName:(null==(n=s.find(t=>t.id===e.businessUnitId))?void 0:n.name)||"N/A"}})},_f=async e=>await Yp.getById(e),Tf=async(e,t)=>{const n=await _f(e.id);if(!n)return null;await Yp.update(e.id,e);const a=[];if(n.roleId!==e.roleId){const t=await Af(n.roleId),s=await Af(e.roleId);a.push({type:dt.USER_ROLE_CHANGED,description:`role changed from "${null==t?void 0:t.name}" to "${null==s?void 0:s.name}"`})}if(n.notificationEmail!==e.notificationEmail&&a.push({type:dt.USER_NOTIFICATION_EMAIL_CHANGED,description:"notification email was updated"}),n.name!==e.name&&a.push({type:dt.USER_ROLE_CHANGED,description:`name was updated to "${e.name}"`}),n.businessUnitId!==e.businessUnitId&&a.push({type:dt.USER_ROLE_CHANGED,description:"business unit was updated"}),n.status!==e.status){const t=e.status===et.ARCHIVED?dt.USER_ARCHIVED:dt.USER_UNARCHIVED;a.push({type:t,description:`status changed to ${e.status}`})}if(a.length>0){const n=a.map(e=>e.description).join(", ");await Xf({userId:e.id,message:`An administrator updated your profile: ${n}.`,type:"info",isCrucial:!0});for(const s of a)await Ef({timestamp:Date.now(),actorId:t.id,actorName:t.name,type:s.type,description:`updated ${s.description} for user ${e.name}`,targetUserId:e.id,targetUserName:e.name})}return e},Sf=async e=>{const t=Up();return await Jp.getAll(t)},Af=async e=>await Jp.getById(e),If=async e=>{const t=Up();return await Zp.getAll(t)},Df=async()=>{const e=Up();return await Qp.getAll(e)},Of=async e=>await Qp.getByEmployee(e),Rf=async(e,t)=>{let n=await Df();const a=n.findIndex(t=>t.id===e.id);if(-1===a)return null;const s=n[a],r=s.status,i=s.managerComments||"";e.status&&(s.status=e.status),void 0!==e.managerComments&&(s.managerComments=e.managerComments);const l=Date.now();if(e.status===tt.ACKNOWLEDGED){s.acknowledgedByManagerId=t.id,s.acknowledgedAt=l,s.acknowledgments||(s.acknowledgments=[]);const n=s.acknowledgments.findIndex(e=>e.managerId===t.id);-1===n?s.acknowledgments.push({managerId:t.id,managerName:t.name,acknowledgedAt:l,comments:e.managerComments,designation:t.roleName}):(s.acknowledgments[n].acknowledgedAt=l,s.acknowledgments[n].comments=e.managerComments)}return await Qp.update(s.id,s),sn({type:"UPDATE_REPORT",payload:{...s}}),e.status===tt.ACKNOWLEDGED&&r!==tt.ACKNOWLEDGED&&(await Ef({timestamp:l,actorId:t.id,actorName:t.name,type:dt.EOD_ACKNOWLEDGED,description:`acknowledged ${s.employeeName}'s EOD report for`,targetId:s.id,targetName:Wt(s.date),targetUserId:s.employeeId,targetUserName:s.employeeName}),await Xf({userId:s.employeeId,message:`Your EOD report was acknowledged by ${t.name}.`,type:"info",link:"/my-reports",actionType:"EOD_ACKNOWLEDGED",targetId:s.id,actors:[{id:s.id,name:Wt(s.date)}],isCrucial:!0})),e.managerComments&&e.managerComments.trim()!==i.trim()&&await Xf({userId:s.employeeId,message:`${t.name} left a comment on your EOD report for ${Wt(s.date)}.`,type:"info",link:"/my-reports",isCrucial:!0}),s},Pf=e=>{const t=e.acknowledgments||[];return{hasManagerAcknowledged:n=>t.length>0?t.some(e=>e.managerId===n):e.acknowledgedByManagerId===n,getAcknowledgingManagers:()=>t.length>0?t.map(e=>({id:e.managerId,name:e.managerName,timestamp:e.acknowledgedAt,designation:e.designation})):e.acknowledgedByManagerId&&e.acknowledgedAt?[{id:e.acknowledgedByManagerId,name:"Manager",timestamp:e.acknowledgedAt}]:[],getAcknowledgmentCount:()=>t.length>0?t.length:e.acknowledgedByManagerId?1:0}},Mf=async e=>{if(e.status===tt.ACKNOWLEDGED)return{editable:!1,reason:"Editing locked: Report has been acknowledged by a manager."};if(e.versions.length>=2)return{editable:!1,reason:"Editing locked: Maximum number of edits (1) reached."};return Date.now()-e.submittedAt>72e5?{editable:!1,reason:"Editing locked: More than 2 hours have passed since initial submission."}:{editable:!0,reason:""}},Uf=async e=>await Xp.getById(e),Lf=async()=>{const e=Up();return await Xp.getAll(e)},Ff=async(e,t)=>{await Lf();const n=Up(),a=Date.now(),s={...e,id:cm("task"),createdOn:a,updatedOn:a,pinnedBy:[],overdueReminderSentFor:[],tenantId:n};await Xp.create(s.id,s),sn({type:"ADD_TASK",payload:{...s}}),await Ef({timestamp:a,actorId:t.id,actorName:t.name,type:dt.TASK_CREATED,description:e.isPersonalTask?"created a personal task:":"created task:",targetId:s.id,targetName:s.title});for(const r of s.assignedTo)r!==t.id&&await Xf({userId:r,message:`${t.name} assigned you a new task: "${s.title}"`,type:"info",link:"/my-tasks?taskId="+s.id,isCrucial:!0});return s},Bf=async(e,t,n)=>{if(-1===(await Lf()).findIndex(t=>t.id===e))return null;const a=await Uf(e);if(!a)return null;const s={...a,...t,updatedOn:Date.now()};await Xp.update(e,s),sn({type:"UPDATE_TASK",payload:{...s}});const r=async(e,t,a,r,i=!1)=>{await Ef({timestamp:s.updatedOn,actorId:n.id,actorName:n.name,type:e,description:`changed the ${t.toLowerCase()} for task`,targetId:s.id,targetName:s.title,details:{changes:[{field:t,from:a,to:r}]},isCrucial:i})};if(a.priority!==s.priority&&await r(dt.TASK_PRIORITY_CHANGED,"priority",a.priority,s.priority,s.priority===nt.High),a.dueDate!==s.dueDate){await r(dt.TASK_DUE_DATE_UPDATED,"dueDate",a.dueDate,s.dueDate);for(const e of s.assignedTo)await Xf({userId:e,message:`The due date for task "${s.title}" was changed to ${Wt(s.dueDate)}.`,type:"info",link:oh(n.roleName)?`/team-tasks?taskId=${s.id}`:`/my-tasks?taskId=${s.id}`,isCrucial:!0})}if(a.status!==s.status){const e=s.status===at.Completed?dt.TASK_COMPLETED:(s.status,at.Blocked,dt.TASK_STATUS_CHANGED);await r(e,"status",a.status,s.status,s.status===at.Blocked),s.status===at.Completed&&a.status!==at.Completed&&n.id!==s.createdBy&&await Xf({userId:s.createdBy,message:`${n.name} completed the task: "${s.title}"`,type:"info",isCrucial:!0,link:`/team-tasks?taskId=${s.id}`}),s.status===at.Blocked&&n.id!==s.createdBy&&await Xf({userId:s.createdBy,message:`${n.name} marked the task "${s.title}" as Blocked.`,type:"warning",isCrucial:!0,link:`/team-tasks?taskId=${s.id}`})}const i=new Set(a.assignedTo),l=new Set(s.assignedTo);if(JSON.stringify([...i].sort())!==JSON.stringify([...l].sort())){await r(dt.TASK_REASSIGNED,"assignedTo",a.assignedTo.join(", "),s.assignedTo.join(", "));const e=[...l].filter(e=>!i.has(e));for(const t of e)await Xf({userId:t,message:`${n.name} assigned you a new task: "${s.title}"`,type:"info",link:`/my-tasks?taskId=${s.id}`,isCrucial:!0})}if(a.description!==s.description||a.title!==s.title){await Ef({timestamp:s.updatedOn,actorId:n.id,actorName:n.name,type:dt.TASK_EDITED,description:"edited the details for task",targetId:s.id,targetName:s.title});for(const e of s.assignedTo)e!==n.id&&await Xf({userId:e,message:`Details for task "${s.title}" were updated.`,type:"info",link:oh(n.roleName)?`/team-tasks?taskId=${s.id}`:`/my-tasks?taskId=${s.id}`,isCrucial:!0})}return s},$f=async(e,t)=>{const n=await Uf(e);return!!n&&(await Xp.delete(e),sn({type:"DELETE_TASK",payload:{taskId:e}}),await Ef({timestamp:Date.now(),actorId:t.id,actorName:t.name,type:dt.TASK_DELETED,description:"deleted task:",targetId:n.id,targetName:n.title}),!0)},Gf=async(e,t,n,a)=>{const s=await Lf(),r=s.findIndex(t=>t.id===e);if(-1===r)return null;const i=s[r];if(i.taskType!==st.Team)return i;const l=i.memberProgress||{};l[t]={status:n,completedAt:n===at.Completed?Date.now():void 0},i.memberProgress=l,i.updatedOn=Date.now();const o=i.assignedTo.every(e=>{var t;return(null==(t=l[e])?void 0:t.status)===at.Completed});return o?i.status=at.Completed:i.status===at.Completed&&(i.status=at.InProgress),await Xp.update(e,i),sn({type:"UPDATE_TASK",payload:{...i}}),await Ef({timestamp:i.updatedOn,actorId:a.id,actorName:a.name,type:n===at.Completed?dt.TASK_COMPLETED:dt.TASK_STATUS_CHANGED,description:`updated their status to "${n}" for task:`,targetId:i.id,targetName:i.title}),o&&i.status===at.Completed&&a.id!==i.createdBy&&await Xf({userId:i.createdBy,message:`All team members completed the task: "${i.title}"`,type:"info",isCrucial:!0,link:`/team-tasks?taskId=${i.id}`}),i},Vf=async e=>await Xp.getComments(e),zf=async()=>{const e=Up();return await ef.getAll(e)},Wf=async(e,t)=>(await ef.getByEmployee(e)).find(e=>e.date===t)||null,qf=async(e,t,n,a)=>{if((await ef.getByEmployee(e)).some(e=>e.date===t))throw new Error(`A leave record already exists for this employee on ${Wt(t)}.`);const s=await _f(e);if(!s)throw new Error("Employee not found");const r=n.trim();if(!r)throw new Error("Please provide a brief reason before marking leave.");const i=new Date(`${t}T00:00:00`);if(Number.isNaN(i.getTime()))throw new Error("Invalid leave date supplied.");if(s.weeklyOffDay&&Zt(i,s.weeklyOffDay))throw new Error(`Today is ${s.weeklyOffDay}, your scheduled weekly off. No leave submission is required.`);const l=Wt(t);if((await jf(e)).some(e=>e.type===dt.LEAVE_REVOKED_BY_EMPLOYEE&&e.targetName===l))throw new Error("This date has already been marked and revoked once. Please contact your manager for any further changes.");const o=Up(),c=cm("leave"),d={id:c,employeeId:e,employeeName:s.name,date:t,status:it.APPROVED,reason:r,createdAt:Date.now(),businessUnitId:s.businessUnitId,businessUnitName:s.businessUnitName,tenantId:o};await ef.create(c,d);const u=a??s,m=i>new Date,p=m?u.id===e?dt.LEAVE_FUTURE_SCHEDULED_BY_EMPLOYEE:dt.LEAVE_FUTURE_SCHEDULED_BY_MANAGER:u.id===e?dt.LEAVE_MARKED_BY_EMPLOYEE:dt.LEAVE_MARKED_BY_MANAGER;return await Ef({timestamp:d.createdAt,actorId:u.id,actorName:u.name,targetUserId:e,targetUserName:s.name,type:p,description:"marked leave for",targetId:d.id,targetName:l,isCrucial:!0}),await Xf({userId:e,message:u.id===e?`Leave recorded for ${l}.`:`${u.name} marked leave for you on ${l}.`,type:m?"reminder":"info",link:"/leave",isCrucial:!0,actors:[{id:u.id,name:u.name}],targetId:d.id,targetType:"leave"}),d},Hf=async(e,t)=>{const n=await ef.getById(e);if(!n)throw new Error("Leave record not found.");const a=t??await _f(n.employeeId)??{id:n.employeeId,name:n.employeeName};if(a.id===n.employeeId){const e=await jf(n.employeeId),t=Wt(n.date);if(e.some(e=>e.type===dt.LEAVE_REVOKED_BY_EMPLOYEE&&e.targetName===t))throw new Error("You have already revoked leave for this date once. Please contact your manager for any additional changes.")}await ef.delete(e);const s=new Date(n.date)>new Date?a.id===n.employeeId?dt.LEAVE_FUTURE_CANCELED_BY_EMPLOYEE:dt.LEAVE_FUTURE_CANCELED_BY_MANAGER:a.id===n.employeeId?dt.LEAVE_REVOKED_BY_EMPLOYEE:dt.LEAVE_REVOKED_BY_MANAGER;return await Ef({timestamp:Date.now(),actorId:a.id,actorName:a.name,targetUserId:n.employeeId,targetUserName:n.employeeName,type:s,description:"updated leave for",targetId:n.id,targetName:Wt(n.date)}),await Xf({userId:n.employeeId,message:a.id===n.employeeId?`You cancelled leave for ${Wt(n.date)}.`:`${a.name} cancelled your leave for ${Wt(n.date)}.`,type:"warning",link:"/leave",isCrucial:!0,actors:[{id:a.id,name:a.name}],targetId:n.id,targetType:"leave"}),!0},Kf=async e=>await of.getByUser(e),Yf=async(e,t,n,a,s,r)=>{const i=await Zf(e);if(!i)throw new Error("Meeting not found");const l=[],o=[];for(const m of a){const e=await Ff({title:m.title,description:m.description||"",dueDate:m.dueDate,priority:m.priority,assignedTo:m.assigneeIds,createdBy:s.id,taskType:m.assigneeIds.length>1?st.Team:st.Direct,isPersonalTask:!1,meetingId:i.id,status:at.NotStarted},s);l.push(e.id),o.push(e)}const c=Up(),d=cm("inst"),u={id:d,seriesId:i.id,occurrenceDate:t,meetingMinutes:n,taskIds:l,finalizedAt:Date.now(),isAsynchronous:r,tenantId:c};return await tf.createInstance(d,u),await async function(e,t,n){var a,s;if(!e||!e.googleEventId)return{calendarSynced:!1};if(!(()=>{const e=gapi.client.getToken();return null!==e&&e.access_token})())return{calendarSynced:!1,error:"Not signed in to Google Calendar"};try{const a=await((e,t)=>{const n=new Date(`${t}T00:00:00Z`).toISOString(),a=new Date(`${t}T23:59:59Z`).toISOString();return gapi.client.calendar.events.instances({calendarId:"primary",eventId:e,timeMin:n,timeMax:a})})(e.googleEventId,t.occurrenceDate);if(!a||!a.result||!a.result.items||0===a.result.items.length)return{calendarSynced:!1,error:"Could not find the specific meeting instance in your calendar."};const s=a.result.items[0].id,r=await Cf(),i=e=>{var t;return(null==(t=r.find(t=>t.id===e))?void 0:t.name)||"Unknown"},l=n.length>0?n.map(e=>`- [ ] ${e.title} (To: ${e.assignedTo.map(i).join(", ")}, Due: ${Wt(e.dueDate)})`).join("\n"):"No action items were created from this session.",o=`---SYNC-NOTES---\n${t.meetingMinutes}\n---END-SYNC-TASKS---\n\n---SYNC-TASKS---\n${l}\n---END-SYNC-TASKS---`;return await Gd(s,{description:o}),{calendarSynced:!0}}catch(r){return{calendarSynced:!1,error:(null==(s=null==(a=null==r?void 0:r.result)?void 0:a.error)?void 0:s.message)||(null==r?void 0:r.message)||"An unknown error occurred during calendar sync."}}}(i,u,o)},Jf=async()=>{const e=Up();return await tf.getAll(e)},Zf=async e=>await tf.getById(e),Qf=async e=>await tf.getInstancesBySeries(e),Xf=async e=>{const t=Up(),n=cm("notif"),a={...e,id:n,timestamp:Date.now(),read:!1,tenantId:t};return await nf.create(n,a),"vibrate"in navigator&&navigator.vibrate(100),"Notification"in window&&"granted"===Notification.permission&&"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(t=>{const n=`${ut} ${"reminder"===e.type?"Reminder":"Notification"}`,s={body:e.message,icon:"icons/icon-192x192.png",badge:"icons/icon-badge-72x72.png",tag:a.id,data:{url:e.link||"/"}};t.showNotification(n,s)}),a},eh=async()=>{const e=(e=>e.sort((e,t)=>t.startsAt-e.startsAt))((await af.getAll()).map(pf));return(e=>{try{window.localStorage.setItem(jt,JSON.stringify(e))}catch(t){}})(e),e},th=async e=>(await eh()).find(t=>t.id===e),nh=async e=>(await eh()).filter(t=>"active"===t.status&&((e,t)=>"all"===e.targetType||("businessUnits"===e.targetType?!!t.businessUnitId&&(e.targetBusinessUnitIds||[]).includes(t.businessUnitId):"users"===e.targetType&&(e.targetUserIds||[]).includes(t.id)))(t,e)),ah=async(e,t)=>{const n=await Cf(),a=((e,t)=>{const n=new Set("users"===e.targetType&&e.targetUserIds||[]);return t.filter(t=>t.status===et.ACTIVE&&("all"===e.targetType||("businessUnits"===e.targetType?t.businessUnitId&&(e.targetBusinessUnitIds||[]).includes(t.businessUnitId):n.has(t.id))))})(e,n);a.length&&await Promise.all(a.map(async n=>{await Xf({userId:n.id,message:e.title,type:"info",link:"/announcements",targetId:e.id,targetType:"announcement",actors:[{id:t.id,name:t.name}],isCrucial:"active"===e.status}),((e,t)=>{const n=" "+t.title,a=`Hi ${e.name},\n\nA new announcement has been published for your organization.\n\n${t.content}\n\nActive from: ${new Date(t.startsAt).toLocaleString()}\nExpires on: ${new Date(t.endsAt).toLocaleString()}\n\nPlease open Syncly to review the full details and acknowledge if required.\n\nThank you,\nPeople Operations`;Xt(e.notificationEmail||e.email,n,a)})(n,e)}))},sh=async e=>(await sf.getByUserId(e)).reduce((e,t)=>(e[t.announcementId]=t,e),{}),rh=async()=>{const e=Up();return await lf.getAll(e)},ih=async e=>{},lh=async(e,t)=>{var n;const a=e.actorId===t.id?"You":e.actorName;let s,r=e.description;if((null==(n=e.details)?void 0:n.changes)&&e.details.changes.length>0){const t=e.details.changes[0];let n=t.field.replace(/([A-Z])/g," $1").toLowerCase(),a=t.from,s=t.to;"due date"===n&&(a=Wt(a),s=Wt(s)),"object"==typeof a&&null!==a&&"humanReadable"in a&&(a=a.humanReadable||"(none)"),"object"==typeof s&&null!==s&&"humanReadable"in s&&(s=s.humanReadable||"(none)"),r=`changed the ${n} for task from "${a}" to "${s}"`}if(e.targetId){switch(e.targetId.split("_")[0]){case"task":s=oh(t.roleName)?`/team-tasks?taskId=${e.targetId}`:`/my-tasks?taskId=${e.targetId}`;break;case"meet":s=`/meetings/${e.targetId}`;break;case"report":s=oh(t.roleName)?"/manage-reports":"/my-reports"}}return{id:e.id,timestamp:e.timestamp,actorName:a,originalActorName:e.actorName,actionDescription:r,targetName:e.targetName,targetId:e.targetId,icon:Vt[e.type]||"fas fa-history",originalActionType:e.type,isCrucial:e.isCrucial,targetLink:s}},oh=e=>"Manager"===e||"Super Admin"===e||"Director"===e||"HR"===e,ch=e=>"Director"===e,dh=async e=>(await Jf()).filter(t=>t.attendeeIds.includes(e)||t.createdBy===e),uh=async()=>{const[e,t,n]=await Promise.all([Cf(),Df(),zf()]);return((e,t,n)=>{const a=e.filter(e=>e.status===et.ACTIVE&&"Employee"===e.roleName),s=[],r=new Date,i=r.getMonth(),l=`${r.getFullYear()}-${String(i+1).padStart(2,"0")}`;for(const o of a){const e=t.filter(e=>e.employeeId===o.id),a=n.filter(e=>e.employeeId===o.id),r=e.filter(e=>e.date.startsWith(l)).length;let i=0,c=new Date;c.setHours(12,0,0,0);for(let t=0;t<90;t++){const n=new Date(c);if(n.setDate(c.getDate()-t),qd(n,o,a)){const t=Ht(n);if(!e.some(e=>e.date===t))break;i++}}s.push({userId:o.id,employeeName:o.name,designation:o.designation,businessUnitName:o.businessUnitName,reportsSubmittedThisMonth:r,currentReportingStreak:i})}return s.sort((e,t)=>t.reportsSubmittedThisMonth!==e.reportsSubmittedThisMonth?t.reportsSubmittedThisMonth-e.reportsSubmittedThisMonth:t.currentReportingStreak!==e.currentReportingStreak?t.currentReportingStreak-e.currentReportingStreak:e.employeeName.localeCompare(t.employeeName)).map((e,t)=>({...e,rank:t+1}))})(e,t,n)},mh=async()=>{const e=await Cf(),t=await Df(),n=e.filter(e=>e.status===et.ACTIVE&&"Employee"===e.roleName),a=[];for(const s of n){let e,n=0;const r=t.filter(e=>e.employeeId===s.id).sort((e,t)=>t.date.localeCompare(e.date));r.length>0&&(e=r[0].date);const i=new Date;i.setHours(0,0,0,0);const l=new Date(i.getFullYear(),i.getMonth(),1),o=Ht(l),c=Ht(i),d=r.filter(e=>e.date>=o&&e.date<=c).length;for(let a=0;a<=90;a++){const e=new Date;e.setDate(i.getDate()-a),e.setHours(0,0,0,0);if(!(await hh(e,s)))continue;const r=Ht(e);if(t.some(e=>e.employeeId===s.id&&e.date===r))break;n++}a.push({user:s,consecutiveDaysMissed:n,lastReportSubmittedOn:e,reportsThisMonth:d})}return a.sort((e,t)=>t.consecutiveDaysMissed-e.consecutiveDaysMissed)},ph=async e=>(await zf()).filter(t=>t.employeeId===e),fh=async(e,t,n)=>{const a=await tf.getById(e);if(!a)return null;const s=a.cancelledOccurrences||[];s.includes(t)||s.push(t);const r={...a,cancelledOccurrences:s,updatedAt:Date.now(),updatedBy:n.id};await tf.update(e,r),await Ef({timestamp:r.updatedAt,actorId:n.id,actorName:n.name,type:dt.MEETING_OCCURRENCE_CANCELLED,description:`cancelled the meeting "${r.title}" for ${Wt(t)}`,targetId:r.id,targetName:Wt(t),isCrucial:!0});for(const i of a.attendeeIds)i!==n.id&&await Xf({userId:i,message:`${n.name} ended the "${a.title}" recurring series.`,type:"info",link:`/meetings/${e}`,actors:[{id:n.id,name:n.name}],targetId:e,targetType:"meeting",isCrucial:!0});for(const i of r.attendeeIds)i!==n.id&&await Xf({userId:i,message:`Meeting cancelled for ${Wt(t)}: "${r.title}"`,type:"warning",link:`/meetings/${r.id}`,isCrucial:!0});return r},hh=async(e,t)=>{if(Zt(e,t.weeklyOffDay))return!1;const n=Ht(e);return!(await Wf(t.id,n))},gh=async(e,t)=>{const n=(await tf.getInstancesBySeries(e.id)).filter(e=>new Date(e.occurrenceDate)<t).sort((e,t)=>t.finalizedAt-e.finalizedAt);if(0===n.length)return null;const a=n[0];if(!a.taskIds||0===a.taskIds.length)return{instance:a,tasks:[]};const s=(await Lf()).filter(e=>a.taskIds.includes(e.id)).filter(e=>e.status!==at.Completed);return{instance:a,tasks:s}};const xh=l.createContext(void 0),yh=({children:e})=>{const[t,n]=l.useState([]),a=l.useCallback((e,t,a=4e3)=>{const s=Date.now()+Math.random();n(n=>[...n,{id:s,message:e,type:t,duration:a}])},[]),s=l.useCallback(e=>{n(t=>t.filter(t=>t.id!==e))},[]);return We.jsx(xh.Provider,{value:{toasts:t,addToast:a,removeToast:s},children:e})},bh=()=>{const e=l.useContext(xh);if(void 0===e)throw new Error("useToast must be used within a ToastProvider");return e};function vh(e,t){const[n,a]=l.useState(()=>{try{const n=window.localStorage.getItem(e);return n?JSON.parse(n):t}catch(n){return t}});return l.useEffect(()=>{try{const t=JSON.stringify(n);window.localStorage.setItem(e,t)}catch(t){}},[e,n]),[n,a]}let Nh=!1;const wh=l.createContext(void 0),kh=({children:e})=>{const[t,n]=vh("eod_current_user",null),[a,s]=l.useState(null),[r,i]=l.useState(null),[o,c]=l.useState(!1),[d,u]=l.useState(!0),{addToast:m}=bh(),p=l.useCallback(e=>{i(e),Op(e)},[]),f=l.useCallback(async e=>{if(e&&e.roleId)try{const t=await Af(e.roleId);s(t)}catch(t){s(null)}else s(null)},[]);l.useEffect(()=>{let e=null;return(async()=>{u(!0);try{e=ne(am,async e=>{if(e){if(t)try{const a=await e.getIdTokenResult(),r=!0===a.claims.isTenantAdmin;c(r),Rp(!0===a.claims.isPlatformAdmin);const i=await _f(t.id);i&&i.status===et.ACTIVE?(n(i),await f(i),p(i.tenantId||null)):(n(null),s(null),p(null),c(!1))}catch(a){n(null),s(null),p(null),c(!1)}}else t&&(n(null),s(null),c(!1));u(!1)})}catch(a){u(!1)}})(),()=>{e&&e()}},[]);const h=async()=>{await ae(am),n(null),s(null),p(null),Rp(!1),c(!1);const{clearUserCache:e}=await v(async()=>{const{clearUserCache:e}=await Promise.resolve().then(()=>cf);return{clearUserCache:e}},void 0);e()},g=l.useCallback(async()=>{if(t){const e=await _f(t.id);if(e){const a=e.roleId!==t.roleId;n(e),a&&await f(e)}else await h()}},[t,n,f]),x=l.useCallback(e=>{if(null==t?void 0:t.isPlatformAdmin)return!0;if(o){if([Xe.CAN_MANAGE_USERS,Xe.CAN_CREATE_USER,Xe.CAN_EDIT_USER,Xe.CAN_ARCHIVE_USER,Xe.CAN_DELETE_ARCHIVED_USER,Xe.CAN_MANAGE_ROLES,Xe.CAN_MANAGE_BUSINESS_UNITS,Xe.CAN_MANAGE_TEAM_TASKS,Xe.CAN_EDIT_ANY_TASK_STATUS,Xe.CAN_CREATE_PERSONAL_TASKS,Xe.CAN_VIEW_OWN_TASKS,Xe.CAN_VIEW_OWN_REPORTS,Xe.CAN_SUBMIT_OWN_EOD,Xe.CAN_MANAGE_TEAM_REPORTS,Xe.CAN_ACKNOWLEDGE_REPORTS,Xe.CAN_VIEW_ALL_REPORTS,Xe.CAN_MANAGE_ALL_LEAVES,Xe.CAN_MANAGE_TEAM_MEETINGS,Xe.CAN_VIEW_OWN_MEETINGS,Xe.CAN_VIEW_OWN_CALENDAR,Xe.CAN_USE_PERFORMANCE_HUB,Xe.CAN_USE_GOOGLE_CALENDAR,Xe.CAN_USE_TELEGRAM_BOT,Xe.CAN_USE_GEMINI_AI].includes(e))return!0}if(a)return a.permissions.includes(e);if(null==t?void 0:t.roleName){const n=t.roleName.toLowerCase();if("tenant admin"===n||"admin"===n||"super admin"===n)return![Xe.PLATFORM_ADMIN,Xe.CAN_MANAGE_TENANTS,Xe.CAN_VIEW_ALL_TENANTS].includes(e);if("manager"===n)return[Xe.CAN_MANAGE_TEAM_TASKS,Xe.CAN_EDIT_ANY_TASK_STATUS,Xe.CAN_CREATE_PERSONAL_TASKS,Xe.CAN_VIEW_OWN_TASKS,Xe.CAN_MANAGE_TEAM_REPORTS,Xe.CAN_ACKNOWLEDGE_REPORTS,Xe.CAN_SUBMIT_OWN_EOD,Xe.CAN_VIEW_OWN_REPORTS,Xe.CAN_MANAGE_ALL_LEAVES,Xe.CAN_GRANT_LEAVE_ACCESS,Xe.CAN_MANAGE_TEAM_MEETINGS,Xe.CAN_VIEW_OWN_MEETINGS,Xe.CAN_VIEW_OWN_CALENDAR,Xe.CAN_USE_PERFORMANCE_HUB].includes(e);if("director"===n)return[Xe.CAN_VIEW_ALL_REPORTS,Xe.CAN_MANAGE_TEAM_REPORTS,Xe.CAN_ACKNOWLEDGE_REPORTS,Xe.CAN_VIEW_OWN_REPORTS,Xe.CAN_MANAGE_TEAM_TASKS,Xe.CAN_CREATE_PERSONAL_TASKS,Xe.CAN_EDIT_ANY_TASK_STATUS,Xe.CAN_MANAGE_ALL_LEAVES,Xe.CAN_GRANT_LEAVE_ACCESS,Xe.CAN_MANAGE_WEEKLY_OFF,Xe.CAN_SUBMIT_OWN_LEAVE,Xe.CAN_MANAGE_TEAM_MEETINGS,Xe.CAN_VIEW_OWN_MEETINGS,Xe.CAN_VIEW_LEADERBOARD,Xe.CAN_VIEW_TEAM_CALENDAR,Xe.CAN_VIEW_OWN_CALENDAR,Xe.CAN_USE_PERFORMANCE_HUB,Xe.CAN_VIEW_TRIGGER_LOG].includes(e);if("team lead"===n)return[Xe.CAN_MANAGE_TEAM_TASKS,Xe.CAN_CREATE_PERSONAL_TASKS,Xe.CAN_VIEW_OWN_TASKS,Xe.CAN_MANAGE_TEAM_REPORTS,Xe.CAN_SUBMIT_OWN_EOD,Xe.CAN_VIEW_OWN_REPORTS,Xe.CAN_MANAGE_TEAM_MEETINGS,Xe.CAN_VIEW_OWN_MEETINGS,Xe.CAN_VIEW_OWN_CALENDAR].includes(e);if("employee"===n)return[Xe.CAN_CREATE_PERSONAL_TASKS,Xe.CAN_VIEW_OWN_TASKS,Xe.CAN_SUBMIT_OWN_EOD,Xe.CAN_VIEW_OWN_REPORTS,Xe.CAN_VIEW_OWN_MEETINGS,Xe.CAN_VIEW_OWN_CALENDAR].includes(e)}return!1},[a,t,o]);return We.jsx(wh.Provider,{value:{currentUser:t,currentUserRole:a,currentTenantId:r,login:async(e,t)=>{try{if(!t)return!1;const s=await se(am,e,t),r=s.user.uid;await s.user.getIdToken(!0);const i=await s.user.getIdTokenResult();c(!0===i.claims.isTenantAdmin);const l=await _f(r);if(l){if(l.status===et.ARCHIVED)return m("Your account has been archived and cannot be accessed.","error"),await ae(am),!1;p(l.tenantId||null),Rp(l.isPlatformAdmin||!1);const e=!0===i.claims.isTenantAdmin;c(e),await f(l),n(l),(l.isPlatformAdmin||e)&&l.tenantId&&async function(e){if(!Nh){Nh=!0;try{const n=await jm(e);if(!n||0===n.length)return;let a=!1;const s=[];for(const e of n){const t=e.id;if(!It.includes(t))continue;const n=Dt.find(e=>e.id===t);if(!n)continue;const r=new Set(e.permissions||[]);n.permissions.filter(e=>!r.has(e)).length>0&&(a=!0,s.push({roleData:e,roleId:t,template:n}))}if(!a)return;for(const{roleData:e,roleId:r,template:i}of s)try{const t=e.id,n=z(sm,"roles",t);await q(n,{permissions:i.permissions,description:i.description})}catch(t){}}catch(t){}}}(l.tenantId).catch(e=>{});try{await ih(l.id)}catch(a){}try{await Ef({timestamp:Date.now(),actorId:l.id,actorAuthUid:r,actorName:l.name,type:"USER_LOGIN",description:"logged in to the system",tenantId:l.tenantId||"platform"})}catch(a){}return"Notification"in window&&"default"===Notification.permission&&Notification.requestPermission().then(e=>{}),!0}return m("User profile not found","error"),await ae(am),!1}catch(s){return"auth/invalid-credential"===(null==s?void 0:s.code)||"auth/user-not-found"===(null==s?void 0:s.code)||"auth/wrong-password"===(null==s?void 0:s.code)?m("Invalid email or password","error"):"auth/too-many-requests"===(null==s?void 0:s.code)?m("Too many failed attempts. Please try again later.","error"):m("Login failed. Please try again.","error"),!1}},logout:h,isLoading:d,refreshUser:g,hasPermission:x},children:e})},Eh=()=>{const e=l.useContext(wh);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e},jh=e=>{const{hasPermission:t}=Eh();return t(e)},Ch=({label:e,id:t,error:n,className:a="",wrapperClassName:s="",fieldIdentifier:r,...i})=>{const l=n?"border-red-500 focus:ring-red-500 focus:border-red-500":"";return We.jsxs("div",{className:`mb-2 ${s}`,children:[" ",e&&We.jsx("label",{htmlFor:t,className:"block text-sm font-medium text-text-primary dark:text-dark-text-primary",children:e}),We.jsx("input",{id:t,"data-fieldidentifier":r,className:`mt-1 block w-full px-3 py-2 bg-surface-inset dark:bg-dark-surface-inset border border-border-primary dark:border-dark-border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-accent focus:border-accent sm:text-sm transition text-text-primary dark:text-dark-text-primary placeholder:text-text-secondary dark:placeholder:text-dark-text-secondary focus:animate-input-glow ${l} ${a}`,...i}),n&&We.jsx("p",{className:"mt-1 text-xs text-red-600",children:n})]})},_h=({children:e,variant:t="primary",size:n="md",isLoading:a=!1,icon:s,className:r="",to:i,onClick:l,...d})=>{const u=!(!s||e&&0!==o.Children.count(e)),m={sm:u?"w-9 h-9 p-0 text-lg":"px-3 py-1.5 text-sm",md:u?"w-10 h-10 p-0 text-xl":"px-4 py-2 text-base",lg:u?"w-12 h-12 p-0 text-2xl":"px-6 py-3 text-lg"},p=a||d.disabled?"opacity-60 cursor-not-allowed transform-none hover:shadow-sm":"",f=`rounded-lg font-semibold focus:outline-none focus:ring-2 focus:ring-offset-2 transition-all duration-200 ease-in-out flex items-center justify-center shadow-sm hover:shadow-md disabled:shadow-sm transform hover:-translate-y-0.5 active:translate-y-0 ${{primary:"bg-gradient-to-r from-primary to-secondary text-white hover:shadow-lg hover:shadow-primary/50 focus:ring-accent dark:from-sky-500 dark:to-cyan-400 dark:hover:shadow-cyan-500/30 dark:focus:ring-cyan-300 dark:focus:ring-offset-dark-bg",secondary:"bg-secondary hover:bg-secondary-hover text-white focus:ring-secondary dark:focus:ring-offset-dark-bg",danger:"bg-red-600 hover:bg-red-700 text-white focus:ring-red-500 dark:focus:ring-offset-dark-bg",warning:"bg-amber-500 hover:bg-amber-600 text-white focus:ring-amber-500 dark:focus:ring-offset-dark-bg",success:"bg-emerald-500 hover:bg-emerald-600 text-white focus:ring-emerald-400 dark:focus:ring-offset-dark-bg",ghost:"bg-surface-secondary/70 dark:bg-dark-surface-secondary/70 hover:bg-surface-hover dark:hover:bg-dark-surface-hover text-text-secondary dark:text-dark-text-secondary border-0 focus:ring-primary focus:ring-opacity-50 dark:focus:ring-offset-dark-bg",outline:"bg-transparent hover:bg-accent/10 text-accent border border-accent focus:ring-accent dark:focus:ring-offset-dark-bg"}[t]} ${m[n]} ${p} ${r}`,h=We.jsx(We.Fragment,{children:a?We.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[We.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),We.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):We.jsxs(We.Fragment,{children:[s,e&&We.jsx("span",{className:(s?"ml-2":"")+" whitespace-nowrap",children:e})]})});if(i){const{disabled:e,type:t,...n}=d;return We.jsx(c,{to:i,className:f,onClick:t=>{(a||e)&&t.preventDefault(),l&&l(t)},"aria-disabled":a||e,...n,children:h})}return We.jsx("button",{className:f,disabled:a||d.disabled,onClick:l,...d,children:h})},Th=({message:e,children:t,className:n="",...a})=>{const[s,r]=o.useState(a.type),i={success:We.jsx("i",{className:"fas fa-check-circle mr-3 text-emerald-500 dark:text-emerald-400"}),error:We.jsx("i",{className:"fas fa-exclamation-circle mr-3 text-red-500 dark:text-red-400"}),warning:We.jsx("i",{className:"fas fa-exclamation-triangle mr-3 text-amber-500 dark:text-amber-400"}),info:We.jsx("i",{className:"fas fa-info-circle mr-3 text-blue-500 dark:text-blue-400"})},[l,c]=o.useState(!0);return l?We.jsx("div",{className:`border-l-4 p-4 my-4 rounded-r-lg shadow-sm ${{success:"bg-emerald-50 border-emerald-500 text-emerald-800 dark:bg-emerald-500/10 dark:border-emerald-500/30 dark:text-emerald-300",error:"bg-red-50 border-red-500 text-red-800 dark:bg-red-500/10 dark:border-red-500/30 dark:text-red-300",warning:"bg-amber-50 border-amber-500 text-amber-800 dark:bg-amber-500/10 dark:border-amber-500/30 dark:text-amber-300",info:"bg-blue-50 border-blue-500 text-blue-800 dark:bg-blue-500/10 dark:border-blue-500/30 dark:text-blue-300"}[s]} ${n}`,role:"alert",children:We.jsxs("div",{className:"flex items-start",children:[We.jsx("div",{className:"flex-shrink-0 pt-0.5",children:i[s]}),We.jsxs("div",{className:"flex-1",children:[e&&We.jsx("p",{className:"font-medium",children:e}),t&&We.jsx("div",{className:e?"mt-2":"",children:t})]}),We.jsx("button",{onClick:()=>{c(!1),a.onClose&&a.onClose()},className:"ml-auto -mx-1.5 -my-1.5 p-1.5 rounded-lg focus:ring-2 focus:ring-opacity-50","aria-label":"Dismiss",children:We.jsx("i",{className:"fas fa-times"})})]})}):null},Sh=()=>{const[e,t]=l.useState(""),[n,a]=l.useState(""),[s,r]=l.useState(""),{login:i,isLoading:o,currentUser:u}=Eh(),m=d();l.useEffect(()=>{u&&m("/",{replace:!0})},[u,m]);return We.jsx("div",{className:"w-full h-screen flex items-center justify-center p-4",children:We.jsxs("div",{className:"bg-surface-primary/70 dark:bg-dark-surface-primary/70 backdrop-blur-xl p-8 md:p-12 rounded-2xl shadow-2xl w-full max-w-md relative z-10 border border-border-primary dark:border-dark-border",children:[We.jsxs("div",{className:"text-center mb-8",children:[We.jsx("div",{className:"inline-block bg-gradient-to-br from-primary to-secondary dark:from-sky-500 dark:to-cyan-400 text-white p-4 rounded-full mb-4 shadow-lg",children:We.jsx("i",{className:"fas fa-infinity text-3xl"})}),We.jsx("h1",{className:"text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-primary to-secondary dark:from-sky-400 dark:to-cyan-400",children:ut}),We.jsx("p",{className:"text-text-secondary dark:text-dark-text-secondary mt-1",children:"The Future. In Sync."})]}),s&&We.jsx(Th,{type:"error",message:s}),We.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),r(""),!e.trim()||!n.trim())return void r("Email and password are required.");await i(e,n)||r("Invalid email or password, or account is suspended.")},className:"space-y-4",children:[We.jsx(Ch,{label:"Email Address",id:"email",type:"email",value:e,onChange:e=>t(e.target.value),placeholder:"you@example.com",required:!0,autoFocus:!0,autoComplete:"email"}),We.jsx(Ch,{label:"Password",id:"password",type:"password",value:n,onChange:e=>a(e.target.value),placeholder:"",required:!0,autoComplete:"current-password"}),We.jsx(_h,{type:"submit",variant:"primary",className:"w-full mt-4",isLoading:o,size:"lg",children:o?"Signing In...":"Sign In"})]}),We.jsxs("p",{className:"text-xs text-text-secondary dark:text-dark-text-secondary mt-6 text-center",children:["By signing in, you agree to our"," ",We.jsx(c,{to:"/terms-of-service",className:"text-primary hover:underline",children:"Terms of Service"}),".",We.jsx("br",{})," ",(new Date).getFullYear()," Syncly. All rights reserved."]})]})})},Ah=({children:e,title:t})=>{const n=u(),a=d(),{currentUser:s}=Eh(),r=!["/","/dashboard"].includes(n.pathname),i=n.pathname.split("/").filter(Boolean).length>1,l=i?"Go back to previous page":"Go back to Dashboard",o=i?"Back":"Dashboard";return We.jsxs("div",{className:"p-4 md:p-8",children:[We.jsxs("div",{className:"flex items-center mb-6",children:[r&&We.jsx(_h,{onClick:()=>{a(i?-1:"/")},variant:"ghost",size:"sm",className:"mr-3 bg-surface-secondary dark:bg-dark-surface-secondary hover:bg-surface-hover dark:hover:bg-dark-surface-hover text-text-secondary dark:text-dark-text-secondary","aria-label":l,title:o,icon:We.jsx("i",{className:"fas fa-arrow-left"}),children:"Back"}),t&&We.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-text-primary dark:text-dark-text",children:t})]}),e]})},Ih=({children:e,className:t="",title:n,titleIcon:a,actions:s,onClick:r})=>{const i=r?"cursor-pointer hover:shadow-xl hover:-translate-y-1":"";return We.jsxs("div",{className:`bg-surface-primary dark:bg-dark-surface-primary backdrop-blur-md shadow-lg rounded-xl border border-border-primary dark:border-dark-border transition-all duration-300 ease-in-out ${i} ${t}`,onClick:r,children:[(n||s)&&We.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border-primary dark:border-dark-border bg-surface-primary/50 dark:bg-dark-surface-primary/50 rounded-t-xl",children:[n&&We.jsxs("h3",{className:"text-lg font-semibold text-primary dark:text-accent flex items-center",children:[a&&We.jsx("span",{className:"mr-3 text-primary/80 dark:text-accent/80",children:a}),n]}),s&&We.jsx("div",{children:s})]}),We.jsx("div",{className:"p-4 sm:p-6 text-text-primary dark:text-dark-text",children:e})]})},Dh=({isOpen:e,onClose:t,title:n,children:a,footer:s,size:r="md"})=>{if(l.useEffect(()=>{const n=e=>{"Escape"===e.key&&t()};return e&&(document.addEventListener("keydown",n),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",n),document.body.style.overflow="auto"}},[e,t]),!e)return null;return We.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm transition-opacity duration-300 ease-in-out",onClick:t,children:[We.jsxs("div",{className:`bg-surface-primary/95 dark:bg-dark-surface-primary/95 backdrop-blur-lg border border-border-primary dark:border-dark-border rounded-xl shadow-2xl m-4 w-full ${{sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-2xl"}[r]} transform transition-all duration-300 ease-in-out scale-95 opacity-0 animate-fade-scale-in flex flex-col`,onClick:e=>e.stopPropagation(),style:{animationFillMode:"forwards"},children:[We.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border-primary dark:border-dark-border flex-shrink-0",children:[We.jsx("h3",{className:"text-xl font-semibold text-primary dark:text-accent",children:n}),We.jsx("button",{onClick:t,"aria-label":"Close modal",className:"text-text-secondary dark:text-dark-text-secondary hover:text-text-primary dark:hover:text-dark-text rounded-full w-8 h-8 flex items-center justify-center hover:bg-surface-hover dark:hover:bg-dark-surface-hover transition",children:We.jsx("i",{className:"fas fa-times"})})]}),We.jsx("div",{className:"text-text-primary dark:text-dark-text max-h-[70vh] overflow-y-auto p-6 flex-grow",children:a}),s&&We.jsx("div",{className:"p-4 bg-surface-secondary/50 dark:bg-dark-surface-secondary/50 border-t border-border-primary dark:border-dark-border flex justify-end space-x-3 flex-shrink-0 rounded-b-xl",children:s})]}),We.jsx("style",{children:"\n        @keyframes fade-scale-in {\n          from { opacity: 0; transform: scale(0.95); }\n          to { opacity: 1; transform: scale(1); }\n        }\n        .animate-fade-scale-in {\n          animation: fade-scale-in 0.2s ease-out forwards;\n        }\n      "})]})},Oh=({label:e,id:t,error:n,options:a,className:s="",wrapperClassName:r="",placeholder:i,...l})=>{const o=n?"border-red-500 focus:ring-red-500 focus:border-red-500":"";return We.jsxs("div",{className:`mb-2 ${r}`,children:[" ",e&&We.jsx("label",{htmlFor:t,className:"block text-sm font-medium text-text-primary dark:text-dark-text-primary",children:e}),We.jsxs("select",{id:t,className:`mt-1 block w-full pl-3 pr-10 py-2 bg-surface-inset dark:bg-dark-surface-inset border-border-primary dark:border-dark-border text-text-primary dark:text-dark-text-primary focus:outline-none focus:ring-2 focus:ring-accent focus:border-accent sm:text-sm rounded-lg shadow-sm transition focus:animate-input-glow ${o} ${s}`,...l,children:[i&&We.jsx("option",{value:"",disabled:!0,children:i}),a.map(e=>We.jsx("option",{value:e.value,className:"bg-white dark:bg-dark-bg",children:e.label},e.value))]}),n&&We.jsx("p",{className:"mt-1 text-xs text-red-600",children:n})]})},Rh=({currentUserToEdit:e,onFormSubmit:t,onCancel:n})=>{const{currentUser:a}=Eh(),[s,r]=l.useState(""),[i,o]=l.useState(""),[c,d]=l.useState(""),[u,m]=l.useState(""),[p,f]=l.useState(""),[h,g]=l.useState(""),[x,y]=l.useState(""),[b,N]=l.useState(void 0),[w,k]=l.useState([]),[E,j]=l.useState([]),[C,_]=l.useState(""),[T,S]=l.useState(!1),A=!!e,I=w.find(e=>e.id===p);l.useEffect(()=>{(async()=>{const[e,t]=await Promise.all([If(),Sf()]);j(e.filter(e=>"active"===e.status)),k(t.filter(e=>"super_admin"!==e.id))})()},[]),l.useEffect(()=>{e?(r(e.name),o(e.email),m(e.notificationEmail||""),f(e.roleId),g(e.designation||""),y(e.weeklyOffDay||""),N(e.businessUnitId||void 0)):(r(""),o(""),d(""),m(""),f(""),g(""),y(Ct[0]),N(void 0))},[e]);const D=w.map(e=>({value:e.id,label:e.name})),O=Ct.map(e=>({value:e,label:e})),R=E.map(e=>({value:e.id,label:e.name}));return We.jsxs("form",{onSubmit:async n=>{if(n.preventDefault(),_(""),!(s.trim()&&i.trim()&&p&&u.trim()))return void _("Name, Login Email, Notification Email, and Role are required.");if(!A&&!c.trim())return void _("Password is required for new users.");const r="Manager"===(null==I?void 0:I.name)||"Employee"===(null==I?void 0:I.name);if(!r||b)if("Employee"!==(null==I?void 0:I.name)||x)if(a){S(!0);try{let n;const l={name:s.trim(),email:i.trim(),notificationEmail:u.trim(),roleId:p,designation:"Employee"===(null==I?void 0:I.name)?h:void 0,weeklyOffDay:"Employee"===(null==I?void 0:I.name)?x:void 0,businessUnitId:r?b:void 0,password:A?void 0:c.trim()};if(A){const t={...e,...l};n=await Tf(t,a)}else n=await(async(e,t)=>{var n,a,s;if((await Cf()).some(t=>t.email.toLowerCase()===e.email.toLowerCase()))throw new Error("A user with this email already exists.");const r=Up(),i=e.password||`${e.email.split("@")[0]}@2025`,l=await Sf(),o=await If(),c=l.find(t=>t.id===e.roleId),d=o.find(t=>t.id===e.businessUnitId);try{const{callCreateUser:a}=await v(async()=>{const{callCreateUser:e}=await Promise.resolve().then(()=>fg);return{callCreateUser:e}},void 0),s=await a({email:e.email.toLowerCase(),password:i,name:e.name,roleId:e.roleId,roleName:(null==c?void 0:c.name)||"Employee",notificationEmail:(null==(n=e.notificationEmail)?void 0:n.toLowerCase())||e.email.toLowerCase(),businessUnitId:e.businessUnitId||"",businessUnitName:(null==d?void 0:d.name)||"",designation:e.designation||"",tenantId:r}),{clearUserCache:l}=await v(async()=>{const{clearUserCache:e}=await Promise.resolve().then(()=>cf);return{clearUserCache:e}},void 0);l();const o=await _f(s.userId);return o?(await Ef({timestamp:Date.now(),actorId:t.id,actorName:t.name,type:dt.USER_CREATED,description:`created a new user: ${o.name}`,targetUserId:o.id,targetUserName:o.name}),o):null}catch(C){if((null==(a=C.message)?void 0:a.includes("email-already-in-use"))||(null==(s=C.message)?void 0:s.includes("already exists")))throw new Error("This email is already registered. If the user doesn't appear in the list, please contact support to clean up orphaned accounts.");throw new Error(C.message||"Failed to create user")}})(l,a);n?t(n,!A):_("Failed to save user. Please try again.")}catch(l){_(`Failed to save user: ${l.message}`)}finally{S(!1)}}else _("Administrator context not found. Please re-login.");else _("Weekly Off Day is required for Employees.");else _("Business Unit is required for this role.")},className:"space-y-4",children:[C&&We.jsx(Th,{type:"error",message:C,onClose:()=>_("")}),We.jsx(Ch,{label:"Full Name",id:"userName",value:s,onChange:e=>r(e.target.value),required:!0}),We.jsx(Ch,{label:"Login Email (Internal ID)",id:"userEmail",type:"email",value:i,onChange:e=>o(e.target.value),required:!0,disabled:A,placeholder:"e.g., firstname.lastname@mittaleod.com"}),!A&&We.jsx(Ch,{label:"Password",id:"userPassword",type:"password",value:c,onChange:e=>d(e.target.value),required:!0,placeholder:"Minimum 6 characters",minLength:6}),We.jsx(Ch,{label:"Notification Email (Real Email)",id:"userNotificationEmail",type:"email",value:u,onChange:e=>m(e.target.value),required:!0,placeholder:"e.g., real.email@company.com"}),We.jsx(Oh,{label:"Role",id:"userRole",options:D,value:p,onChange:e=>f(e.target.value),required:!0,placeholder:"Select a role"}),("Employee"===(null==I?void 0:I.name)||"Manager"===(null==I?void 0:I.name))&&We.jsx(Oh,{label:"Business Unit",id:"userBusinessUnit",options:R,value:b||"",onChange:e=>N(e.target.value),required:!0,placeholder:"Select Business Unit"}),"Employee"===(null==I?void 0:I.name)&&We.jsxs(We.Fragment,{children:[We.jsx(Ch,{label:"Designation (Optional for Employee)",id:"userDesignation",value:h,onChange:e=>g(e.target.value)}),We.jsx(Oh,{label:"Weekly Off Day",id:"userWeeklyOff",options:O,value:x,onChange:e=>y(e.target.value),required:!0,placeholder:"Select weekly off day"})]}),We.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[We.jsx(_h,{type:"button",variant:"ghost",onClick:n,children:"Cancel"}),We.jsx(_h,{type:"submit",variant:"primary",isLoading:T,children:T?"Saving...":A?"Update User":"Add User"})]})]})},Ph=({size:e="md",color:t="text-primary",message:n})=>We.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[We.jsxs("svg",{className:`animate-spin ${{sm:"h-6 w-6",md:"h-10 w-10",lg:"h-16 w-16"}[e]} ${t}`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[We.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),We.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),n&&We.jsx("p",{className:`mt-2 text-sm ${t}`,children:n})]}),Mh={sm:"w-6 h-6 text-xs",md:"w-8 h-8 text-sm",lg:"w-10 h-10 text-base"},Uh=({name:e,size:t="md",className:n=""})=>{const a=((e="")=>{if(!e||"string"!=typeof e)return"?";const t=e.trim().split(" ");return t.length>1?(t[0][0]+t[t.length-1][0]).toUpperCase():1===t.length&&t[0].length>0?t[0][0].toUpperCase():"?"})(e),s=(e=>{let t=0;for(let a=0;a<e.length;a++)t=e.charCodeAt(a)+((t<<5)-t);const n=["bg-red-500","bg-orange-500","bg-amber-500","bg-yellow-500","bg-lime-500","bg-green-500","bg-emerald-500","bg-teal-500","bg-cyan-500","bg-sky-500","bg-blue-500","bg-indigo-500","bg-violet-500","bg-purple-500","bg-fuchsia-500","bg-pink-500","bg-rose-500"];return n[Math.abs(t%n.length)]})(e||"");return We.jsx("div",{className:`rounded-full flex items-center justify-center font-bold text-white flex-shrink-0 ${s} ${Mh[t]} ${n}`,title:e,children:a})},Lh=({isOpen:e,onClose:t,onConfirm:n,title:a,children:s,confirmText:r="Confirm",cancelText:i="Cancel",confirmButtonVariant:l="primary"})=>We.jsx(Dh,{isOpen:e,onClose:t,title:a,footer:We.jsxs(We.Fragment,{children:[We.jsx(_h,{variant:"ghost",onClick:t,children:i}),We.jsx(_h,{variant:l,onClick:n,children:r})]}),children:We.jsx("div",{className:"text-mediumtext",children:s})}),{useSearchParams:Fh}=m,Bh=()=>{const{currentUser:e,hasPermission:t}=Eh(),[n,a]=l.useState([]),[s,r]=l.useState([]),[i,o]=l.useState(!0),[c,d]=l.useState(!1),[u,m]=l.useState(null),[p,f]=l.useState(null),[h,g]=l.useState(null),[x,y]=l.useState(null),{addToast:b}=bh(),[v,j]=l.useState([]),[C,_]=l.useState(!1),T=l.useRef(null),[S,A]=Fh(),I=S.get("search")||"",D=S.get("role")||"",O=S.get("bu")||"",R=S.get("status")||et.ACTIVE,P=parseInt(S.get("page")||"1",10);l.useEffect(()=>{const e=e=>{T.current&&!T.current.contains(e.target)&&_(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const M=l.useCallback(async()=>{o(!0);try{const[e,t,n]=await Promise.all([Cf(),Sf(),If()]);a(e),r(t),j(n)}catch(e){b("Error loading users: "+e.message,"error")}o(!1)},[e]);l.useEffect(()=>{M()},[M]);const U=e=>{f(e)},L=e=>{A(t=>(Object.entries(e).forEach(([e,n])=>{n?t.set(e,n):t.delete(e)}),e.hasOwnProperty("page")||t.delete("page"),t),{replace:!0})},F=l.useMemo(()=>n.filter(e=>{const t=I.toLowerCase();return e.name.toLowerCase().includes(t)||e.email.toLowerCase().includes(t)||e.designation&&e.designation.toLowerCase().includes(t)}).filter(e=>!D||e.roleId===D).filter(e=>!O||e.businessUnitId===O).filter(e=>"all"===R||e.status===R).sort((e,t)=>e.name.localeCompare(t.name)),[n,D,O,I,R]),B=Math.ceil(F.length/10),$=l.useMemo(()=>{const e=10*(P-1);return F.slice(e,e+10)},[F,P]),G=e=>{e>=1&&e<=B&&L({page:String(e)})},V=()=>F.map(e=>({"User ID":e.id,Name:e.name,Email:e.email,Role:e.roleName||"N/A","Business Unit":e.businessUnitName||"N/A",Designation:e.designation||"N/A",Status:e.status,"Weekly Off Day":e.weeklyOffDay||"N/A"}));return i?We.jsx(Ph,{message:"Loading user data..."}):We.jsxs(We.Fragment,{children:[We.jsxs(Ih,{title:"User Management",titleIcon:We.jsx("i",{className:"fas fa-users-cog"}),actions:We.jsxs("div",{className:"flex items-center space-x-2",children:[We.jsxs("div",{className:"relative",ref:T,children:[We.jsxs(_h,{variant:"secondary",onClick:()=>_(!C),icon:We.jsx("i",{className:"fas fa-file-export"}),disabled:0===F.length,children:["Export (",F.length,")",We.jsx("i",{className:"fas fa-chevron-down ml-2 transition-transform "+(C?"rotate-180":"")})]}),C&&We.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-surface-primary dark:bg-dark-surface-primary rounded-md shadow-lg py-1 z-20 border border-border-primary dark:border-dark-border",children:[We.jsxs("button",{onClick:()=>{const e=V();if(0===e.length)return void alert("No data to export based on current filters.");const t=Object.keys(e[0]),n="data:text/csv;charset=utf-8,"+t.join(",")+"\n"+e.map(e=>t.map(t=>`"${String(e[t]).replace(/"/g,'""')}"`).join(",")).join("\n"),a=encodeURI(n),s=document.createElement("a");s.setAttribute("href",a),s.setAttribute("download","user_management_export.csv"),document.body.appendChild(s),s.click(),document.body.removeChild(s),_(!1)},className:"w-full text-left block px-4 py-2 text-sm text-text-primary dark:text-dark-text hover:bg-primary-light dark:hover:bg-dark-surface-hover hover:text-primary",children:[We.jsx("i",{className:"fas fa-file-csv mr-2"}),"Export as CSV"]}),We.jsxs("button",{onClick:()=>{const e=V();if(0===e.length)return void alert("No data to export based on current filters.");const t=new N({orientation:"landscape"}),n=Object.keys(e[0]),a=e.map(e=>n.map(t=>String(e[t])));w(t,{head:[n],body:a,styles:{fontSize:8},headStyles:{fillColor:[0,85,164]},margin:{top:10,right:5,bottom:10,left:5},tableWidth:"auto"}),t.save("user_management_export.pdf"),_(!1)},className:"w-full text-left block px-4 py-2 text-sm text-text-primary dark:text-dark-text hover:bg-primary-light dark:hover:bg-dark-surface-hover hover:text-primary",children:[We.jsx("i",{className:"fas fa-file-pdf mr-2"}),"Export as PDF"]}),We.jsxs("button",{onClick:()=>{const e=V();if(0===e.length)return void alert("No data to export based on current filters.");const t=k.json_to_sheet(e),n=k.book_new();k.book_append_sheet(n,t,"Users"),E(n,"user_management_export.xlsx"),_(!1)},className:"w-full text-left block px-4 py-2 text-sm text-text-primary dark:text-dark-text hover:bg-primary-light dark:hover:bg-dark-surface-hover hover:text-primary",children:[We.jsx("i",{className:"fas fa-file-excel mr-2"}),"Export as Excel"]})]})]}),t(Xe.CAN_CREATE_USER)&&We.jsx(_h,{onClick:()=>{m(null),d(!0)},variant:"primary",icon:We.jsx("i",{className:"fas fa-user-plus"}),children:"Add User"})]}),children:[We.jsx("div",{className:"mb-4 p-3 bg-surface-secondary dark:bg-dark-surface-secondary rounded-lg border dark:border-dark-border",children:We.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[We.jsx(Ch,{type:"text",placeholder:"Search by name, email, designation...",value:I,onChange:e=>L({search:e.target.value}),wrapperClassName:"mb-0"}),We.jsx(Oh,{options:[{value:"",label:"All Roles"},...s.map(e=>({value:e.id,label:e.name}))],value:D,onChange:e=>L({role:e.target.value}),wrapperClassName:"mb-0"}),We.jsx(Oh,{options:[{value:"",label:"All Business Units"},...v.map(e=>({value:e.id,label:e.name}))],value:O,onChange:e=>L({bu:e.target.value}),wrapperClassName:"mb-0"}),We.jsx(Oh,{options:[{value:"all",label:"All Statuses"},{value:et.ACTIVE,label:"Active"},{value:et.ARCHIVED,label:"Archived"}],value:R,onChange:e=>L({status:e.target.value}),wrapperClassName:"mb-0"})]})}),x&&We.jsx(Th,{type:x.type,message:x.message,onClose:()=>y(null)}),We.jsx("div",{className:"overflow-x-auto",children:We.jsxs("table",{className:"min-w-full divide-y divide-border-primary dark:divide-dark-border",children:[We.jsx("thead",{className:"bg-surface-secondary dark:bg-dark-surface-secondary",children:We.jsxs("tr",{children:[We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase tracking-wider",children:"Name"}),We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase tracking-wider",children:"Role"}),We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase tracking-wider",children:"Business Unit"}),We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase tracking-wider",children:"Status"}),We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase tracking-wider",children:"Actions"})]})}),We.jsx("tbody",{className:"bg-surface-primary dark:bg-dark-surface-primary divide-y divide-border-primary dark:divide-dark-border",children:$.map(e=>We.jsxs("tr",{className:"hover:bg-surface-hover dark:hover:bg-dark-surface-hover",children:[We.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:We.jsxs("div",{className:"flex items-center",children:[We.jsx(Uh,{name:e.name,size:"md",className:"mr-3"}),We.jsxs("div",{children:[We.jsx("div",{className:"text-sm font-medium text-text-primary dark:text-dark-text",children:e.name}),We.jsx("div",{className:"text-xs text-text-secondary dark:text-dark-text-secondary",children:e.email})]})]})}),We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-text-secondary dark:text-dark-text-secondary",children:e.roleName}),We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-text-secondary dark:text-dark-text-secondary",children:e.businessUnitName||"N/A"}),We.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:We.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+(e.status===et.ACTIVE?"bg-green-100 text-green-800 dark:bg-green-500/20 dark:text-green-300":"bg-yellow-100 text-yellow-800 dark:bg-yellow-500/20 dark:text-yellow-300"),children:e.status})}),We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:We.jsxs("div",{className:"flex items-center space-x-2",children:[t(Xe.CAN_EDIT_USER)&&We.jsx(_h,{variant:"ghost",size:"sm",onClick:()=>(e=>{m(e),d(!0)})(e),children:"Edit"}),e.status===et.ACTIVE&&t(Xe.CAN_ARCHIVE_USER)&&We.jsx(_h,{variant:"warning",size:"sm",onClick:()=>U(e),children:"Archive"}),e.status===et.ARCHIVED&&t(Xe.CAN_ARCHIVE_USER)&&We.jsx(_h,{variant:"success",size:"sm",onClick:()=>U(e),children:"Unarchive"}),e.status===et.ARCHIVED&&t(Xe.CAN_DELETE_ARCHIVED_USER)&&We.jsx(_h,{variant:"danger",size:"sm",onClick:()=>(e=>{g(e)})(e),children:"Delete"})]})})]},e.id))})]})}),B>1&&We.jsxs("div",{className:"mt-4 flex justify-between items-center",children:[We.jsxs("span",{className:"text-sm text-text-secondary dark:text-dark-text-secondary",children:["Page ",P," of ",B]}),We.jsxs("div",{children:[We.jsx(_h,{onClick:()=>G(P-1),disabled:1===P,variant:"ghost",size:"sm",children:"Previous"}),We.jsx(_h,{onClick:()=>G(P+1),disabled:P===B,variant:"ghost",size:"sm",className:"ml-2",children:"Next"})]})]})]}),We.jsx(Dh,{isOpen:c,onClose:()=>d(!1),title:u?"Edit User":"Add New User",children:We.jsx(Rh,{currentUserToEdit:u,onFormSubmit:async(e,t)=>{b(`User "${e.name}" ${t?"added":"updated"} successfully.`,"success"),d(!1),await new Promise(e=>setTimeout(e,500)),await M()},onCancel:()=>d(!1)})}),We.jsxs(Lh,{isOpen:!!p,onClose:()=>f(null),onConfirm:async()=>{if(!p||!e)return;const t=p.status===et.ACTIVE,n=t?et.ARCHIVED:et.ACTIVE,a={...p,status:n};await Tf(a,e)?(b(`User ${p.name} has been ${t?"archived":"re-activated"}.`,"success"),M()):b("Failed to update user status.","error"),f(null)},title:"Confirm User Status Change",confirmButtonVariant:(null==p?void 0:p.status)===et.ACTIVE?"warning":"success",confirmText:(null==p?void 0:p.status)===et.ACTIVE?"Yes, Archive":"Yes, Unarchive",children:[We.jsxs("p",{children:["Are you sure you want to ",(null==p?void 0:p.status)===et.ACTIVE?"archive":"unarchive"," the user ",We.jsx("strong",{children:null==p?void 0:p.name}),"?"]}),(null==p?void 0:p.status)===et.ACTIVE&&We.jsx("p",{className:"text-sm text-amber-600 dark:text-amber-400 mt-2",children:"Archived users cannot log in."})]}),We.jsxs(Lh,{isOpen:!!h,onClose:()=>g(null),onConfirm:async()=>{if(h&&e)try{await(async(e,t)=>{const n=await _f(e);if(!n)throw new Error("User not found.");if(n.status!==et.ARCHIVED)throw new Error("Only archived users can be permanently deleted.");await Yp.delete(e);const a=await Df();for(const l of a.filter(t=>t.employeeId===e))await Qp.delete(l.id);const s=await ef.getByEmployee(e);for(const l of s)await ef.delete(l.id);const r=await nf.getByUser(e);for(const l of r)await nf.delete(l.id);const i=await Lf();for(const l of i.filter(t=>t.createdBy===e||t.assignedTo.includes(e)))await Xp.delete(l.id);await Ef({timestamp:Date.now(),actorId:t.id,actorName:t.name,type:dt.USER_PERMANENTLY_DELETED,description:`permanently deleted user ${n.name}`,targetUserId:n.id,targetUserName:n.name})})(h.id,e),b(`User ${h.name} permanently deleted.`,"success"),M()}catch(t){b(`Error deleting user: ${t.message}`,"error")}finally{g(null)}},title:"Confirm Permanent Deletion",confirmButtonVariant:"danger",confirmText:"Yes, Permanently Delete",children:[We.jsxs("p",{children:["Are you sure you want to permanently delete the user ",We.jsx("strong",{children:null==h?void 0:h.name}),"?"]}),We.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mt-2",children:"This action is irreversible and will delete all their associated data."})]})]})},$h=async(e,t,n)=>{const a=`tenants/${Mp()}/${t}/${n}`,s=(r=a,Ku(D(im),r));var r;await em(s,e);var i;return{downloadUrl:await(i=s,qu(i=D(i))),storagePath:a}},Gh=async(e,t)=>{const n=`${Date.now()}_${e.name.replace(/[^a-zA-Z0-9.-]/g,"_")}`,{downloadUrl:a,storagePath:s}=await $h(e,`reports/${t}/attachments`,n);return{name:e.name,type:e.type,size:e.size,storageUrl:a,storagePath:s}},Vh=["","","","",""],zh=({report:e,isOpen:t,onClose:n,currentUser:a,onReportUpdate:s})=>{const{hasPermission:r}=Eh(),[i,o]=l.useState(e.managerComments||""),[c,d]=l.useState(!1),[u,m]=l.useState(null),p=l.useMemo(()=>[...e.versions||[]].sort((e,t)=>t.versionNumber-e.versionNumber),[e.versions]),[f,h]=l.useState(p.length>0?p[0].versionNumber:0),g=l.useMemo(()=>e.versions.find(e=>e.versionNumber===f),[e.versions,f]);l.useEffect(()=>{o(e.managerComments||""),d(!1),m(null);const t=[...e.versions||[]].sort((e,t)=>t.versionNumber-e.versionNumber);h(t.length>0?t[0].versionNumber:0)},[e]);const x=async()=>{let t=i.trim();u&&(t=u+" "+t);const r={id:e.id,status:tt.ACKNOWLEDGED,managerComments:t.trim()},l=await Rf(r,a);l&&s&&s(l),n()},y=({label:e,value:t,defaultText:n="N/A",className:a=""})=>We.jsxs("div",{className:`mb-3 ${a}`,children:[We.jsxs("p",{className:"text-sm font-semibold text-gray-600 dark:text-slate-400",children:[e,":"]}),We.jsx("div",{className:"text-gray-800 dark:text-slate-200 whitespace-pre-wrap",children:t||n})]}),b=r(Xe.CAN_ACKNOWLEDGE_REPORTS),v=Pf(e),N=!!a&&v.hasManagerAcknowledged(a.id),w=e.versions.sort((e,t)=>t.versionNumber-e.versionNumber).map(e=>({value:e.versionNumber,label:`Version ${e.versionNumber} (${e.action} @ ${qt(e.timestamp)}${e.isCopied?" - Copied":""})`}));return We.jsx(Dh,{isOpen:t,onClose:n,title:`EOD Report - ${Wt(e.date)}`,size:"lg",footer:(()=>{const e=[];return b&&!N&&e.push(We.jsxs(_h,{onClick:x,variant:"success",children:[We.jsx("i",{className:"fas fa-check-circle mr-2"}),"Acknowledge Report"]},"acknowledge")),b&&N&&e.push(We.jsxs("span",{className:"text-sm text-green-600 dark:text-green-400 font-semibold",children:[We.jsx("i",{className:"fas fa-check-double mr-2"}),"You acknowledged this report"]},"acknowledged-status")),e.push(We.jsx(_h,{onClick:n,variant:"ghost",children:"Close"},"close")),We.jsx(We.Fragment,{children:e})})(),children:We.jsxs("div",{className:"space-y-4 max-h-[75vh] overflow-y-auto pr-2",children:[e.isYesterdaySubmission&&We.jsxs("div",{className:"p-3 mb-2 bg-cyan-50 dark:bg-cyan-900/50 border border-cyan-200 dark:border-cyan-700 rounded-md text-sm text-cyan-700 dark:text-cyan-300 flex items-center",children:[We.jsx("i",{className:"fas fa-undo-alt mr-2"}),We.jsxs("span",{children:["This late report for a previous day was submitted on: ",qt(e.submittedAt)]})]}),e.isLate&&!e.isYesterdaySubmission&&We.jsxs("div",{className:"p-3 mb-2 bg-orange-50 dark:bg-orange-900/50 border border-orange-200 dark:border-orange-700 rounded-md text-sm text-orange-700 dark:text-orange-300",children:[We.jsx("i",{className:"fas fa-clock mr-2"}),"This was a late submission."]}),e.submittedOnWeekOff&&We.jsxs("div",{className:"p-3 mb-2 bg-blue-50 dark:bg-blue-900/50 border border-blue-200 dark:border-blue-700 rounded-md text-sm text-blue-700 dark:text-blue-300",children:[We.jsx("i",{className:"fas fa-info-circle mr-2"}),"This report was submitted on the employee's designated weekly off day."]}),We.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4",children:[We.jsx(y,{label:"Employee",value:e.employeeName}),We.jsx(y,{label:"Report For Date",value:Wt(e.date)}),We.jsx(y,{label:"Initial Submission Time",value:qt(e.submittedAt)}),We.jsx(y,{label:"Overall Status",value:We.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full "+(e.status===tt.ACKNOWLEDGED?"bg-green-100 text-green-700 dark:bg-green-500/20 dark:text-green-300":"bg-yellow-100 text-yellow-700 dark:bg-yellow-500/20 dark:text-yellow-300"),children:e.status})}),We.jsx(y,{label:"Total Versions",value:String(e.versions.length)})]}),e.status===tt.ACKNOWLEDGED&&(()=>{const t=Pf(e).getAcknowledgingManagers();return t.length>0?We.jsxs("div",{className:"mt-4 p-3 bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-700 rounded-md",children:[We.jsxs("p",{className:"text-sm font-semibold text-green-800 dark:text-green-300 mb-2",children:[We.jsx("i",{className:"fas fa-check-circle mr-2"}),"Acknowledged by:"]}),We.jsx("div",{className:"space-y-1",children:t.map((e,t)=>We.jsxs("div",{className:"text-sm text-green-700 dark:text-green-400",children:[We.jsx("i",{className:"fas fa-user-check mr-2"}),We.jsxs("span",{className:"font-medium",children:[e.name,e.designation&&"Director"===e.designation&&We.jsx("span",{className:"ml-1 text-xs opacity-70",children:"(Director)"})]}),We.jsxs("span",{className:"text-xs ml-2 text-green-600 dark:text-green-500",children:["(",qt(e.timestamp),")"]})]},t))})]}):null})(),e.versions.length>1&&We.jsx("div",{className:"my-3",children:We.jsx(Oh,{label:"View Report Version:",options:w,value:f,onChange:e=>h(Number(e.target.value)),wrapperClassName:"mb-0"})}),g&&We.jsxs(Ih,{title:`Version ${g.versionNumber} Details`,className:"bg-gray-50 dark:bg-slate-800/50",titleIcon:We.jsx("i",{className:"fas fa-file-alt"}),children:[We.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 mb-3",children:[We.jsx(y,{label:"Version Action",value:"submitted"===g.action?"Original Submission":"Edited Version"}),We.jsx(y,{label:"Timestamp",value:qt(g.timestamp)})]}),g.isCopied&&We.jsxs("div",{className:"p-2 mb-2 bg-teal-50 dark:bg-teal-900/50 border border-teal-200 dark:border-teal-700 rounded-md text-xs text-teal-700 dark:text-teal-300",children:[We.jsx("i",{className:"fas fa-copy mr-2"}),"This version's content was (re)submitted using copied data."]}),We.jsx(y,{label:"Tasks Completed",value:g.tasksCompleted}),We.jsx(y,{label:"Challenges Faced",value:g.challengesFaced}),We.jsx(y,{label:"Plan for Tomorrow",value:g.planForTomorrow}),g.attachments&&g.attachments.length>0&&We.jsxs("div",{className:"mt-3 pt-3 border-t dark:border-slate-700",children:[We.jsxs("p",{className:"text-sm font-semibold text-gray-600 dark:text-slate-400 mb-2",children:["Attachments for this version (",g.attachments.length,"):"]}),We.jsx("div",{className:"flex flex-wrap gap-3",children:g.attachments.map((e,t)=>{const n=(a=e).storageUrl||a.dataUrl||"";var a;return We.jsx("div",{className:"border dark:border-slate-700 rounded-md p-2 hover:shadow-md transition-shadow",children:e.type.startsWith("image/")?We.jsxs("a",{href:n,target:"_blank",rel:"noopener noreferrer",title:`View ${e.name}`,children:[We.jsx("img",{src:n,alt:e.name,className:"w-20 h-20 object-cover rounded border"}),We.jsx("p",{className:"text-xs text-center mt-1 truncate max-w-[80px] dark:text-slate-300",children:e.name})]}):We.jsxs("a",{href:n,download:e.name,target:"_blank",rel:"noopener noreferrer",title:`Download ${e.name}`,className:"flex flex-col items-center justify-center w-20 h-20 text-center p-1 rounded cursor-pointer hover:bg-gray-50 dark:hover:bg-slate-700/50",children:[We.jsx("i",{className:`fas ${"application/pdf"===e.type?"fa-file-pdf":e.type.includes("wordprocessingml")?"fa-file-word":"fa-file-alt"} text-3xl text-primary mb-1`}),We.jsx("p",{className:"text-xs truncate max-w-[80px] dark:text-slate-300",children:e.name})]})},`${f}-${t}`)})})]})]}),!g&&e.versions.length>0&&We.jsx("p",{className:"text-red-500",children:"Error: Could not load selected version details."}),!g&&0===e.versions.length&&We.jsx("p",{className:"text-yellow-500",children:"This report has no versions."}),b&&!N&&We.jsxs("div",{className:"my-3 p-3 border dark:border-slate-700 rounded-md bg-indigo-50 dark:bg-indigo-900/40",children:[We.jsx("p",{className:"text-sm font-semibold text-indigo-700 dark:text-indigo-300 mb-2",children:"Add Quick Reaction (Optional):"}),We.jsx("div",{className:"flex space-x-2 flex-wrap",children:Vh.map(e=>We.jsx("button",{type:"button",onClick:()=>m(t=>t===e?null:e),className:"p-2 rounded-full text-2xl transition-all duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-primary\n                                "+(u===e?"bg-primary-light dark:bg-sky-900/50 ring-2 ring-primary scale-110 shadow-lg":"hover:bg-gray-200 dark:hover:bg-slate-700"),"aria-label":`Select ${e} reaction`,"aria-pressed":u===e,children:e},e))})]}),We.jsxs("div",{className:"mt-4 pt-4 border-t dark:border-slate-700",children:[We.jsx("p",{className:"text-sm font-semibold text-gray-600 dark:text-slate-400 mb-1",children:"Manager Comments (Overall):"}),b?N?c?We.jsxs(We.Fragment,{children:[We.jsx("textarea",{value:i,onChange:e=>o(e.target.value),className:"w-full p-2 border dark:border-slate-600 rounded-md min-h-[80px] focus:ring-primary focus:border-primary bg-white dark:bg-slate-800 dark:text-slate-200",placeholder:"Edit your overall comments for this report..."}),We.jsxs("div",{className:"mt-2 flex space-x-2",children:[We.jsx(_h,{onClick:async()=>{const t={id:e.id,managerComments:i},r=await Rf(t,a);r&&(s&&s(r),d(!1),n())},size:"sm",variant:"primary",children:"Save & Close Comment"}),We.jsx(_h,{onClick:()=>{d(!1),o(e.managerComments||""),m(null)},size:"sm",variant:"ghost",children:"Cancel"})]})]}):We.jsxs(We.Fragment,{children:[We.jsx("div",{className:"text-gray-800 dark:text-slate-200 whitespace-pre-wrap min-h-[40px]",children:e.managerComments||"No overall comments yet."}),We.jsxs(_h,{onClick:()=>{d(!0),m(null)},size:"sm",variant:"ghost",className:"mt-1 text-xs",children:[We.jsx("i",{className:"fas fa-edit mr-1"})," ",e.managerComments?"Edit Comment":"Add Comment"]})]}):We.jsx(We.Fragment,{children:We.jsx("textarea",{value:i,onChange:e=>o(e.target.value),className:"w-full p-2 border dark:border-slate-600 rounded-md min-h-[80px] focus:ring-primary focus:border-primary bg-white dark:bg-slate-800 dark:text-slate-200",placeholder:"Add your overall comments for this report (optional)..."})}):We.jsx("div",{className:"text-gray-800 dark:text-slate-200 whitespace-pre-wrap",children:e.managerComments||"No overall comments from manager yet."})]})]})})},Wh=()=>{const{currentUser:e}=Eh(),[t,n]=l.useState([]),[a,s]=l.useState([]),[r,i]=l.useState([]),[o,c]=l.useState(null),[d,u]=l.useState(!0),[m,p]=l.useState({searchTerm:"",employeeId:"",status:"",dateRange:{startDate:null,endDate:null},businessUnitId:""}),[f,h]=l.useState(1),[g,x]=l.useState({key:"date",direction:"descending"}),y=l.useCallback(async()=>{u(!0),n(await Df()),s(await Cf()),i(await If()),u(!1)},[]);l.useEffect(()=>{y()},[y]);const b=l.useMemo(()=>a.filter(e=>"Employee"===e.roleName||"Manager"===e.roleName).map(e=>({value:e.id,label:e.name})),[a]),v=l.useMemo(()=>[{value:"",label:"All Business Units"},...r.map(e=>({value:e.id,label:e.name}))],[r]),N=e=>{let t="ascending";g&&g.key===e&&"ascending"===g.direction&&(t="descending"),x({key:e,direction:t})},w=e=>g&&g.key===e?"ascending"===g.direction?We.jsx("i",{className:"fas fa-sort-up text-primary ml-1"}):We.jsx("i",{className:"fas fa-sort-down text-primary ml-1"}):We.jsx("i",{className:"fas fa-sort text-gray-400 ml-1"}),k=l.useMemo(()=>{let e=t.filter(e=>{const t=m.searchTerm.toLowerCase(),n=e.versions.sort((e,t)=>t.versionNumber-e.versionNumber)[0];if(!n)return!1;const s=a.find(t=>t.id===e.employeeId),r=e.employeeName.toLowerCase().includes(t)||n.tasksCompleted.toLowerCase().includes(t)||n.challengesFaced&&n.challengesFaced.toLowerCase().includes(t)||n.planForTomorrow&&n.planForTomorrow.toLowerCase().includes(t)||(null==s?void 0:s.businessUnitName)&&s.businessUnitName.toLowerCase().includes(t),i=!m.employeeId||e.employeeId===m.employeeId,l=!m.status||e.status===m.status,o=new Date(e.date+"T00:00:00Z"),c=m.dateRange.startDate?new Date(m.dateRange.startDate+"T00:00:00Z"):null,d=m.dateRange.endDate?new Date(m.dateRange.endDate+"T23:59:59Z"):null,u=(!c||o>=c)&&(!d||o<=d),p=!m.businessUnitId||s&&s.businessUnitId===m.businessUnitId;return r&&i&&l&&u&&p});return null!==g?e.sort((e,t)=>{var n,s;let r=e[g.key],i=t[g.key];return"businessUnitName"===g.key?(r=(null==(n=a.find(t=>t.id===e.employeeId))?void 0:n.businessUnitName)||"",i=(null==(s=a.find(e=>e.id===t.employeeId))?void 0:s.businessUnitName)||""):"date"===g.key&&(r=new Date(e.date).getTime(),i=new Date(t.date).getTime()),"string"==typeof r&&"string"==typeof i&&(r=r.toLowerCase(),i=i.toLowerCase()),r<i?"ascending"===g.direction?-1:1:r>i?"ascending"===g.direction?1:-1:"date"!==g.key?new Date(t.date).getTime()-new Date(e.date).getTime():0}):e.sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()||e.employeeName.localeCompare(t.employeeName)),e},[t,m,a,g]);l.useEffect(()=>{h(1)},[m,g]);const E=Math.ceil(k.length/10),j=l.useMemo(()=>{const e=10*(f-1),t=e+10;return k.slice(e,t)},[k,f]),C=e=>{e>=1&&e<=E&&h(e)},_=(e,t)=>{p(n=>({...n,[e]:t}))};return d?We.jsx(Ph,{message:"Loading all reports..."}):e?We.jsxs(Ih,{title:"All Submitted EOD Reports",titleIcon:We.jsx("i",{className:"fas fa-archive"}),actions:We.jsxs(_h,{onClick:()=>{const e=JSON.stringify(k.map(e=>{var t;const n=a.find(t=>t.id===e.employeeId),s=e.versions.sort((e,t)=>t.versionNumber-e.versionNumber)[0]||{};return{reportId:e.id,employeeName:e.employeeName,employeeEmail:(null==n?void 0:n.email)||"N/A",employeeBusinessUnit:(null==n?void 0:n.businessUnitName)||"N/A",reportDate:Wt(e.date),status:e.status,managerComments:e.managerComments||"",submittedOnWeekOff:e.submittedOnWeekOff,totalVersions:e.versions.length,latestVersionDetails:{versionNumber:s.versionNumber,timestamp:s.timestamp,action:s.action,tasksCompleted:s.tasksCompleted,challengesFaced:s.challengesFaced,planForTomorrow:s.planForTomorrow,attachmentsCount:(null==(t=s.attachments)?void 0:t.length)||0,isCopied:s.isCopied}}}),null,2),t="data:application/json;charset=utf-8,"+encodeURIComponent(e),n=document.createElement("a");n.setAttribute("href",t),n.setAttribute("download","eod_reports_export_admin.json"),n.click()},variant:"secondary",icon:We.jsx("i",{className:"fas fa-file-export"}),disabled:0===k.length,children:["Export Filtered Data (",k.length,")"]}),children:[We.jsxs("div",{className:"mb-4 p-3 border rounded-md bg-surface-secondary dark:bg-dark-surface-secondary dark:border-dark-border",children:[We.jsx("h3",{className:"text-base font-medium text-primary dark:text-sky-400 mb-1",children:"Filter Reports"}),We.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3 items-end",children:[We.jsx(Ch,{type:"text",placeholder:"Search (name, tasks, BU...)",value:m.searchTerm,onChange:e=>_("searchTerm",e.target.value),wrapperClassName:"mb-0"}),We.jsx(Oh,{options:[{value:"",label:"All Users"},...b],value:m.employeeId,onChange:e=>_("employeeId",e.target.value),wrapperClassName:"mb-0",placeholder:"Filter by User"}),We.jsx(Oh,{options:[{value:"",label:"All Statuses"},{value:tt.PENDING_ACKNOWLEDGMENT,label:"Pending Acknowledgment"},{value:tt.ACKNOWLEDGED,label:"Acknowledged"}],value:m.status,onChange:e=>_("status",e.target.value),wrapperClassName:"mb-0",placeholder:"Filter by Status"}),We.jsx(Oh,{options:v,value:m.businessUnitId,onChange:e=>_("businessUnitId",e.target.value),wrapperClassName:"mb-0",placeholder:"Filter by Business Unit"}),We.jsx(Ch,{type:"date",label:"Start Date",value:m.dateRange.startDate||"",onChange:e=>_("dateRange",{...m.dateRange,startDate:e.target.value||null}),wrapperClassName:"mb-0"}),We.jsx(Ch,{type:"date",label:"End Date",value:m.dateRange.endDate||"",onChange:e=>_("dateRange",{...m.dateRange,endDate:e.target.value||null}),wrapperClassName:"mb-0"}),We.jsx("div",{className:"lg:col-span-2",children:We.jsx(_h,{onClick:()=>{p({searchTerm:"",employeeId:"",status:"",dateRange:{startDate:null,endDate:null},businessUnitId:""})},variant:"ghost",className:"w-full",children:"Reset Filters"})})]})]}),0===k.length?We.jsx("p",{className:"text-center text-text-secondary dark:text-dark-text-secondary py-8",children:"No reports match your current filters."}):We.jsxs(We.Fragment,{children:[We.jsx("div",{className:"overflow-x-auto",children:We.jsxs("table",{className:"min-w-full divide-y divide-border-primary dark:divide-dark-border",children:[We.jsx("thead",{className:"bg-surface-secondary dark:bg-dark-surface-secondary",children:We.jsxs("tr",{children:[We.jsxs("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase tracking-wider cursor-pointer",onClick:()=>N("employeeName"),children:["Employee ",w("employeeName")]}),We.jsxs("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase tracking-wider cursor-pointer",onClick:()=>N("date"),children:["Report Date ",w("date")]}),We.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase tracking-wider",children:"Tasks (Latest)"}),We.jsxs("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase tracking-wider cursor-pointer",onClick:()=>N("status"),children:["Status ",w("status")]}),We.jsxs("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase tracking-wider cursor-pointer",onClick:()=>N("businessUnitName"),children:["Business Unit ",w("businessUnitName")]}),We.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase tracking-wider",children:"Info"}),We.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase tracking-wider",children:"Actions"})]})}),We.jsx("tbody",{className:"bg-surface-primary dark:bg-dark-surface-primary divide-y divide-border-primary dark:divide-dark-border",children:j.map(e=>{const t=e.versions.sort((e,t)=>t.versionNumber-e.versionNumber)[0];if(!t)return null;const n=a.find(t=>t.id===e.employeeId);return We.jsxs("tr",{className:"hover:bg-surface-hover dark:hover:bg-dark-surface-hover",children:[We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-text-primary dark:text-dark-text",children:e.employeeName}),We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-text-secondary dark:text-dark-text-secondary",children:Wt(e.date)}),We.jsxs("td",{className:"px-6 py-4 whitespace-normal text-sm text-text-secondary dark:text-dark-text-secondary max-w-sm break-words",children:[t.tasksCompleted.substring(0,70),t.tasksCompleted.length>70?"...":""]}),We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:We.jsx("span",{className:"px-2 py-0.5 inline-block text-xs font-semibold rounded-full "+(e.status===tt.ACKNOWLEDGED?"bg-green-100 text-green-700 dark:bg-green-500/20 dark:text-green-300":"bg-yellow-100 text-yellow-700 dark:bg-yellow-500/20 dark:text-yellow-300"),children:e.status})}),We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-text-secondary dark:text-dark-text-secondary",children:(null==n?void 0:n.businessUnitName)||"N/A"}),We.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-text-secondary dark:text-dark-text-secondary",children:[e.submittedOnWeekOff&&We.jsxs("span",{className:"block text-xs text-blue-600 dark:text-blue-400 mb-0.5",title:"Submitted on Week Off",children:[We.jsx("i",{className:"fas fa-calendar-check mr-1"}),"On Week Off"]}),t.attachments&&t.attachments.length>0&&We.jsxs("span",{className:"block text-xs text-gray-600 dark:text-slate-400 mb-0.5",title:`${t.attachments.length} attachment(s)`,children:[We.jsx("i",{className:"fas fa-paperclip mr-1"}),t.attachments.length," Attach."]}),e.versions.length>1&&We.jsxs("span",{className:"block text-xs text-purple-600 dark:text-purple-400",title:`Edited (V${t.versionNumber})`,children:[We.jsx("i",{className:"fas fa-history mr-1"}),"V",t.versionNumber]})]}),We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:We.jsx(_h,{onClick:()=>c(e),variant:"ghost",size:"sm",icon:We.jsx("i",{className:"fas fa-eye"}),children:"Details"})})]},e.id)})})]})}),E>1&&We.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row justify-between items-center space-y-3 sm:space-y-0",children:[We.jsxs("span",{className:"text-sm text-text-secondary dark:text-dark-text-secondary",children:["Page ",f," of ",E," (Total reports: ",k.length,")"]}),We.jsxs("div",{className:"flex items-center",children:[We.jsx(_h,{onClick:()=>C(f-1),disabled:1===f,variant:"ghost",size:"sm",icon:We.jsx("i",{className:"fas fa-chevron-left"}),className:"mr-2",children:"Prev"}),(()=>{const e=[];if(E<=7)for(let t=1;t<=E;t++)e.push(We.jsx(_h,{onClick:()=>C(t),variant:t===f?"primary":"ghost",size:"sm",className:"mx-1",children:t},t));else{e.push(We.jsx(_h,{onClick:()=>C(1),variant:1===f?"primary":"ghost",size:"sm",className:"mx-1",children:"1"},1));let t=Math.max(2,f-Math.floor(1.5)),n=Math.min(E-1,f+Math.floor(1.5));f<=Math.ceil(2.5)?n=4:f>E-Math.ceil(2.5)&&(t=E-3),t>2&&e.push(We.jsx("span",{className:"mx-1 p-2",children:"..."},"start-ellipsis"));for(let a=t;a<=n;a++)e.push(We.jsx(_h,{onClick:()=>C(a),variant:a===f?"primary":"ghost",size:"sm",className:"mx-1",children:a},a));n<E-1&&e.push(We.jsx("span",{className:"mx-1 p-2",children:"..."},"end-ellipsis")),e.push(We.jsx(_h,{onClick:()=>C(E),variant:E===f?"primary":"ghost",size:"sm",className:"mx-1",children:E},E))}return e})(),We.jsx(_h,{onClick:()=>C(f+1),disabled:f===E,variant:"ghost",size:"sm",icon:We.jsx("i",{className:"fas fa-chevron-right"}),className:"ml-2",children:"Next"})]})]})]}),o&&e&&We.jsx(zh,{report:o,isOpen:!!o,onClose:()=>c(null),currentUser:e,onReportUpdate:e=>{n(t=>t.map(t=>t.id===e.id?e:t)),o&&o.id===e.id&&c(e)}})]}):null},{useSearchParams:qh}=m,Hh=()=>{const[e,t]=l.useState([]),[n,a]=l.useState(!0),[s,r]=l.useState(!1),i=l.useRef(null),[o,c]=qh(),d=o.get("search")||"",u=parseInt(o.get("page")||"1",10),m=l.useCallback(async()=>{const e=await rh();t(e)},[]);l.useEffect(()=>{a(!0),m().finally(()=>a(!1));const e=tn.on("appDataChanged",e=>{e&&e.keyChanged===gt&&m()});return()=>e()},[m]),l.useEffect(()=>{const e=e=>{i.current&&!i.current.contains(e.target)&&r(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const p=l.useMemo(()=>e.filter(e=>{const t=d.toLowerCase();return e.employeeName.toLowerCase().includes(t)||e.managerName.toLowerCase().includes(t)||e.reason.toLowerCase().includes(t)||qt(e.timestamp).toLowerCase().includes(t)}),[e,d]),f=Math.ceil(p.length/15),h=l.useMemo(()=>{const e=15*(u-1),t=e+15;return p.slice(e,t)},[p,u]),g=e=>{if(e>=1&&e<=f){const t=new URLSearchParams(o);t.set("page",String(e)),c(t)}};return n?We.jsx(Ph,{message:"Loading trigger log..."}):We.jsxs(Ih,{title:"Trigger Log History",titleIcon:We.jsx("i",{className:"fas fa-history"}),children:[We.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row justify-between items-center gap-4",children:[We.jsx(Ch,{type:"text",placeholder:"Search log (employee, manager, reason, date...)",value:d,onChange:e=>(e=>{const t=new URLSearchParams(o);e?t.set("search",e):t.delete("search"),t.delete("page"),c(t)})(e.target.value),wrapperClassName:"mb-0 flex-grow",className:"w-full"}),We.jsxs("div",{className:"relative",ref:i,children:[We.jsxs(_h,{variant:"secondary",onClick:()=>r(!s),icon:We.jsx("i",{className:"fas fa-download"}),disabled:0===p.length,children:["Download Log (",p.length,")",We.jsx("i",{className:"fas fa-chevron-down ml-2 transition-transform "+(s?"rotate-180":"")})]}),s&&We.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-surface-primary dark:bg-dark-surface-primary rounded-md shadow-lg py-1 z-20 border border-border-primary dark:border-dark-border",children:[We.jsxs("button",{onClick:()=>{const e=p.map(e=>[e.employeeName,e.managerName,qt(e.timestamp),e.reason]);let t="data:text/csv;charset=utf-8,"+["Employee Name","Trigger Sent By","Date & Time","Reason"].join(",")+"\n"+e.map(e=>e.map(e=>`"${String(e).replace(/"/g,'""')}"`).join(",")).join("\n");const n=encodeURI(t),a=document.createElement("a");a.setAttribute("href",n),a.setAttribute("download","trigger_log.csv"),document.body.appendChild(a),a.click(),document.body.removeChild(a),r(!1)},className:"w-full text-left block px-4 py-2 text-sm text-text-primary dark:text-dark-text hover:bg-surface-hover dark:hover:bg-dark-surface-hover hover:text-primary",children:[We.jsx("i",{className:"fas fa-file-csv mr-2"}),"Download as CSV"]}),We.jsxs("button",{onClick:()=>{const e=new N;w(e,{head:[["Employee Name","Trigger Sent By","Date & Time","Reason"]],body:p.map(e=>[e.employeeName,e.managerName,qt(e.timestamp),e.reason]),styles:{fontSize:8},headStyles:{fillColor:[0,85,164]},margin:{top:10,right:10,bottom:10,left:10},tableWidth:"auto"}),e.save("trigger_log.pdf"),r(!1)},className:"w-full text-left block px-4 py-2 text-sm text-text-primary dark:text-dark-text hover:bg-surface-hover dark:hover:bg-dark-surface-hover hover:text-primary",children:[We.jsx("i",{className:"fas fa-file-pdf mr-2"}),"Download as PDF"]}),We.jsxs("button",{onClick:()=>{const e=k.json_to_sheet(p.map(e=>({"Employee Name":e.employeeName,"Trigger Sent By":e.managerName,"Date & Time":qt(e.timestamp),Reason:e.reason}))),t=k.book_new();k.book_append_sheet(t,e,"TriggerLog"),E(t,"trigger_log.xlsx"),r(!1)},className:"w-full text-left block px-4 py-2 text-sm text-text-primary dark:text-dark-text hover:bg-surface-hover dark:hover:bg-dark-surface-hover hover:text-primary",children:[We.jsx("i",{className:"fas fa-file-excel mr-2"}),"Download as Excel"]})]})]})]}),0===p.length?We.jsx("p",{className:"text-center text-text-secondary dark:text-dark-text-secondary py-6",children:d?"No log entries match your search.":"No trigger events have been logged yet."}):We.jsxs(We.Fragment,{children:[We.jsx("div",{className:"overflow-x-auto",children:We.jsxs("table",{className:"min-w-full divide-y divide-border-primary dark:divide-dark-border",children:[We.jsx("thead",{className:"bg-surface-secondary dark:bg-dark-surface-secondary",children:We.jsxs("tr",{children:[We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase tracking-wider",children:"Employee"}),We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase tracking-wider",children:"Manager"}),We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase tracking-wider",children:"Date & Time"}),We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase tracking-wider",children:"Reason"})]})}),We.jsx("tbody",{className:"bg-surface-primary dark:bg-dark-surface-primary divide-y divide-border-primary dark:divide-dark-border",children:h.map(e=>We.jsxs("tr",{className:"hover:bg-surface-hover dark:hover:bg-dark-surface-hover",children:[We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-text-primary dark:text-dark-text",children:We.jsxs("div",{className:"flex items-center",children:[We.jsx(Uh,{name:e.employeeName,size:"md",className:"mr-3"}),e.employeeName]})}),We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-text-secondary dark:text-dark-text-secondary",children:We.jsxs("div",{className:"flex items-center",children:[We.jsx(Uh,{name:e.managerName,size:"md",className:"mr-3"}),e.managerName]})}),We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-text-secondary dark:text-dark-text-secondary",children:qt(e.timestamp)}),We.jsx("td",{className:"px-6 py-4 whitespace-normal text-sm text-text-secondary dark:text-dark-text-secondary max-w-xs break-words",children:e.reason})]},e.id))})]})}),f>1&&We.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row justify-between items-center space-y-3 sm:space-y-0",children:[We.jsxs("span",{className:"text-sm text-text-secondary dark:text-dark-text-secondary",children:["Page ",u," of ",f," (Total entries: ",p.length,")"]}),We.jsxs("div",{className:"flex items-center",children:[We.jsx(_h,{onClick:()=>g(u-1),disabled:1===u,variant:"ghost",size:"sm",icon:We.jsx("i",{className:"fas fa-chevron-left"}),className:"mr-2",children:"Prev"}),(()=>{const e=[];if(f<=7)for(let t=1;t<=f;t++)e.push(We.jsx(_h,{onClick:()=>g(t),variant:t===u?"primary":"ghost",size:"sm",className:"mx-1",children:t},t));else{e.push(We.jsx(_h,{onClick:()=>g(1),variant:1===u?"primary":"ghost",size:"sm",className:"mx-1",children:"1"},1));let t=Math.max(2,u-Math.floor(1.5)),n=Math.min(f-1,u+Math.floor(1.5));u<=Math.ceil(2.5)?n=4:u>f-Math.ceil(2.5)&&(t=f-3),t>2&&e.push(We.jsx("span",{className:"mx-1 p-2",children:"..."},"start-ellipsis"));for(let a=t;a<=n;a++)e.push(We.jsx(_h,{onClick:()=>g(a),variant:a===u?"primary":"ghost",size:"sm",className:"mx-1",children:a},a));n<f-1&&e.push(We.jsx("span",{className:"mx-1 p-2",children:"..."},"end-ellipsis")),e.push(We.jsx(_h,{onClick:()=>g(f),variant:f===u?"primary":"ghost",size:"sm",className:"mx-1",children:f},f))}return e})(),We.jsx(_h,{onClick:()=>g(u+1),disabled:u===f,variant:"ghost",size:"sm",icon:We.jsx("i",{className:"fas fa-chevron-right"}),className:"ml-2",children:"Next"})]})]})]})]})},Kh=()=>{const e=jh(Xe.CAN_MANAGE_BUSINESS_UNITS);if(!e)return We.jsx("div",{className:"flex items-center justify-center min-h-screen",children:We.jsx(Ih,{title:"Access Denied",children:We.jsxs("div",{className:"text-center py-8",children:[We.jsx("i",{className:"fas fa-lock text-6xl text-gray-400 dark:text-gray-600 mb-4"}),We.jsx("p",{className:"text-lg font-semibold mb-2",children:"Permission Required"}),We.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"You do not have permission to manage business units. Please contact your administrator."})]})})});const[t,n]=l.useState([]),[a,s]=l.useState(!0),[r,i]=l.useState(!1),[o,c]=l.useState(null),[d,u]=l.useState(null),[m,p]=l.useState(""),[f,h]=l.useState(""),{addToast:g}=bh(),{currentUser:x}=Eh(),y=l.useCallback(async()=>{s(!0);const e=await If();n(e),s(!1)},[]);l.useEffect(()=>{y()},[y]);const b=l.useMemo(()=>t.filter(e=>"active"===e.status).sort((e,t)=>e.name.localeCompare(t.name)),[t]),v=l.useMemo(()=>t.filter(e=>"archived"===e.status).sort((e,t)=>e.name.localeCompare(t.name)),[t]),N=async t=>{if(x)if(e)try{await(async(e,t)=>{const n=await Zp.getById(e);if(!n)throw new Error("Business Unit not found");n.status="archived",await Zp.update(e,n),await Ef({timestamp:Date.now(),actorId:t.id,actorName:t.name,type:dt.BUSINESS_UNIT_ARCHIVED,description:"archived business unit:",targetId:n.id,targetName:n.name})})(t.id,x),g(`Business Unit "${t.name}" archived successfully.`,"success"),y()}catch(n){g(n.message,"error")}else g("You do not have permission to archive business units.","error");else g("You must be logged in to perform this action.","error")},w=async t=>{if(x)if(e)try{await(async(e,t)=>{const n=await Zp.getById(e);if(!n)throw new Error("Business Unit not found");n.status="active",await Zp.update(e,n),await Ef({timestamp:Date.now(),actorId:t.id,actorName:t.name,type:dt.BUSINESS_UNIT_UNARCHIVED,description:"restored business unit:",targetId:n.id,targetName:n.name})})(t.id,x),g(`Business Unit "${t.name}" has been restored.`,"success"),y()}catch(n){g(n.message,"error")}else g("You do not have permission to restore business units.","error");else g("You must be logged in to perform this action.","error")};return a?We.jsx(Ph,{message:"Loading Business Units..."}):We.jsxs("div",{className:"space-y-6",children:[We.jsx(Ih,{title:"Active Business Units",titleIcon:We.jsx("i",{className:"fas fa-briefcase"}),actions:e?We.jsx(_h,{onClick:()=>{e?(c(null),p(""),h(""),i(!0)):g("You do not have permission to create business units.","error")},variant:"primary",icon:We.jsx("i",{className:"fas fa-plus"}),children:"Add Business Unit"}):void 0,children:0===b.length?We.jsx("p",{className:"text-center text-text-secondary dark:text-dark-text-secondary py-6",children:"No active Business Units found."}):We.jsx("div",{className:"overflow-x-auto",children:We.jsxs("table",{className:"min-w-full divide-y divide-border-primary dark:divide-dark-border",children:[We.jsx("thead",{className:"bg-surface-secondary dark:bg-dark-surface-secondary",children:We.jsxs("tr",{children:[We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase",children:"Name"}),We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase",children:"Actions"})]})}),We.jsx("tbody",{className:"bg-surface-primary dark:bg-dark-surface-primary divide-y divide-border-primary dark:divide-dark-border",children:b.map(t=>We.jsxs("tr",{className:"hover:bg-surface-hover dark:hover:bg-dark-surface-hover",children:[We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-text-primary dark:text-dark-text",children:t.name}),We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:We.jsxs("div",{className:"flex items-center space-x-2",children:[We.jsx(_h,{variant:"ghost",size:"sm",onClick:()=>(t=>{e?(c(t),p(t.name),h(""),i(!0)):g("You do not have permission to edit business units.","error")})(t),icon:We.jsx("i",{className:"fas fa-edit"}),children:"Edit"}),We.jsx(_h,{variant:"warning",size:"sm",onClick:()=>N(t),icon:We.jsx("i",{className:"fas fa-archive"}),children:"Archive"})]})})]},t.id))})]})})}),v.length>0&&We.jsx(Ih,{title:"Archived Business Units",titleIcon:We.jsx("i",{className:"fas fa-archive text-slate-500"}),children:We.jsx("div",{className:"overflow-x-auto",children:We.jsxs("table",{className:"min-w-full divide-y divide-border-primary dark:divide-dark-border",children:[We.jsx("thead",{className:"bg-surface-secondary dark:bg-dark-surface-secondary",children:We.jsxs("tr",{children:[We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase",children:"Name"}),We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase",children:"Actions"})]})}),We.jsx("tbody",{className:"bg-surface-primary dark:bg-dark-surface-primary divide-y divide-border-primary dark:divide-dark-border",children:v.map(e=>We.jsxs("tr",{className:"hover:bg-surface-hover dark:hover:bg-dark-surface-hover opacity-70",children:[We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-text-primary dark:text-dark-text",children:e.name}),We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:We.jsxs("div",{className:"flex items-center space-x-2",children:[We.jsx(_h,{variant:"success",size:"sm",onClick:()=>w(e),icon:We.jsx("i",{className:"fas fa-box-open"}),children:"Unarchive"}),We.jsx(_h,{variant:"danger",size:"sm",onClick:()=>u(e),icon:We.jsx("i",{className:"fas fa-trash-alt"}),children:"Delete Permanently"})]})})]},e.id))})]})})}),We.jsx(Dh,{isOpen:r,onClose:()=>i(!1),title:o?"Edit Business Unit":"Add New Business Unit",size:"md",children:We.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),h(""),!m.trim())return void h("Business Unit name cannot be empty.");if(!x)return void h("You must be logged in to perform this action.");if(o&&!e)return void h("You do not have permission to edit business units.");if(!o&&!e)return void h("You do not have permission to create business units.");if((await If()).find(e=>e.name.toLowerCase()===m.trim().toLowerCase()&&e.id!==(null==o?void 0:o.id)))return void h(`Business Unit name "${m.trim()}" already exists.`);let n=null;n=o?await(async(e,t)=>{if(!(await Zp.getById(e.id)))throw new Error("Business Unit not found");return await Zp.update(e.id,e),await Ef({timestamp:Date.now(),actorId:t.id,actorName:t.name,type:dt.BUSINESS_UNIT_UPDATED,description:"updated business unit:",targetId:e.id,targetName:e.name}),e})({...o,name:m.trim()},x):await(async(e,t)=>{if((await If()).some(t=>t.name.toLowerCase()===e.name.toLowerCase()))throw new Error("Business Unit name already exists");const n=Up(),a={...e,id:cm("bu"),status:"active",tenantId:n};return await Zp.create(a.id,a),await Ef({timestamp:Date.now(),actorId:t.id,actorName:t.name,type:dt.BUSINESS_UNIT_CREATED,description:"created business unit:",targetId:a.id,targetName:a.name}),a})({name:m.trim()},x),n?(g(`Business Unit "${n.name}" ${o?"updated":"added"} successfully.`,"success"),i(!1),y()):h("Failed to save Business Unit. Please try again.")},className:"space-y-4",children:[f&&We.jsx(Th,{type:"error",message:f,onClose:()=>h("")}),We.jsx(Ch,{label:"Business Unit Name",id:"buName",value:m,onChange:e=>p(e.target.value),required:!0,autoFocus:!0}),We.jsxs("div",{className:"flex justify-end space-x-3 pt-3",children:[We.jsx(_h,{type:"button",variant:"ghost",onClick:()=>i(!1),children:"Cancel"}),We.jsx(_h,{type:"submit",variant:"primary",children:o?"Update Business Unit":"Add Business Unit"})]})]})}),We.jsxs(Lh,{isOpen:!!d,onClose:()=>u(null),onConfirm:async()=>{if(d)if(x){if(!e)return g("You do not have permission to permanently delete business units.","error"),void u(null);try{await(async(e,t)=>{if((await Cf()).some(t=>t.businessUnitId===e))throw new Error("Cannot delete Business Unit as it is assigned to users.");const n=await Zp.getById(e);await Zp.delete(e),n&&await Ef({timestamp:Date.now(),actorId:t.id,actorName:t.name,type:dt.BUSINESS_UNIT_DELETED,description:"permanently deleted business unit:",targetId:e,targetName:n.name})})(d.id,x),g(`Business Unit "${d.name}" permanently deleted.`,"success"),y()}catch(t){g(t.message,"error")}finally{u(null)}}else g("You must be logged in to perform this action.","error")},title:"Confirm Permanent Deletion",confirmButtonVariant:"danger",confirmText:"Yes, Permanently Delete",children:[We.jsxs("p",{children:['Are you sure you want to permanently delete the Business Unit "',We.jsx("strong",{children:null==d?void 0:d.name}),'"?']}),We.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mt-2",children:"This action is irreversible. It will remove the unit and disassociate it from all historical user and leave records."})]})]})},Yh=({label:e,id:t,error:n,className:a="",wrapperClassName:s="",fieldIdentifier:r,addonButton:i,hintText:o,textareaRef:c,...d})=>{const u=n?"border-red-500 focus:ring-red-500 focus:border-red-500":"",m=l.useRef(null),p=c||m;return l.useLayoutEffect(()=>{const e=p.current;e&&(e.style.height="auto",e.style.height=`${e.scrollHeight}px`)},[d.value,p]),We.jsxs("div",{className:`mb-1 ${s}`,children:[e&&We.jsx("label",{htmlFor:t,className:"block text-sm font-medium text-text-primary dark:text-dark-text-primary",children:e}),We.jsxs("div",{className:"relative mt-1",children:[We.jsx("textarea",{ref:p,id:t,"data-fieldidentifier":r,className:`block w-full px-3 py-2 bg-surface-inset dark:bg-dark-surface-inset border border-border-primary dark:border-dark-border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-accent focus:border-accent sm:text-sm resize-y transition text-text-primary dark:text-dark-text-primary placeholder:text-text-secondary dark:placeholder:text-dark-text-secondary focus:animate-input-glow ${u} ${a} ${i?"pr-10":""}`,...d}),i&&We.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:i})]}),o&&We.jsx("p",{className:"mt-1 text-xs text-text-secondary dark:text-dark-text-secondary",children:o}),n&&We.jsx("p",{className:"mt-1 text-xs text-red-600",children:n})]})},Jh=()=>{const e=jh(Xe.CAN_MANAGE_ROLES);if(!e)return We.jsx("div",{className:"flex items-center justify-center min-h-screen",children:We.jsx(Ih,{title:"Access Denied",children:We.jsxs("div",{className:"text-center py-8",children:[We.jsx("i",{className:"fas fa-lock text-6xl text-gray-400 dark:text-gray-600 mb-4"}),We.jsx("p",{className:"text-lg font-semibold mb-2",children:"Permission Required"}),We.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"You do not have permission to manage roles and permissions. Please contact your administrator."})]})})});const[t,n]=l.useState([]),[a,s]=l.useState(null),[r,i]=l.useState(!0),[o,c]=l.useState(!1),[d,u]=l.useState(null),{addToast:m}=bh(),{currentUser:p}=Eh(),f=l.useCallback(async()=>{i(!0);const e=await Sf();n(e),i(!1)},[]);l.useEffect(()=>{f()},[f]);const h=e=>It.includes(e);return r?We.jsx(Ph,{message:"Loading roles and permissions..."}):We.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[We.jsx(Ih,{title:"Roles",titleIcon:We.jsx("i",{className:"fas fa-user-tag"}),actions:e?We.jsx(_h,{onClick:()=>{e?s({id:"",name:"",description:"",permissions:[],tenantId:""}):m("You do not have permission to create roles.","error")},icon:We.jsx("i",{className:"fas fa-plus"}),size:"sm",children:"New Role"}):void 0,children:We.jsx("ul",{className:"space-y-2",children:t.map(e=>We.jsx("li",{children:We.jsxs("button",{onClick:()=>(e=>{s(JSON.parse(JSON.stringify(e)))})(e),className:"w-full text-left p-3 rounded-lg transition-colors "+((null==a?void 0:a.id)===e.id?"bg-primary text-white":"hover:bg-primary-light dark:hover:bg-slate-700"),children:[We.jsxs("div",{className:"font-semibold",children:[e.name," ",h(e.id)&&We.jsx("span",{className:"text-xs opacity-70",children:"(System Role)"})]}),We.jsx("div",{className:"text-xs opacity-80",children:e.description})]})},e.id))})}),We.jsx("div",{className:"lg:col-span-2",children:a?We.jsx(Ih,{title:a.id?`Editing: ${a.name}`:"Create New Role",children:We.jsxs("div",{className:"space-y-4",children:[We.jsx(Ch,{label:"Role Name",value:a.name,onChange:e=>s({...a,name:e.target.value}),disabled:o||h(a.id)}),h(a.id)&&We.jsxs("p",{className:"text-xs text-orange-600 dark:text-orange-400 mt-1",children:[We.jsx("i",{className:"fas fa-lock mr-1"}),"System role - cannot be modified for security reasons."]}),We.jsx(Yh,{label:"Description",value:a.description,onChange:e=>s({...a,description:e.target.value}),disabled:o,rows:2}),We.jsx("h3",{className:"font-semibold text-lg pt-4 border-t dark:border-slate-700",children:"Permissions"}),We.jsx("div",{className:"space-y-4 max-h-[50vh] overflow-y-auto pr-2",children:Object.entries(_t).map(([t,n])=>We.jsxs("div",{children:[We.jsx("h4",{className:"font-semibold text-md mb-2 text-secondary dark:text-slate-300",children:n.label}),We.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-x-4 gap-y-2",children:n.permissions.map(t=>We.jsxs("div",{className:"flex items-center",children:[We.jsx("input",{type:"checkbox",id:t,checked:a.permissions.includes(t),onChange:e=>((e,t)=>{if(!a)return;const n=a.permissions;t&&!n.includes(e)?s({...a,permissions:[...n,e]}):t||s({...a,permissions:n.filter(t=>t!==e)})})(t,e.target.checked),className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary",disabled:o||h(a.id)||!e}),We.jsx("label",{htmlFor:t,className:"ml-2 text-sm text-gray-700 dark:text-slate-300 capitalize cursor-pointer",style:{textTransform:"capitalize"},children:t.replace(/CAN_/g,"").replace(/_/g," ").toLowerCase()})]},t))})]},t))}),We.jsxs("div",{className:"flex justify-between items-center pt-4 border-t dark:border-slate-700",children:[We.jsxs("div",{children:[a.id&&!h(a.id)&&We.jsxs(_h,{variant:"danger",onClick:()=>u(a),disabled:o,children:[We.jsx("i",{className:"fas fa-trash mr-2"}),"Delete Role"]}),a.id&&h(a.id)&&We.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[We.jsx("i",{className:"fas fa-lock mr-1"}),"System roles cannot be deleted"]})]}),We.jsxs("div",{className:"flex items-center space-x-2",children:[We.jsxs(_h,{variant:"ghost",onClick:()=>s(null),disabled:o,children:[We.jsx("i",{className:"fas fa-times mr-2"}),"Cancel"]}),We.jsxs(_h,{variant:"primary",onClick:async()=>{if(a&&a.name.trim())if(p)if(a.id&&h(a.id))m("System roles cannot be modified for security reasons.","error");else if(e){c(!0);try{if(a.id)await(async(e,t)=>{const n=await Af(e.id);if(!n)throw new Error("Role not found");const a=[];n.name!==e.name&&a.push({field:"Role Name",from:n.name,to:e.name}),n.description!==e.description&&a.push({field:"Role Description",from:n.description||"(none)",to:e.description||"(none)"});const s=new Set(n.permissions),r=new Set(e.permissions),i=e.permissions.filter(e=>!s.has(e)),l=n.permissions.filter(e=>!r.has(e));i.length>0&&a.push({field:"Permissions Added",from:{canonical:[],humanReadable:""},to:{canonical:i,humanReadable:i.map(e=>e.replace(/CAN_/g,"").replace(/_/g," ").toLowerCase()).join(", ")}}),l.length>0&&a.push({field:"Permissions Removed",from:{canonical:l,humanReadable:l.map(e=>e.replace(/CAN_/g,"").replace(/_/g," ").toLowerCase()).join(", ")},to:{canonical:[],humanReadable:""}}),await Jp.update(e.id,e);const o=a.length>0?`updated role "${e.name}" (${a.length} change${a.length>1?"s":""})`:`updated role "${e.name}"`;if(await Ef({timestamp:Date.now(),actorId:t.id,actorName:t.name,type:dt.ROLE_UPDATED,description:o,targetId:e.id,targetName:e.name,details:a.length>0?{changes:a}:void 0}),i.length>0||l.length>0){const n=(await Cf()).filter(n=>n.roleId===e.id&&n.id!==t.id),s=[];i.length>0&&s.push(`gained ${i.length} permission${i.length>1?"s":""}`),l.length>0&&s.push(`lost ${l.length} permission${l.length>1?"s":""}`);for(const r of n)await Ef({timestamp:Date.now(),actorId:t.id,actorName:t.name,type:dt.ROLE_UPDATED,description:`updated your role "${e.name}" - you ${s.join(" and ")}`,targetId:e.id,targetName:e.name,targetUserId:r.id,targetUserName:r.name,details:{changes:a},isCrucial:!0})}return e})(a,p),m(`Role "${a.name}" updated successfully.`,"success");else{const e=await(async(e,t)=>{if((await Sf()).some(t=>t.name.toLowerCase()===e.name.toLowerCase()))throw new Error("Role name already exists");const n=Up(),a={...e,id:cm("role"),tenantId:n};await Jp.create(a.id,a);const s=a.permissions.length,r=a.permissions.map(e=>e.replace(/CAN_/g,"").replace(/_/g," ").toLowerCase()).join(", "),i={changes:[{field:"Role Name",from:null,to:a.name},{field:"Description",from:null,to:a.description||"(none)"},{field:"Permissions",from:{canonical:[],humanReadable:""},to:{canonical:a.permissions,humanReadable:`${s} permission${1!==s?"s":""}: ${r}`}}]};return await Ef({timestamp:Date.now(),actorId:t.id,actorName:t.name,type:dt.ROLE_CREATED,description:`created new role "${a.name}" with ${s} permission${1!==s?"s":""}`,targetId:a.id,targetName:a.name,details:i}),a})({name:a.name,description:a.description,permissions:a.permissions},p);s(e),m(`Role "${a.name}" created successfully.`,"success")}await f()}catch(t){m(`Error saving role: ${t.message}`,"error")}finally{c(!1)}}else m("You do not have permission to manage roles.","error");else m("You must be logged in to perform this action.","error");else m("Role name is required.","error")},isLoading:o,children:[We.jsx("i",{className:"fas fa-save mr-2"}),o?"Saving...":"Save Role"]})]})]})]})}):We.jsx("div",{className:"flex items-center justify-center h-full bg-slate-50 dark:bg-slate-800/50 rounded-lg p-8 text-center",children:We.jsxs("div",{className:"text-slate-500 dark:text-slate-400",children:[We.jsx("i",{className:"fas fa-arrow-left text-3xl mb-4"}),We.jsx("p",{children:"Select a role from the left to view or edit its permissions, or create a new one."})]})})}),We.jsxs(Lh,{isOpen:!!d,onClose:()=>u(null),onConfirm:async()=>{if(d)if(p){if(!e)return m("You do not have permission to delete roles.","error"),void u(null);if(h(d.id))return m("System roles cannot be deleted for security reasons.","error"),void u(null);try{await(async(e,t)=>{if((await Cf()).some(t=>t.roleId===e))throw new Error("Cannot delete role as it is assigned to one or more users.");const n=await Jp.getById(e);let a;if(n){const e=n.permissions.length,t=n.permissions.map(e=>e.replace(/CAN_/g,"").replace(/_/g," ").toLowerCase()).join(", ");a={changes:[{field:"Role Name",from:n.name,to:null},{field:"Description",from:n.description||"(none)",to:null},{field:"Permissions",from:{canonical:n.permissions,humanReadable:`${e} permission${1!==e?"s":""}: ${t}`},to:{canonical:[],humanReadable:""}}]}}await Jp.delete(e),n&&await Ef({timestamp:Date.now(),actorId:t.id,actorName:t.name,type:dt.ROLE_DELETED,description:`deleted role "${n.name}"`,targetId:e,targetName:n.name,details:a,isCrucial:!0})})(d.id,p),m(`Role "${d.name}" deleted successfully.`,"success"),s(null),await f()}catch(t){m(`Error deleting role: ${t.message}`,"error")}finally{u(null)}}else m("You must be logged in to perform this action.","error")},title:`Confirm Deletion of "${null==d?void 0:d.name}"`,confirmButtonVariant:"danger",confirmText:"Yes, Delete Role",children:[We.jsx("p",{children:"Are you sure you want to delete this role? This cannot be undone."}),We.jsx("p",{className:"text-sm font-semibold text-red-600 dark:text-red-400 mt-2",children:"If any users are currently assigned to this role, you will not be able to delete it."})]})]})},{Link:Zh}=m,Qh=({title:e,events:t,isLoading:n=!1,maxHeight:a="max-h-[30rem]"})=>{if(n)return We.jsx(Ih,{title:e,titleIcon:We.jsx("i",{className:"fas fa-stream"}),children:We.jsx(Ph,{message:`Loading ${e.toLowerCase()}...`})});const s=e=>{if(!e.isCrucial)return"border-transparent";switch(e.originalActionType){case dt.EOD_SUBMITTED:case dt.EOD_LATE_SUBMITTED:case dt.MEETING_CRUCIAL_UPDATE_POSTED:return"border-amber-500";case dt.TASK_COMPLETED:return"border-emerald-500";case dt.TASK_STATUS_CHANGED:return"border-red-500";case dt.LEAVE_MARKED_BY_EMPLOYEE:case dt.LEAVE_MARKED_BY_MANAGER:return"border-rose-500";case dt.LEAVE_REVOKED_BY_MANAGER:return"border-indigo-400";default:return"border-yellow-500"}},r=e=>{const t=We.jsx("span",{className:"font-semibold text-primary dark:text-sky-400",children:e.actorName}),n=e.targetName&&!e.actionDescription.includes(`"${e.targetName}"`),a=n&&e.targetLink&&e.targetName?We.jsxs(Zh,{to:e.targetLink,className:"font-medium text-secondary dark:text-blue-300 hover:underline",children:['"',e.targetName,'"']}):n&&e.targetName?We.jsxs("span",{className:"font-medium text-secondary dark:text-blue-300",children:['"',e.targetName,'"']}):null;return We.jsxs("p",{className:"text-sm text-gray-800 dark:text-slate-300 leading-tight",children:[t," ",e.actionDescription," ",a]})};return We.jsx(Ih,{title:e,titleIcon:We.jsx("i",{className:"fas fa-stream"}),className:"h-full flex flex-col",children:0===t.length?We.jsx("div",{className:"flex-grow flex items-center justify-center",children:We.jsx("p",{className:"text-center text-mediumtext dark:text-slate-400 py-4 italic",children:"No activity to display."})}):We.jsx("div",{className:`${a} overflow-y-auto pr-2 space-y-3 flex-grow`,children:t.map(e=>We.jsxs("div",{className:`flex items-start p-2.5 border-b border-slate-100 dark:border-slate-800/60 hover:bg-slate-50 dark:hover:bg-slate-800/50 rounded-md transition-colors border-l-4 ${s(e)}`,children:[We.jsx(Uh,{name:e.originalActorName,size:"md",className:"mr-3 mt-0.5"}),We.jsxs("div",{className:"flex-grow",children:[r(e),We.jsx("p",{className:"text-xs text-gray-500 dark:text-slate-400 mt-0.5",children:qt(e.timestamp)})]})]},`${e.id}-${e.timestamp}`))})})},{Navigate:Xh}=m,eg=()=>{const{currentUser:e}=Eh(),[t,n]=l.useState({totalUsers:0,totalReports:0,pendingReports:0,reportsByDay:[],totalBusinessUnits:0,totalLeaveRecords:0}),[a,s]=l.useState([]);if(l.useEffect(()=>{if(!e)return;(async()=>{const t=await Cf(),a=await Df(),r=await If(),i=await zf(),l=await(async()=>{const e=Up();return await rf.getAll(e)})(),o={},c=new Date;for(let e=6;e>=0;e--){const t=new Date(c);t.setDate(c.getDate()-e);const n=t.toLocaleDateString("en-US",{weekday:"short"});o[n]=0}const d=[];for(let e=6;e>=0;e--){const t=new Date(c);t.setDate(c.getDate()-e),d.push(t.toLocaleDateString("en-US",{weekday:"short"}))}a.forEach(e=>{if(e.versions&&e.versions.length>0){const t=new Date(e.date+"T00:00:00Z"),n=c.getTime()-t.getTime(),a=Math.floor(n/864e5);if(a>=0&&a<7){const e=t.toLocaleDateString("en-US",{weekday:"short"});void 0!==o[e]&&o[e]++}}});const u=d.map(e=>({name:e,reports:o[e]||0}));n({totalUsers:t.length,totalReports:a.length,pendingReports:a.filter(e=>e.status===tt.PENDING_ACKNOWLEDGMENT).length,reportsByDay:u,totalBusinessUnits:r.length,totalLeaveRecords:i.length});const m=l.slice(0,25).map(t=>lh(t,e)),p=await Promise.all(m);s(p.sort((e,t)=>t.timestamp-e.timestamp))})()},[e]),!e)return We.jsx(Xh,{to:"/login",replace:!0});const r=()=>We.jsx(Ih,{title:"System Overview",titleIcon:We.jsx("i",{className:"fas fa-server"}),children:We.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[We.jsxs("div",{className:"bg-sky-50 dark:bg-sky-500/10 p-4 rounded-lg text-center",children:[We.jsx("p",{className:"text-3xl font-bold text-sky-600 dark:text-sky-400",children:t.totalUsers}),We.jsx("p",{className:"text-sm text-mediumtext dark:text-slate-400",children:"Total Users"})]}),We.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-500/10 p-4 rounded-lg text-center",children:[We.jsx("p",{className:"text-3xl font-bold text-indigo-600 dark:text-indigo-400",children:t.totalBusinessUnits}),We.jsx("p",{className:"text-sm text-mediumtext dark:text-slate-400",children:"Business Units"})]}),We.jsxs("div",{className:"bg-emerald-50 dark:bg-emerald-500/10 p-4 rounded-lg text-center",children:[We.jsx("p",{className:"text-3xl font-bold text-emerald-600 dark:text-emerald-400",children:t.totalReports}),We.jsx("p",{className:"text-sm text-mediumtext dark:text-slate-400",children:"Total Reports"})]}),We.jsxs("div",{className:"bg-amber-50 dark:bg-amber-500/10 p-4 rounded-lg text-center",children:[We.jsx("p",{className:"text-3xl font-bold text-amber-600 dark:text-amber-400",children:t.pendingReports}),We.jsx("p",{className:"text-sm text-mediumtext dark:text-slate-400",children:"Pending Ack."})]}),We.jsxs("div",{className:"bg-teal-50 dark:bg-teal-500/10 p-4 rounded-lg text-center",children:[We.jsx("p",{className:"text-3xl font-bold text-teal-600 dark:text-teal-400",children:t.totalLeaveRecords}),We.jsx("p",{className:"text-sm text-mediumtext dark:text-slate-400",children:"Total Leave Records"})]})]})});return We.jsx(Ah,{title:`${(()=>{const e=(new Date).getHours();return e<12?"Good Morning":e<18?"Good Afternoon":"Good Evening"})()}, ${e.name}!`,children:We.jsxs("div",{className:"space-y-6",children:[We.jsx(r,{}),We.jsx(Qh,{title:"System Activity Log",events:a}),We.jsx(Ih,{title:"Admin Tools",titleIcon:We.jsx("i",{className:"fas fa-tools"}),children:We.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[We.jsx(_h,{to:"/user-management",variant:"primary",size:"lg",className:"w-full",icon:We.jsx("i",{className:"fas fa-users-cog"}),children:"Manage Users"}),We.jsx(_h,{to:"/roles-permissions",variant:"primary",size:"lg",className:"w-full",icon:We.jsx("i",{className:"fas fa-user-shield"}),children:"Roles & Permissions"}),We.jsx(_h,{to:"/manage-business-units",variant:"primary",size:"lg",className:"w-full",icon:We.jsx("i",{className:"fas fa-briefcase"}),children:"Manage Business Units"}),We.jsx(_h,{to:"/all-reports",variant:"secondary",size:"lg",className:"w-full",icon:We.jsx("i",{className:"fas fa-archive"}),children:"View All Reports"}),We.jsx(_h,{to:"/admin-trigger-log",variant:"ghost",size:"lg",className:"w-full",icon:We.jsx("i",{className:"fas fa-history"}),children:"View Trigger Log"}),We.jsx(_h,{to:"/admin/leave-records",variant:"primary",size:"lg",className:"w-full lg:col-span-1",icon:We.jsx("i",{className:"fas fa-calendar-times"}),children:"Manage Leave Records"})]})})]})})},tg=()=>We.jsx(Ah,{title:"User Management",children:We.jsx(Bh,{})}),ng=()=>We.jsx(Ah,{title:"All EOD Reports",children:We.jsx(Wh,{})}),ag=()=>We.jsx(Ah,{title:"Trigger Log History",children:We.jsx(Hh,{})}),sg=()=>We.jsx(Ah,{title:"Manage Business Units",children:We.jsx(Kh,{})}),rg=()=>We.jsx(Ah,{title:"Roles & Permissions",children:We.jsx(Jh,{})}),ig=async e=>{const t=await Yp.getAll(e);return{totalUsers:t.length,activeUsers:t.filter(e=>e.status===et.ACTIVE).length,archivedUsers:t.filter(e=>e.status===et.ARCHIVED).length}},lg=V(nm),og=async()=>{try{const e=re(lg,"fixAllUserClaims");return(await e()).data}catch(e){throw new Error(e.message||"Failed to fix user claims")}},cg=async e=>{try{const t=re(lg,"createTenant");return(await t(e)).data}catch(t){throw new Error(t.message||"Failed to create tenant")}},dg=async e=>{try{const t=re(lg,"submitDemoRequest");return(await t(e)).data}catch(t){throw new Error(t.message||"Failed to submit demo request")}},ug=async e=>{try{const t=re(lg,"setUserCustomClaims");return(await t(e)).data}catch(t){throw new Error(t.message||"Failed to set custom claims")}},mg=async()=>{try{const e=re(lg,"migrateExistingData");return(await e({})).data}catch(e){throw new Error(e.message||"Failed to migrate data")}},pg=async()=>{try{const e=re(lg,"generateTelegramLinkingCode");return(await e({})).data}catch(e){throw new Error(e.message||"Failed to generate Telegram linking code")}},fg=Object.freeze(Object.defineProperty({__proto__:null,callCreateTenant:cg,callCreateUser:async e=>{try{const t=re(lg,"createUser");return(await t(e)).data}catch(t){const e=(()=>{var e;const n="string"==typeof(null==t?void 0:t.message)&&t.message.trim()||"string"==typeof(null==t?void 0:t.details)&&t.details.trim()||"string"==typeof(null==(e=null==t?void 0:t.details)?void 0:e.message)&&t.details.message.trim()||"";if(n&&"internal"!==n.toLowerCase())return n;const a=(null==t?void 0:t.code)||(null==t?void 0:t.status);switch(a){case"functions/permission-denied":case"permission-denied":return"You do not have permission to create users.";case"functions/already-exists":case"already-exists":return"A user with this email already exists.";case"functions/invalid-argument":case"invalid-argument":return"One or more fields are invalid. Please double-check and try again.";default:return a?`Failed to create user. (${a})`:"Failed to create user. Please try again."}})();throw new Error(e)}},callFixAllUserClaims:og,callGenerateTelegramLinkingCode:pg,callMigrateExistingData:mg,callSetUserCustomClaims:ug,callSubmitDemoRequest:dg},Symbol.toStringTag,{value:"Module"})),hg=()=>{var e,t;const{currentUser:n}=Eh(),{addToast:a}=bh(),[s,r]=l.useState([]),[i,o]=l.useState(!0),[c,d]=l.useState(!1),[u,m]=l.useState(!1),[p,f]=l.useState({}),[h,g]=l.useState(null),[x,y]=l.useState(!1),[b,N]=l.useState(!1),[w,k]=l.useState(""),[E,j]=l.useState(!1),[C,_]=l.useState(!1),[T,S]=l.useState(!1),[A,I]=l.useState(!1),[D,O]=l.useState({}),[R,P]=l.useState({companyName:"",plan:"Professional",adminEmail:"",adminPassword:"",adminName:""});l.useEffect(()=>{M()},[]);const M=async()=>{try{const e=await Kp.getAll();r(e);const t={};for(const n of e)t[n.id]=await ig(n.id);f(t)}catch(e){a("Failed to load tenants","error")}finally{o(!1)}},U=async(e,t)=>{try{await(async(e,t)=>{await Kp.update(e,{status:t})})(e,t),a("Tenant status updated","success"),await M()}catch(n){a("Failed to update status","error")}},L=async(e,t)=>{try{await(async(e,t)=>{const n=t===lt.STARTER?10:t===lt.PROFESSIONAL?50:500;await Kp.update(e,{plan:t,settings:{maxUsers:n,features:["eod","tasks","meetings","leaderboard","performance-hub"]}})})(e,t),a("Tenant plan updated","success"),await M()}catch(n){a("Failed to update plan","error")}},F=e=>{switch(e){case ot.ACTIVE:return"bg-green-100 text-green-800";case ot.SUSPENDED:return"bg-yellow-100 text-yellow-800";case ot.INACTIVE:default:return"bg-gray-100 text-gray-800"}},B=e=>{switch(e){case lt.STARTER:return"bg-blue-100 text-blue-800";case lt.PROFESSIONAL:return"bg-purple-100 text-purple-800";case lt.ENTERPRISE:return"bg-indigo-100 text-indigo-800";default:return"bg-gray-100 text-gray-800"}};return(null==n?void 0:n.isPlatformAdmin)?i?We.jsx("div",{className:"flex justify-center items-center h-64",children:We.jsx("div",{className:"text-gray-600",children:"Loading tenants..."})}):We.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[We.jsxs("div",{className:"flex justify-between items-center mb-6",children:[We.jsxs("div",{children:[We.jsxs("h1",{className:"text-3xl font-bold text-gray-800",children:[We.jsx("i",{className:"fas fa-building mr-2"}),"Super Admin Panel"]}),We.jsx("p",{className:"text-gray-600 mt-1",children:"Manage multi-tenant organizations"})]}),We.jsxs("div",{className:"flex gap-3",children:[We.jsx(_h,{variant:"danger",onClick:async()=>{if(confirm(" FIX MISSING FIELDS\n\nThis migration will:\n Add isDeleted=false to all users\n Add status='active' to all business units\n\nThis fixes the User Management and Business Units display issues.\n\nSafe to run multiple times. Continue?")){I(!0);try{const e=await mg();if(e.success){const{results:t}=e;a(` Migration complete! Fixed ${t.usersFixed} users, ${t.businessUnitsFixed} business units`,"success"),alert(` DATA MIGRATION SUCCESSFUL!\n\nUsers Fixed: ${t.usersFixed}\nBusiness Units Fixed: ${t.businessUnitsFixed}\nErrors: ${t.errors}\n\nPlease logout and login again to see all users and business units!`)}else a("Migration failed","error")}catch(e){a(`Error: ${e.message}`,"error")}finally{I(!1)}}},disabled:A,title:" FIX: Add missing isDeleted and status fields to existing data",children:A?We.jsxs(We.Fragment,{children:[We.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Migrating..."]}):We.jsxs(We.Fragment,{children:[We.jsx("i",{className:"fas fa-database mr-2"}),"Fix Missing Fields"]})}),We.jsx(_h,{variant:"warning",onClick:async()=>{if(confirm("Fix custom claims for all existing users?\n\nThis sets the isTenantAdmin flag for Admin role users.\n\nUsers will need to LOGOUT and LOGIN again to get fresh tokens.\n\nContinue?")){S(!0);try{const e=await og();if(e.success){const{results:t}=e,n=t.details.map(e=>`${e.email}: ${e.action} ${e.roleName?`(${e.roleName})`:""}`).join("\n");alert(` User Claims Migration Complete!\n\nTotal Users: ${t.total}\nUpdated: ${t.updated}\nSkipped: ${t.skipped}\nErrors: ${t.errors}\n\nDetails:\n${n}\n\n IMPORTANT: All users must LOGOUT and LOGIN again to get new permissions!`),a(` Fixed ${t.updated} users. Users must logout/login again!`,"success")}else a("Failed to fix user claims","error")}catch(e){a(`Error: ${e.message}`,"error")}finally{S(!1)}}},disabled:T,title:" CRITICAL FIX: Set isTenantAdmin flag for Admin role users",children:T?We.jsxs(We.Fragment,{children:[We.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Fixing..."]}):We.jsxs(We.Fragment,{children:[We.jsx("i",{className:"fas fa-user-shield mr-2"}),"Fix User Claims"]})}),We.jsx(_h,{variant:"secondary",onClick:async()=>{if(confirm("This will update all tenant roles to use correct permission format. Continue?")){o(!0);try{const{httpsCallable:e}=await v(async()=>{const{httpsCallable:e}=await import("./firebase-B8V1oFvZ.js").then(e=>e.J);return{httpsCallable:e}},[]),{functions:t}=await v(async()=>{const{functions:e}=await Promise.resolve().then(()=>lm);return{functions:e}},void 0),n=e(t,"fixRolePermissions"),s=(await n()).data;s.success?(a(` ${s.message}`,"success"),alert(`Permission Fix Complete!\n\nRoles Updated: ${s.rolesUpdated}\n\nPlease logout and login again to see changes.`)):a("Permission fix failed","error")}catch(e){a(`Error: ${e.message}`,"error")}finally{o(!1)}}},disabled:i,title:"Fix role permissions to use correct enum format",children:i?We.jsxs(We.Fragment,{children:[We.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Fixing..."]}):We.jsxs(We.Fragment,{children:[We.jsx("i",{className:"fas fa-shield-alt mr-2"}),"Fix Permissions"]})}),We.jsx(_h,{variant:"secondary",onClick:async()=>{if(confirm("Run migration to backfill admin info on all existing tenants?\n\nThis is safe to run multiple times.")){_(!0);try{const{httpsCallable:t}=await v(async()=>{const{httpsCallable:e}=await import("./firebase-B8V1oFvZ.js").then(e=>e.J);return{httpsCallable:e}},[]),{functions:n}=await v(async()=>{const{functions:e}=await Promise.resolve().then(()=>lm);return{functions:e}},void 0),s=t(n,"backfillTenantAdminInfo"),r=(await s({})).data;if(r.success){const{results:t}=r;if(t.errors.length>0){const n=t.errors.join("\n"),s=t.errors.some(e=>e.includes("No users found"));if(s&&confirm(`Migration Complete!\n\n Updated: ${t.updated}\n Skipped: ${t.skipped}\n Errors: ${t.errors.length}\n\nError Details:\n${n}\n\nSome tenants have no users (orphaned). Would you like to clean them up?`)){for(const n of t.errors){const t=n.match(/tenant (tenant_[^\s]+)/);if(t){const n=t[1];try{const{httpsCallable:e}=await v(async()=>{const{httpsCallable:e}=await import("./firebase-B8V1oFvZ.js").then(e=>e.J);return{httpsCallable:e}},[]),{functions:t}=await v(async()=>{const{functions:e}=await Promise.resolve().then(()=>lm);return{functions:e}},void 0),a=e(t,"deleteOrphanedTenant");await a({tenantId:n})}catch(e){}}}a(" Orphaned tenants cleaned up!","success"),M()}else s||alert(`Migration Complete!\n\n Updated: ${t.updated}\n Skipped: ${t.skipped}\n Errors: ${t.errors.length}\n\nError Details:\n${n}`)}else a(` Migration complete! Updated: ${t.updated}, Skipped: ${t.skipped}`,"success");M()}else a("Migration failed","error")}catch(t){a(`Error: ${t.message}`,"error")}finally{_(!1)}}},disabled:C,title:"One-time migration to backfill admin info on existing tenants",children:C?We.jsxs(We.Fragment,{children:[We.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Migrating..."]}):We.jsxs(We.Fragment,{children:[We.jsx("i",{className:"fas fa-database mr-2"}),"Run Migration"]})}),We.jsxs(_h,{onClick:()=>d(!0),children:[We.jsx("i",{className:"fas fa-plus mr-2"}),"Create New Tenant"]})]})]}),We.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[We.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[We.jsx("div",{className:"text-sm text-gray-600",children:"Total Tenants"}),We.jsx("div",{className:"text-2xl font-bold text-gray-800",children:s.length})]}),We.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[We.jsx("div",{className:"text-sm text-gray-600",children:"Active Tenants"}),We.jsx("div",{className:"text-2xl font-bold text-green-600",children:s.filter(e=>e.status===ot.ACTIVE).length})]}),We.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[We.jsx("div",{className:"text-sm text-gray-600",children:"Suspended"}),We.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:s.filter(e=>e.status===ot.SUSPENDED).length})]}),We.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[We.jsx("div",{className:"text-sm text-gray-600",children:"Total Users"}),We.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Object.values(p).reduce((e,t)=>e+((null==t?void 0:t.totalUsers)||0),0)})]})]}),We.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:We.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[We.jsx("thead",{className:"bg-gray-50",children:We.jsxs("tr",{children:[We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Organization"}),We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Plan"}),We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Users"}),We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Admin Email"}),We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),We.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(e=>{var t,n;return We.jsxs("tr",{className:"hover:bg-gray-50",children:[We.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:We.jsxs("div",{children:[We.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.name}),We.jsx("div",{className:"text-sm text-gray-500",children:e.domain||"No domain"})]})}),We.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:We.jsxs("select",{value:e.plan,onChange:t=>L(e.id,t.target.value),className:`text-xs px-2 py-1 rounded-full ${B(e.plan)}`,children:[We.jsx("option",{value:lt.STARTER,children:"Starter"}),We.jsx("option",{value:lt.PROFESSIONAL,children:"Professional"}),We.jsx("option",{value:lt.ENTERPRISE,children:"Enterprise"})]})}),We.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:We.jsxs("select",{value:e.status,onChange:t=>U(e.id,t.target.value),className:`text-xs px-2 py-1 rounded-full ${F(e.status)}`,children:[We.jsx("option",{value:ot.ACTIVE,children:"Active"}),We.jsx("option",{value:ot.SUSPENDED,children:"Suspended"}),We.jsx("option",{value:ot.INACTIVE,children:"Inactive"})]})}),We.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[(null==(t=p[e.id])?void 0:t.activeUsers)||0," / ",(null==(n=e.settings)?void 0:n.maxUsers)||0]}),We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.adminEmail||"N/A"}),We.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:[We.jsx("button",{onClick:()=>(e=>{g(e),y(!0)})(e),className:"text-blue-600 hover:text-blue-800 mr-3",title:"View Details",children:We.jsx("i",{className:"fas fa-eye"})}),We.jsx("button",{onClick:()=>(e=>{g(e),k(""),N(!0)})(e),className:"text-green-600 hover:text-green-800 mr-3",title:"Settings",children:We.jsx("i",{className:"fas fa-cog"})}),e.adminEmail&&We.jsx("button",{onClick:()=>(async e=>{if(!e.adminEmail)return void a("No admin email found for this tenant","error");const t=` DELETE TENANT ADMIN\n\nThis will permanently delete:\n Email: ${e.adminEmail}\n From: ${e.name}\n\nThis action CANNOT be undone!\n\nType 'DELETE' to confirm.`;if("DELETE"===prompt(t)){O(t=>({...t,[e.id]:!0}));try{const{httpsCallable:t}=await v(async()=>{const{httpsCallable:e}=await import("./firebase-B8V1oFvZ.js").then(e=>e.J);return{httpsCallable:e}},[]),{functions:n}=await v(async()=>{const{functions:e}=await Promise.resolve().then(()=>lm);return{functions:e}},void 0),s=t(n,"deleteTenantAdmin"),r=(await s({tenantId:e.id,adminEmail:e.adminEmail})).data;r.success?(a(` ${r.message}`,"success"),await M()):a(`Failed: ${r.message}`,"error")}catch(n){a(`Error: ${n.message}`,"error")}finally{O(t=>({...t,[e.id]:!1}))}}else a("Delete cancelled","info")})(e),className:"text-red-600 hover:text-red-800",title:"Delete Tenant Admin",disabled:D[e.id],children:We.jsx("i",{className:"fas "+(D[e.id]?"fa-spinner fa-spin":"fa-trash")})})]})]},e.id)})})]})}),We.jsx(Dh,{isOpen:x,onClose:()=>{y(!1),g(null)},title:"Tenant Details",children:h&&We.jsxs("div",{className:"space-y-4",children:[We.jsxs("div",{children:[We.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Organization"}),We.jsx("p",{className:"mt-1 text-sm text-gray-900",children:h.name})]}),We.jsxs("div",{children:[We.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Domain"}),We.jsx("p",{className:"mt-1 text-sm text-gray-900",children:h.domain||"No domain"})]}),We.jsxs("div",{children:[We.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Admin Email"}),We.jsx("p",{className:"mt-1 text-sm text-gray-900",children:h.adminEmail})]}),We.jsxs("div",{children:[We.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Plan"}),We.jsx("p",{className:"mt-1 text-sm text-gray-900",children:h.plan})]}),We.jsxs("div",{children:[We.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),We.jsx("p",{className:"mt-1 text-sm text-gray-900",children:h.status})]}),We.jsxs("div",{children:[We.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Users"}),We.jsxs("p",{className:"mt-1 text-sm text-gray-900",children:[(null==(e=p[h.id])?void 0:e.activeUsers)||0," / ",(null==(t=h.settings)?void 0:t.maxUsers)||0]})]}),We.jsxs("div",{children:[We.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Created"}),We.jsx("p",{className:"mt-1 text-sm text-gray-900",children:h.createdAt?new Date(h.createdAt).toLocaleDateString():"N/A"})]})]})}),We.jsx(Dh,{isOpen:b,onClose:()=>{N(!1),g(null),k("")},title:`Settings - ${(null==h?void 0:h.name)||""}`,children:h&&We.jsxs("div",{className:"space-y-6",children:[We.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:We.jsxs("div",{className:"flex items-start",children:[We.jsx("i",{className:"fas fa-exclamation-triangle text-yellow-600 mt-1 mr-3"}),We.jsxs("div",{children:[We.jsx("h4",{className:"text-sm font-medium text-yellow-800",children:"Reset Admin Password"}),We.jsxs("p",{className:"text-sm text-yellow-700 mt-1",children:["Use this to reset the password for tenant admin: ",We.jsx("strong",{children:h.adminEmail})]})]})]})}),We.jsx(Ch,{label:"New Password *",type:"password",value:w,onChange:e=>k(e.target.value),placeholder:"Enter new password (min 6 characters)",disabled:E}),We.jsxs("div",{className:"flex justify-end gap-3",children:[We.jsx(_h,{variant:"secondary",onClick:()=>{N(!1),g(null),k("")},disabled:E,children:"Cancel"}),We.jsx(_h,{onClick:async()=>{if(!h||!w||w.length<6)a("Password must be at least 6 characters","error");else{j(!0);try{const{httpsCallable:e}=await v(async()=>{const{httpsCallable:e}=await import("./firebase-B8V1oFvZ.js").then(e=>e.J);return{httpsCallable:e}},[]),{functions:t}=await v(async()=>{const{functions:e}=await Promise.resolve().then(()=>lm);return{functions:e}},void 0),n=e(t,"resetTenantAdminPassword"),s=(await n({tenantId:h.id,newPassword:w})).data;s.success?(a(" Password reset successfully!","success"),N(!1),k("")):a(`Failed: ${s.message}`,"error")}catch(e){a(`Error: ${e.message}`,"error")}finally{j(!1)}}},disabled:E||!w,children:E?We.jsxs(We.Fragment,{children:[We.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Resetting..."]}):We.jsxs(We.Fragment,{children:[We.jsx("i",{className:"fas fa-key mr-2"}),"Reset Password"]})})]})]})}),We.jsx(Dh,{isOpen:c,onClose:()=>d(!1),title:"Create New Tenant",children:We.jsxs("div",{className:"space-y-4",children:[We.jsx(Ch,{label:"Company Name *",value:R.companyName,onChange:e=>P({...R,companyName:e.target.value}),placeholder:"Acme Corporation"}),We.jsx(Oh,{label:"Plan",value:R.plan,onChange:e=>P({...R,plan:e.target.value}),options:[{value:"Starter",label:"Starter (10 users)"},{value:"Professional",label:"Professional (50 users)"},{value:"Enterprise",label:"Enterprise (500 users)"}]}),We.jsx("hr",{className:"my-4"}),We.jsx("h3",{className:"text-lg font-semibold",children:"Admin User"}),We.jsx(Ch,{label:"Admin Name *",value:R.adminName,onChange:e=>P({...R,adminName:e.target.value}),placeholder:"John Doe"}),We.jsx(Ch,{label:"Admin Email *",type:"email",value:R.adminEmail,onChange:e=>P({...R,adminEmail:e.target.value}),placeholder:"admin@acme.com"}),We.jsx(Ch,{label:"Admin Password *",type:"password",value:R.adminPassword,onChange:e=>P({...R,adminPassword:e.target.value}),placeholder:"Secure password"}),We.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[We.jsx(_h,{variant:"secondary",onClick:()=>d(!1),children:"Cancel"}),We.jsx(_h,{onClick:async()=>{if(R.companyName&&R.adminEmail&&R.adminPassword&&R.adminName){m(!0);try{const e=await cg(R);e.success?(a(` Tenant "${R.companyName}" created successfully!`,"success"),d(!1),P({companyName:"",plan:"Professional",adminEmail:"",adminPassword:"",adminName:""}),await M()):a(`Failed: ${e.message}`,"error")}catch(e){a(`Error: ${e.message}`,"error")}finally{m(!1)}}else a("Please fill all required fields","error")},disabled:u,children:u?We.jsxs(We.Fragment,{children:[We.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Creating..."]}):We.jsxs(We.Fragment,{children:[We.jsx("i",{className:"fas fa-check mr-2"}),"Create Tenant"]})})]})]})})]}):We.jsxs("div",{className:"p-8 text-center",children:[We.jsx("h2",{className:"text-2xl font-bold text-red-600",children:"Access Denied"}),We.jsx("p",{className:"mt-2 text-gray-600",children:"You do not have permission to access the Platform Admin panel."})]})},gg=({icon:e,title:t,message:n,cta:a,className:s=""})=>We.jsxs("div",{className:`text-center py-12 px-6 bg-slate-50 dark:bg-slate-800/50 rounded-lg border-2 border-dashed border-slate-300 dark:border-slate-700 animate-fade-in-up ${s}`,children:[We.jsx("div",{className:"text-5xl text-slate-400 dark:text-slate-500 mb-4",children:e}),We.jsx("h3",{className:"text-xl font-semibold text-slate-700 dark:text-slate-200",children:t}),We.jsx("p",{className:"mt-2 text-sm text-slate-500 dark:text-slate-400 max-w-sm mx-auto",children:n}),a&&We.jsx("div",{className:"mt-6",children:a})]}),xg=()=>{const{currentUser:e,hasPermission:t}=Eh(),[n,a]=l.useState([]),[s,r]=l.useState([]),[i,o]=l.useState(!0),[c,d]=l.useState(""),[u,m]=l.useState([]),p=t(Xe.CAN_MANAGE_TEAM_REPORTS)||t(Xe.CAN_MANAGE_USERS);l.useEffect(()=>{(async()=>{o(!0);const[e,t,n]=await Promise.all([uh(),Cf(),If()]);if(a(e),r(t),p){const e=n.map(e=>({value:e.id,label:e.name}));m([{value:"",label:"All Business Units"},...e])}o(!1)})()},[e,p]);const f=l.useMemo(()=>{if(!c||!p)return n;return n.filter(e=>{const t=s.find(t=>t.id===e.userId);return(null==t?void 0:t.businessUnitId)===c}).map((e,t)=>({...e,rank:t+1}))},[n,c,p,s]);return i?We.jsx(Ph,{message:"Loading Leadership Board..."}):We.jsxs(Ih,{title:" Monthly Leadership Board",titleIcon:We.jsx("i",{className:"fas fa-trophy"}),children:[p&&u.length>1&&We.jsx("div",{className:"mb-4",children:We.jsx(Oh,{label:"Filter by Business Unit:",options:u,value:c,onChange:e=>d(e.target.value),wrapperClassName:"max-w-xs"})}),0===f.length?We.jsx(gg,{icon:We.jsx("i",{className:"fas fa-award"}),title:"Leaderboard is Fresh",message:"No employees have ranked on the leaderboard yet for this period, or no employees match your filter."}):We.jsxs("div",{className:"overflow-x-auto max-h-96",children:[" ",We.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-slate-700",children:[We.jsx("thead",{className:"bg-slate-50 dark:bg-slate-800/60 sticky top-0 z-10",children:We.jsxs("tr",{children:[We.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-slate-400 uppercase tracking-wider",children:"Rank"}),We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-slate-400 uppercase tracking-wider",children:"Employee"}),We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-slate-400 uppercase tracking-wider",children:"Designation"}),p&&We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-slate-400 uppercase tracking-wider",children:"Business Unit"}),We.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-slate-400 uppercase tracking-wider",children:"Current Streak"}),We.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-slate-400 uppercase tracking-wider",children:"Reports This Month"})]})}),We.jsx("tbody",{className:"bg-white dark:bg-slate-900 divide-y divide-gray-200 dark:divide-slate-700/50",children:f.map(e=>{return We.jsxs("tr",{className:`animate-fade-in-up ${e.rank&&e.rank<=3?"bg-amber-50 dark:bg-amber-500/10":""} hover:bg-slate-50 dark:hover:bg-slate-800/50`,children:[We.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-semibold text-center w-16 dark:text-slate-300",children:(t=e.rank,void 0===t?"":1===t?"":2===t?"":3===t?"":t)}),We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-slate-200",children:We.jsxs("div",{className:"flex items-center",children:[We.jsx(Uh,{name:e.employeeName,size:"md",className:"mr-3"}),e.employeeName]})}),We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-slate-400",children:e.designation||"N/A"}),p&&We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-slate-400",children:e.businessUnitName||"N/A"}),We.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-slate-400 text-center",children:[e.currentReportingStreak," days"]}),We.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-slate-400 text-center",children:e.reportsSubmittedThisMonth})]},e.userId);var t})})]})]}),We.jsx("p",{className:"text-xs text-gray-500 dark:text-slate-500 mt-4 text-center",children:"Leaderboard stats (Reports This Month) reset at the start of each new month. Ranking is based on Current Reporting Streak (working days), then Reports This Month."})]})},yg=({allUsers:e,allLeaveRecords:t,onLeaveUpdated:n,scope:a="team"})=>{const{currentUser:s}=Eh(),r=jh(Xe.CAN_GRANT_LEAVE_ACCESS),{addToast:i}=bh(),[o,c]=l.useState(!1),[d,u]=l.useState(null),[m,p]=l.useState(null),[f,h]=l.useState(null),[g,x]=l.useState(""),[y,b]=l.useState(null),[v,N]=l.useState(!1),w=new Date,k=Ht(w),E=Ct[w.getDay()],j=l.useMemo(()=>{if(!s)return[];const t=e.filter(e=>"Employee"===e.roleName&&!e.isSuspended);return"tenant"!==a&&"Director"!==s.roleName&&s.businessUnitId?t.filter(e=>e.businessUnitId===s.businessUnitId):t},[e,s,a]),C=l.useMemo(()=>j.map(e=>{const n=t.find(t=>t.employeeId===e.id&&t.date===k&&t.status===it.APPROVED);if(!n)return null;return e.weeklyOffDay===E||Zt(w,e.weeklyOffDay??"")?null:{employee:e,leaveRecord:n}}).filter(e=>Boolean(e)),[j,t,k,E,w]),_=l.useMemo(()=>{const e=new Set(C.map(e=>e.employee.id));return j.filter(t=>!e.has(t.id)).map(e=>({employee:e,isWeeklyOffToday:e.weeklyOffDay===E||Zt(w,e.weeklyOffDay??"")}))},[j,C,E,w]);if(!s)return null;const T=()=>{c(!1),u(null),p(null),h(null),x(""),b(null),N(!1)},S=(null==m?void 0:m.weeklyOffDay)??null,A="mark"===d&&!!S&&Zt(w,S);return We.jsxs(We.Fragment,{children:[We.jsxs(Ih,{title:"On Leave Today",className:"h-full flex flex-col dark:bg-slate-900",children:[We.jsx("div",{className:"flex-grow",children:0===C.length?We.jsx("div",{className:"flex items-center justify-center h-full",children:We.jsx("p",{className:"text-center text-mediumtext dark:text-slate-400 py-4",children:"No employees are on approved leave today."})}):We.jsx("div",{className:"max-h-60 overflow-y-auto pr-2 space-y-2",children:C.map(({employee:e,leaveRecord:t})=>We.jsxs("div",{className:"p-3 border dark:border-slate-700 rounded-md bg-blue-50 dark:bg-slate-800/60 shadow-sm flex items-start justify-between space-x-3",children:[We.jsxs("div",{className:"flex items-start space-x-3",children:[We.jsx(Uh,{name:e.name,size:"md"}),We.jsxs("div",{children:[We.jsx("p",{className:"font-semibold text-primary dark:text-sky-400",children:e.name}),We.jsxs("p",{className:"text-xs text-gray-500 dark:text-slate-400 mt-1",children:["Reason: ",We.jsx("span",{className:"italic",children:t.reason||"Not specified"})]})]})]}),We.jsx("div",{className:"flex items-center space-x-2",children:r&&We.jsx(_h,{variant:"ghost",size:"sm",disabled:v,onClick:()=>{return n={employee:e,leaveRecord:t},void(canManageLeaves?(p(n.employee),h(n.leaveRecord),u("revoke"),b(null),c(!0)):i("You do not have permission to manage team leave records.","error"));var n},children:"Revoke"})})]},e.id))})}),We.jsx("p",{className:"text-xs text-gray-500 dark:text-slate-500 mt-3 pt-2 border-t border-gray-200 dark:border-slate-700/50",children:"Note: Weekly-off days are excluded automatically."}),r&&We.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-slate-700/40",children:[We.jsx("h4",{className:"text-sm font-semibold text-secondary dark:text-slate-300 mb-3",children:"Quick team actions"}),0===_.length?We.jsx("p",{className:"text-xs text-gray-500 dark:text-slate-500",children:"All active team members are accounted for today."}):We.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto pr-1",children:_.map(({employee:e,isWeeklyOffToday:t})=>We.jsxs("div",{className:"flex items-center justify-between rounded-md border border-dashed border-slate-200 dark:border-slate-700 px-3 py-2",children:[We.jsxs("div",{children:[We.jsx("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:e.name}),t&&We.jsx("p",{className:"text-xs text-amber-600 dark:text-amber-400",children:"Weekly off today  leave not required."})]}),We.jsx(_h,{variant:"primary",size:"sm",disabled:v||t,onClick:()=>(e=>{r?(p(e),u("mark"),x(""),b(null),c(!0)):i("You do not have permission to manage team leave records.","error")})(e),children:"Mark On Leave"})]},e.id))})]})]}),We.jsxs(Dh,{isOpen:o,onClose:()=>{v||T()},title:"mark"===d?`Mark ${(null==m?void 0:m.name)??""} on leave`:`Revoke leave for ${(null==m?void 0:m.name)??""}`,footer:We.jsxs("div",{className:"flex justify-end space-x-2",children:[We.jsx(_h,{variant:"ghost",onClick:T,disabled:v,children:"Cancel"}),We.jsx(_h,{variant:"revoke"===d?"danger":"primary",onClick:async()=>{if(s&&d&&m&&r){if("mark"===d){if(!g.trim())return void b("Please provide a short reason before marking leave.");if(A)return void b(`${m.name} already has a weekly off scheduled today. Leave is not required.`)}N(!0);try{"mark"===d?(await(async(e,t,n,a)=>qf(e,t,n,a))(m.id,k,g.trim(),s),i(`Marked ${m.name} as on leave for today.`,"success")):"revoke"===d&&f&&(await(async(e,t)=>Hf(e,t))(f.id,s),i(`Reverted leave for ${m.name}.`,"info")),await n(),T()}catch(e){const t=(null==e?void 0:e.message)||("mark"===d?"Failed to mark leave for this team member.":"Failed to revoke leave for this team member.");b(t)}finally{N(!1)}}},disabled:v||"mark"===d&&(!g.trim()||A),isLoading:v,children:"mark"===d?"Mark Leave":"Revoke Leave"})]}),children:[y&&We.jsx(Th,{type:"error",message:y}),"mark"===d?We.jsxs(We.Fragment,{children:[A&&We.jsx(Th,{type:"warning",message:"This team member already has a weekly off today. Please confirm the schedule before proceeding."}),We.jsx(Ch,{label:"Reason for leave",placeholder:"E.g., Medical appointment",value:g,onChange:e=>{x(e.target.value),y&&b(null)},disabled:v,autoFocus:!0}),We.jsx("p",{className:"text-xs text-gray-500 dark:text-slate-400 mt-2",children:"The employee will see this reason in their leave history."})]}):We.jsxs("p",{children:["Are you sure you want to revoke the leave for ",null==m?void 0:m.name,"? They will be notified about this change."]})]})]})},bg=({allUsers:e,scope:t="team"})=>{const{currentUser:n}=Eh(),a=jh(Xe.CAN_MANAGE_WEEKLY_OFF),s="Director"===(null==n?void 0:n.roleName),r=t;if(!n||!a&&!s)return null;const i=new Date,o=Ht(i),c=Ct[i.getDay()],d=l.useMemo(()=>{const t=e.filter(e=>e.status===et.ACTIVE&&e.id!==n.id);return[..."tenant"===r||s||!n.businessUnitId?t:t.filter(e=>e.businessUnitId===n.businessUnitId),n].filter(e=>e.weeklyOffDay&&Zt(i,e.weeklyOffDay)).map(e=>({user:e,weeklyOffDay:e.weeklyOffDay??c,displayDate:Wt(o)})).sort((e,t)=>e.user.name.localeCompare(t.user.name))},[e,n,i,o,c,r,s]);return We.jsxs(Ih,{title:"Resting Today",titleIcon:We.jsx("i",{className:"fas fa-bed"}),className:"h-full flex flex-col",children:[We.jsx(Th,{type:"info",message:"Team members listed here are on their scheduled weekly off and cannot be edited.",className:"mb-3 text-sm"}),0===d.length?We.jsx("div",{className:"flex-grow flex items-center justify-center",children:We.jsx("p",{className:"text-sm text-gray-500 dark:text-slate-400",children:"No team members are resting today."})}):We.jsx("div",{className:"flex-grow space-y-2 overflow-y-auto pr-1",children:d.map(({user:e,weeklyOffDay:t,displayDate:n})=>We.jsxs("div",{className:"flex items-start justify-between rounded-md border border-slate-200 dark:border-slate-700 px-3 py-2 bg-slate-50 dark:bg-slate-800/50",children:[We.jsxs("div",{className:"flex items-start space-x-3",children:[We.jsx(Uh,{name:e.name,size:"sm"}),We.jsxs("div",{children:[We.jsx("p",{className:"text-sm font-semibold text-slate-700 dark:text-slate-200",children:e.name}),We.jsx("p",{className:"text-xs text-gray-500 dark:text-slate-400",children:e.designation||"Team Member"})]})]}),We.jsxs("div",{className:"text-right text-xs text-gray-500 dark:text-slate-400",children:[We.jsx("p",{children:t}),We.jsx("p",{children:n})]})]},e.id))})]})},vg=({isOpen:e,onClose:t,summaryDate:n,summaryText:a,isLoading:s,error:r,onSaveSummary:i})=>{const{addToast:l}=bh(),o=n?`AI Summary for ${new Date(n+"T00:00:00").toLocaleDateString()}`:"AI Meeting Summary",c=()=>{a&&navigator.clipboard.writeText(a).then(()=>l("Summary copied!","success")).catch(()=>l("Failed to copy text.","error"))};return We.jsxs(Dh,{isOpen:e,onClose:t,title:o,size:"lg",footer:s?We.jsx(_h,{variant:"ghost",onClick:t,children:"Cancel Generation"}):r?We.jsx(_h,{onClick:t,children:"Close"}):a?We.jsxs(We.Fragment,{children:[We.jsx(_h,{variant:"ghost",onClick:c,icon:We.jsx("i",{className:"fas fa-copy"}),children:"Copy Text"}),i&&We.jsx(_h,{variant:"secondary",onClick:()=>i(a),icon:We.jsx("i",{className:"fas fa-save"}),children:"Save to Workspace"}),We.jsx(_h,{variant:"primary",onClick:t,children:"Done"})]}):We.jsx(_h,{onClick:t,children:"Close"}),children:[s&&We.jsx(Ph,{message:"Generating AI summary, please wait..."}),r&&!s&&We.jsx(Th,{type:"error",message:r}),!s&&!r&&a&&We.jsx("div",{className:"prose prose-sm max-w-none dark:prose-invert whitespace-pre-wrap bg-slate-50 dark:bg-slate-800/50 p-4 rounded-md border dark:border-slate-700 max-h-[60vh] overflow-y-auto",children:a}),!s&&!r&&!a&&We.jsx("p",{className:"text-gray-600 dark:text-slate-400",children:"No summary available. This might happen if there were no reports or an issue occurred."})]})},Ng=({currentUser:e,allUsers:t})=>{var n;const[a,s]=l.useState([]),[r,i]=l.useState(null),[o,c]=l.useState(!0),[d,u]=l.useState([]),[m,p]=l.useState({searchTerm:"",employeeId:"",status:"",dateRange:{startDate:null,endDate:null},businessUnitId:e.businessUnitId||""}),[f,h]=l.useState(1),[g,x]=l.useState(!1),[y,b]=l.useState(!1),v=l.useRef(null),[j,C]=l.useState({key:"date",direction:"descending"}),{addToast:_}=bh(),[T,S]=l.useState(!1),[A,I]=l.useState(null),[D,O]=l.useState(null),[R,P]=l.useState(!1),[M,U]=l.useState(null);l.useEffect(()=>{const e=e=>{v.current&&!v.current.contains(e.target)&&b(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const L=l.useCallback(async()=>{c(!0);const e=await Df();s(e);const t=await If();u(t),c(!1)},[]);l.useEffect(()=>{L()},[L]);const F=e=>{s(t=>t.map(t=>t.id===e.id?e:t)),r&&r.id===e.id&&i(e)},B=l.useMemo(()=>t.filter(e=>"Employee"===e.roleName&&e.status===et.ACTIVE&&(!m.businessUnitId||e.businessUnitId===m.businessUnitId)).map(e=>({value:e.id,label:e.name})),[t,m.businessUnitId]),$=l.useMemo(()=>{if(e.businessUnitId){const t=d.find(t=>t.id===e.businessUnitId);return t?[{value:t.id,label:t.name}]:[]}return[{value:"",label:"All Business Units"},...d.map(e=>({value:e.id,label:e.name}))]},[d,e.businessUnitId]),G=e=>{let t="ascending";j&&j.key===e&&"ascending"===j.direction&&(t="descending"),C({key:e,direction:t})},V=e=>j&&j.key===e?"ascending"===j.direction?We.jsx("i",{className:"fas fa-sort-up text-primary ml-1"}):We.jsx("i",{className:"fas fa-sort-down text-primary ml-1"}):We.jsx("i",{className:"fas fa-sort text-gray-400 ml-1"}),z=l.useMemo(()=>{let n=a.filter(n=>{const a=m.searchTerm.toLowerCase(),s=n.versions.sort((e,t)=>t.versionNumber-e.versionNumber)[0];if(!s)return!1;const r=t.find(e=>e.id===n.employeeId),i=(n.employeeName||"").toLowerCase().includes(a)||(s.tasksCompleted||"").toLowerCase().includes(a)||(s.challengesFaced||"").toLowerCase().includes(a)||(s.planForTomorrow||"").toLowerCase().includes(a)||((null==r?void 0:r.businessUnitName)||"").toLowerCase().includes(a),l=!m.employeeId||n.employeeId===m.employeeId,o=!m.status||n.status===m.status,c=new Date(n.date+"T00:00:00Z"),d=m.dateRange.startDate?new Date(m.dateRange.startDate+"T00:00:00Z"):null,u=m.dateRange.endDate?new Date(m.dateRange.endDate+"T23:59:59Z"):null,p=(!d||c>=d)&&(!u||c<=u),f=e.businessUnitId||m.businessUnitId,h=!f||r&&r.businessUnitId===f;return i&&l&&o&&p&&h});return null!==j?n.sort((e,n)=>{var a,s;let r,i;return"date"===j.key?(r=e.date,i=n.date):"businessUnitName"===j.key?(r=(null==(a=t.find(t=>t.id===e.employeeId))?void 0:a.businessUnitName)||"",i=(null==(s=t.find(e=>e.id===n.employeeId))?void 0:s.businessUnitName)||""):(r=e[j.key],i=n[j.key]),"string"==typeof r&&"string"==typeof i&&(r=r.toLowerCase(),i=i.toLowerCase()),r<i?"ascending"===j.direction?-1:1:r>i?"ascending"===j.direction?1:-1:"date"===j.key?n.submittedAt-e.submittedAt:n.date.localeCompare(e.date)}):n.sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()||e.employeeName.localeCompare(t.employeeName)),n},[a,m,t,j,e.businessUnitId]);l.useEffect(()=>{h(1)},[m,j]);const W=l.useMemo(()=>z.filter(e=>e.status===tt.PENDING_ACKNOWLEDGMENT),[z]),q=Math.ceil(z.length/10),H=l.useMemo(()=>{const e=10*(f-1),t=e+10;return z.slice(e,t)},[z,f]),K=(e,t)=>{if("dateRange"===e){const e=t;if(e.startDate&&e.endDate&&e.startDate>e.endDate)return void _("Start date cannot be after end date.","error")}p(n=>({...n,[e]:t}))},Y=e=>{e>=1&&e<=q&&h(e)},J=()=>z.map(e=>{var n;const a=t.find(t=>t.id===e.employeeId),s=e.versions.sort((e,t)=>t.versionNumber-e.versionNumber)[0]||{};return{"Report ID":e.id,"Employee Name":e.employeeName,"Employee Email":(null==a?void 0:a.email)||"N/A","Business Unit":(null==a?void 0:a.businessUnitName)||"N/A","Report Date":Wt(e.date),"Report Status":e.status,"Manager Comments":e.managerComments||"","Submitted on Week Off":e.submittedOnWeekOff?"Yes":"No","Is Late Submission":e.isLate?"Yes":"No","Total Versions":e.versions.length,"Latest Version Timestamp":s.timestamp?new Date(s.timestamp).toLocaleString():"N/A","Latest Version Action":s.action||"N/A","Latest Version Tasks Completed":s.tasksCompleted||"","Latest Version Challenges Faced":s.challengesFaced||"","Latest Version Plan for Tomorrow":s.planForTomorrow||"","Latest Version Attachments Count":(null==(n=s.attachments)?void 0:n.length)||0,"Latest Version Content Copied":s.isCopied?"Yes":"No"}}),Z=l.useMemo(()=>{if(0===H.length)return!1;const e=H[0].date;return H.every(t=>t.date===e)},[H]);if(o)return We.jsx(Ph,{message:"Loading reports..."});return We.jsxs(Ih,{title:"Employee EOD Reports",titleIcon:We.jsx("i",{className:"fas fa-folder-open"}),children:[We.jsxs("div",{className:"mb-4 p-3 bg-amber-50 dark:bg-amber-900/50 border border-amber-200 dark:border-amber-700 rounded-md text-sm text-amber-800 dark:text-amber-300",children:[We.jsxs("span",{className:"font-semibold text-lg",children:[" Pending Acknowledgments: ",W.length]}),We.jsx("p",{className:"text-xs",children:"This count reflects all pending reports matching your current filters, across all pages."})]}),We.jsxs("div",{className:"mb-3 p-3 border rounded-md bg-surface-secondary dark:bg-dark-surface-secondary dark:border-dark-border",children:[We.jsx("h3",{className:"text-base font-medium text-primary dark:text-sky-400 mb-1",children:"Filter Reports"}),We.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 items-end",children:[We.jsx(Ch,{type:"text",placeholder:"Search (name, tasks, BU...)",value:m.searchTerm,onChange:e=>K("searchTerm",e.target.value),wrapperClassName:"mb-0"}),We.jsx(Oh,{options:[{value:"",label:"All Employees"},...B],value:m.employeeId,onChange:e=>K("employeeId",e.target.value),wrapperClassName:"mb-0",placeholder:"Filter by Employee"}),We.jsx(Oh,{options:[{value:"",label:"All Statuses"},{value:tt.PENDING_ACKNOWLEDGMENT,label:"Pending Acknowledgment"},{value:tt.ACKNOWLEDGED,label:"Acknowledged"}],value:m.status,onChange:e=>K("status",e.target.value),wrapperClassName:"mb-0",placeholder:"Filter by Status"}),!e.businessUnitId&&We.jsx(Oh,{options:$,value:m.businessUnitId,onChange:e=>K("businessUnitId",e.target.value),wrapperClassName:"mb-0",placeholder:"Filter by Business Unit"}),We.jsx(Ch,{type:"date",label:"Start Date",value:m.dateRange.startDate||"",onChange:e=>K("dateRange",{...m.dateRange,startDate:e.target.value||null}),max:m.dateRange.endDate||void 0,wrapperClassName:"mb-0"}),We.jsx(Ch,{type:"date",label:"End Date",value:m.dateRange.endDate||"",onChange:e=>K("dateRange",{...m.dateRange,endDate:e.target.value||null}),min:m.dateRange.startDate||void 0,wrapperClassName:"mb-0"}),We.jsx("div",{className:"lg:col-span-1 xl:col-span-1",children:We.jsx(_h,{onClick:()=>{p({searchTerm:"",employeeId:"",status:"",dateRange:{startDate:null,endDate:null},businessUnitId:e.businessUnitId||""})},variant:"ghost",className:"w-full",children:"Reset Filters"})})]})]}),We.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row justify-end items-center gap-3",children:[We.jsx(_h,{variant:"secondary",onClick:async()=>{if(Z){S(!0),P(!0),U(null),I(null),O(H.length>0?H[0].date:null);try{const e=await(async e=>{const t=bf();if(!t)throw new Error(xf);try{const n=new Md({apiKey:t}),a=`Summarize the following EOD reports for a manager. Highlight key achievements, common challenges, and any notable plans. Be concise and use bullet points.\n\nREPORTS:\n${JSON.stringify(e,null,2)}`;return(await n.models.generateContent({model:"gemini-2.5-flash",contents:a})).text}catch(n){throw kf(n)}})(H);I(e)}catch(e){U(e.message)}finally{P(!1)}}else _("AI Summary can only be generated for reports from a single day. Please adjust your filters.","info")},icon:We.jsx("span",{className:"text-lg",children:""}),disabled:!Z,title:Z?`Generate AI Summary for ${Wt(null==(n=H[0])?void 0:n.date)}`:"Filter reports to a single day to enable AI summary",children:"AI Summary"}),We.jsxs("div",{className:"relative",ref:v,children:[We.jsxs(_h,{variant:"secondary",onClick:()=>b(!y),icon:We.jsx("i",{className:"fas fa-file-export"}),disabled:0===z.length,children:["Export Reports (",z.length,")",We.jsx("i",{className:"fas fa-chevron-down ml-2 transition-transform "+(y?"rotate-180":"")})]}),y&&We.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-surface-primary dark:bg-dark-surface-primary rounded-md shadow-lg py-1 z-20 border border-border-primary dark:border-dark-border",children:[We.jsxs("button",{onClick:()=>{const e=J();if(0===e.length)return void alert("No data to export based on current filters.");const t=Object.keys(e[0]),n="data:text/csv;charset=utf-8,"+t.join(",")+"\n"+e.map(e=>t.map(t=>`"${String(e[t]).replace(/"/g,'""')}"`).join(",")).join("\n"),a=encodeURI(n),s=document.createElement("a");s.setAttribute("href",a),s.setAttribute("download","eod_reports.csv"),document.body.appendChild(s),s.click(),document.body.removeChild(s),b(!1)},className:"w-full text-left block px-4 py-2 text-sm text-text-primary dark:text-dark-text hover:bg-primary-light dark:hover:bg-dark-surface-hover hover:text-primary",children:[We.jsx("i",{className:"fas fa-file-csv mr-2"}),"Export as CSV"]}),We.jsxs("button",{onClick:()=>{const e=J();if(0===e.length)return void alert("No data to export based on current filters.");const t=new N({orientation:"landscape"}),n=Object.keys(e[0]),a=e.map(e=>n.map(t=>String(e[t])));w(t,{head:[n],body:a,styles:{fontSize:6,cellPadding:1,overflow:"linebreak"},headStyles:{fillColor:[0,85,164],fontSize:7},columnStyles:{0:{cellWidth:20},1:{cellWidth:25},2:{cellWidth:30}},margin:{top:10,right:5,bottom:10,left:5},tableWidth:"auto"}),t.save("eod_reports.pdf"),b(!1)},className:"w-full text-left block px-4 py-2 text-sm text-text-primary dark:text-dark-text hover:bg-primary-light dark:hover:bg-dark-surface-hover hover:text-primary",children:[We.jsx("i",{className:"fas fa-file-pdf mr-2"}),"Export as PDF"]}),We.jsxs("button",{onClick:()=>{const e=J();if(0===e.length)return void alert("No data to export based on current filters.");const t=k.json_to_sheet(e),n=k.book_new();k.book_append_sheet(n,t,"EOD Reports"),E(n,"eod_reports.xlsx"),b(!1)},className:"w-full text-left block px-4 py-2 text-sm text-text-primary dark:text-dark-text hover:bg-primary-light dark:hover:bg-dark-surface-hover hover:text-primary",children:[We.jsx("i",{className:"fas fa-file-excel mr-2"}),"Export as Excel"]})]})]}),W.length>0&&We.jsx(_h,{onClick:async()=>{x(!0);const t=W.map(e=>e.id);try{if(!(await(async(e,t)=>{let n=await Df();const a={};for(const s of e){const e=n.findIndex(e=>e.id===s);if(-1===e)continue;const r=n[e];if(Pf(r).hasManagerAcknowledged(t.id))continue;const i=Date.now(),l={managerId:t.id,managerName:t.name,acknowledgedAt:i,comments:"Acknowledged in batch",designation:t.roleName};r.acknowledgments||(r.acknowledgments=[]),r.acknowledgments.push(l),1===r.acknowledgments.length&&(r.status=tt.ACKNOWLEDGED,r.acknowledgedByManagerId=t.id,r.acknowledgedAt=i,r.managerComments||(r.managerComments="Acknowledged in batch")),await Qp.update(r.id,r),await Ef({timestamp:i,actorId:t.id,actorName:t.name,type:dt.EOD_ACKNOWLEDGED,description:`acknowledged ${r.employeeName}'s EOD report for`,targetId:r.id,targetName:Wt(r.date),targetUserId:r.employeeId,targetUserName:r.employeeName}),a[r.employeeId]||(a[r.employeeId]=[]),a[r.employeeId].push({report:r,managerName:t.name})}for(const s in a){const e=a[s],t=e[0].managerName;await Xf({userId:s,message:`Your EOD reports have been acknowledged by ${t}.`,type:"info",link:"/my-reports",actionType:"EOD_ACKNOWLEDGED",targetId:`batch-ack-${Date.now()}`,actors:e.map(e=>({id:e.report.id,name:Wt(e.report.date)})),isCrucial:!0})}return!0})(t,e)))throw new Error("Batch acknowledgement failed in data service.");_(`${t.length} reports acknowledged.`,"success"),await L()}catch(n){_("An error occurred while acknowledging reports.","error")}finally{x(!1)}},variant:"success",disabled:0===W.length||g,isLoading:g,icon:We.jsx("i",{className:"fas fa-check-double"}),children:g?"Acknowledging...":`Acknowledge All (${W.length})`})]}),0===z.length?We.jsx("p",{className:"text-center text-text-secondary dark:text-dark-text-secondary py-8",children:"No reports match your current filters."}):We.jsxs(We.Fragment,{children:[We.jsx("div",{className:"overflow-x-auto",children:We.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-dark-border",children:[We.jsx("thead",{className:"bg-surface-secondary dark:bg-dark-surface-secondary",children:We.jsxs("tr",{children:[We.jsxs("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase tracking-wider cursor-pointer",onClick:()=>G("employeeName"),children:["Employee ",V("employeeName")]}),We.jsxs("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase tracking-wider cursor-pointer",onClick:()=>G("date"),children:["Report Date ",V("date")]}),We.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase tracking-wider",children:"Tasks (Latest)"}),We.jsxs("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase tracking-wider cursor-pointer",onClick:()=>G("status"),children:["Status ",V("status")]}),We.jsxs("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase tracking-wider cursor-pointer",onClick:()=>G("businessUnitName"),children:["Business Unit ",V("businessUnitName")]}),We.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase tracking-wider",children:"Acknowledgments"}),We.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase tracking-wider",children:"Info"}),We.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase tracking-wider",children:"Actions"})]})}),We.jsx("tbody",{className:"bg-surface-primary dark:bg-dark-surface-primary divide-y divide-gray-200 dark:divide-dark-border",children:H.map(n=>{const s=n.versions.sort((e,t)=>t.versionNumber-e.versionNumber)[0];if(!s)return null;const r=t.find(e=>e.id===n.employeeId),l=Pf(n),o=l.hasManagerAcknowledged(e.id),c=l.getAcknowledgingManagers(),d=l.getAcknowledgmentCount();return We.jsxs("tr",{className:"hover:bg-surface-hover dark:hover:bg-dark-surface-hover animate-fade-in-up",children:[We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-text-primary dark:text-dark-text",children:We.jsxs("div",{className:"flex items-center",children:[We.jsx(Uh,{name:n.employeeName,size:"md",className:"mr-3"}),n.employeeName]})}),We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-text-secondary dark:text-dark-text-secondary",children:Wt(n.date)}),We.jsxs("td",{className:"px-6 py-4 whitespace-normal text-sm text-text-secondary dark:text-dark-text-secondary max-w-sm break-words",children:[s.tasksCompleted.substring(0,70),s.tasksCompleted.length>70?"...":""]}),We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:We.jsx("span",{className:"px-2 py-0.5 inline-block text-xs font-semibold rounded-full "+(n.status===tt.ACKNOWLEDGED?"bg-green-100 text-green-700 dark:bg-green-500/20 dark:text-green-300":"bg-yellow-100 text-yellow-700 dark:bg-yellow-500/20 dark:text-yellow-300"),children:n.status})}),We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-text-secondary dark:text-dark-text-secondary",children:(null==r?void 0:r.businessUnitName)||"N/A"}),We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-text-secondary dark:text-dark-text-secondary",children:d>0?We.jsx("div",{className:"space-y-0.5",children:c.map((t,n)=>{const a=t.id===e.id,s="Director"===t.designation;return We.jsxs("div",{className:"text-xs "+(a?"text-green-600 dark:text-green-400 font-semibold":"text-gray-600 dark:text-gray-400"),children:[We.jsx("i",{className:`fas ${a?"fa-check-circle":"fa-user-check"} mr-1`}),t.name,s&&We.jsx("span",{className:"ml-1 text-[10px] opacity-70",children:"(Director)"})]},n)})}):We.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 italic",children:[We.jsx("i",{className:"fas fa-hourglass-half mr-1"}),"Not acknowledged"]})}),We.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-text-secondary dark:text-dark-text-secondary",children:[n.isLate&&We.jsxs("span",{className:"block text-xs text-orange-600 dark:text-orange-400 mb-0.5",title:"Late Submission",children:[We.jsx("i",{className:"fas fa-clock mr-1"}),"Late"]}),n.managerComments&&We.jsxs("span",{className:"block text-xs text-indigo-600 dark:text-indigo-400 mb-0.5",title:"Has comment",children:[We.jsx("i",{className:"fas fa-comment-dots mr-1"}),"Commented"]}),n.versions.length>1&&We.jsxs("span",{className:"block text-xs text-purple-600 dark:text-purple-400",title:`Edited (V${s.versionNumber})`,children:[We.jsx("i",{className:"fas fa-history mr-1"}),"V",s.versionNumber]})]}),We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:We.jsxs("div",{className:"flex items-center space-x-1",children:[We.jsx(_h,{onClick:()=>i(n),variant:"ghost",size:"sm",icon:We.jsx("i",{className:"fas fa-eye"}),children:"Details"}),!o&&We.jsx(_h,{onClick:()=>(async t=>{const n=a.find(e=>e.id===t);if(n){const t=await Rf({id:n.id,status:tt.ACKNOWLEDGED,managerComments:n.managerComments||"Acknowledged"},e);t&&F(t)}})(n.id),variant:"success",size:"sm",icon:We.jsx("i",{className:"fas fa-check"}),title:"Acknowledge this report",children:"Ack."}),o&&We.jsxs("span",{className:"text-xs text-green-600 dark:text-green-400 font-semibold px-2",children:[We.jsx("i",{className:"fas fa-check-double mr-1"}),"You acknowledged"]})]})})]},n.id)})})]})}),q>1&&We.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row justify-between items-center space-y-3 sm:space-y-0",children:[We.jsxs("span",{className:"text-sm text-text-secondary dark:text-dark-text-secondary",children:["Page ",f," of ",q," (Total reports: ",z.length,")"]}),We.jsxs("div",{className:"flex items-center",children:[We.jsx(_h,{onClick:()=>Y(f-1),disabled:1===f,variant:"ghost",size:"sm",icon:We.jsx("i",{className:"fas fa-chevron-left"}),className:"mr-2",children:"Prev"}),(()=>{const e=[];if(q<=7)for(let t=1;t<=q;t++)e.push(We.jsx(_h,{onClick:()=>Y(t),variant:t===f?"primary":"ghost",size:"sm",className:"mx-1",children:t},t));else{e.push(We.jsx(_h,{onClick:()=>Y(1),variant:1===f?"primary":"ghost",size:"sm",className:"mx-1",children:"1"},1));let t=Math.max(2,f-Math.floor(1.5)),n=Math.min(q-1,f+Math.floor(1.5));f<=Math.ceil(2.5)?n=4:f>q-Math.ceil(2.5)&&(t=q-3),t>2&&e.push(We.jsx("span",{className:"mx-1 p-2",children:"..."},"start-ellipsis"));for(let a=t;a<=n;a++)e.push(We.jsx(_h,{onClick:()=>Y(a),variant:a===f?"primary":"ghost",size:"sm",className:"mx-1",children:a},a));n<q-1&&e.push(We.jsx("span",{className:"mx-1 p-2",children:"..."},"end-ellipsis")),e.push(We.jsx(_h,{onClick:()=>Y(q),variant:q===f?"primary":"ghost",size:"sm",className:"mx-1",children:q},q))}return e})(),We.jsx(_h,{onClick:()=>Y(f+1),disabled:f===q,variant:"ghost",size:"sm",icon:We.jsx("i",{className:"fas fa-chevron-right"}),className:"ml-2",children:"Next"})]})]})]}),r&&We.jsx(zh,{report:r,isOpen:!!r,onClose:()=>i(null),currentUser:e,onReportUpdate:F}),We.jsx(vg,{isOpen:T,onClose:()=>S(!1),summaryDate:D,summaryText:A,isLoading:R,error:M})]})},wg=["January","February","March","April","May","June","July","August","September","October","November","December"],kg=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Eg=({user:e,isOpen:t,onClose:n})=>{const[a,s]=l.useState(new Date),[r,i]=l.useState({}),[o,c]=l.useState(!1);l.useEffect(()=>{if(t&&e){const t=async()=>{c(!0);const t=a.getFullYear(),n=a.getMonth(),s=await(async(e,t,n)=>{const a={},s=await _f(e);if(!s)return{};const r=await Of(e),i=await ph(e),l=new Date(t,n+1,0).getDate();for(let o=1;o<=l;o++){const e=new Date(Date.UTC(t,n,o)),l=Ht(e),c=Zt(e,s.weeklyOffDay),d=i.some(e=>e.date===l);if(c||d){a[l]="non-working";continue}if(e>new Date)continue;const u=r.some(e=>e.date===l);a[l]=u?"submitted":"missed"}return a})(e.id,t,n);i(e=>{var t,n;return(null==(t=Object.keys(e)[0])?void 0:t.substring(0,7))===(null==(n=Object.keys(s)[0])?void 0:n.substring(0,7))&&JSON.stringify(e)===JSON.stringify(s)?e:s}),c(!1)};t()}else s(new Date)},[t,e,a.getFullYear(),a.getMonth()]);const d=a.getFullYear(),u=a.getMonth(),m=new Date(d,u+1,1)>new Date;return We.jsxs(Dh,{isOpen:t,onClose:n,title:e?`Consistency for ${e.name}`:"Consistency Calendar",size:"lg",children:[We.jsxs("div",{className:"flex justify-between items-center mb-4",children:[We.jsx(_h,{onClick:()=>s(new Date(d,u-1,1)),variant:"ghost",size:"sm",icon:We.jsx("i",{className:"fas fa-chevron-left"})}),We.jsxs("h3",{className:"font-semibold text-lg text-text-primary dark:text-dark-text",children:[wg[u]," ",d]}),We.jsx(_h,{onClick:()=>s(new Date(d,u+1,1)),variant:"ghost",size:"sm",icon:We.jsx("i",{className:"fas fa-chevron-right"}),disabled:m})]}),o?We.jsx(Ph,{message:"Loading calendar..."}):We.jsxs("div",{className:"grid grid-cols-7 gap-px border-t border-l border-border-primary/30 dark:border-dark-border/30 bg-border-primary dark:bg-dark-border",children:[kg.map(e=>We.jsx("div",{className:"text-center font-medium p-2 bg-surface-secondary dark:bg-dark-surface-secondary text-xs text-text-secondary dark:text-dark-text-secondary",children:e},e)),(()=>{const e=new Date(d,u+1,0).getDate(),t=new Date(d,u,1).getDay(),n=[],a=Ht(new Date);for(let s=0;s<t;s++)n.push(We.jsx("div",{className:"border-border-primary/30 dark:border-dark-border/30 bg-surface-secondary/50 dark:bg-dark-surface-secondary/30"},`empty-${s}`));for(let s=1;s<=e;s++){const e=`${d}-${String(u+1).padStart(2,"0")}-${String(s).padStart(2,"0")}`,t=r[e],i=e===a;let l=null;"submitted"===t?l=We.jsx("div",{className:"absolute bottom-1.5 right-1.5 w-2.5 h-2.5 bg-emerald-500 rounded-full",title:"Report Submitted"}):"missed"===t&&(l=We.jsx("div",{className:"absolute bottom-1.5 right-1.5 w-2.5 h-2.5 bg-red-500 rounded-full",title:"Report Missed"}));const o="non-working"===t;n.push(We.jsxs("div",{className:"border-border-primary/30 dark:border-dark-border/30 p-1 min-h-[3.5rem] flex flex-col relative "+(i?"bg-blue-100 dark:bg-sky-900/40":o?"bg-slate-100 dark:bg-slate-800/50":"bg-surface-primary dark:bg-dark-surface-primary"),children:[We.jsx("span",{className:"text-xs sm:text-sm self-end "+(i?"text-primary dark:text-sky-400 font-bold":o?"text-text-secondary/50 dark:text-dark-text-secondary/50":"text-text-primary dark:text-dark-text"),children:s}),l]},s))}return n})()]}),We.jsxs("div",{className:"flex justify-center items-center gap-6 mt-4 pt-4 border-t border-border-primary dark:border-dark-border",children:[We.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[We.jsx("div",{className:"w-3 h-3 bg-emerald-500 rounded-full"}),We.jsx("span",{children:"Submitted"})]}),We.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[We.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),We.jsx("span",{children:"Missed"})]}),We.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[We.jsx("div",{className:"w-3 h-3 bg-slate-300 dark:bg-slate-600 rounded-full"}),We.jsx("span",{children:"Non-Working Day"})]})]})]})},jg=()=>{const{currentUser:e,hasPermission:t}=Eh(),[n,a]=l.useState([]),[s,r]=l.useState([]),[i,o]=l.useState([]),[c,d]=l.useState(!0),[u,m]=l.useState(!1),[p,f]=l.useState(null),[h,g]=l.useState(null),[x,y]=l.useState(null),[b,v]=l.useState(""),[N,w]=l.useState(()=>(null==e?void 0:e.businessUnitId)||""),k=t(Xe.CAN_VIEW_ALL_REPORTS),E=null==e?void 0:e.businessUnitId,j=l.useCallback(async()=>{d(!0);const[e,t,n]=await Promise.all([mh(),rh(),If()]);a(e),o(t),r(n.filter(e=>"active"===e.status)),d(!1)},[]);l.useEffect(()=>{j()},[j]),l.useEffect(()=>{!k&&E&&w(E)},[k,E]);const C=l.useMemo(()=>k||!E?n:n.filter(e=>e.user.businessUnitId===E),[n,k,E]),_=l.useMemo(()=>{if(k)return[{value:"",label:"All Business Units"},...s.map(e=>({value:e.id,label:e.name}))];const e=s.find(e=>e.id===E);return e?[{value:e.id,label:e.name}]:[]},[s,k,E]),T=l.useMemo(()=>C.filter(e=>{const t=b.toLowerCase(),n=e.user.name.toLowerCase().includes(t)||e.user.email.toLowerCase().includes(t),a=!N||e.user.businessUnitId===N;return n&&a}),[C,b,N]),S=async(t,n)=>{if(!e)return null;await Xf({userId:t.id,message:` Reminder from your manager, ${e.name}: ${n}`,type:"reminder",isCrucial:!0});return await(async e=>{const t=Up(),n=cm("trig"),a={...e,id:n,timestamp:Date.now(),tenantId:t};return await lf.create(n,a),a})({managerId:e.id,managerName:e.name,employeeId:t.id,employeeName:t.name,reason:n})},A=l.useMemo(()=>(new Date).toISOString().split("T")[0],[]),I=l.useMemo(()=>new Set(i.filter(e=>new Date(e.timestamp).toISOString().split("T")[0]===A).map(e=>e.employeeId)),[i,A]),D=l.useMemo(()=>T.filter(e=>e.consecutiveDaysMissed>0&&!I.has(e.user.id)).length,[T,I]);return We.jsxs(We.Fragment,{children:[We.jsxs(Ih,{title:"Reporting Consistency Tracker",titleIcon:We.jsx("i",{className:"fas fa-check-double text-primary"}),children:[x&&We.jsx(Th,{type:x.type,message:x.message,onClose:()=>y(null)}),We.jsx("div",{className:"mb-4 p-3 border rounded-md bg-surface-secondary dark:bg-dark-surface-secondary dark:border-dark-border",children:We.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 items-end",children:[We.jsx(Ch,{type:"text",placeholder:"Search by name or email...",value:b,onChange:e=>v(e.target.value)}),We.jsx(Oh,{options:_,value:N,onChange:e=>w(e.target.value),label:"Filter by Business Unit",disabled:!k||_.length<=1})]})}),We.jsx("div",{className:"mb-4 flex justify-end",children:We.jsxs(_h,{onClick:()=>{const t=(new Date).toISOString().split("T")[0],n=new Set(i.filter(e=>new Date(e.timestamp).toISOString().split("T")[0]===t).map(e=>e.employeeId)),a=T.filter(e=>e.consecutiveDaysMissed>0&&!n.has(e.user.id));0!==a.length?(g({isBulk:!0,employees:a.map(e=>e.user),onConfirm:async()=>{if(!e)return;const t=[];for(const n of a){const a=`You have missed your EOD report for ${n.consecutiveDaysMissed} consecutive working day(s). Please submit it ASAP.`,s=await S(n.user,a);n.consecutiveDaysMissed>=3&&en(n.user,e),s&&t.push(s)}t.length>0&&o(e=>[...t,...e].sort((e,t)=>t.timestamp-e.timestamp)),y({type:"success",message:`${a.length} reminder(s) sent successfully.`}),m(!1)}}),m(!0)):y({type:"info",message:"Reminders have already been sent to all applicable employees today."})},variant:"warning",icon:We.jsx("i",{className:"fas fa-paper-plane"}),disabled:0===D,children:["Send Reminder to All (",D,")"]})}),c?We.jsx(Ph,{message:"Loading consistency data..."}):We.jsx("div",{className:"overflow-x-auto",children:We.jsxs("table",{className:"min-w-full divide-y divide-border-primary dark:divide-dark-border",children:[We.jsx("thead",{className:"bg-surface-secondary dark:bg-dark-surface-secondary",children:We.jsxs("tr",{children:[We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase",children:"Employee"}),We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase",children:"Last Report"}),We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase",children:"Reports This Month"}),We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase",children:"Actions"})]})}),We.jsx("tbody",{className:"bg-surface-primary dark:bg-dark-surface-primary divide-y divide-border-primary dark:divide-dark-border",children:0===T.length?We.jsx("tr",{children:We.jsx("td",{colSpan:4,className:"text-center py-8 text-text-secondary dark:text-dark-text-secondary",children:"No employees match the current filters."})}):T.map(t=>{const n=(a=t.consecutiveDaysMissed)>=3?{base:"bg-red-100 dark:bg-red-900/50",text:"text-red-800 dark:text-red-300",label:`${a} Days Missed`,icon:""}:a>0?{base:"bg-amber-100 dark:bg-amber-900/50",text:"text-amber-800 dark:text-amber-300",label:`${a} Day${a>1?"s":""} Missed`,icon:""}:{base:"bg-emerald-100 dark:bg-emerald-900/50",text:"text-emerald-800 dark:text-emerald-300",label:"On Track",icon:""};var a;const s=I.has(t.user.id);return We.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/50",children:[We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-text-primary dark:text-dark-text",children:We.jsxs("div",{className:"flex items-center",children:[We.jsx(Uh,{name:t.user.name,size:"md",className:"mr-3"}),We.jsxs("div",{children:[We.jsx("div",{children:t.user.name}),We.jsx("div",{className:"text-xs text-text-secondary dark:text-dark-text-secondary",children:t.user.email})]})]})}),We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-text-secondary dark:text-dark-text-secondary",children:t.lastReportSubmittedOn?Wt(t.lastReportSubmittedOn):"Never"}),We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:We.jsxs("button",{onClick:()=>f(t.user),className:`px-3 py-1.5 text-xs font-semibold rounded-full flex items-center gap-2 ${n.base} ${n.text} hover:shadow-md transition-shadow`,children:[We.jsx("span",{children:n.icon}),We.jsx("span",{children:t.reportsThisMonth})]})}),We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:We.jsx(_h,{onClick:()=>(t=>{const n=`You have missed your EOD report for ${t.consecutiveDaysMissed} consecutive working day(s). Please submit it ASAP.`;g({employees:[t.user],isBulk:!1,onConfirm:async()=>{const a=await S(t.user,n);a&&o(e=>[a,...e].sort((e,t)=>t.timestamp-e.timestamp)),t.consecutiveDaysMissed>=3&&e&&en(t.user,e),y({type:"success",message:`Reminder sent to ${t.user.name}.`}),m(!1)}}),m(!0)})(t),size:"sm",variant:"secondary",disabled:s||0===t.consecutiveDaysMissed,title:s?"Reminder already sent today":0===t.consecutiveDaysMissed?"User is on track":"Send a reminder",children:s?"Sent Today":"Send Reminder"})})]},t.user.id)})})]})})]}),We.jsx(Lh,{isOpen:u,onClose:()=>m(!1),onConfirm:()=>{(null==h?void 0:h.onConfirm)&&h.onConfirm()},title:"Confirm Reminder",children:h&&We.jsxs("div",{children:[We.jsxs("p",{children:["Are you sure you want to send a reminder to ",h.isBulk?`${h.employees.length} employee(s)`:We.jsx("strong",{children:h.employees[0].name}),"?"]}),We.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"This will send them an in-app notification and log the action."})]})}),We.jsx(Eg,{isOpen:!!p,onClose:()=>f(null),user:p})]})},Cg=["January","February","March","April","May","June","July","August","September","October","November","December"].map((e,t)=>({value:t,label:e})),_g=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Tg=({reports:e,meetings:t,currentUser:n,allUsersForFilter:a,onReportUpdate:s,leaveRecords:r=[]})=>{const i=d(),{addToast:o}=bh(),[c,u]=l.useState(new Date),[m,p]=l.useState(null),[f,h]=l.useState({isOpen:!1,meeting:null,date:null}),[g,x]=l.useState(""),[y,b]=l.useState("all"),[v,N]=l.useState("all"),w=c.getFullYear(),k=c.getMonth(),E=l.useMemo(()=>{const e=(new Date).getFullYear();return Array.from({length:11},(t,n)=>({value:e-5+n,label:(e-5+n).toString()}))},[]),j=l.useMemo(()=>[{value:"",label:"All Employees"},...(null==a?void 0:a.filter(e=>"Employee"===e.roleName).map(e=>({value:e.id,label:e.name})))||[]],[a]),C=l.useMemo(()=>{let a=e,s=t.filter(e=>"live_memo"!==e.meetingType);if("Employee"===n.roleName?(a=e.filter(e=>e.employeeId===n.id),s=t.filter(e=>e.attendeeIds.includes(n.id)||e.createdBy===n.id)):g&&(a=e.filter(e=>e.employeeId===g),s=t.filter(e=>e.attendeeIds.includes(g)||e.createdBy===g)),"all"!==v){const e="pending"===v?"Pending Acknowledgment":"Acknowledged";a=a.filter(t=>t.status===e)}const r=new Map;"all"!==y&&"reports"!==y||a.forEach(e=>{const t=e.date;r.has(t)||r.set(t,[]),r.get(t).push(e)});const i=new Map;return"all"!==y&&"meetings"!==y||s.forEach(e=>{const t=((e,t,n)=>{var a;const s=[];if("live_memo"===e.meetingType)return[];const r=e.recurrenceRule&&"none"!==e.recurrenceRule,i=new Date(Date.UTC(t,n,1)),l=new Date(Date.UTC(t,n+1,0,23,59,59));if(!r){const t=new Date(e.meetingDateTime),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()));return n>=i&&n<=l&&s.push(e),s}let o=new Date(e.meetingDateTime),c=0;const d={hours:o.getHours(),minutes:o.getMinutes(),seconds:o.getSeconds(),ms:o.getMilliseconds()};for(;o<i;){if(e.recurrenceEndDate&&o.getTime()>e.recurrenceEndDate)return s;if(e.recurrenceCount&&c>=e.recurrenceCount)return s;switch(e.recurrenceRule){case"daily":o.setDate(o.getDate()+1);break;case"weekly":o.setDate(o.getDate()+7);break;case"monthly":o.setMonth(o.getMonth()+1);break;default:return s}c++}for(;o<=l&&!(e.recurrenceEndDate&&o.getTime()>e.recurrenceEndDate)&&!(e.recurrenceCount&&c>=e.recurrenceCount);){const t=Ht(o);if(!(null==(a=e.cancelledOccurrences)?void 0:a.includes(t))){const t=new Date(o);t.setHours(d.hours,d.minutes,d.seconds,d.ms),s.push({...e,meetingDateTime:t.getTime()})}switch(e.recurrenceRule){case"daily":o.setDate(o.getDate()+1);break;case"weekly":o.setDate(o.getDate()+7);break;case"monthly":o.setMonth(o.getMonth()+1)}c++}return s})(e,w,k);t.forEach(e=>{const t=Ht(new Date(e.meetingDateTime));i.has(t)||i.set(t,[]),i.get(t).push(e)})}),{reportsByDate:r,meetingsByDate:i}},[e,t,n,g,y,v,w,k]),_=(e,t)=>{const a=e.recurrenceRule&&"none"!==e.recurrenceRule;"Manager"===n.roleName&&a?h({isOpen:!0,meeting:e,date:t}):i(`/meetings/${e.id}`)};return We.jsxs("div",{className:"bg-surface-primary dark:bg-dark-surface-primary dark:border dark:border-dark-border p-4 sm:p-6 rounded-lg shadow-xl",children:[We.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6",children:We.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2 mb-4 sm:mb-0",children:[We.jsx("button",{onClick:()=>u(new Date(w,k-1,1)),"aria-label":"Previous month",className:"p-2 text-primary dark:text-sky-400 hover:bg-primary-light dark:hover:bg-dark-surface-hover rounded-full focus:outline-none focus:ring-2 focus:ring-primary transition-colors",children:We.jsx("i",{className:"fas fa-chevron-left"})}),We.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2",children:[We.jsx(Oh,{options:Cg,value:k,onChange:e=>u(new Date(w,parseInt(e.target.value),1)),wrapperClassName:"mb-0",className:"!w-auto !min-w-[120px] !mt-0 py-1.5 px-2 text-sm sm:text-base","aria-label":"Select month"}),We.jsx(Oh,{options:E,value:w,onChange:e=>u(new Date(parseInt(e.target.value),k,1)),wrapperClassName:"mb-0",className:"!w-auto !min-w-[90px] !mt-0 py-1.5 px-2 text-sm sm:text-base","aria-label":"Select year"})]}),We.jsx("button",{onClick:()=>u(new Date(w,k+1,1)),"aria-label":"Next month",className:"p-2 text-primary dark:text-sky-400 hover:bg-primary-light dark:hover:bg-dark-surface-hover rounded-full focus:outline-none focus:ring-2 focus:ring-primary transition-colors",children:We.jsx("i",{className:"fas fa-chevron-right"})}),We.jsx(_h,{onClick:()=>u(new Date),variant:"outline",size:"sm",className:"hover:!shadow-accent/30 hover:shadow-sm dark:hover:shadow-accent/40",children:"Today"})]})}),"Manager"===n.roleName&&We.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4 p-3 bg-surface-secondary dark:bg-dark-surface-secondary rounded-lg border dark:border-dark-border",children:[We.jsx(Oh,{label:"Filter by Type",options:[{value:"all",label:"All Events"},{value:"reports",label:"Reports Only"},{value:"meetings",label:"Meetings Only"}],value:y,onChange:e=>b(e.target.value),wrapperClassName:"!mb-0"}),We.jsx(Oh,{label:"Filter by Employee",options:j,value:g,onChange:e=>x(e.target.value),wrapperClassName:"!mb-0"}),We.jsx(Oh,{label:"Report Status",options:[{value:"all",label:"All Reports"},{value:"pending",label:"Pending"},{value:"acknowledged",label:"Acknowledged"}],value:v,onChange:e=>N(e.target.value),wrapperClassName:"!mb-0",disabled:"meetings"===y})]}),We.jsxs("div",{className:"grid grid-cols-7 gap-px border-t border-l border-border-primary dark:border-dark-border bg-border-primary dark:bg-dark-border",children:[_g.map(e=>We.jsx("div",{className:"text-center font-medium p-2 bg-surface-secondary dark:bg-dark-surface-secondary text-sm text-text-secondary dark:text-dark-text-secondary",children:e},e)),(()=>{const e=new Date(w,k+1,0).getDate(),t=new Date(w,k,1).getDay(),a=[],s=Ht(new Date);for(let n=0;n<t;n++)a.push(We.jsx("div",{className:"border-border-primary dark:border-dark-border bg-surface-secondary/50 dark:bg-dark-surface-secondary/50"},`empty-${n}`));for(let r=1;r<=e;r++){const e=`${w}-${String(k+1).padStart(2,"0")}-${String(r).padStart(2,"0")}`,t=C.reportsByDate.get(e)||[],i=C.meetingsByDate.get(e)||[],l=e===s;a.push(We.jsxs("div",{className:"border-border-primary dark:border-dark-border p-1 min-h-[8rem] flex flex-col relative "+(l?"bg-blue-50 dark:bg-sky-900/30":"bg-surface-primary dark:bg-dark-surface-primary"),children:[We.jsx("span",{className:"text-xs sm:text-sm font-semibold self-end "+(l?"text-primary dark:text-sky-400 font-bold":"text-text-primary dark:text-dark-text"),children:r}),We.jsxs("div",{className:"mt-1 space-y-1 overflow-y-auto flex-grow",children:[i.map(t=>We.jsx("button",{onClick:()=>_(t,new Date(e+"T12:00:00Z")),title:t.title,className:"block w-full text-left p-1.5 rounded-md text-xs font-medium border-l-4 bg-indigo-100 text-indigo-800 border-indigo-400 hover:bg-indigo-200 dark:bg-indigo-900/50 dark:text-indigo-200 dark:border-indigo-700 dark:hover:bg-indigo-900",children:We.jsxs("p",{className:"truncate flex items-center",children:[We.jsx("i",{className:"fas fa-users-crown mr-1.5"}),t.title]})},`${t.id}-${t.meetingDateTime}`)),We.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:t.map(e=>{const t="Acknowledged"===e.status;return We.jsxs("button",{onClick:()=>p(e),title:`${e.employeeName} - ${e.status}`,className:"w-auto px-2 py-0.5 rounded-full text-xs font-semibold flex items-center gap-1.5 transition-colors "+(t?"bg-emerald-100 text-emerald-800 hover:bg-emerald-200 dark:bg-emerald-900/50 dark:text-emerald-300 dark:hover:bg-emerald-900":"bg-amber-100 text-amber-800 hover:bg-amber-200 dark:bg-amber-900/50 dark:text-amber-300 dark:hover:bg-amber-900"),children:["Manager"===n.roleName&&We.jsx(Uh,{name:e.employeeName,size:"sm",className:"w-4 h-4 text-[10px]"}),We.jsx("span",{className:"hidden sm:inline",children:"Manager"===n.roleName?e.employeeName.split(" ")[0]:"Report"})]},e.id)})})]})]},r))}return a})()]}),m&&We.jsx(zh,{report:m,isOpen:!!m,onClose:()=>p(null),currentUser:n,onReportUpdate:e=>{s&&s(),p(e)}}),f.isOpen&&f.meeting&&We.jsx(Dh,{isOpen:f.isOpen,onClose:()=>h({isOpen:!1,meeting:null,date:null}),title:`Action for "${f.meeting.title}"`,size:"sm",children:We.jsxs("div",{className:"space-y-3",children:[We.jsxs("p",{className:"text-text-primary dark:text-dark-text",children:["What would you like to do for the meeting on ",We.jsx("strong",{children:f.date?Wt(f.date):""}),"?"]}),We.jsx(_h,{variant:"primary",className:"w-full",onClick:()=>{if(!f.meeting||!f.date)return;const e=Ht(f.date);h({isOpen:!1,meeting:null,date:null}),i(`/meetings/${f.meeting.id}?date=${e}`)},children:"View/Manage Workspace"}),We.jsx(_h,{variant:"warning",className:"w-full",onClick:async()=>{if(!f.meeting||!f.date||!n)return;const e=Ht(f.date);try{if(!(await fh(f.meeting.id,e,n))||!s)throw new Error("Failed to get updated meeting from data service.");o(`Meeting for ${Wt(e)} cancelled.`,"success"),s()}catch(t){o("Failed to cancel meeting.","error")}h({isOpen:!1,meeting:null,date:null})},children:"Cancel Only This Occurrence"}),We.jsx(_h,{variant:"danger",className:"w-full",onClick:async()=>{if(f.meeting&&n){try{const e=await(async(e,t)=>{const n=await tf.getById(e);if(!n)return null;const a={...n,recurrenceEndDate:(new Date).getTime(),updatedAt:Date.now(),updatedBy:t.id};return await tf.update(e,a),await Ef({timestamp:a.updatedAt,actorId:t.id,actorName:t.name,type:dt.MEETING_ENDED,description:`ended the recurring series for meeting: "${a.title}"`,targetId:a.id,targetName:a.title,isCrucial:!0}),a})(f.meeting.id,n);if(!e||!s)throw new Error("Failed to get updated meeting from data service.");o(`Recurring series for "${e.title}" has been stopped.`,"success"),s()}catch(e){o("Failed to stop recurring series.","error")}h({isOpen:!1,meeting:null,date:null})}},children:"Stop The Entire Recurring Series"})]})})]})},Sg=(e="")=>e.split(" ").map(e=>e[0]).join("").toUpperCase().substring(0,2),Ag=e=>{var t;return(null==(t=null==e?void 0:e.businessUnitName)?void 0:t.trim())?e.businessUnitName:"No BU"},Ig=({selectedIds:e,onSelectionChange:t,teamMembers:n})=>{const[a,s]=l.useState(""),[r,i]=l.useState(!1),[o,c]=l.useState(-1),d=l.useRef(null),u=l.useRef(null),m=n.filter(t=>e.includes(t.id)),p=n.filter(t=>!e.includes(t.id)&&t.name.toLowerCase().includes(a.toLowerCase()));l.useEffect(()=>{const e=e=>{d.current&&!d.current.contains(e.target)&&i(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),l.useEffect(()=>{r&&p.length>0?c(0):c(-1)},[a,r,p.length]);const f=n=>{var a;t([...e,n]),s(""),i(!1),null==(a=u.current)||a.focus()};return We.jsxs("div",{ref:d,className:"w-full",children:[We.jsx("label",{className:"block text-sm font-medium text-darktext dark:text-slate-300",children:"Attendees"}),We.jsxs("div",{className:"mt-1 relative border border-slate-300 dark:border-slate-600 rounded-lg p-2 min-h-[44px] flex flex-wrap gap-2 items-center bg-white dark:bg-slate-900/50",onClick:()=>{var e;i(!0),null==(e=u.current)||e.focus()},children:[m.map(n=>We.jsxs("span",{className:"flex items-center gap-1.5 bg-primary-light dark:bg-sky-500/20 text-primary dark:text-sky-300 text-sm font-medium pl-2 pr-1 py-1 rounded-full",children:[We.jsx("div",{className:"w-5 h-5 rounded-full bg-primary text-white text-xs flex items-center justify-center font-bold",children:Sg(n.name)}),We.jsxs("span",{className:"flex items-center gap-1 text-primary dark:text-sky-200",children:[n.name,We.jsxs("span",{className:"text-xs text-primary/80 dark:text-sky-300/80",children:["(",Ag(n),")"]})]}),We.jsx("button",{onClick:a=>{var s;a.stopPropagation(),s=n.id,t(e.filter(e=>e!==s))},className:"ml-1 w-4 h-4 rounded-full bg-primary/20 dark:bg-sky-500/30 text-primary/70 dark:text-sky-300/70 hover:bg-primary/40 dark:hover:bg-sky-500/50 hover:text-primary dark:hover:text-sky-200 flex items-center justify-center transition-colors","aria-label":`Remove ${n.name}`,children:We.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:We.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]},n.id)),We.jsx("input",{ref:u,type:"text",value:a,onChange:e=>{s(e.target.value),i(!0)},onFocus:()=>i(!0),onKeyDown:e=>{if(r)switch(e.key){case"ArrowDown":e.preventDefault(),c(e=>(e+1)%p.length);break;case"ArrowUp":e.preventDefault(),c(e=>(e-1+p.length)%p.length);break;case"Enter":e.preventDefault(),o>=0&&p[o]&&f(p[o].id);break;case"Escape":i(!1),c(-1)}},placeholder:e.length>0?"Add more...":"Search team members...",className:"flex-grow bg-transparent focus:outline-none text-sm text-darktext dark:text-slate-200 placeholder:text-slate-400"})]}),r&&We.jsx("div",{className:"absolute z-10 mt-1 w-full max-w-sm bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:p.length>0?We.jsx("ul",{children:p.map((e,t)=>We.jsx("li",{onClick:()=>f(e.id),className:"px-4 py-2 cursor-pointer text-sm text-darktext dark:text-slate-200 flex items-center justify-between "+(o===t?"bg-primary-light dark:bg-slate-700":"hover:bg-primary-light dark:hover:bg-slate-700"),children:We.jsxs("div",{className:"flex items-center",children:[We.jsx("div",{className:"w-6 h-6 mr-3 rounded-full bg-secondary text-white text-xs flex items-center justify-center font-bold",children:Sg(e.name)}),We.jsxs("div",{children:[We.jsxs("div",{className:"font-semibold",children:[e.name," ",We.jsxs("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:["(",Ag(e),")"]})]}),e.designation&&We.jsx("div",{className:"text-xs text-slate-400 dark:text-slate-500",children:e.designation})]})]})},e.id))}):We.jsx("p",{className:"px-4 py-2 text-sm text-slate-500 dark:text-slate-400",children:"No matching members found."})})]})},Dg=({task:e,attendees:t})=>{const n=e=>{var n;return(null==(n=t.find(t=>t.id===e))?void 0:n.name)||"Unknown"};return We.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800/50 rounded-lg border border-slate-200 dark:border-slate-700/50 shadow-sm",children:[We.jsx("p",{className:"font-semibold text-sm text-darktext dark:text-slate-200",children:e.title}),We.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-xs",children:[We.jsxs("span",{className:"flex items-center bg-slate-100 dark:bg-slate-700 px-2 py-1 rounded-full",children:[We.jsx("i",{className:"fas fa-calendar-alt mr-1.5 text-slate-500 dark:text-slate-400"}),Wt(e.dueDate)]}),We.jsxs("span",{className:"flex items-center bg-slate-100 dark:bg-slate-700 px-2 py-1 rounded-full",children:[We.jsx("i",{className:"fas fa-exclamation-circle mr-1.5 text-slate-500 dark:text-slate-400"}),e.priority]})]}),e.assigneeIds.length>0&&We.jsxs("div",{className:"mt-2 pt-2 border-t border-slate-200 dark:border-slate-700/50 flex items-center gap-2",children:[We.jsx("span",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"To:"}),We.jsx("div",{className:"flex flex-wrap gap-1",children:e.assigneeIds.map(e=>We.jsxs("div",{className:"flex items-center bg-primary-light text-primary-dark text-xs font-medium px-1.5 py-0.5 rounded-full",children:[We.jsx(Uh,{name:n(e),size:"sm",className:"w-4 h-4 text-[10px] mr-1"}),We.jsx("span",{children:n(e)})]},e))})]})]})},Og=/@\[([^\]]+)\]\(([^)]+)\)/g,Rg=({value:e,onChange:t,placeholder:n,rows:a=3,className:s="",wrapperClassName:r="",availableUsers:i=[],onKeyDown:o,disabled:c=!1})=>{const[d,u]=l.useState(!1),[m,p]=l.useState(""),[f,h]=l.useState(0),g=l.useRef(null),x=l.useRef(null),y=l.useRef(!1),b=e=>{const t=document.createElement("div");return t.textContent=e,t.innerHTML},v=e=>{let t="";const n=e=>{if(e.nodeType===Node.TEXT_NODE)t+=e.textContent||"";else if(e.nodeType===Node.ELEMENT_NODE){const a=e;if(a.classList&&a.classList.contains("mention-chip")){const e=a.getAttribute("data-mention-name")||"",n=a.getAttribute("data-mention-id")||"";t+=`@[${e}](${n})`}else if("BR"===a.tagName)t+="\n";else{if("DIV"===a.tagName&&t&&!t.endsWith("\n"))return t+="\n",void e.childNodes.forEach(n);e.childNodes.forEach(n)}}};return e.childNodes.forEach(n),t};l.useEffect(()=>{if(!g.current||y.current)return;if(v(g.current)!==e){const t=(()=>{const e=window.getSelection();if(!e||0===e.rangeCount)return null;const t=e.getRangeAt(0);return{node:t.startContainer,offset:t.startOffset}})(),n=(e=>{if(!e)return"";let t="",n=0;const a=new RegExp(Og.source,"g");let s;for(;null!==(s=a.exec(e));){const r=e.substring(n,s.index);t+=b(r);const i=s[1],l=s[2];t+=`<span class="mention-chip" data-mention-name="${b(i)}" data-mention-id="${b(l)}" contenteditable="false">@${b(i)}</span>`,n=a.lastIndex}return t+=b(e.substring(n)),t=t.replace(/\n/g,"<br>"),t})(e);g.current.innerHTML=n||"",t&&(e=>{var t,n;if(e&&e.node)try{const a=window.getSelection(),s=document.createRange();(null==(t=g.current)?void 0:t.contains(e.node))&&(s.setStart(e.node,Math.min(e.offset,(null==(n=e.node.textContent)?void 0:n.length)||0)),s.collapse(!0),null==a||a.removeAllRanges(),null==a||a.addRange(s))}catch(a){}})(t)}},[e]);const N=()=>{if(!g.current||y.current)return;const e=v(g.current);t(e),w()},w=()=>{if(0===i.length)return void u(!1);const e=window.getSelection();if(!e||0===e.rangeCount)return void u(!1);const t=e.getRangeAt(0),n=t.startContainer;if(n.nodeType===Node.TEXT_NODE&&n.textContent){const e=n.textContent.substring(0,t.startOffset).match(/@(\w*)$/);e?(u(!0),p(e[1].toLowerCase()),h(0)):u(!1)}else u(!1)},k=e=>{const n=window.getSelection();if(!n||0===n.rangeCount)return;const a=n.getRangeAt(0);if(!a.collapsed)return;let s=null;if(a.startContainer.nodeType===Node.TEXT_NODE&&0===a.startOffset)s=a.startContainer.previousSibling;else if(a.startContainer.nodeType===Node.ELEMENT_NODE){const e=a.startContainer.childNodes[a.startOffset-1];e&&(s=e)}if(s&&s.nodeType===Node.ELEMENT_NODE&&s.classList.contains("mention-chip")&&(e.preventDefault(),s.remove(),g.current)){const e=v(g.current);t(e)}},E=e=>{var n,a;if(!g.current)return;const s=window.getSelection();if(!s||0===s.rangeCount)return;const r=s.getRangeAt(0),i=r.startContainer;if(i.nodeType===Node.TEXT_NODE&&i.textContent){const l=i.textContent.substring(0,r.startOffset).match(/@\w*$/);if(l){const o=r.startOffset-l[0].length,c=i.textContent.substring(r.startOffset),d=document.createElement("span");d.className="mention-chip",d.setAttribute("data-mention-name",e.name),d.setAttribute("data-mention-id",e.id),d.setAttribute("contenteditable","false"),d.textContent=`@${e.name}`;const m=i.textContent.substring(0,o);i.textContent=m;const p=document.createTextNode(" "+c);null==(n=i.parentNode)||n.insertBefore(d,i.nextSibling),null==(a=i.parentNode)||a.insertBefore(p,d.nextSibling);const f=document.createRange();if(f.setStart(p,1),f.collapse(!0),s.removeAllRanges(),s.addRange(f),u(!1),g.current){const e=v(g.current);t(e)}}}},j=e=>{var t;return(null==(t=null==e?void 0:e.businessUnitName)?void 0:t.trim())?e.businessUnitName:"No BU"},C=i.filter(e=>e.name.toLowerCase().includes(m));l.useEffect(()=>{const e=e=>{x.current&&!x.current.contains(e.target)&&g.current&&!g.current.contains(e.target)&&u(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const _=a?{minHeight:1.5*a+"rem"}:{};return We.jsxs("div",{className:`relative ${r}`,children:[We.jsx("div",{ref:g,contentEditable:!c,onInput:N,onKeyDown:e=>{d&&C.length>0?"ArrowDown"===e.key?(e.preventDefault(),h(e=>e<C.length-1?e+1:e)):"ArrowUp"===e.key?(e.preventDefault(),h(e=>e>0?e-1:0)):"Enter"===e.key||"Tab"===e.key?(e.preventDefault(),E(C[f])):"Escape"===e.key&&u(!1):"Backspace"===e.key?k(e):"Enter"!==e.key||e.shiftKey||d&&e.preventDefault(),null==o||o(e)},onCompositionStart:()=>{y.current=!0},onCompositionEnd:()=>{y.current=!1,N()},className:`w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 focus:outline-none disabled:bg-gray-100 dark:disabled:bg-gray-700 disabled:cursor-not-allowed overflow-y-auto ${s}`,style:_,"data-placeholder":n,suppressContentEditableWarning:!0}),d&&C.length>0&&We.jsx("div",{ref:x,className:"absolute z-50 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-xl max-h-48 overflow-y-auto",children:C.map((e,t)=>We.jsxs("div",{onMouseDown:t=>{t.preventDefault(),E(e)},className:"px-3 py-2 cursor-pointer transition-colors "+(t===f?"bg-indigo-600 text-white":"hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-900 dark:text-gray-100"),children:[We.jsxs("div",{className:"font-medium",children:[e.name," ",We.jsxs("span",{className:"text-xs font-normal opacity-80",children:["(",j(e),")"]})]}),We.jsx("div",{className:"text-xs "+(t===f?"text-indigo-200":"text-gray-500 dark:text-gray-400"),children:e.email})]},e.id))}),We.jsx("style",{children:"\n        [contenteditable][data-placeholder]:empty:before {\n          content: attr(data-placeholder);\n          color: #9CA3AF;\n          pointer-events: none;\n          position: absolute;\n        }\n        .dark [contenteditable][data-placeholder]:empty:before {\n          color: #6B7280;\n        }\n        .mention-chip {\n          display: inline-flex;\n          align-items: center;\n          padding: 0.125rem 0.5rem;\n          border-radius: 9999px;\n          font-size: 0.875rem;\n          background-color: #E0E7FF;\n          color: #3730A3;\n          cursor: default;\n          user-select: none;\n        }\n        .dark .mention-chip {\n          background-color: #312E81;\n          color: #C7D2FE;\n        }\n      "})]})},Pg=({isOpen:e,onClose:t,manager:n,teamMembers:a,onSuccess:s})=>{const{addToast:r}=bh(),[i,o]=l.useState("details"),[c,d]=l.useState(""),[u,m]=l.useState([]),[p,f]=l.useState(""),[h,g]=l.useState([]),x=l.useCallback(()=>{o("details"),d(""),m([]),f(""),g([])},[]);l.useEffect(()=>{e&&x()},[e,x]);const y=l.useMemo(()=>a.filter(e=>e.status===et.ACTIVE),[a]),b=l.useMemo(()=>y.filter(e=>u.includes(e.id)),[y,u]);l.useEffect(()=>{try{const e=cn(p,0,u);g(e)}catch(e){}},[p,b,u]);return We.jsxs("div",{className:"fixed inset-0 z-40 flex justify-end transition-all duration-300 "+(e?"":"pointer-events-none"),children:[We.jsx("div",{className:"absolute inset-0 bg-black/40 transition-opacity "+(e?"opacity-100":"opacity-0"),onClick:t}),We.jsxs("div",{className:"relative w-full max-w-4xl h-full bg-slate-100 dark:bg-slate-950 shadow-2xl flex flex-col transform transition-transform duration-300 ease-in-out "+(e?"translate-x-0":"translate-x-full"),children:[We.jsxs("header",{className:"p-4 border-b border-slate-200 dark:border-slate-800 flex-shrink-0 flex items-center justify-between",children:[We.jsxs("h2",{className:"text-xl font-semibold text-darktext dark:text-slate-200 flex items-center",children:[We.jsx("i",{className:"fas fa-bolt mr-3 text-amber-500"})," Live Action Memo"]}),We.jsx(_h,{variant:"ghost",size:"sm",onClick:t,icon:We.jsx("i",{className:"fas fa-times"})})]}),We.jsxs("main",{className:"flex-grow overflow-y-auto p-4 md:p-6",children:["finalizing"===i&&We.jsx(Ph,{message:"Finalizing memo and assigning tasks..."}),"details"===i&&We.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[We.jsxs("div",{className:"space-y-4",children:[We.jsx(Ch,{label:"Memo Title",placeholder:"E.g., Q3 Project Kickoff",value:c,onChange:e=>d(e.target.value),required:!0}),We.jsx(Ig,{selectedIds:u,onSelectionChange:m,teamMembers:y}),We.jsx(Rg,{value:p,onChange:f,placeholder:"Type notes... Use / or /task to create a task. E.g., / Finalize slides due:tomorrow @Priya",rows:10,wrapperClassName:"!mb-0",availableUsers:b})]}),We.jsx("div",{className:"space-y-4",children:We.jsxs("div",{className:"p-3 bg-white dark:bg-slate-900 rounded-lg shadow-sm border border-slate-200 dark:border-slate-800",children:[We.jsxs("h4",{className:"font-semibold text-primary dark:text-sky-400 mb-2",children:[We.jsx("i",{className:"fas fa-tasks mr-2"})," Action Items Preview"]}),h.length>0?We.jsx("div",{className:"space-y-2 max-h-[60vh] overflow-y-auto",children:h.map((e,t)=>We.jsx(Dg,{task:e,attendees:b},t))}):We.jsx("p",{className:"text-sm text-slate-500 italic text-center py-4",children:'No tasks detected. Start a line with "/" to create one.'})]})})]})]}),We.jsx("footer",{className:"p-4 border-t border-slate-200 dark:border-slate-800 flex-shrink-0 flex items-center justify-end bg-slate-50 dark:bg-slate-800/50",children:We.jsxs("div",{className:"flex items-center space-x-3",children:[We.jsx(_h,{variant:"ghost",onClick:t,children:"Cancel"}),We.jsxs(_h,{variant:"primary",size:"lg",onClick:async()=>{if(c.trim())if(0!==u.length){o("finalizing");try{const e=await(async e=>{const{title:t,notes:n,attendeeIds:a,creator:s}=e,r=Up(),i=new Date,l=cm("meet"),o={id:l,title:t,meetingDateTime:i.getTime(),attendeeIds:a,createdBy:s.id,createdAt:i.getTime(),updatedAt:i.getTime(),meetingType:"live_memo",seenBy:[s.id],tenantId:r};await tf.create(l,o);const c=cn(n,e.attendees,a),d=[];for(const p of c){const e=await Ff({title:p.title,description:p.description||"",dueDate:p.dueDate,priority:p.priority,assignedTo:p.assigneeIds,createdBy:s.id,taskType:p.assigneeIds.length>1?st.Team:st.Direct,isPersonalTask:!1,meetingId:o.id,status:at.NotStarted},s);d.push(e.id)}const u=cm("inst"),m={id:u,seriesId:o.id,occurrenceDate:Ht(i),meetingMinutes:n,taskIds:d,finalizedAt:i.getTime(),tenantId:r};return await tf.createInstance(u,m),o})({title:c,notes:p,attendeeIds:u,creator:n,attendees:b});r("Live memo finalized and tasks assigned!","success"),s(e),t()}catch(e){r(`Failed to finalize memo: ${e.message}`,"error"),o("details")}}else r("Please select at least one attendee.","error");else r("Please enter a title for this memo.","error")},disabled:"details"!==i,children:[We.jsx("i",{className:"fas fa-check-circle mr-2"})," Finalize Memo & Assign Tasks"]})]})})]})]})},Mg=({isOpen:e,onClose:t,onSelect:n})=>We.jsx(Dh,{isOpen:e,onClose:t,title:"Choose Meeting Type",size:"md",children:We.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[We.jsxs("button",{onClick:()=>n("live"),className:"group flex flex-col items-center justify-center p-6 bg-slate-50 dark:bg-slate-800/50 rounded-lg border-2 border-dashed border-slate-300 dark:border-slate-600 hover:border-primary hover:bg-primary-light dark:hover:bg-sky-900/40 dark:hover:border-sky-500 transition-all duration-200",children:[We.jsx("i",{className:"fas fa-bolt text-4xl text-primary dark:text-sky-400 mb-3 group-hover:scale-110 transition-transform"}),We.jsx("h3",{className:"font-semibold text-lg text-darktext dark:text-slate-200",children:"Start Live Memo"}),We.jsx("p",{className:"text-sm text-mediumtext dark:text-slate-400 text-center mt-1",children:"For spontaneous, in-person meetings. Quickly capture notes and delegate tasks."})]}),We.jsxs("button",{onClick:()=>n("formal"),className:"group flex flex-col items-center justify-center p-6 bg-slate-50 dark:bg-slate-800/50 rounded-lg border-2 border-dashed border-slate-300 dark:border-slate-600 hover:border-secondary hover:bg-indigo-50 dark:hover:bg-indigo-900/40 dark:hover:border-indigo-500 transition-all duration-200",children:[We.jsx("i",{className:"fas fa-calendar-alt text-4xl text-secondary dark:text-indigo-400 mb-3 group-hover:scale-110 transition-transform"}),We.jsx("h3",{className:"font-semibold text-lg text-darktext dark:text-slate-200",children:"Schedule Formal Meeting"}),We.jsx("p",{className:"text-sm text-mediumtext dark:text-slate-400 text-center mt-1",children:"For planned events with agendas, attachments, and recurring options."})]})]})}),Ug=l.createContext(void 0),Lg=({children:e})=>{const[t,n]=l.useState(!1),[a,s]=l.useState(!1),[r,i]=l.useState(null),[o,c]=l.useState(null);return l.useEffect(()=>{let e=!0,t=0;const a=async()=>{if(e)try{await new Promise((e,t)=>{if("undefined"==typeof gapi)return t(new Error("GAPI script not loaded."));gapi.load("client",()=>{gapi.client.init({}).then(()=>{gapi.client.load("calendar","v3",()=>{e()})}).catch(e=>{t(e)})})}),await new Promise((e,t)=>{if("undefined"==typeof google)return t(new Error("GIS script not loaded."));try{Ud=google.accounts.oauth2.initTokenClient({client_id:"790117665889-8mfsqenv4lcimef1728ikoj5pi1lrvi1.apps.googleusercontent.com",scope:"https://www.googleapis.com/auth/calendar.events",callback:e=>{e&&e.access_token?(gapi.client.setToken(e),Ld&&Ld(!0)):Ld&&Ld(!1)},error_callback:e=>{Ld&&Ld(!1)}}),e()}catch(n){t(n)}}),e&&s(!0)}catch(t){e&&c("Could not connect to Google services. Please check your internet connection and disable any ad-blockers or browser extensions that might interfere with scripts from google.com. Refresh the page to try again.")}},r=()=>{"undefined"!=typeof gapi&&"undefined"!=typeof google?a():t<20?(t++,setTimeout(r,500)):e&&c("Google scripts failed to load. Please check your network connection.")};return r(),Ld=async t=>{if(e)if(n(t),t)try{const e=await(null===gapi.client.getToken()?Promise.reject("User not signed in."):gapi.client.request({path:"https://www.googleapis.com/oauth2/v3/userinfo"}));e&&e.result&&i({name:e.result.name,email:e.result.email,picture:e.result.picture})}catch(a){i(null)}else i(null)},()=>{e=!1}},[]),We.jsx(Ug.Provider,{value:{isSignedIn:t,isGapiReady:a,googleUser:r,signIn:Fd,signOut:Bd,createEvent:$d,initializationError:o},children:e})},Fg=()=>{const e=l.useContext(Ug);if(void 0===e)throw new Error("useGoogleCalendar must be used within a GoogleCalendarProvider");return e},{Link:Bg}=m,$g=({manager:e,teamMembers:t,onSuccess:n,onCancel:a,meetingToEdit:s})=>{const{addToast:r}=bh(),{isSignedIn:i,createEvent:o}=Fg(),[c,d]=l.useState("internal"),[u,m]=l.useState(""),[p,f]=l.useState(""),[h,g]=l.useState([]),[x,y]=l.useState(""),[b,v]=l.useState(""),[N,w]=l.useState([]),[k,E]=l.useState("none"),[j,C]=l.useState("never"),[_,T]=l.useState(""),[S,A]=l.useState(1),[I,D]=l.useState(!1),[O,R]=l.useState(!1),[P,M]=l.useState(""),U=!!s;l.useEffect(()=>{if(U&&s){m(s.title);const e=new Date(s.meetingDateTime),t=`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}T${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`;f(t),g(s.attendeeIds),y((s.externalGuests||[]).join(", ")),d(s.externalGuests&&s.externalGuests.length>0?"external":"internal"),v(s.agenda||""),w(s.attachments||[]),E(s.recurrenceRule||"none")}},[s,U]);const L=l.useMemo(()=>t.filter(e=>e.status===et.ACTIVE),[t]),F=({isActive:e,onClick:t,icon:n,children:a})=>We.jsxs("button",{type:"button",onClick:t,className:"flex-1 p-3 text-sm font-semibold flex items-center justify-center gap-2 rounded-t-lg transition-colors "+(e?"bg-white dark:bg-slate-800 text-primary dark:text-sky-400 border-b-2 border-primary dark:border-sky-400":"bg-slate-100 dark:bg-slate-900 text-slate-500 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-700"),children:[We.jsx("i",{className:`fas ${n}`})," ",a]});return We.jsxs("div",{className:"space-y-4",children:[We.jsxs("div",{className:"flex",children:[We.jsx(F,{isActive:"internal"===c,onClick:()=>d("internal"),icon:"fa-building",children:"Internal Team"}),We.jsx(F,{isActive:"external"===c,onClick:()=>d("external"),icon:"fa-globe-americas",children:"External Guests"})]}),We.jsxs("div",{className:"p-4 border border-t-0 rounded-b-lg dark:border-slate-700 bg-white dark:bg-slate-800",children:[We.jsx(Ch,{label:"Meeting Title",placeholder:"E.g., Weekly Team Sync",value:u,onChange:e=>m(e.target.value),required:!0}),We.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[We.jsx(Ch,{label:"Date & Time",type:"datetime-local",value:p,onChange:e=>(e=>{f(e);const t=new Date(e).getTime(),n=(new Date).getTime()+12e4;M(t<n?"Meeting must be scheduled at least 2 minutes in the future.":"")})(e.target.value),required:!0,error:P}),We.jsx(Oh,{label:"Recurrence",options:[{value:"none",label:"Does not repeat"},{value:"daily",label:"Daily"},{value:"weekly",label:"Weekly"},{value:"monthly",label:"Monthly"}],value:k,onChange:e=>E(e.target.value),disabled:U})]}),"none"!==k&&!U&&We.jsxs("div",{className:"p-3 my-2 bg-slate-50 dark:bg-slate-700/50 rounded-lg border dark:border-slate-200 dark:border-slate-600",children:[We.jsx("label",{className:"block text-sm font-medium text-darktext dark:text-slate-300 mb-2",children:"End Recurrence"}),We.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[We.jsxs("div",{className:"flex items-center",children:[We.jsx("input",{type:"radio",id:"end_never",name:"recurEnd",value:"never",checked:"never"===j,onChange:()=>C("never"),className:"h-4 w-4"}),We.jsx("label",{htmlFor:"end_never",className:"ml-2 text-sm",children:"Never"})]}),We.jsxs("div",{className:"flex items-center",children:[We.jsx("input",{type:"radio",id:"end_on",name:"recurEnd",value:"on",checked:"on"===j,onChange:()=>C("on"),className:"h-4 w-4"}),We.jsx("label",{htmlFor:"end_on",className:"ml-2 text-sm",children:"On date"})]}),We.jsxs("div",{className:"flex items-center",children:[We.jsx("input",{type:"radio",id:"end_after",name:"recurEnd",value:"after",checked:"after"===j,onChange:()=>C("after"),className:"h-4 w-4"}),We.jsx("label",{htmlFor:"end_after",className:"ml-2 text-sm",children:"After"})]})]}),"on"===j&&We.jsx(Ch,{type:"date",value:_,onChange:e=>T(e.target.value),wrapperClassName:"mt-2",min:Ht(new Date)}),"after"===j&&We.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[We.jsx(Ch,{type:"number",value:S,onChange:e=>A(Number(e.target.value)),min:"1",wrapperClassName:"w-24 !mb-0"}),We.jsx("span",{className:"text-sm",children:"occurrences"})]})]}),U&&We.jsx("p",{className:"text-xs text-slate-500 -mt-2",children:"Recurrence rules cannot be changed after a meeting is created."}),"internal"===c?We.jsx(Ig,{selectedIds:h,onSelectionChange:g,teamMembers:L}):We.jsx(Yh,{label:"Invite External Guests by Email",placeholder:"Enter email addresses, separated by commas...",value:x,onChange:e=>y(e.target.value),rows:2}),We.jsx(Yh,{label:"Agenda (Optional)",placeholder:"- Opening remarks\n- Review of last week's action items\n- Project updates...",value:b,onChange:e=>v(e.target.value),rows:6}),We.jsx("div",{className:"mt-2 p-3 rounded-md bg-slate-100 dark:bg-slate-700/50",children:i?We.jsxs("div",{className:"flex items-center space-x-2",children:[We.jsx("input",{type:"checkbox",id:"sync-calendar",checked:I,onChange:e=>D(e.target.checked),className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary",disabled:U}),We.jsxs("label",{htmlFor:"sync-calendar",className:"text-sm text-slate-600 dark:text-slate-300 "+(U?"opacity-50":""),children:[We.jsx("i",{className:"fas fa-calendar-plus mr-2 text-primary dark:text-sky-400"}),"Sync with Google Calendar ",U&&"(only available for new meetings)"]})]}):We.jsxs("div",{className:"flex items-center space-x-2",children:[We.jsx("input",{type:"checkbox",id:"sync-calendar-disabled",disabled:!0,className:"h-4 w-4 rounded border-gray-300"}),We.jsxs("label",{htmlFor:"sync-calendar-disabled",className:"text-sm text-slate-500 dark:text-slate-400",children:[We.jsx("i",{className:"fas fa-calendar-plus mr-2"}),"Connect your account in ",We.jsx(Bg,{to:"/integrations",className:"text-primary hover:underline",children:"Integrations"})," to sync with Google Calendar."]})]})})]}),We.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[We.jsx(_h,{variant:"ghost",onClick:a,children:"Cancel"}),We.jsx(_h,{variant:"primary",onClick:async()=>{var t,a,l;const d=x.split(",").map(e=>e.trim()).filter(e=>e&&e.includes("@")),m="external"===c;if(u.trim()&&p)if(m&&0===d.length)r("Please enter at least one valid external guest email.","error");else if(m||0!==h.length)if(P)r(P,"error");else{R(!0);try{let c;if(I&&i&&!U){const n=await Cf(),s=m?d.map(e=>({email:e})):n.filter(e=>h.includes(e.id)).map(e=>({email:e.notificationEmail})),i=n.find(t=>t.id===e.id);i&&i.notificationEmail&&s.push({email:i.notificationEmail});const g=`${window.location.origin}/#/meetings/TEMP_ID`,x=`MEETING AGENDA\n-----------------------------------\n${b||"No agenda provided."}\n\n-----------------------------------\n View this meeting in Syncly: ${g}`,y=Intl.DateTimeFormat().resolvedOptions().timeZone,v={summary:u,description:x,start:{dateTime:new Date(p).toISOString(),timeZone:y},end:{dateTime:new Date(new Date(p).getTime()+36e5).toISOString(),timeZone:y},attendees:s};if("none"!==k){let e=`RRULE:FREQ=${k.toUpperCase()}`;if("on"===j&&_){const t=new Date(_);t.setUTCHours(23,59,59,999);e+=`;UNTIL=${(t.toISOString().split(".")[0]+"Z").replace(/[-:]/g,"")}`}else"after"===j&&S>0&&(e+=`;COUNT=${S}`);v.recurrence=[e]}try{const e=await o(v);c=null==(t=null==e?void 0:e.result)?void 0:t.id,c&&r("Event created in Google Calendar!","info")}catch(f){const e=(null==(l=null==(a=null==f?void 0:f.result)?void 0:a.error)?void 0:l.message)||(null==f?void 0:f.message)||"An unknown error occurred.";r(`Could not sync to Google Calendar: ${e}`,"error")}}if(U&&s){const t={title:u,meetingDateTime:new Date(p).getTime(),attendeeIds:m?[]:h,externalGuests:m?d:[],agenda:b,attachments:N},a=await(async(e,t,n)=>{const a=await tf.getById(e);if(!a)return null;const s={...a,...t,updatedAt:Date.now(),updatedBy:n.id};return await tf.update(e,s),s})(s.id,t,e);r("Meeting updated successfully!","success"),n(a)}else{const t={title:u,meetingDateTime:new Date(p).getTime(),attendeeIds:m?[]:h,externalGuests:m?d:[],agenda:b,attachments:N,recurrenceRule:k,createdBy:e.id};"on"===j&&_&&(t.recurrenceEndDate=new Date(_).getTime()),"after"===j&&S>0&&(t.recurrenceCount=S),c&&(t.googleEventId=c);const a=await(async(e,t)=>{const n=Up(),a=cm("meet"),s=Date.now(),r={...e,id:a,createdAt:s,updatedAt:s,updatedBy:t.id,meetingType:"formal_meeting",seenBy:[t.id],tenantId:n};if(await tf.create(a,r),e.attendeeIds&&e.attendeeIds.length>0){new Date(e.meetingDateTime);const n=qt(e.meetingDateTime);for(const s of e.attendeeIds)s!==t.id&&await Xf({userId:s,message:`${t.name} scheduled you for a meeting: "${e.title}" on ${n}`,type:"info",isCrucial:!0,link:`/meetings/${a}`,actionType:"MEETING_SCHEDULED",targetId:a,actors:[{id:t.id,name:t.name}]})}return await Ef({timestamp:s,actorId:t.id,actorName:t.name,type:dt.MEETING_SCHEDULED,description:"scheduled a meeting",targetId:a,targetName:e.title}),r})(t,e);if(c){const e=`${window.location.origin}/#/meetings/${a.id}`,t=`MEETING AGENDA\n-----------------------------------\n${b||"No agenda provided."}\n\n-----------------------------------\n View this meeting in Syncly: ${e}`;await Gd(c,{description:t})}r("Formal meeting scheduled successfully!","success"),n(a)}}catch(g){r(`Failed to ${U?"update":"schedule"} meeting: ${g.message}`,"error")}finally{R(!1)}}else r("Please select at least one internal attendee.","error");else r("Title and Date/Time are required.","error")},isLoading:O,disabled:!!P,children:U?"Update Meeting":"Schedule Meeting"})]})]})},Gg=()=>{const{currentUser:e}=Eh(),{addToast:t}=bh(),[n,a]=l.useState([]),[s,r]=l.useState([]),[i,o]=l.useState([]),[c,d]=l.useState([]),[u,m]=l.useState(!0),[p,f]=l.useState(""),[h,g]=l.useState(""),[x,y]=l.useState(""),[b,v]=l.useState(!1),[N,w]=l.useState(""),[k,E]=l.useState(""),[j,C]=l.useState("");l.useEffect(()=>{(async()=>{if(!e)return;m(!0);const[t,n,s,i]=await Promise.all([Cf(),Df(),Lf(),zf()]);a(t),r(n),o(s),d(i),m(!1)})()},[e]);const _="HR"===(null==e?void 0:e.roleName)||"Director"===(null==e?void 0:e.roleName)||"Super Admin"===(null==e?void 0:e.roleName)||(null==e?void 0:e.isPlatformAdmin),T=l.useMemo(()=>n.filter(t=>"Employee"===t.roleName&&t.status===et.ACTIVE&&(_||(null==e?void 0:e.businessUnitId)&&t.businessUnitId===e.businessUnitId)).map(e=>({value:e.id,label:`${e.name}${e.businessUnitName?`  ${e.businessUnitName}`:""}`})),[n,e,_]);return u?We.jsx(Ph,{message:"Loading performance data..."}):We.jsxs("div",{className:"space-y-6",children:[We.jsxs(Ih,{title:"Generate Performance Summary",titleIcon:We.jsx("i",{className:"fas fa-user-chart"}),children:[We.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 items-end",children:[We.jsx(Oh,{label:"Select Employee",options:T,value:p,onChange:e=>f(e.target.value),placeholder:"Choose an employee..."}),We.jsx(Ch,{label:"Start Date",type:"date",value:h,onChange:e=>g(e.target.value),max:x||void 0}),We.jsx(Ch,{label:"End Date",type:"date",value:x,onChange:e=>y(e.target.value),min:h||void 0})]}),We.jsx("div",{className:"mt-4 flex justify-end",children:We.jsx(_h,{onClick:async()=>{if(!p||!h||!x)return void t("Please select an employee and a date range.","error");if(new Date(h)>new Date(x))return void t("Start date cannot be after end date.","error");v(!0),E(""),w("");const e=n.find(e=>e.id===p);if(!e)return E("Selected employee not found."),void v(!1);C(e.name);const a=s.filter(e=>e.employeeId===p&&e.date>=h&&e.date<=x),r=i.filter(e=>e.assignedTo.includes(p)&&e.status===at.Completed&&e.dueDate>=h&&e.dueDate<=x);if(0===a.length&&0===r.length)return E(`No EOD reports or completed tasks found for ${e.name} in the selected period.`),void v(!1);try{const t=await(async(e,t,n,a,s)=>{const r=bf();if(!r)throw new Error(xf);try{const i=new Md({apiKey:r}),l=t.map(e=>({date:e.date,isLate:e.isLate,tasksCompleted:e.versions[e.versions.length-1].tasksCompleted,challengesFaced:e.versions[e.versions.length-1].challengesFaced})),o=n.map(e=>({title:e.title,priority:e.priority,status:e.status,dueDate:e.dueDate})),c=`\n      Generate a concise performance review summary for the employee "${e.name}" for the period from ${s.startDate} to ${s.endDate}.\n      Use the provided data. The output should be professional, well-structured markdown.\n\n      Employee Details:\n      - Name: ${e.name}\n      - Designation: ${e.designation}\n\n      Data:\n      - Total EOD Reports Submitted in Period: ${t.length}\n      - Reports Marked as Late: ${t.filter(e=>e.isLate).length}\n      - Total Completed Tasks in Period: ${n.length}\n      - Total Leave Days in Period: ${a.length}\n\n      EOD Report Details:\n      ${JSON.stringify(l,null,2)}\n\n      Completed Task Details:\n      ${JSON.stringify(o,null,2)}\n\n      Instructions:\n      1.  **Overall Summary:** Start with a brief paragraph summarizing the employee's performance, mentioning consistency, task management, and any standout achievements or areas for improvement.\n      2.  **Reporting Consistency:** Analyze their EOD reporting habits. Mention their consistency, punctuality (late reports), and the quality of their reports if discernible from the tasks completed and challenges.\n      3.  **Task Management:** Evaluate their task completion. Mention the volume and priority of tasks handled.\n      4.  **Key Achievements:** Based on the "Tasks Completed" in reports and the list of completed tasks, identify and list 2-3 key achievements as bullet points.\n      5.  **Areas for Improvement:** Based on "Challenges Faced" in reports or patterns of late submissions/overdue tasks, identify 1-2 constructive areas for improvement as bullet points.\n      6.  **Attendance:** Briefly mention their attendance based on the number of leaves taken.\n    `;return(await i.models.generateContent({model:"gemini-2.5-flash",contents:c})).text}catch(k){throw kf(k)}})(e,a,r,c,{startDate:h,endDate:x});w(t)}catch(l){E(l.message||"An unknown error occurred while generating the summary.")}finally{v(!1)}},isLoading:b,disabled:!p||!h||!x,size:"lg",children:"Generate AI Summary"})})]}),(b||k||N)&&We.jsxs(Ih,{title:N?`Summary for ${j}`:"AI Analysis",actions:N&&We.jsx(_h,{variant:"ghost",size:"sm",onClick:()=>{N&&navigator.clipboard.writeText(N).then(()=>t("Summary copied!","success")).catch(()=>t("Failed to copy text.","error"))},icon:We.jsx("i",{className:"fas fa-copy"}),children:"Copy"}),children:[b&&We.jsx(Ph,{message:"Analyzing performance data..."}),k&&We.jsx(Th,{type:"error",message:k}),N&&We.jsx("div",{className:"prose prose-sm max-w-none dark:prose-invert whitespace-pre-wrap max-h-[60vh] overflow-y-auto",children:N})]})]})},Vg=({teamMembers:e,allReports:t,allTasks:n,allLeaveRecords:a})=>{const{addToast:s}=bh(),[r,i]=l.useState(""),[o,d]=l.useState("7"),[u,m]=l.useState(!1),[p,f]=l.useState(""),[h,g]=l.useState(null),[x,y]=l.useState(vf()),b=l.useMemo(()=>e.map(e=>({value:e.id,label:e.name})),[e]),v=l.useCallback(()=>{const e=new Date,t=new Date;return t.setDate(e.getDate()-parseInt(o,10)),{startDate:Ht(t),endDate:Ht(e)}},[o]),N=l.useCallback(async()=>{if(!r)return;const i=e.find(e=>e.id===r);if(i){m(!0),f(""),g(null);try{const e=v(),s=t.filter(t=>t.employeeId===r&&t.date>=e.startDate&&t.date<=e.endDate),l=n.filter(t=>t.assignedTo.includes(r)&&t.status===at.Completed&&t.dueDate>=e.startDate&&t.dueDate<=e.endDate),o=a.filter(t=>t.employeeId===r&&t.date>=e.startDate&&t.date<=e.endDate),c=await(async(e,t,n,a,s)=>{const r=bf();if(!r)throw new Error(xf);try{const i=new Md({apiKey:r}),l=`\n      Analyze the following performance data for employee "${e.name}" from ${s.startDate} to ${s.endDate} and provide a very concise, 2-3 bullet point snapshot for a manager's dashboard.\n      Focus on key metrics and actionable insights.\n\n      Data:\n      - EOD Reports Submitted: ${t.length}\n      - Late Reports: ${t.filter(e=>e.isLate).length}\n      - Completed Tasks: ${n.length}\n      - High Priority Tasks Completed: ${n.filter(e=>e.priority===nt.High).length}\n      - Days on Leave: ${a.length}\n      - Key tasks completed titles: ${n.map(e=>e.title).slice(0,5).join(", ")}\n\n      Example Output Format:\n      - **Reporting:** Submitted 18/20 reports, with 2 late. Good consistency.\n      - **Task Output:** Completed 15 tasks, including 5 high-priority. Key accomplishment was closing the "Project X" deal.\n      - **Attendance:** Took 1 day of planned leave. Reliable attendance.\n    `;return(await i.models.generateContent({model:"gemini-2.5-flash",contents:l})).text}catch(p){throw kf(p)}})(i,s,l,o,e);g(c)}catch(l){const e=l.message||"Failed to generate snapshot.";f(e),s(e,"error")}finally{m(!1)}}},[r,o,e,t,n,a,s,v]);return l.useEffect(()=>{r&&x?N():g(null)},[r,o,N,x]),We.jsxs(Ih,{title:" Performance Snapshot",titleIcon:We.jsx("i",{className:"fas fa-bolt"}),className:"h-full flex flex-col",children:[We.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-4",children:[We.jsx(Oh,{label:"Select Employee",options:b,value:r,onChange:e=>i(e.target.value),placeholder:"Choose employee...",wrapperClassName:"flex-grow"}),We.jsx(Oh,{label:"Period",options:[{value:"7",label:"Last 7 Days"},{value:"30",label:"Last 30 Days"},{value:"90",label:"Last 90 Days (Quarter)"}],value:o,onChange:e=>d(e.target.value),wrapperClassName:"sm:w-48"})]}),We.jsx("div",{className:"flex-grow flex flex-col justify-center",children:x?r?u?We.jsx(Ph,{message:"Generating snapshot..."}):p?We.jsx(Th,{type:"error",message:p}):h?We.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none whitespace-pre-wrap p-3 bg-slate-50 dark:bg-slate-800/50 rounded-md",children:h}):We.jsx("div",{className:"text-center text-slate-500 dark:text-slate-400 py-8",children:We.jsx("p",{children:"No performance data available for the selected period."})}):We.jsx("div",{className:"text-center text-slate-500 dark:text-slate-400 py-8",children:We.jsx("p",{children:"Select an employee to view their performance snapshot."})}):We.jsx(Th,{type:"warning",children:"AI features are not configured. Please set up your Gemini API key."})}),We.jsx("div",{className:"mt-auto pt-4 border-t border-border-primary dark:border-dark-border text-center",children:We.jsx(c,{to:"/performance-hub",className:"text-sm text-primary hover:underline",children:"Go to Full Performance Hub for detailed analysis "})})]})},zg=({meeting:e,tasks:t,onStart:n})=>{const a=Kt(e),s=t.filter(t=>t.meetingId===e.id&&t.status!==at.Completed);return a?We.jsxs(Ih,{className:"!p-0",children:[We.jsxs("div",{className:"p-4",children:[We.jsx("h4",{className:"font-semibold text-primary dark:text-sky-400",children:e.title}),We.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:["Next: ",We.jsx("span",{className:"font-medium text-slate-700 dark:text-slate-300",children:qt(a)})]}),We.jsxs("div",{className:"mt-2 flex items-center justify-between text-sm",children:[We.jsxs("span",{className:"font-semibold text-secondary dark:text-slate-200",children:[s.length," pending action item(s)"]}),We.jsx(c,{to:`/meetings/${e.id}`,className:"text-xs text-primary hover:underline",children:"View Workspace"})]})]}),We.jsx("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-2 rounded-b-xl",children:We.jsxs(_h,{onClick:()=>n(e.id),variant:"secondary",size:"sm",className:"w-full",children:[We.jsx("i",{className:"fas fa-bolt mr-2"})," Start Live Session"]})})]}):null},Wg=()=>{const{currentUser:e}=Eh(),[t,n]=l.useState([]),[a,s]=l.useState([]),[r,i]=l.useState([]),[o,u]=l.useState([]),[m,f]=l.useState([]),[h,g]=l.useState([]),[x,y]=l.useState(null),[b,v]=l.useState([]),[N,w]=l.useState(!0),[k,E]=l.useState(null),j=d(),[C,_]=l.useState({type:"",userId:"",dateRange:{start:null,end:null}});l.useMemo(()=>[{value:"",label:"All Team Members"},...t.filter(t=>t.businessUnitId===(null==e?void 0:e.businessUnitId)&&"Employee"===t.roleName&&t.status===et.ACTIVE).map(e=>({value:e.id,label:e.name}))],[t,e]),l.useMemo(()=>{const e=Object.values(dt);return[{value:"",label:"All Action Types"},...[...new Set(e)].map(e=>({value:e,label:e.replace(/_/g," ").toLowerCase().replace(/\b\w/g,e=>e.toUpperCase())}))]},[]);const T=l.useCallback(async()=>{if(e&&"Manager"===e.roleName){const[t,a,r,l,o]=await Promise.all([Cf(),Df(),zf(),Lf(),Jf()]);n(t),s(a),i(r),f(o);const c=t.filter(t=>t.businessUnitId===e.businessUnitId&&"Employee"===t.roleName&&!t.isSuspended).map(e=>e.id),d=[...c,e.id],m=l.filter(t=>t.createdBy===e.id||t.assignedTo.some(e=>c.includes(e)));u(m),g(m.filter(t=>t.pinnedBy.includes(e.id)).sort((e,t)=>new Date(e.dueDate).getTime()-new Date(t.dueDate).getTime()));const p=(await Promise.all(d.map(e=>jf(e)))).flat().sort((e,t)=>t.timestamp-e.timestamp).filter(e=>{const t=!C.type||e.type===C.type,n=!C.userId||e.actorId===C.userId||e.targetUserId===C.userId,a=new Date(e.timestamp),s=C.dateRange.start?new Date(C.dateRange.start):null,r=C.dateRange.end?new Date(C.dateRange.end):null;s&&s.setHours(0,0,0,0),r&&r.setHours(23,59,59,999);return t&&n&&((!s||a>=s)&&(!r||a<=r))}),h=Array.from(new Map(p.map(e=>[e.id,e])).values()).slice(0,50).map(t=>lh(t,e)),x=await Promise.all(h);v(x.sort((e,t)=>t.timestamp-e.timestamp).slice(0,25))}},[e,C]),S=l.useCallback(async()=>{if(!e||"Manager"!==e.roleName)return;const t=await zf();i(t)},[e]);l.useEffect(()=>{w(!0),T().finally(()=>w(!1));const e=[pt,ht,bt,yt],t=tn.on("appDataChanged",t=>{const n=null==t?void 0:t.keyChanged;(null==n?void 0:n.startsWith(e.find(e=>n.startsWith(e))||""))&&T()});return()=>t()},[T]);const A=e=>{T(),E(null),j(`/meetings/${e.id}`)},I=l.useMemo(()=>e?m.filter(t=>t.createdBy===e.id&&t.recurrenceRule&&"none"!==t.recurrenceRule):[],[m,e]),D=l.useMemo(()=>e?t.filter(t=>t.status===et.ACTIVE&&t.tenantId===e.tenantId&&!t.isPlatformAdmin&&t.id!==e.id):[],[t,e]);if(!e)return We.jsx(p,{to:"/login",replace:!0});if(N)return We.jsx(Ah,{title:"Manager Dashboard",children:We.jsx(Ph,{message:"Loading dashboard data..."})});return We.jsxs(Ah,{title:`${(()=>{const e=(new Date).getHours();return e<12?"Good Morning":e<18?"Good Afternoon":"Good Evening"})()}, ${e.name}!`,children:[We.jsx(Mg,{isOpen:"selector"===k,onClose:()=>E(null),onSelect:e=>E(e)}),We.jsx(Pg,{isOpen:"live"===k,onClose:()=>E(null),manager:e,teamMembers:D,onSuccess:A}),We.jsx(Dh,{isOpen:"formal"===k,onClose:()=>E(null),title:"Schedule Formal Meeting",size:"lg",children:We.jsx($g,{manager:e,teamMembers:D,onSuccess:A,onCancel:()=>E(null)})}),We.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[We.jsxs(Ih,{title:" Management Toolkit",children:[We.jsx("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[{label:"Manage Reports",path:"/manage-reports",icon:"fa-file-signature",color:"bg-blue-100 dark:bg-dark-surface-secondary text-blue-600 dark:text-sky-400",hoverColor:"hover:bg-blue-600 dark:hover:bg-sky-500"},{label:"Team Tasks",path:"/team-tasks",icon:"fa-users-cog",color:"bg-teal-50 dark:bg-dark-surface-secondary text-teal-600 dark:text-teal-400",hoverColor:"hover:bg-teal-600 dark:hover:bg-teal-500"},{label:"Consistency Tracker",path:"/delinquent-reports",icon:"fa-bell",color:"bg-orange-50 dark:bg-orange-900/50 text-orange-600 dark:text-orange-400",hoverColor:"hover:bg-orange-600 dark:hover:bg-orange-800/60"},{label:"Calendar View",path:"/calendar-view",icon:"fa-calendar-alt",color:"bg-indigo-50 dark:bg-dark-surface-secondary text-indigo-600 dark:text-indigo-400",hoverColor:"hover:bg-indigo-600 dark:hover:bg-indigo-500"}].map(e=>We.jsxs(c,{to:e.path,className:`group flex flex-col items-center justify-center text-center p-4 rounded-xl ${e.color} ${e.hoverColor} hover:text-white dark:hover:text-white transition-all duration-300 transform hover:-translate-y-1 hover:shadow-lg`,children:[We.jsx("i",{className:`fas ${e.icon} text-3xl mb-2 transition-all duration-300 group-hover:scale-110`}),We.jsx("span",{className:"font-semibold text-sm text-slate-800 dark:text-slate-200 group-hover:text-white transition-colors duration-300",children:e.label})]},e.label))}),We.jsxs("button",{onClick:()=>E("selector"),className:"w-full bg-cyan-500 hover:bg-cyan-600 dark:bg-cyan-400 dark:hover:bg-cyan-500 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-300 flex items-center justify-center gap-2 shadow-md hover:shadow-lg transform hover:-translate-y-0.5",children:[We.jsx("i",{className:"fas fa-plus text-lg"}),We.jsx("span",{children:"Plan a New Meeting"})]})]}),We.jsx(Vg,{teamMembers:t.filter(t=>"Employee"===t.roleName&&t.businessUnitId===e.businessUnitId&&t.status===et.ACTIVE),allReports:a,allTasks:o,allLeaveRecords:r})]}),I.length>0&&We.jsx(Ih,{title:" Upcoming Recurring Meetings",className:"mb-6",children:We.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:I.map(e=>We.jsx(zg,{meeting:e,tasks:o,onStart:e=>j(`/meetings/${e}`)},e.id))})}),We.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[We.jsx(Ih,{title:" Pinned Tasks",children:h.length>0?We.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto pr-2",children:h.map(e=>We.jsxs(c,{to:`/team-tasks?taskId=${e.id}`,className:"block p-3 bg-white dark:bg-slate-800/60 rounded-md shadow-sm hover:shadow-md transition-shadow hover:bg-slate-50 dark:hover:bg-slate-800",children:[We.jsxs("div",{className:"flex justify-between items-start",children:[We.jsx("p",{className:"font-semibold text-primary dark:text-sky-400 truncate pr-2",children:e.title}),We.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full "+(e.status===at.Completed?"bg-emerald-100 dark:bg-emerald-500/20 text-emerald-700 dark:text-emerald-300":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300"),children:e.status})]}),We.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:["Due: ",Wt(e.dueDate)]})]},e.id))}):We.jsx("p",{className:"text-center text-slate-500 dark:text-slate-400 py-8",children:"Pin important tasks from the 'Team Tasks' page to see them here."})}),We.jsx(Qh,{title:"Recent Team Activity",events:b})]}),We.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[We.jsx(yg,{allUsers:t.filter(t=>t.businessUnitId===e.businessUnitId),allLeaveRecords:r,onLeaveUpdated:S}),We.jsx(bg,{allUsers:t.filter(t=>t.businessUnitId===e.businessUnitId)})]}),We.jsx(xg,{}),x&&We.jsx(zh,{report:x,isOpen:!!x,onClose:()=>y(null),currentUser:e,onReportUpdate:e=>{s(t=>t.map(t=>t.id===e.id?e:t)),y(e)}})]})},qg=()=>{const{currentUser:e}=Eh(),[t,n]=l.useState([]),[a,s]=l.useState(!0);return l.useEffect(()=>{Cf().then(e=>{n(e),s(!1)})},[]),e?a?We.jsx(Ah,{title:"Manage Team Reports",children:We.jsx(Ph,{message:"Loading users..."})}):We.jsx(Ah,{title:"Manage Team Reports",children:We.jsx(Ng,{currentUser:e,allUsers:t})}):We.jsx(p,{to:"/login"})},Hg=()=>We.jsx(Ah,{title:"Reporting Consistency Tracker",children:We.jsx(jg,{})}),Kg=()=>{const{currentUser:e}=Eh(),[t,n]=l.useState([]),[a,s]=l.useState([]),[r,i]=l.useState([]),[o,c]=l.useState([]),[d,u]=l.useState(!0),m=l.useMemo(()=>e?r.filter(t=>t.businessUnitId===e.businessUnitId&&"Employee"===t.roleName).map(e=>e.id):[],[r,e]),p=l.useCallback(async()=>{if(e){const[e,t,a,r]=await Promise.all([Cf(),Df(),zf(),Jf()]);i(e),n(t),s(a),c(r)}},[e]);if(l.useEffect(()=>{u(!0),p().finally(()=>u(!1))},[p]),!e)return null;if(d)return We.jsx(Ah,{title:"Team Calendar",children:We.jsx(Ph,{message:"Loading calendar data..."})});const f=t.filter(e=>m.includes(e.employeeId)),h=a.filter(e=>m.includes(e.employeeId)),g=o.filter(t=>t.createdBy===e.id||t.attendeeIds.some(e=>m.includes(e)));return We.jsx(Ah,{title:"Team Calendar",children:We.jsx(Tg,{reports:f,meetings:g,currentUser:e,allUsersForFilter:r.filter(t=>t.businessUnitId===e.businessUnitId),leaveRecords:h,onReportUpdate:p})})},Yg=()=>We.jsx(Ah,{title:"Performance Hub",children:We.jsx(Gg,{})}),Jg=({meeting:e,tasks:t,onStart:n})=>{const a=Kt(e),s=t.filter(t=>t.meetingId===e.id&&t.status!==at.Completed);return a?We.jsxs(Ih,{className:"!p-0",children:[We.jsxs("div",{className:"p-4",children:[We.jsx("h4",{className:"font-semibold text-primary dark:text-sky-400",children:e.title}),We.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:["Next: ",We.jsx("span",{className:"font-medium text-slate-700 dark:text-slate-300",children:qt(a)})]}),We.jsxs("div",{className:"mt-2 flex items-center justify-between text-sm",children:[We.jsxs("span",{className:"font-semibold text-secondary dark:text-slate-200",children:[s.length," pending action item(s)"]}),We.jsx(c,{to:`/meetings/${e.id}`,className:"text-xs text-primary hover:underline",children:"View Workspace"})]})]}),We.jsx("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-2 rounded-b-xl",children:We.jsxs(_h,{onClick:()=>n(e.id),variant:"secondary",size:"sm",className:"w-full",children:[We.jsx("i",{className:"fas fa-bolt mr-2"})," Start Live Session"]})})]}):null},Zg=()=>{var e;const{currentUser:t}=Eh(),[n,a]=l.useState([]),[s,r]=l.useState([]),[i,o]=l.useState([]),[u,m]=l.useState([]),[f,h]=l.useState([]),[g,x]=l.useState([]),[y,b]=l.useState([]),[v,N]=l.useState(null),[w,k]=l.useState([]),[E,j]=l.useState(!0),[C,_]=l.useState(null),[T,S]=l.useState(""),A=d(),I=l.useMemo(()=>n.filter(e=>"Employee"===e.roleName&&e.status===et.ACTIVE),[n]),D=l.useMemo(()=>T?I.filter(e=>e.businessUnitId===T):I,[I,T]),O=l.useMemo(()=>[{value:"",label:"All Business Units"},...g.filter(e=>"active"===e.status).map(e=>({value:e.id,label:e.name}))],[g]),R=l.useCallback(async()=>{if(t&&ch(t.roleName)){const[e,n,s,i,l,c]=await Promise.all([Cf(),Df(),zf(),Lf(),Jf(),If()]);a(e),r(n),o(s),h(l),x(c);const d=["Employee","Manager","Team Lead"],u=e.filter(e=>e.roleName&&d.includes(e.roleName)&&!e.isSuspended).map(e=>e.id),p=Array.from(new Set([...u,t.id])),f=i.filter(e=>e.createdBy===t.id||e.assignedTo.some(e=>u.includes(e)));m(f),b(f.filter(e=>e.pinnedBy.includes(t.id)).sort((e,t)=>new Date(e.dueDate).getTime()-new Date(t.dueDate).getTime()));const g=(await Promise.all(p.map(e=>jf(e)))).flat().sort((e,t)=>t.timestamp-e.timestamp),y=Array.from(new Map(g.map(e=>[e.id,e])).values()).slice(0,50).map(e=>lh(e,t)),v=await Promise.all(y);k(v.sort((e,t)=>t.timestamp-e.timestamp).slice(0,25))}},[t]);l.useEffect(()=>{j(!0),R().finally(()=>j(!1));const e=[pt,ht,bt,yt,jt],t=tn.on("appDataChanged",t=>{const n=null==t?void 0:t.keyChanged;(null==n?void 0:n.startsWith(e.find(e=>n.startsWith(e))||""))&&R()});return()=>t()},[R]);const P=e=>{R(),_(null),A(`/meetings/${e.id}`)},M=l.useMemo(()=>t?f.filter(e=>e.createdBy===t.id&&e.recurrenceRule&&"none"!==e.recurrenceRule):[],[f,t]);if(!t)return We.jsx(p,{to:"/login",replace:!0});if(!ch(t.roleName))return We.jsx(p,{to:"/dashboard",replace:!0});if(E)return We.jsx(Ah,{title:"Director Dashboard",children:We.jsx(Ph,{message:"Loading dashboard data..."})});return We.jsxs(Ah,{title:`${(()=>{const e=(new Date).getHours();return e<12?"Good Morning":e<18?"Good Afternoon":"Good Evening"})()}, ${t.name}!`,children:[We.jsx(Mg,{isOpen:"selector"===C,onClose:()=>_(null),onSelect:e=>_(e)}),We.jsx(Pg,{isOpen:"live"===C,onClose:()=>_(null),manager:t,teamMembers:D,onSuccess:P}),We.jsx(Dh,{isOpen:"formal"===C,onClose:()=>_(null),title:"Schedule Formal Meeting",size:"lg",children:We.jsx($g,{manager:t,teamMembers:D,onSuccess:P,onCancel:()=>_(null)})}),We.jsx("div",{className:"mb-6",children:We.jsx(Ih,{title:" Business Unit Filter",children:We.jsxs("div",{className:"flex items-center gap-4",children:[We.jsx("div",{className:"flex-1",children:We.jsx(Oh,{value:T,onChange:e=>S(e.target.value),options:O,label:"Filter by Business Unit"})}),We.jsx("div",{className:"text-sm text-slate-600 dark:text-slate-400 pt-6",children:T?`Showing ${D.length} employee(s) from ${(null==(e=g.find(e=>e.id===T))?void 0:e.name)||"selected unit"}`:`Showing all ${I.length} employee(s) across all business units`})]})})}),We.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[We.jsxs(Ih,{title:" Management Toolkit",children:[We.jsx("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[{label:"Manage Reports",path:"/manage-reports",icon:"fa-file-signature",color:"bg-blue-100 dark:bg-dark-surface-secondary text-blue-600 dark:text-sky-400",hoverColor:"hover:bg-blue-600 dark:hover:bg-sky-500"},{label:"Team Tasks",path:"/team-tasks",icon:"fa-users-cog",color:"bg-teal-50 dark:bg-dark-surface-secondary text-teal-600 dark:text-teal-400",hoverColor:"hover:bg-teal-600 dark:hover:bg-teal-500"},{label:"Consistency Tracker",path:"/delinquent-reports",icon:"fa-bell",color:"bg-orange-50 dark:bg-orange-900/50 text-orange-600 dark:text-orange-400",hoverColor:"hover:bg-orange-600 dark:hover:bg-orange-800/60"},{label:"Calendar View",path:"/calendar-view",icon:"fa-calendar-alt",color:"bg-indigo-50 dark:bg-dark-surface-secondary text-indigo-600 dark:text-indigo-400",hoverColor:"hover:bg-indigo-600 dark:hover:bg-indigo-500"}].map(e=>We.jsxs(c,{to:e.path,className:`group flex flex-col items-center justify-center text-center p-4 rounded-xl ${e.color} ${e.hoverColor} hover:text-white dark:hover:text-white transition-all duration-300 transform hover:-translate-y-1 hover:shadow-lg`,children:[We.jsx("i",{className:`fas ${e.icon} text-3xl mb-2 transition-all duration-300 group-hover:scale-110`}),We.jsx("span",{className:"font-semibold text-sm text-slate-800 dark:text-slate-200 group-hover:text-white transition-colors duration-300",children:e.label})]},e.label))}),We.jsxs("button",{onClick:()=>_("selector"),className:"w-full bg-cyan-500 hover:bg-cyan-600 dark:bg-cyan-400 dark:hover:bg-cyan-500 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-300 flex items-center justify-center gap-2 shadow-md hover:shadow-lg transform hover:-translate-y-0.5",children:[We.jsx("i",{className:"fas fa-plus text-lg"}),We.jsx("span",{children:"Plan a New Meeting"})]})]}),We.jsx(Vg,{teamMembers:D,allReports:s,allTasks:u,allLeaveRecords:i})]}),M.length>0&&We.jsx(Ih,{title:" Upcoming Recurring Meetings",className:"mb-6",children:We.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:M.map(e=>We.jsx(Jg,{meeting:e,tasks:u,onStart:e=>A(`/meetings/${e}`)},e.id))})}),We.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[We.jsx(Ih,{title:" Pinned Tasks",children:y.length>0?We.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto pr-2",children:y.map(e=>We.jsxs(c,{to:`/team-tasks?taskId=${e.id}`,className:"block p-3 bg-white dark:bg-slate-800/60 rounded-md shadow-sm hover:shadow-md transition-shadow hover:bg-slate-50 dark:hover:bg-slate-800",children:[We.jsxs("div",{className:"flex justify-between items-start",children:[We.jsx("p",{className:"font-semibold text-primary dark:text-sky-400 truncate pr-2",children:e.title}),We.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full "+(e.status===at.Completed?"bg-emerald-100 dark:bg-emerald-500/20 text-emerald-700 dark:text-emerald-300":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300"),children:e.status})]}),We.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:["Due: ",Wt(e.dueDate)]})]},e.id))}):We.jsx("p",{className:"text-center text-slate-500 dark:text-slate-400 py-8",children:"Pin important tasks from the 'Team Tasks' page to see them here."})}),We.jsx(Qh,{title:"Organization Activity",events:w})]}),We.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[We.jsx(yg,{allUsers:D.length>0?D:I,allLeaveRecords:i,onLeaveUpdated:R,scope:"tenant"}),We.jsx(bg,{allUsers:D.length>0?D:I,scope:"tenant"})]}),We.jsx(xg,{}),v&&We.jsx(zh,{report:v,isOpen:!!v,onClose:()=>N(null),currentUser:t,onReportUpdate:e=>{r(t=>t.map(t=>t.id===e.id?e:t)),N(e)}})]})},Qg=()=>{const{currentUser:e}=Eh(),t=d(),[n,a]=l.useState(!0),[s,r]=l.useState([]),[i,o]=l.useState([]),[u,m]=l.useState([]),[p,f]=l.useState([]),[h,g]=l.useState([]);l.useEffect(()=>{(async()=>{a(!0);try{const[e,t,n,a,s]=await Promise.all([eh(),Cf(),Df(),Lf(),zf()]);r(e),o(t),m(n),f(a),g(s)}finally{a(!1)}})()},[]);const x=l.useMemo(()=>({active:s.filter(e=>"active"===e.status),upcoming:s.filter(e=>"scheduled"===e.status),expired:s.filter(e=>"expired"===e.status)}),[s]),y=l.useMemo(()=>i.filter(e=>"Employee"===e.roleName),[i]);return n||!e?We.jsx(Ah,{title:"HR Command Center",children:We.jsx("div",{className:"flex justify-center py-20",children:We.jsx(Ph,{message:"Preparing insights..."})})}):We.jsxs(Ah,{title:"HR Command Center",description:"Monitor wellbeing, attendance, and announcements across the organization.",action:We.jsx(c,{to:"/announcements",children:We.jsxs(_h,{children:[We.jsx("i",{className:"fas fa-bullhorn mr-2"}),"Manage Announcements"]})}),children:[We.jsx(Ih,{title:"HR Quick Actions",className:"mb-6",children:We.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4",children:[{label:"Plan Announcement",description:"Broadcast org-wide updates",icon:"fa-bullhorn",color:"bg-gradient-to-br from-primary/80 via-sky-500 to-cyan-500 text-white",hoverColor:"hover:opacity-90",path:"/announcements"},{label:"Attendance Pulse",description:"Monitor leaves & weekly offs",icon:"fa-calendar-check",color:"bg-gradient-to-br from-emerald-500 via-teal-500 to-cyan-500 text-white",hoverColor:"hover:opacity-90",path:"/admin/leave-records"},{label:"Consistency Tracker",description:"Spot delinquent reporting",icon:"fa-route",color:"bg-gradient-to-br from-amber-400 via-orange-500 to-rose-500 text-white",hoverColor:"hover:opacity-90",path:"/delinquent-reports"},{label:"HR Taskboard",description:"Follow up on policy work",icon:"fa-list-check",color:"bg-gradient-to-br from-indigo-500 via-violet-500 to-fuchsia-500 text-white",hoverColor:"hover:opacity-90",path:"/team-tasks"}].map(e=>We.jsxs(c,{to:e.path,className:`group flex flex-col h-full rounded-2xl p-4 transition-all duration-300 ${e.color} ${e.hoverColor} transform hover:-translate-y-1 hover:shadow-2xl`,children:[We.jsxs("div",{className:"flex items-center justify-between",children:[We.jsx("i",{className:`fas ${e.icon} text-2xl group-hover:scale-110 transition-transform`}),We.jsx("span",{className:"text-xs uppercase tracking-[0.3em] opacity-70",children:"Go"})]}),We.jsxs("div",{className:"mt-6",children:[We.jsx("p",{className:"text-lg font-semibold",children:e.label}),We.jsx("p",{className:"text-sm opacity-80",children:e.description})]})]},e.label))})}),We.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[We.jsxs(Ih,{title:"Active Announcements",children:[We.jsx("p",{className:"text-3xl font-bold text-slate-900 dark:text-white",children:x.active.length}),x.active.slice(0,2).map(e=>We.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:[e.title,"  active until ",qt(new Date(e.endsAt))]},e.id))]}),We.jsxs(Ih,{title:"Upcoming Campaigns",children:[We.jsx("p",{className:"text-3xl font-bold text-slate-900 dark:text-white",children:x.upcoming.length}),We.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:["Next launch:"," ",x.upcoming[0]?qt(new Date(x.upcoming[0].startsAt)):"TBD"]})]}),We.jsxs(Ih,{title:"Pending Tasks",children:[We.jsx("p",{className:"text-3xl font-bold text-slate-900 dark:text-white",children:p.filter(e=>e.status!==at.Completed&&!e.isPersonalTask).length}),We.jsx(c,{to:"/team-tasks",className:"text-sm text-primary hover:underline",children:"Go to My Tasks"})]})]}),We.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[We.jsx("div",{className:"h-full",children:We.jsx(Vg,{teamMembers:y,allReports:u,allTasks:p,allLeaveRecords:h})}),We.jsx("div",{className:"h-full",children:We.jsx(yg,{allUsers:i,allLeaveRecords:h,onLeaveUpdated:async()=>{const e=await zf();g(e)},scope:"tenant"})})]}),We.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[We.jsx("div",{className:"h-full",children:We.jsx(bg,{allUsers:i,scope:"tenant"})}),We.jsx(Ih,{title:"Announcement Health",children:We.jsxs("div",{className:"space-y-4",children:[We.jsxs("div",{className:"flex items-center justify-between",children:[We.jsxs("div",{children:[We.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Active campaigns"}),We.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:x.active.length})]}),We.jsxs(_h,{onClick:()=>t("/announcements"),children:[We.jsx("i",{className:"fas fa-plus mr-2"}),"New announcement"]})]}),We.jsxs("div",{children:[We.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Highlights"}),x.active.slice(0,2).map(e=>We.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:[e.title,"  ends ",qt(new Date(e.endsAt))]},e.id)),0===x.active.length&&We.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"No live announcements right now."})]})]})})]})]})},Xg=({report:e,onViewDetails:t})=>{const n=e.versions.sort((e,t)=>t.versionNumber-e.versionNumber)[0],[a,s]=l.useState({editable:!1,reason:""});if(l.useEffect(()=>{(async()=>{const t=await Mf(e);s(t)})()},[e]),!n)return We.jsx(Ih,{className:"mb-4 hover:shadow-lg transition-shadow duration-200",children:We.jsx("p",{className:"text-red-500",children:"Error: Report has no version data."})});const{date:r,status:i,managerComments:o,submittedOnWeekOff:c,isLate:d}=e,{tasksCompleted:u,timestamp:m,action:p,attachments:f,versionNumber:h}=n;return We.jsxs(Ih,{className:"mb-4 hover:shadow-lg transition-shadow duration-200 animate-fade-in-up",children:[We.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start",children:[We.jsxs("div",{children:[We.jsxs("h4",{className:"text-lg font-semibold text-secondary dark:text-slate-200",children:["EOD Report - ",Wt(r),e.versions.length>1&&We.jsxs("span",{className:"text-sm text-gray-500 dark:text-slate-400 ml-2",children:["(V",h,")"]})]}),We.jsxs("div",{className:"flex items-center space-x-2 mt-1 flex-wrap",children:[We.jsxs("span",{className:"px-2 py-0.5 inline-block text-xs font-semibold rounded-full "+(i===tt.ACKNOWLEDGED?"bg-green-100 text-green-700 dark:bg-green-500/20 dark:text-green-300":"bg-yellow-100 text-yellow-700 dark:bg-yellow-500/20 dark:text-yellow-300"),children:[We.jsx("i",{className:`fas ${i===tt.ACKNOWLEDGED?"fa-check-circle":"fa-hourglass-half"} mr-1`}),i]}),d&&We.jsxs("span",{className:"px-2 py-0.5 inline-block text-xs font-semibold rounded-full bg-orange-100 text-orange-700 dark:bg-orange-500/20 dark:text-orange-300",children:[We.jsx("i",{className:"fas fa-clock mr-1"}),"Late Submission"]}),c&&We.jsxs("span",{className:"px-2 py-0.5 inline-block text-xs font-semibold rounded-full bg-blue-100 text-blue-700 dark:bg-blue-500/20 dark:text-blue-300",children:[We.jsx("i",{className:"fas fa-calendar-check mr-1"}),"On Week Off"]}),f&&f.length>0&&We.jsxs("span",{className:"px-2 py-0.5 inline-block text-xs font-semibold rounded-full bg-gray-100 text-gray-700 dark:bg-slate-700 dark:text-slate-300",title:`${f.length} attachment(s)`,children:[We.jsx("i",{className:"fas fa-paperclip mr-1"})," ",f.length]}),e.versions.length>1&&We.jsxs("span",{className:"px-2 py-0.5 inline-block text-xs font-semibold rounded-full bg-purple-100 text-purple-700 dark:bg-purple-500/20 dark:text-purple-300",title:"This report has been edited.",children:[We.jsx("i",{className:"fas fa-history mr-1"}),"Edited"]}),o&&We.jsxs("span",{className:"px-2 py-0.5 inline-block text-xs font-semibold rounded-full bg-indigo-100 text-indigo-700 dark:bg-indigo-500/20 dark:text-indigo-300",title:"Manager has commented",children:[We.jsx("i",{className:"fas fa-comment-dots mr-1"}),"Commented"]})]}),e.versions.length>1&&We.jsxs("span",{className:"ml-0 text-xs text-gray-500 dark:text-slate-400 italic",children:["Last action: ",p," at ",qt(m)]})]}),We.jsxs("div",{className:"mt-2 sm:mt-0 flex flex-col sm:flex-row sm:space-x-2 space-y-2 sm:space-y-0 items-stretch sm:items-center w-full sm:w-auto",children:[a.editable&&We.jsxs(_h,{to:`/edit-eod/${e.id}`,variant:"warning",size:"sm",className:"w-full sm:w-auto",icon:We.jsx("i",{className:"fas fa-edit"}),children:["Edit (V",n.versionNumber,")"]}),We.jsx(_h,{onClick:()=>t(e),variant:"ghost",size:"sm",className:"w-full sm:w-auto",children:"View Details"})]})]}),We.jsxs("div",{className:"mt-3",children:[We.jsx("p",{className:"text-sm text-text-primary dark:text-dark-text-primary mb-1",children:We.jsx("strong",{children:"Tasks Completed (Latest Version):"})}),We.jsx("p",{className:"text-sm text-text-secondary dark:text-dark-text-secondary whitespace-pre-wrap truncate max-h-16",children:u}),!a.editable&&a.reason&&We.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 mt-1 italic",children:a.reason})]}),i===tt.ACKNOWLEDGED&&(()=>{const t=Pf(e).getAcknowledgingManagers();return We.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100 dark:border-slate-800 space-y-2",children:[t.length>0&&We.jsxs("div",{children:[We.jsx("p",{className:"text-sm text-text-primary dark:text-dark-text-primary mb-1",children:We.jsx("strong",{children:"Acknowledged by:"})}),We.jsx("div",{className:"bg-green-50 dark:bg-green-900/30 p-2 rounded space-y-1",children:t.map((e,t)=>We.jsxs("div",{className:"text-sm text-green-700 dark:text-green-400 flex items-center",children:[We.jsx("i",{className:"fas fa-check-circle mr-2"}),We.jsxs("span",{className:"font-medium",children:[e.name,e.designation&&"Director"===e.designation&&We.jsx("span",{className:"ml-1 text-xs opacity-70",children:"(Director)"})]}),We.jsxs("span",{className:"text-xs ml-2 text-green-600 dark:text-green-500",children:["(",qt(e.timestamp),")"]})]},t))})]}),o&&We.jsxs("div",{children:[We.jsx("p",{className:"text-sm text-text-primary dark:text-dark-text-primary mb-1",children:We.jsx("strong",{children:"Manager's Feedback (Overall):"})}),We.jsxs("p",{className:"text-sm text-text-secondary dark:text-dark-text-secondary italic bg-gray-50 dark:bg-slate-800/50 p-2 rounded whitespace-pre-wrap truncate max-h-16",children:['"',o,'"']})]})]})})()]})},ex=({currentUser:e})=>{const[t,n]=l.useState([]),[a,s]=l.useState(null),[r,i]=l.useState(!0),[o,c]=f(),d=o.get("search")||"",u=o.get("status")||"",m=parseInt(o.get("page")||"1",10),p={key:o.get("sortKey")||"date",direction:o.get("sortDir")||"descending"};l.useEffect(()=>{(async()=>{i(!0);const t=await Of(e.id);n(t),i(!1)})()},[e.id]);const h=e=>{const t=new URLSearchParams(o);Object.entries(e).forEach(([e,n])=>{n?t.set(e,n):t.delete(e)}),t.set("page","1"),c(t)},g=e=>{var t;t={page:String(e)},c(e=>(Object.entries(t).forEach(([t,n])=>{n?e.set(t,n):e.delete(t)}),e),{replace:!0})},x=l.useMemo(()=>{let e=[...t];return null!==p&&e.sort((e,t)=>{let n,a;switch(p.key){case"date":n=e.submittedAt,a=t.submittedAt;break;case"versions":n=e.versions.length,a=t.versions.length;break;case"status":n=e.status,a=t.status;break;default:n=e[p.key],a=t[p.key]}return n<a?"ascending"===p.direction?-1:1:n>a?"ascending"===p.direction?1:-1:"date"!==p.key?t.submittedAt-e.submittedAt:0}),e.filter(e=>{const t=d.toLowerCase(),n=e.versions.sort((e,t)=>t.versionNumber-e.versionNumber)[0];return!!n&&((n.tasksCompleted||"").toLowerCase().includes(t)||n.challengesFaced&&n.challengesFaced.toLowerCase().includes(t)||n.planForTomorrow&&n.planForTomorrow.toLowerCase().includes(t)||e.date.includes(t)||Wt(e.date).toLowerCase().includes(t))}).filter(e=>!u||e.status===u)},[t,d,u,p]),y=Math.ceil(x.length/10),b=l.useMemo(()=>{const e=10*(m-1);return x.slice(e,e+10)},[x,m]);return r?We.jsx(Ph,{message:"Loading your reports..."}):We.jsxs(Ih,{title:"My EOD Reports",titleIcon:We.jsx("i",{className:"fas fa-history"}),children:[We.jsx("div",{className:"mb-4 p-4 rounded-lg bg-surface-secondary dark:bg-dark-surface-secondary",children:We.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[We.jsx(Ch,{type:"text",placeholder:"Search reports (latest tasks, date...)",value:d,onChange:e=>h({search:e.target.value}),wrapperClassName:"mb-0"}),We.jsx(Oh,{options:[{value:"",label:"All Statuses"},{value:tt.PENDING_ACKNOWLEDGMENT,label:"Pending Acknowledgment"},{value:tt.ACKNOWLEDGED,label:"Acknowledged"}],value:u,onChange:e=>h({status:e.target.value}),wrapperClassName:"mb-0",placeholder:"Filter by Status"})]})}),0===x.length?We.jsx(gg,{icon:We.jsx("i",{className:"fas fa-file-alt"}),title:d||u?"No Reports Match":"No Reports Yet",message:d||u?"No reports matched your search or filter criteria. Try adjusting your filters.":"You haven't submitted any EOD reports yet. Let's get started!",cta:d||u?void 0:We.jsx(_h,{to:"/submit-eod/today",variant:"primary",icon:We.jsx("i",{className:"fas fa-plus"}),children:"Submit Your First Report"})}):We.jsxs(We.Fragment,{children:[We.jsx("div",{className:"space-y-4",children:b.map(e=>We.jsx(Xg,{report:e,onViewDetails:s},e.id))}),y>1&&We.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row justify-between items-center space-y-3 sm:space-y-0",children:[We.jsxs("span",{className:"text-sm text-text-secondary dark:text-dark-text-secondary",children:["Page ",m," of ",y," (Total reports: ",x.length,")"]}),We.jsxs("div",{className:"flex items-center",children:[We.jsx(_h,{onClick:()=>g(m-1),disabled:1===m,variant:"ghost",size:"sm",icon:We.jsx("i",{className:"fas fa-chevron-left"}),className:"mr-2",children:"Prev"}),(()=>{const e=[];if(y<=5)for(let t=1;t<=y;t++)e.push(We.jsx(_h,{onClick:()=>g(t),variant:t===m?"primary":"ghost",size:"sm",className:"mx-1",children:t},t));else{e.push(We.jsx(_h,{onClick:()=>g(1),variant:1===m?"primary":"ghost",size:"sm",className:"mx-1",children:"1"},1));let t=Math.max(2,m-Math.floor(.5)),n=Math.min(y-1,m+Math.floor(.5));m<=Math.ceil(1.5)?n=2:m>y-Math.ceil(1.5)&&(t=y-1),t>2&&e.push(We.jsx("span",{className:"mx-1 p-2",children:"..."},"start-ellipsis"));for(let a=t;a<=n;a++)e.push(We.jsx(_h,{onClick:()=>g(a),variant:a===m?"primary":"ghost",size:"sm",className:"mx-1",children:a},a));n<y-1&&e.push(We.jsx("span",{className:"mx-1 p-2",children:"..."},"end-ellipsis")),e.push(We.jsx(_h,{onClick:()=>g(y),variant:y===m?"primary":"ghost",size:"sm",className:"mx-1",children:y},y))}return e})(),We.jsx(_h,{onClick:()=>g(m+1),disabled:m===y,variant:"ghost",size:"sm",icon:We.jsx("i",{className:"fas fa-chevron-right"}),className:"ml-2",children:"Next"})]})]})]}),a&&We.jsx(zh,{report:a,isOpen:!!a,onClose:()=>s(null),currentUser:e,onReportUpdate:async t=>{n(e=>e.map(e=>e.id===t.id?t:e)),a&&a.id===t.id&&s(t);const r=await Of(e.id);n(r)}})]})},tx=["image/jpeg","image/png","application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],nx=({isOpen:e,onClose:t,onCapture:n,videoRef:a,canvasRef:s})=>{const[r,i]=l.useState(null),[o,c]=l.useState(null);return l.useEffect(()=>{let t=null;return e?(c(null),navigator.mediaDevices.getUserMedia({video:!0}).then(e=>{t=e,i(e),a.current&&(a.current.srcObject=e)}).catch(e=>{c("Could not access camera. Please check permissions and ensure no other app is using it.")})):r&&(r.getTracks().forEach(e=>e.stop()),i(null)),()=>{t&&t.getTracks().forEach(e=>e.stop())}},[e,a]),We.jsxs(Dh,{isOpen:e,onClose:t,title:"Take a Photo",size:"lg",footer:We.jsxs(We.Fragment,{children:[We.jsx(_h,{variant:"ghost",onClick:t,children:"Cancel"}),We.jsxs(_h,{variant:"primary",onClick:n,disabled:!!o||!r,children:[We.jsx("i",{className:"fas fa-camera mr-2"}),"Take Picture"]})]}),children:[o&&We.jsx(Th,{type:"error",message:o}),We.jsx("div",{className:"bg-black rounded-lg overflow-hidden",children:We.jsx("video",{ref:a,autoPlay:!0,playsInline:!0,className:"w-full h-auto",muted:!0})}),We.jsx("canvas",{ref:s,className:"hidden"})]})},ax=({currentUser:e,reportDate:t,onReportSubmitOrUpdate:n})=>{const a=d(),{addToast:s}=bh(),{reportId:r}=h(),[i,o]=l.useState(null),[c,u]=l.useState(!1),[m,p]=l.useState(t),[f,g]=l.useState(""),[x,y]=l.useState(""),[b,v]=l.useState(""),[N,w]=l.useState([]),[k,E]=l.useState(!1),[j,C]=l.useState(""),[_,T]=l.useState(""),[S,A]=l.useState(""),[I,D]=l.useState(!1),[O,R]=l.useState(!1),[P,M]=l.useState(!1),[U,L]=l.useState(null),[F,B]=l.useState(null),$=l.useRef(null),G=l.useRef(null),V=l.useRef(null),[z,W]=l.useState(!1),[q,H]=l.useState({editable:!0,reason:""}),[K,Y]=l.useState(!1),J=l.useRef(null),Z=l.useRef(null),[Q,X]=l.useState([]),[ee,te]=l.useState(!1),[ne,ae]=l.useState(new Set),[se]=l.useState(()=>`report_${e.id}_${m.replace(/-/g,"")}_${Date.now()}`);l.useEffect(()=>{const e=window.SpeechRecognition||window.webkitSpeechRecognition;if(e){const t=new e;t.continuous=!1,t.interimResults=!1,t.lang="en-US",$.current=t,M(!0)}else M(!1)},[]),l.useEffect(()=>{(async()=>{if(r){R(!0);const t=await(async e=>await Qp.getById(e))(r);if(t&&t.employeeId===e.id){o(t),p(t.date);const e=await Mf(t);H(e);const n=t.versions.sort((e,t)=>t.versionNumber-e.versionNumber)[0];n&&(g(n.tasksCompleted),y(n.challengesFaced||""),v(n.planForTomorrow||""),w(n.attachments||[]),E(n.isCopied||!1)),u(!0)}else C("Report not found or you don't have permission to edit it."),a("/my-reports",{replace:!0});R(!1)}else p(t),u(!1),o(null),g(""),y(""),v(""),w([]),E(!1);C(""),A("")})()},[r,e.id,a,t]),l.useEffect(()=>{if(c)return;(async()=>{te(!0);const t=(await Lf()).filter(t=>(t.assignedTo.includes(e.id)||t.isPersonalTask&&t.createdBy===e.id)&&t.status!==at.Completed).sort((e,t)=>new Date(e.dueDate).getTime()-new Date(t.dueDate).getTime());X(t),te(!1)})()},[e.id,c]),l.useEffect(()=>{c&&!q.editable?A(q.reason):A("")},[c,q]);const re=l.useCallback(()=>{if(!e.weeklyOffDay)return!1;const t=new Date(m.replace(/-/g,"/"));return Zt(t,e.weeklyOffDay)},[m,e.weeklyOffDay]);l.useEffect(()=>{if(c||j||S)return;const t=`Today is your designated weekly off (${e.weeklyOffDay}). Submission is optional if you chose to work.`;re()?k||A(t):k||S!==t||A("")},[m,e.weeklyOffDay,c,k,j,S,A,re]),l.useEffect(()=>{const e=$.current;return()=>{e&&U&&e.stop(),G.current&&clearTimeout(G.current)}},[U]);if(O)return We.jsx(Ph,{message:"Loading report data..."});const ie=(e,t,n,a,s,r)=>{const i=U===e,l="tasksCompleted"===e?"Tasks Completed Today":"challengesFaced"===e?"Challenges Faced (Optional)":"Plan for Tomorrow (Optional)",o=c&&!q.editable;return We.jsxs("div",{className:"mb-4",children:[We.jsx("label",{htmlFor:e,className:"block text-sm font-medium text-text-primary dark:text-dark-text-primary mb-1",children:t}),We.jsxs("div",{className:"flex items-start space-x-2",children:[We.jsx(Yh,{id:e,fieldIdentifier:e,value:n,onChange:a,placeholder:s,required:r,wrapperClassName:"flex-grow",disabled:o}),P&&We.jsx("button",{type:"button",onClick:()=>(e=>{const t=$.current;if(!t)return B("Speech recognition is not supported by your browser."),void M(!1);if(B(null),U===e)return t.stop(),G.current&&clearTimeout(G.current),void L(null);U&&U!==e&&(t.stop(),G.current&&clearTimeout(G.current)),L(e),t.onresult=t=>{const n=t.results[0][0].transcript,a="tasksCompleted"===e?f:"challengesFaced"===e?x:b,s=(a?a+" ":"")+n;switch(e){case"tasksCompleted":g(s);break;case"challengesFaced":y(s);break;case"planForTomorrow":v(s)}},t.onerror=e=>{let t="Speech recognition error: "+e.error;"no-speech"===e.error&&(t="No speech was detected. Please try again."),"audio-capture"===e.error&&(t="Microphone problem. Ensure it's enabled and not in use by another app."),"not-allowed"===e.error&&(t="Microphone permission denied. Please enable it in your browser settings."),B(t),L(null),G.current&&clearTimeout(G.current)},t.onend=()=>{L(null),G.current&&(clearTimeout(G.current),G.current=null)};try{t.start(),G.current=window.setTimeout(()=>{U===e&&t&&t.stop()},1e4)}catch(n){B("Could not start voice recognition: "+n.message),L(null),G.current&&clearTimeout(G.current)}})(e),className:`p-3 rounded-full flex-shrink-0 transition-colors duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-primary self-start ${i?"bg-red-500 text-white hover:bg-red-600 animate-pulse":"bg-primary text-white hover:bg-primary-hover"} ${o?"opacity-50 cursor-not-allowed":""}`,title:i?`Stop listening for ${l}`:`Start voice input for ${l}`,"aria-label":i?`Stop voice input for ${l}`:`Start voice input for ${l}`,"aria-pressed":i,disabled:o,children:We.jsx("i",{className:"fas fa-microphone w-5 h-5"})})]}),P&&We.jsx("p",{className:"mt-1 text-xs text-text-secondary dark:text-dark-text-secondary",children:i?`Listening for ${l}...`:"Tap the mic to speak."}),!P&&We.jsx("p",{className:"mt-1 text-xs text-text-secondary dark:text-dark-text-secondary",children:"Voice input not supported by your browser."})]})},le=c?`Edit EOD Report for ${Wt(m)}`:`Submit EOD Report for ${Wt(m)}`,oe=null==i?void 0:i.versions.sort((e,t)=>t.versionNumber-e.versionNumber)[0],ce=c&&!q.editable;return We.jsxs(We.Fragment,{children:[We.jsx(nx,{isOpen:K,onClose:()=>Y(!1),onCapture:async()=>{if(J.current&&Z.current){const e=J.current,t=Z.current,n=t.getContext("2d");n&&(t.width=e.videoWidth,t.height=e.videoHeight,n.drawImage(e,0,0,e.videoWidth,e.videoHeight),t.toBlob(async e=>{if(e)try{T("Uploading photo to secure storage...");const t=`photo-${Date.now()}.jpg`,n=new File([e],t,{type:"image/jpeg"}),a=await Gh(n,(null==i?void 0:i.id)||se),r={name:a.name,type:a.type,size:a.size,storageUrl:a.storageUrl,storagePath:a.storagePath};w(e=>[...e,r]),T(""),Y(!1),s("Photo uploaded successfully","success")}catch(t){T("Failed to upload photo. Please try again.")}else T("Failed to capture photo")},"image/jpeg",.9))}},videoRef:J,canvasRef:Z}),We.jsx(Dh,{isOpen:z,onClose:()=>{W(!1),a("/my-reports",{replace:!0})},title:"Edit Submitted Successfully",footer:We.jsx(_h,{onClick:()=>{W(!1),a("/my-reports",{replace:!0})},variant:"primary",children:"OK"}),children:We.jsx("p",{children:"Your report has been updated successfully. You have now used your one allowed edit for this report."})}),We.jsxs(Ih,{title:le,titleIcon:We.jsx("i",{className:"fas "+(c?"fa-edit":"fa-paper-plane")}),children:[j&&We.jsx(Th,{type:"error",message:j,onClose:()=>C("")}),S&&!j&&We.jsx(Th,{type:"info",message:S,className:"mb-4"}),F&&We.jsx(Th,{type:"error",message:F,onClose:()=>B(null)}),!P&&We.jsx(Th,{type:"warning",message:"Voice input (Speech Recognition) is not supported by your browser. Please type your report."}),We.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),C(""),B(null),T(""),A(""),D(!0),!f.trim()&&0===ne.size)return C('Please either type your tasks or mark a pending task as "Completed".'),void D(!1);const r=Ht(new Date);if(!c&&m===r){if(await Wf(e.id,r)){const e="EOD Report Submission Restricted",t="You are marked on leave today. You cannot submit the EOD report.";return C(`${e}\n${t}`),s(`${e}  ${t}`,"warning"),void D(!1)}}let l=f.trim();if(ne.size>0){const e=Array.from(ne).map(e=>{const t=Q.find(t=>t.id===e);return t?`- Completed: ${t.title}`:null}).filter(Boolean).join("\n");l=l?`${e}\n\n--- Other Notes ---\n${l}`:e}const o={tasksCompleted:l,challengesFaced:x,planForTomorrow:b,attachments:N,isCopied:k};try{let t=null;if(c&&i){const r=await Mf(i);if(!r.editable)return C(r.reason),A(r.reason),void D(!1);t=await(async(e,t,n)=>{let a=await Df();const s=a.findIndex(t=>t.id===e);if(-1===s)return null;const r=a[s];if(r.versions.length>=2)throw new Error("Maximum number of edits reached.");const i=Date.now();return r.versions.push({...t,versionNumber:r.versions.length+1,timestamp:i,action:"edited"}),await Qp.update(r.id,r),sn({type:"UPDATE_REPORT",payload:{...r}}),await Ef({timestamp:i,actorId:n.id,actorName:n.name,type:dt.EOD_EDITED,description:"edited EOD report for",targetId:r.id,targetName:Wt(r.date)}),r})(i.id,o,e),t?(n&&n(t),t.versions.length>=2?W(!0):(s("EOD report updated successfully!","success"),a("/my-reports",{replace:!0}))):C("Failed to update report. Ensure you are editing on the same day and within version limits.")}else{if((await Of(e.id)).some(e=>e.date===m))return C(`You have already submitted a report for ${Wt(m)}. You can view or edit it from "My EOD Reports".`),void D(!1);const r={employeeId:e.id,employeeName:e.name,date:m,initialTasksCompleted:o.tasksCompleted,initialChallengesFaced:o.challengesFaced,initialPlanForTomorrow:o.planForTomorrow,initialAttachments:o.attachments,isCopied:o.isCopied};t=await(async e=>{await Df();const t=await Cf(),n=t.find(t=>t.id===e.employeeId);if(!n)throw new Error("Employee not found");const a=new Date,s=new Date(e.date.replace(/-/g,"/")),r=Up(),i={id:cm("report"),employeeId:e.employeeId,employeeName:e.employeeName,date:e.date,versions:[{versionNumber:1,tasksCompleted:e.initialTasksCompleted,challengesFaced:e.initialChallengesFaced,planForTomorrow:e.initialPlanForTomorrow,attachments:e.initialAttachments,isCopied:e.isCopied,timestamp:a.getTime(),action:"submitted"}],status:tt.PENDING_ACKNOWLEDGMENT,submittedOnWeekOff:Zt(s,n.weeklyOffDay),isLate:a.getHours()>=19,isYesterdaySubmission:Ht(a)!==e.date,submittedAt:a.getTime(),tenantId:r};await Qp.create(i.id,i),sn({type:"ADD_REPORT",payload:{...i}});const l=i.isLate?dt.EOD_LATE_SUBMITTED:dt.EOD_SUBMITTED;await Ef({timestamp:i.submittedAt,actorId:n.id,actorName:n.name,type:l,description:"submitted EOD report for",targetId:i.id,targetName:Wt(i.date),isCrucial:i.isLate});const o=t.find(e=>"Manager"===e.roleName&&e.businessUnitId===n.businessUnitId);o&&await Xf({userId:o.id,message:`${n.name} submitted a new report.`,type:"reminder",link:"/manage-reports",actionType:"ACKNOWLEDGE_REPORT",targetId:i.id,actors:[{id:n.id,name:n.name}],isCrucial:!0});const c=users.filter(e=>"Director"===e.roleName&&e.status===et.ACTIVE);return c.length>0&&await Promise.all(c.map(e=>Xf({userId:e.id,message:`${n.name} submitted a new report${n.businessUnitName?` (${n.businessUnitName})`:""}.`,type:"info",link:"/director-dashboard",actionType:"ACKNOWLEDGE_REPORT",targetId:i.id,actors:[{id:n.id,name:n.name}],isCrucial:i.isLate}))),i})(r),s("EOD report submitted successfully!","success"),t.submittedOnWeekOff&&s("Report submitted for your weekly off day. Thank you!","info"),n&&n(t),a("/my-reports",{replace:!0})}t&&ih(e.id)}catch(d){C(`Failed to ${c?"update":"submit"} report: ${d.message}`)}finally{D(!1)}},className:"space-y-2",children:[!c&&We.jsx("div",{className:"flex justify-end mb-2",children:We.jsx(_h,{type:"button",variant:"ghost",onClick:async()=>{C(""),B(null),T("");const t=await Of(e.id);if(t.length>0){const e=t.sort((e,t)=>t.submittedAt-e.submittedAt)[0].versions.sort((e,t)=>t.versionNumber-e.versionNumber)[0];e?(g(e.tasksCompleted),y(e.challengesFaced||""),v(e.planForTomorrow||""),w([]),E(!0),s("Report content copied. Please update details.","info")):C("Could not find content in the most recent report.")}else C("No previous reports found to copy from.")},icon:We.jsx("i",{className:"fas fa-copy"}),size:"sm",children:"Copy Previous Report"})}),We.jsx(Ch,{label:"Report Date",id:"report-date",type:"text",value:Wt(m),required:!0,disabled:!0,wrapperClassName:"mb-4"}),!c&&We.jsxs(Ih,{title:"Your Pending Tasks",titleIcon:We.jsx("i",{className:"fas fa-clipboard-list text-indigo-500"}),className:"mb-6",children:[We.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mb-3",children:'Quickly update your tasks. "Completed" tasks will be added to your report automatically.'}),ee?We.jsx(Ph,{message:"Loading tasks..."}):0===Q.length?We.jsx("p",{className:"text-center text-text-secondary dark:text-slate-400 py-4 italic",children:"You have no pending tasks. Great job!"}):We.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto pr-2 -mr-2",children:Q.map(t=>We.jsxs("div",{className:"p-2 border dark:border-slate-700 rounded-lg flex items-center justify-between gap-4 bg-white dark:bg-slate-800/60 shadow-sm",children:[We.jsxs("div",{className:"flex-grow",children:[We.jsx("p",{className:"font-medium text-slate-800 dark:text-slate-200",children:t.title}),We.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:["Due: ",Wt(t.dueDate)]})]}),We.jsx("div",{className:"flex-shrink-0",children:We.jsx(Oh,{options:Object.values(at).filter(e=>e!==at.Blocked).map(e=>({value:e,label:e})),value:t.status,onChange:n=>(async(t,n)=>{if(!Q.find(e=>e.id===t))return;const a=[...Q],r=Q.map(e=>e.id===t?{...e,status:n}:e);X(r),n===at.Completed?ae(e=>new Set(e).add(t)):ae(e=>{const n=new Set(e);return n.delete(t),n});try{await Bf(t,{status:n},e),s(`Task status updated to "${n}"`,"success")}catch(i){X(a),s("Failed to update task status.","error"),n===at.Completed&&ae(e=>{const n=new Set(e);return n.delete(t),n})}})(t.id,n.target.value),wrapperClassName:"!mb-0",className:"!mt-0 !text-xs !py-1 w-32"})})]},t.id))})]}),ie("tasksCompleted","Tasks Completed Today (Manual Entry)",f,e=>g(e.target.value),"Optionally add any other tasks you completed today that were not in your task list...",!c&&0===ne.size),ie("challengesFaced","Challenges Faced (Optional)",x,e=>y(e.target.value),"Any roadblocks or issues encountered?"),ie("planForTomorrow","Plan for Tomorrow (Optional)",b,e=>v(e.target.value),"What are your key priorities for the next working day?"),We.jsxs("div",{className:"pt-2",children:[We.jsx("label",{className:"block text-sm font-medium text-text-primary dark:text-dark-text-primary mb-1",children:"Upload Photos, Screenshots, or Documents (optional)"}),We.jsxs("div",{className:"flex items-center space-x-2",children:[We.jsxs("label",{htmlFor:"attachments-input",className:"cursor-pointer inline-flex items-center px-4 py-2 border border-border-primary dark:border-dark-border rounded-md shadow-sm text-sm font-medium text-text-primary dark:text-dark-text-primary bg-white dark:bg-dark-surface-secondary hover:bg-surface-hover dark:hover:bg-dark-surface-hover focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary "+(ce||N.length>=3?"opacity-50 cursor-not-allowed":""),children:[We.jsx("i",{className:"fas fa-upload mr-2"})," Choose Files"]}),We.jsx(_h,{type:"button",onClick:()=>{N.length>=3?T("You can upload a maximum of 3 files."):Y(!0)},variant:"outline",disabled:ce||N.length>=3,icon:We.jsx("i",{className:"fas fa-camera"}),children:"Take Photo"})]}),We.jsx("input",{ref:V,type:"file",id:"attachments-input",multiple:!0,accept:".jpg, .jpeg, .png, .pdf, .docx",onChange:async e=>{T("");const t=e.target.files;if(!t)return;if(N.length+t.length>3)return T("You can upload a maximum of 3 files."),void(V.current&&(V.current.value=""));T("Uploading files to secure storage...");const n=[];for(let s=0;s<t.length;s++){const e=t[s];if(!tx.includes(e.type))return T(`File type not allowed: ${e.name}. Allowed: JPG, PNG, PDF, DOCX.`),void(V.current&&(V.current.value=""));const a=Gh(e,(null==i?void 0:i.id)||se).then(e=>({name:e.name,type:e.type,size:e.size,storageUrl:e.storageUrl,storagePath:e.storagePath})).catch(t=>{throw new Error(`Failed to upload ${e.name}`)});n.push(a)}try{const e=await Promise.all(n);w(t=>[...t,...e]),T(""),s(`${e.length} file(s) uploaded successfully`,"success")}catch(a){T(a.message||"Error uploading one or more files.")}V.current&&(V.current.value="")},className:"hidden","aria-describedby":"attachments-help attachments-error",disabled:ce||N.length>=3}),We.jsxs("p",{id:"attachments-help",className:"mt-1 text-xs text-text-secondary dark:text-dark-text-secondary",children:["Attach proof of work, screenshots, or reports if needed. Max ",3," files (JPG, PNG, PDF, DOCX).",We.jsx("br",{}),"A submitted report can be edited only ",We.jsx("strong",{children:"once"}),", within ",We.jsx("strong",{children:"2 hours"})," of the initial submission. All edits are logged."]}),_&&We.jsx("p",{id:"attachments-error",className:"mt-1 text-xs text-red-600 font-semibold",children:_}),N.length>0&&We.jsxs("div",{className:"mt-3 space-y-2",children:[We.jsxs("p",{className:"text-sm font-medium text-text-primary dark:text-dark-text-primary",children:["Selected files (",N.length,"/",3,"):"]}),N.map((e,t)=>We.jsxs("div",{className:"flex items-center justify-between p-2 border rounded-md bg-gray-50 dark:bg-dark-surface-secondary text-sm",children:[We.jsxs("div",{className:"flex items-center space-x-2 overflow-hidden",children:[e.type.startsWith("image/")?We.jsx("img",{src:e.dataUrl,alt:e.name,className:"w-8 h-8 object-cover rounded flex-shrink-0"}):We.jsx("i",{className:`fas ${"application/pdf"===e.type?"fa-file-pdf text-red-500":e.type.includes("wordprocessingml")?"fa-file-word text-blue-500":"fa-file-alt text-gray-500"} text-lg flex-shrink-0 w-6 text-center`}),We.jsx("span",{className:"truncate text-text-primary dark:text-dark-text-primary",title:e.name,children:e.name}),We.jsxs("span",{className:"text-xs text-text-secondary dark:text-dark-text-secondary flex-shrink-0",children:["(",(e.size/1024).toFixed(1)," KB)"]})]}),We.jsx("button",{type:"button",onClick:()=>{return t=e.name,w(e=>e.filter(e=>e.name!==t)),void T("");var t},className:"text-red-500 hover:text-red-700 p-1",title:`Remove ${e.name}`,"aria-label":`Remove ${e.name}`,disabled:ce,children:We.jsx("i",{className:"fas fa-times-circle"})})]},t))]})]}),We.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[We.jsx(_h,{type:"button",variant:"ghost",onClick:()=>a("/my-reports",{replace:!0}),children:"Cancel"}),We.jsx(_h,{type:"submit",variant:"primary",isLoading:I,size:"lg",disabled:ce,children:I?c?"Updating...":"Submitting...":c?"Update Report":"Submit Report"})]})]}),c&&i&&oe&&We.jsxs("div",{className:"mt-4 p-3 bg-gray-50 dark:bg-dark-surface-secondary rounded text-xs text-gray-600 dark:text-dark-text-secondary",children:[We.jsxs("p",{children:["Report Date: ",Wt(i.date)]}),We.jsxs("p",{children:["Initial Submission: ",qt(i.submittedAt)]}),We.jsxs("p",{children:["Number of Versions: ",i.versions.length," / ",2]}),i.isLate&&We.jsx("p",{className:"font-semibold text-orange-600 dark:text-orange-400",children:"This was a late submission."}),i.submittedOnWeekOff&&We.jsx("p",{className:"font-semibold text-blue-600 dark:text-blue-400",children:"This report was submitted on a weekly off day."}),oe.isCopied&&We.jsx("p",{className:"font-semibold text-teal-700 dark:text-teal-400",children:"This version's content was based on a copied report."}),ce&&We.jsx("p",{className:"font-bold text-red-600 dark:text-red-400",children:S||"Editing is locked for this report."})]})]})]})},sx=({isOpen:e,onClose:t,currentUser:n,onLeaveManaged:a})=>{const[s,r]=l.useState([]),[i,o]=l.useState(""),[c,d]=l.useState(""),[u,m]=l.useState(""),[p,f]=l.useState(!1),[h,g]=l.useState(null),[x,y]=l.useState(null),b=l.useCallback(async()=>{if(!n)return;f(!0);const e=await ph(n.id),t=Ht(new Date);r(e.filter(e=>e.date>=t&&e.status===it.APPROVED).sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime())),f(!1)},[n]);l.useEffect(()=>{e&&(b(),o(""),d(""),m(""),g(null))},[e,b]);const v=()=>Ht(new Date);return We.jsxs(We.Fragment,{children:[We.jsx(Dh,{isOpen:e,onClose:t,title:"Manage My Leave",size:"lg",footer:We.jsx(_h,{onClick:t,variant:"ghost",children:"Close"}),children:We.jsxs("div",{className:"space-y-6",children:[h&&We.jsx(Th,{type:h.type,message:h.message,onClose:()=>g(null)}),We.jsxs("div",{className:"p-4 border dark:border-slate-700 rounded-md bg-gray-50 dark:bg-slate-800/50",children:[We.jsx("h3",{className:"text-lg font-semibold text-primary dark:text-sky-400 mb-3",children:"Schedule Future Leave(s)"}),We.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-3",children:[We.jsx(Ch,{label:"Select Start Date",type:"date",value:i,onChange:e=>o(e.target.value),min:v(),required:!0}),We.jsx(Ch,{label:"Select End Date (Optional)",type:"date",value:c,onChange:e=>d(e.target.value),min:i||v()})]}),We.jsx(Yh,{label:"Reason for Leave(s)",value:u,onChange:e=>m(e.target.value),placeholder:"Enter reason for your future leave(s)...",rows:2,wrapperClassName:"mb-3",required:!0}),We.jsx(_h,{onClick:async()=>{if(!i||!u.trim())return void g({type:"error",message:"Future leave start date and reason are required."});const e=Ht(new Date);if(i<e)return void g({type:"error",message:"Future leave start date cannot be in the past."});if(c&&c<i)return void g({type:"error",message:"End date cannot be before start date."});g(null),f(!0);const t=new Date(i+"T00:00:00"),s=c?new Date(c+"T00:00:00"):t;let r=new Date(t),l=0,p=0;const h=[],x=await _f(n.id);for(;r<=s;){const e=Ht(r);if(x&&Zt(r,x.weeklyOffDay))p++;else try{await qf(n.id,e,u,n),l++}catch(v){v.message.includes("already exists")?p++:h.push(`Failed for ${Wt(e)}: ${v.message}`)}r.setDate(r.getDate()+1)}let y="";l>0&&(y+=`${l} leave day(s) scheduled. `),p>0&&(y+=`${p} day(s) skipped (e.g., weekly off or already on leave). `),h.length>0&&(y+=`Errors: ${h.join(", ")}.`),l>0&&0===h.length?g({type:"success",message:y.trim()}):l>0&&h.length>0?g({type:"warning",message:y.trim()}):h.length>0?g({type:"error",message:y.trim()||"Failed to schedule any leaves."}):p>0&&0===l&&0===h.length&&g({type:"info",message:y.trim()||"No new leave days scheduled (e.g., all were weekly offs or already on leave)."}),o(""),d(""),m(""),await b(),a(),f(!1)},variant:"primary",isLoading:p,disabled:p,children:p?"Scheduling...":"Schedule Leave(s)"}),We.jsx("p",{className:"text-xs text-gray-500 dark:text-slate-400 mt-2",children:"If end date is not selected, only the start date will be scheduled. Leaves will not be scheduled on your weekly off days."})]}),We.jsxs("div",{children:[We.jsx("h3",{className:"text-lg font-semibold text-primary dark:text-sky-400 mb-3",children:"Your Scheduled Leaves"}),p&&!s.length?We.jsx(Ph,{message:"Loading scheduled leaves..."}):0===s.length?We.jsx("p",{className:"text-mediumtext dark:text-slate-400 italic text-center py-4",children:"You have no future leaves scheduled."}):We.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2 pr-2",children:s.map(e=>We.jsxs("div",{className:"p-3 border dark:border-slate-700/50 rounded-md flex justify-between items-center bg-white dark:bg-slate-800 shadow-sm",children:[We.jsxs("div",{children:[We.jsx("p",{className:"font-semibold dark:text-slate-200",children:Wt(e.date)}),We.jsxs("p",{className:"text-sm text-gray-600 dark:text-slate-300",children:["Reason: ",e.reason]})]}),We.jsx(_h,{variant:"danger",size:"sm",onClick:()=>y(e),isLoading:p,disabled:p,icon:We.jsx("i",{className:"fas fa-times-circle"}),children:"Cancel"})]},e.id))})]})]})}),We.jsxs(Lh,{isOpen:!!x,onClose:()=>y(null),onConfirm:async()=>{if(x){g(null),f(!0);try{await Hf(x.id,n)?(g({type:"success",message:"Future leave cancelled successfully."}),await b(),a()):g({type:"error",message:"Failed to cancel future leave."})}catch(e){g({type:"error",message:e.message||"Failed to cancel future leave."})}finally{f(!1),y(null)}}},title:"Confirm Leave Cancellation",confirmButtonVariant:"danger",confirmText:"Yes, Cancel Leave",children:[We.jsxs("p",{children:["Are you sure you want to cancel your leave for ",We.jsx("strong",{children:x?Wt(x.date):""}),"?"]}),We.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"This action cannot be undone."})]})]})},rx=({earnedBadges:e})=>{const t=(t,n)=>{const a=e.find(e=>e.badgeType===t);return a?`${n.earnedTooltipText} (Earned on ${Wt(a.earnedDate)})`:n.defaultTooltip};return We.jsxs(Ih,{title:" My Performance Badges",titleIcon:We.jsx("i",{className:"fas fa-award"}),className:"mt-6",children:[We.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(zt).map(([n,a])=>{const s=n,r=e.some(e=>e.badgeType===s),i=r?(t=>{const n=e.filter(e=>e.badgeType===t).sort((e,t)=>new Date(t.earnedDate).getTime()-new Date(e.earnedDate).getTime());return n.length>0?n[0].earnedDate:null})(s):null;return We.jsxs("div",{title:t(s,a),className:"p-4 rounded-lg shadow-md flex flex-col items-center text-center transition-all duration-300 ease-in-out transform hover:scale-105\n                "+(r?"bg-gradient-to-br from-amber-300 to-amber-500 text-amber-900":"bg-slate-100 dark:bg-slate-800 text-slate-500 dark:text-slate-400 opacity-70"),children:[We.jsx("span",{className:"text-5xl mb-2","aria-hidden":"true",children:a.icon}),We.jsx("h4",{className:"text-md font-semibold "+(r?"text-amber-800":"text-slate-700 dark:text-slate-300"),children:a.title}),r&&i?We.jsxs("p",{className:"text-xs mt-1",children:["Earned: ",Wt(i)]}):We.jsx("p",{className:"text-xs mt-1 italic",children:"Not yet earned"})]},s)})}),We.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-500 mt-4 text-center",children:"Hover over a badge to see how to earn it or when you earned it. Keep up the great work!"})]})},ix=({tasks:e,currentUser:t,onUpdateTask:n,onViewTask:a})=>{const s=l.useMemo(()=>e.filter(e=>e.pinnedBy.includes(t.id)).sort((e,t)=>new Date(e.dueDate).getTime()-new Date(t.dueDate).getTime()),[e,t.id]);return We.jsx(Ih,{title:" Pinned Tasks",titleIcon:We.jsx("i",{className:"fas fa-thumbtack"}),children:s.length>0?We.jsx("div",{className:"space-y-3 max-h-80 overflow-y-auto pr-2 animate-fade-in-up",children:s.map(s=>We.jsx("div",{onClick:()=>a(s),className:"p-3 bg-slate-50 dark:bg-slate-800/60 rounded-lg shadow-sm hover:shadow-md transition-all duration-200 ease-in-out cursor-pointer border-l-4 border-amber-400 dark:border-amber-500 hover:-translate-y-1",children:We.jsxs("div",{className:"flex justify-between items-start",children:[We.jsxs("div",{children:[We.jsx("p",{className:"font-semibold text-primary dark:text-sky-400 truncate pr-2",children:s.title}),We.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:["Due: ",Wt(s.dueDate)]})]}),We.jsx("button",{onClick:a=>((a,s)=>{a.stopPropagation();const r=e.find(e=>e.id===s);if(r){const e=r.pinnedBy.filter(e=>e!==t.id);n(s,{pinnedBy:e})}})(a,s.id),className:"p-1 text-amber-500 hover:text-amber-700 dark:hover:text-amber-300 transition-colors",title:"Unpin Task","aria-label":"Unpin Task",children:We.jsx("i",{className:"fas fa-thumbtack"})})]})},s.id))}):We.jsx(gg,{icon:We.jsx("i",{className:"fas fa-thumbtack"}),title:"No Pinned Tasks",message:"Pin up to 5 tasks to see them here for quick access. Click the pin icon on any task!"})})},lx=({currentUser:e})=>We.jsxs("div",{className:"p-6 rounded-xl bg-gradient-to-br from-primary to-secondary shadow-lg text-white transform hover:-translate-y-1 transition-transform duration-300",children:[We.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center",children:[We.jsxs("div",{children:[We.jsxs("h2",{className:"text-3xl font-bold",children:[(()=>{const e=(new Date).getHours();return e<12?"Good Morning":e<18?"Good Afternoon":"Good Evening"})(),", ",e.name.split(" ")[0],"!"]}),We.jsx("p",{className:"mt-1 text-blue-200",children:"Welcome to your dashboard. Here are your quick actions."})]}),We.jsx("div",{className:"mt-4 md:mt-0",children:We.jsxs(_h,{to:"/meetings",variant:"outline",className:"!text-white !border-white/50 hover:!bg-white/10 !px-6 !py-3 animate-pulse-slow",children:[We.jsx("i",{className:"fas fa-users-class mr-3 text-xl"}),We.jsx("span",{className:"font-semibold text-lg",children:"My Meetings"})]})})]}),We.jsxs("div",{className:"mt-6 pt-4 border-t border-white/20 grid grid-cols-1 sm:grid-cols-3 gap-3",children:[We.jsxs(_h,{to:"/submit-eod/today",variant:"outline",className:"!text-white !border-white/50 hover:!bg-white/10 w-full justify-center",children:[We.jsx("i",{className:"fas fa-paper-plane mr-2"})," Submit EOD"]}),We.jsxs(_h,{to:"/my-tasks",variant:"outline",className:"!text-white !border-white/50 hover:!bg-white/10 w-full justify-center",children:[We.jsx("i",{className:"fas fa-tasks mr-2"})," View Tasks"]}),We.jsxs(_h,{to:"/calendar-view",variant:"outline",className:"!text-white !border-white/50 hover:!bg-white/10 w-full justify-center",children:[We.jsx("i",{className:"fas fa-calendar-alt mr-2"})," My Calendar"]})]})]}),ox=({currentUser:e,onManageFutureLeave:t,onLeaveUpdated:n})=>{const{addToast:a}=bh(),[s,r]=l.useState(null),[i,o]=l.useState(!1),[c,d]=l.useState(!0),[u,m]=l.useState(!1),[p,f]=l.useState(null),[h,g]=l.useState(""),[x,y]=l.useState(!1),b=Ht(new Date),v=l.useMemo(()=>!!e.weeklyOffDay&&Zt(new Date,e.weeklyOffDay),[e.weeklyOffDay]),N=l.useCallback(async()=>{d(!0);const[t,n]=await Promise.all([Wf(e.id,b),jf(e.id)]);r(t);const a=n.some(e=>e.type===dt.LEAVE_REVOKED_BY_EMPLOYEE&&e.targetName===b);o(a),d(!1)},[e.id,b]);l.useEffect(()=>{N()},[N]);const w=e=>{"mark"!==e||h.trim()?"mark"===e&&v?y(!0):(f(e),m(!0)):a("Please provide a reason for your leave first.","warning")};return We.jsxs(We.Fragment,{children:[We.jsx(Ih,{title:"Leave Management",titleIcon:We.jsx("i",{className:"fas fa-plane-departure"}),children:We.jsxs("div",{className:"space-y-4",children:[c?We.jsx("div",{className:"h-20 flex items-center justify-center",children:We.jsx("div",{className:"w-6 h-6 border-2 border-dashed rounded-full animate-spin border-primary"})}):s?We.jsxs("div",{className:"text-center p-4 bg-emerald-50 dark:bg-emerald-900/30 rounded-lg",children:[We.jsx("p",{className:"font-semibold text-emerald-600 dark:text-emerald-400 mb-2",children:"You are marked as on leave today."}),i?We.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"You have already used your one-time revoke for today."}):We.jsx(_h,{variant:"warning",onClick:()=>w("revoke"),size:"sm",children:"Clicked by mistake? Revoke Leave"})]}):i?We.jsx("div",{className:"text-center p-4 bg-slate-100 dark:bg-slate-800 rounded-lg",children:We.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"You have already marked and revoked leave today."})}):We.jsxs("div",{className:"space-y-3",children:[We.jsx(Ch,{label:"Reason for today's leave",placeholder:"E.g., Sick leave, Personal appointment",value:h,onChange:e=>g(e.target.value),wrapperClassName:"!mb-0"}),We.jsx(_h,{variant:"primary",onClick:()=>w("mark"),className:"w-full",disabled:!h.trim(),children:"Mark Today as Leave"})]}),We.jsx("div",{className:"text-center pt-2 border-t border-slate-200 dark:border-slate-700/50",children:We.jsx("button",{onClick:t,className:"text-sm text-primary dark:text-sky-400 hover:underline",children:"Schedule or Cancel Future Leaves"})})]})}),We.jsx(Lh,{isOpen:u,onClose:()=>m(!1),onConfirm:"mark"===p?async()=>{if(h.trim()){d(!0);try{await qf(e.id,b,h,e),a(`Leave marked for ${Wt(b)}`,"success"),n(),await N(),g("")}catch(t){a(t.message||"Failed to mark leave.","error")}finally{d(!1),m(!1)}}else a("A reason is required to mark today as leave.","error")}:async()=>{if(s){d(!0);try{await Hf(s.id),a(`Leave for ${Wt(b)} has been revoked.`,"info"),n(),await N()}catch(e){a(e.message||"Failed to revoke leave.","error")}finally{d(!1),m(!1)}}},title:"mark"===p?"Confirm Mark Leave":"Confirm Revoke Leave",confirmButtonVariant:"mark"===p?"primary":"danger",confirmText:"mark"===p?"Yes, Mark Leave":"Yes, Revoke",children:"mark"===p?We.jsxs("p",{children:["Are you sure you want to mark today, ",Wt(b),', as a leave day with the reason: "',h,'"?']}):We.jsxs(We.Fragment,{children:[We.jsx("p",{children:"Are you sure you want to revoke your leave for today? Your manager will be notified."}),We.jsx("p",{className:"font-semibold text-amber-600 dark:text-amber-400 mt-2",children:"Note: You can only revoke a leave once per day."})]})}),We.jsx(Lh,{isOpen:x,onClose:()=>y(!1),onConfirm:()=>y(!1),title:"Cannot Submit Leave",confirmButtonVariant:"primary",confirmText:"OK",children:We.jsx("p",{children:"You cannot submit leave on a weekly off day. Please select a valid working day."})})]})},cx=()=>{const{currentUser:e}=Eh(),[t,n]=l.useState([]),[a,s]=l.useState([]),[r,i]=l.useState([]),[o,c]=l.useState(!0),[u,m]=l.useState(!1),f=d(),h=l.useCallback(async()=>{if(e&&"Employee"===e.roleName){const t=performance.now(),[a,r,l]=await Promise.all([Lf(),Kf(e.id),jf(e.id)]),o=(performance.now(),a.filter(t=>t.assignedTo.includes(e.id)||t.isPersonalTask&&t.createdBy===e.id));n(o),i(r);const c=performance.now(),d=l.map(t=>lh(t,e)),u=await Promise.all(d);performance.now();s(u.sort((e,t)=>t.timestamp-e.timestamp).slice(0,15));performance.now()}},[e]);l.useEffect(()=>{if(!(null==e?void 0:e.id))return;c(!0),h().finally(()=>c(!1));const t=[pt,bt,ht,xt,yt+e.id,wt],n=tn.on("appDataChanged",e=>{const n=null==e?void 0:e.keyChanged;t.some(e=>null==n?void 0:n.startsWith(e))&&h()});return()=>n()},[null==e?void 0:e.id,h]);return e?o?We.jsx(Ah,{children:We.jsx(Ph,{message:"Loading your dashboard..."})}):We.jsxs(We.Fragment,{children:[We.jsx(Ah,{children:We.jsxs("div",{className:"space-y-6",children:[We.jsx(lx,{currentUser:e}),We.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-6",children:[We.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[We.jsx(ix,{tasks:t,currentUser:e,onUpdateTask:async(t,n)=>{e&&await Bf(t,n,e)},onViewTask:e=>f(`/my-tasks?taskId=${e.id}`)}),We.jsx(ox,{currentUser:e,onManageFutureLeave:()=>m(!0),onLeaveUpdated:h})]}),We.jsx("div",{className:"lg:col-span-2",children:We.jsx(Qh,{title:"Your Recent Activity",events:a,isLoading:o,maxHeight:"max-h-96"})})]}),We.jsx(rx,{earnedBadges:r}),We.jsx(xg,{})]})}),We.jsx(sx,{isOpen:u,onClose:()=>m(!1),currentUser:e,onLeaveManaged:h})]}):We.jsx(p,{to:"/login"})},dx=()=>{const{currentUser:e}=Eh();return e?We.jsx(Ah,{title:"My EOD Reports",children:We.jsx(ex,{currentUser:e})}):We.jsx(p,{to:"/login"})},ux=()=>{const{currentUser:e}=Eh(),{forDate:t}=h();if(!e)return We.jsx(p,{to:"/login"});const n="today"!==t&&t&&/^\d{4}-\d{2}-\d{2}$/.test(t)?t:Ht(new Date);return We.jsx(Ah,{children:We.jsx(ax,{currentUser:e,reportDate:n})})},mx=()=>{const{currentUser:e}=Eh();return e?We.jsx(Ah,{children:We.jsx(ax,{currentUser:e,reportDate:""})}):We.jsx(p,{to:"/my-reports"})},px=()=>{const{currentUser:e}=Eh(),[t,n]=l.useState([]),[a,s]=l.useState([]),[r,i]=l.useState([]),[o,c]=l.useState(!0),d=l.useCallback(async()=>{if(e){const[t,a,r]=await Promise.all([Of(e.id),ph(e.id),dh(e.id)]);n(t),s(a),i(r)}},[e]);return l.useEffect(()=>{c(!0),d().finally(()=>c(!1))},[d]),e?o?We.jsx(Ah,{title:"My Calendar",children:We.jsx(Ph,{message:"Loading calendar data..."})}):We.jsx(Ah,{title:"My Calendar",children:We.jsx(Tg,{reports:t,meetings:r,currentUser:e,leaveRecords:a,onReportUpdate:d})}):null},fx=({task:e,size:t="default"})=>{if("Team Task"!==e.taskType||!e.memberProgress)return We.jsx("div",{className:"text-xs text-gray-500 italic",children:"N/A for this task type"});const n=e.assignedTo.length;if(0===n)return We.jsx("div",{className:"text-xs text-gray-500 italic",children:"No members assigned"});const a=Object.values(e.memberProgress).filter(e=>e.status===at.Completed).length,s=n>0?Math.round(a/n*100):0;return"compact"===t?We.jsxs("div",{className:"w-full",children:[We.jsxs("div",{className:"flex justify-between items-center text-xs mb-0.5",children:[We.jsx("span",{className:"font-semibold text-gray-600",children:"Progress"}),We.jsxs("span",{className:"font-bold text-primary",children:[s,"%"]})]}),We.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:We.jsx("div",{className:"bg-primary h-1.5 rounded-full",style:{width:`${s}%`}})}),We.jsxs("div",{className:"text-xs text-right text-gray-500 mt-0.5",children:[a,"/",n]})]}):We.jsxs("div",{className:"w-full",children:[We.jsxs("div",{className:"flex justify-between items-center text-xs mb-1",children:[We.jsx("span",{className:"font-semibold text-gray-600",children:"Team Progress"}),We.jsxs("span",{className:"font-bold text-primary",children:[s,"%"]})]}),We.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700",children:We.jsx("div",{className:"bg-primary h-2.5 rounded-full",style:{width:`${s}%`}})}),We.jsxs("div",{className:"text-xs text-right text-gray-500 mt-1",children:[a," of ",n," completed"]})]})},{Link:hx}=m,gx=({tasks:e,currentUser:t,onViewTask:n,onEditTask:a,onUpdateTask:s,onDeleteTask:r,isManagerView:i=!1,onBatchDelete:o,onBatchChangeStatus:c,onBatchChangeDueDate:d,onBatchReassign:u,meetingsMap:m=new Map,currentPage:p,onPageChange:f})=>{const{addToast:h}=bh(),{hasPermission:g}=Eh(),[x,y]=l.useState({key:"dueDate",direction:"asc"}),[b,v]=l.useState([]),[N,w]=l.useState(!0),[k,E]=l.useState(new Set),j=l.useMemo(()=>e.filter(e=>e.pinnedBy.includes(t.id)).length,[e,t.id]);l.useEffect(()=>{E(new Set);(async()=>{v(await Cf())})()},[e]);const C=e=>{const t={[st.Direct]:"bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-300",[st.Team]:"bg-purple-100 text-purple-800 dark:bg-purple-900/50 dark:text-purple-300",[st.Personal]:"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300"};return We.jsx("span",{className:`px-2 py-0.5 text-xs font-semibold rounded-full ${t[e]}`,children:e})},_=l.useMemo(()=>[...e].sort((e,n)=>{const a=e.pinnedBy.includes(t.id),s=n.pinnedBy.includes(t.id);if(a&&!s)return-1;if(!a&&s)return 1;const r=e[x.key],i=n[x.key];return r<i?"asc"===x.direction?-1:1:r>i?"asc"===x.direction?1:-1:0}),[e,x,t.id]),T=l.useMemo(()=>N?_:_.filter(e=>e.status!==at.Completed),[_,N]),S=Math.ceil(T.length/10),A=l.useMemo(()=>{const e=10*(p-1);return T.slice(e,e+10)},[T,p]);l.useEffect(()=>{f(1),E(new Set)},[e,N]);const I=Object.values(at).map(e=>({value:e,label:e}));return 0===e.length?We.jsx(gg,{icon:We.jsx("i",{className:"fas fa-check-double"}),title:"All Tasks Cleared!",message:"You have no tasks in this view. Great job staying on top of your work!"}):We.jsxs("div",{children:[i&&k.size>0&&We.jsxs("div",{className:"fixed bottom-4 right-4 z-30 flex items-center space-x-2 p-3 bg-surface-primary dark:bg-dark-surface-primary rounded-lg shadow-lg border border-primary dark:border-sky-500",children:[We.jsxs("span",{className:"text-sm font-semibold text-primary dark:text-sky-400",children:[k.size," selected"]}),We.jsx(_h,{size:"sm",variant:"secondary",onClick:()=>u&&u(Array.from(k)),icon:We.jsx("i",{className:"fas fa-user-friends"}),children:"Reassign"}),We.jsx(_h,{size:"sm",variant:"secondary",onClick:()=>d&&d(Array.from(k)),icon:We.jsx("i",{className:"fas fa-calendar-alt"}),children:"Due Date"}),We.jsx(_h,{size:"sm",variant:"secondary",onClick:()=>c&&c(Array.from(k),at.Completed),icon:We.jsx("i",{className:"fas fa-check-circle"}),children:"Complete"}),We.jsx(_h,{size:"sm",variant:"danger",onClick:()=>o&&o(Array.from(k)),icon:We.jsx("i",{className:"fas fa-trash"}),children:"Delete"})]}),We.jsx("div",{className:"flex justify-end mb-2",children:We.jsxs(_h,{onClick:()=>w(!N),variant:"ghost",size:"sm",icon:We.jsx("i",{className:"fas "+(N?"fa-eye-slash":"fa-eye")}),children:[N?"Hide":"Show"," Completed"]})}),We.jsx("div",{className:"overflow-x-auto",children:We.jsxs("table",{className:"min-w-full divide-y divide-border-primary dark:divide-dark-border",children:[We.jsx("thead",{className:"bg-surface-secondary dark:bg-dark-surface-secondary",children:We.jsxs("tr",{children:[i&&We.jsx("th",{className:"px-4 py-2",children:We.jsx("input",{type:"checkbox",className:"rounded",onChange:()=>{k.size===A.length&&A.length>0?E(new Set):E(new Set(A.map(e=>e.id)))},checked:k.size===A.length&&A.length>0})}),We.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase",children:"Task"}),i&&We.jsx("th",{className:"px-4 py-2 text-left min-w-[200px] text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase",children:"Team Progress"}),We.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase",children:"Due Date"}),We.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase",children:i?"Overall Status":"My Stage"}),We.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase",children:"Priority"}),We.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase",children:"Pin"}),We.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase",children:"Actions"})]})}),We.jsxs("tbody",{className:"divide-y divide-border-primary dark:divide-dark-border",children:[0===A.length&&We.jsx("tr",{children:We.jsx("td",{colSpan:i?8:7,className:"py-4",children:We.jsx(gg,{icon:We.jsx("i",{className:"fas fa-search"}),title:"No Tasks Found",message:"No tasks matched your current filter criteria. Try adjusting your filters."})})}),A.map(r=>{var l,o;const c=i&&(g(Xe.CAN_EDIT_ANY_TASK_STATUS)||r.createdBy===t.id),d=r.pinnedBy.includes(t.id),u=!d&&j>=5,p=(e=>{switch(e){case nt.High:return{icon:"fas fa-arrow-up",color:"text-red-600 dark:text-red-400",text:"High"};case nt.Medium:return{icon:"fas fa-equals",color:"text-yellow-600 dark:text-amber-400",text:"Medium"};case nt.Low:return{icon:"fas fa-arrow-down",color:"text-green-600 dark:text-emerald-400",text:"Low"};default:return{icon:"fas fa-minus",color:"text-gray-500 dark:text-slate-400",text:"N/A"}}})(r.priority),f=i&&r.createdBy===t.id||!i&&r.isPersonalTask&&r.createdBy===t.id,x=r.meetingId?m.get(r.meetingId):null,y=r.status===at.Completed;return We.jsxs("tr",{className:`hover:bg-surface-hover dark:hover:bg-dark-surface-hover animate-fade-in-up transition-opacity ${d?"bg-yellow-50 dark:bg-yellow-500/10":""} ${y?"opacity-60":""}`,children:[i&&We.jsx("td",{className:"px-4 py-2",children:We.jsx("input",{type:"checkbox",className:"rounded",checked:k.has(r.id),onChange:()=>(e=>{const t=new Set(k);t.has(e)?t.delete(e):t.add(e),E(t)})(r.id)})}),We.jsxs("td",{className:"px-4 py-2 font-medium text-text-primary dark:text-dark-text cursor-pointer max-w-xs",onClick:()=>n(r),children:[We.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[We.jsx("p",{className:"truncate font-semibold text-primary dark:text-sky-400 "+(y?"line-through":""),children:r.teamName||Wd(r.title,b)}),C(r.taskType)]}),x&&We.jsx(hx,{to:`/meetings/${x.id}`,onClick:e=>e.stopPropagation(),className:"text-xs text-text-secondary dark:text-dark-text-secondary mb-1 cursor-pointer inline-block",children:We.jsxs("span",{className:"inline-flex items-center bg-purple-100 dark:bg-purple-900/50 text-purple-800 dark:text-purple-300 font-medium px-2 py-0.5 rounded-full hover:bg-purple-200 dark:hover:bg-purple-900",children:[We.jsx("i",{className:"fas fa-link mr-1.5"}),"From: ",x.title]})}),We.jsx("p",{className:"text-xs text-text-secondary dark:text-dark-text-secondary truncate",children:r.teamName?Wd(r.title,b):Wd(r.description,b)})]}),i&&We.jsx("td",{className:"px-4 py-2",children:We.jsx(fx,{task:r})}),We.jsx("td",{className:"px-4 py-2 text-sm text-text-secondary dark:text-dark-text-secondary",children:Wt(r.dueDate)}),We.jsx("td",{className:"px-4 py-2",children:c?We.jsx(Oh,{value:r.status,onChange:e=>s(r.id,{status:e.target.value}),options:I,onClick:e=>e.stopPropagation(),className:"!mt-0 !text-xs !py-1 w-32",wrapperClassName:"!mb-0"}):i?We.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full "+(r.status===at.Completed?"bg-green-100 text-green-700 dark:bg-green-900/50 dark:text-green-300":r.status===at.InProgress?"bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-300":r.status===at.Blocked?"bg-red-100 text-red-700 dark:bg-red-900/50 dark:text-red-300":"bg-gray-100 text-gray-700 dark:bg-slate-700 dark:text-slate-300"),children:r.status}):We.jsx(Oh,{value:r.taskType===st.Team?(null==(o=null==(l=r.memberProgress)?void 0:l[t.id])?void 0:o.status)||at.NotStarted:r.status,onChange:n=>(async(n,a)=>{const r=e.find(e=>e.id===n);r&&(r.taskType===st.Team?(await Gf(n,t.id,a,t),s(n,{})):s(n,{status:a}))})(r.id,n.target.value),options:I,className:"p-1 text-xs border rounded-md bg-surface-primary dark:bg-dark-surface-inset dark:border-dark-border focus:ring-primary focus:border-primary",onClick:e=>e.stopPropagation(),wrapperClassName:"!mb-0",disabled:y})}),We.jsx("td",{className:"px-4 py-2",children:We.jsxs("div",{className:`flex items-center justify-center ${p.color}`,children:[We.jsx("i",{className:`${p.icon} mr-1`}),We.jsx("span",{className:"text-sm font-medium",children:p.text})]})}),We.jsx("td",{className:"px-4 py-2 text-center",children:We.jsx("button",{type:"button",onClick:e=>{if(e.stopPropagation(),u)return void h("You can pin a maximum of 5 tasks.","warning");const n=d?r.pinnedBy.filter(e=>e!==t.id):[...r.pinnedBy,t.id];s(r.id,{pinnedBy:n})},className:"p-2 rounded-full w-10 h-10 flex items-center justify-center transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500 "+(u?"cursor-not-allowed opacity-50":""),title:d?"Unpin task":u?"Pin limit (5) reached":"Pin task","aria-label":d?"Unpin task":"Pin task","aria-pressed":d,disabled:u,children:We.jsx("span",{className:"text-xl transition-all "+(d?"transform scale-125":"opacity-100"),children:""})})}),We.jsx("td",{className:"px-4 py-2 text-right",children:We.jsxs("div",{className:"flex items-center justify-end space-x-1",children:[We.jsx(_h,{variant:"ghost",size:"sm",onClick:()=>n(r),children:"View"}),f&&We.jsx(_h,{variant:"secondary",size:"sm",onClick:()=>a(r),children:"Edit"})]})})]},r.id)})]})]})}),S>1&&We.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mt-6 pt-4 border-t border-border-primary dark:border-dark-border gap-4",children:[We.jsxs("span",{className:"text-sm text-text-secondary dark:text-dark-text-secondary",children:["Page ",p," of ",S,We.jsxs("span",{className:"hidden sm:inline",children:[" (",T.length," total tasks)"]})]}),We.jsxs("div",{className:"flex items-center",children:[We.jsx(_h,{onClick:()=>f(p-1),disabled:1===p,variant:"ghost",size:"sm",icon:We.jsx("i",{className:"fas fa-chevron-left"}),className:"mr-1","aria-label":"Previous Page",children:We.jsx("span",{className:"hidden md:inline",children:"Prev"})}),We.jsx("div",{className:"hidden md:flex items-center",children:(()=>{const e=[];if(S<=5){for(let t=1;t<=S;t++)e.push(We.jsx(_h,{onClick:()=>f(t),variant:t===p?"primary":"ghost",size:"sm",className:"mx-1 !p-0 w-8 h-8",children:t},t));return e}let t,n;e.push(We.jsx(_h,{onClick:()=>f(1),variant:1===p?"primary":"ghost",size:"sm",className:"mx-1 !p-0 w-8 h-8",children:"1"},1)),p<=3?(t=2,n=4):p>=S-2?(t=S-3,n=S-1):(t=p-1,n=p+1),t>2&&e.push(We.jsx("span",{className:"mx-1 self-center p-2",children:"..."},"start-ellipsis"));for(let a=t;a<=n;a++)e.push(We.jsx(_h,{onClick:()=>f(a),variant:a===p?"primary":"ghost",size:"sm",className:"mx-1 !p-0 w-8 h-8",children:a},a));return n<S-1&&e.push(We.jsx("span",{className:"mx-1 self-center p-2",children:"..."},"end-ellipsis")),e.push(We.jsx(_h,{onClick:()=>f(S),variant:S===p?"primary":"ghost",size:"sm",className:"mx-1 !p-0 w-8 h-8",children:S},S)),e})()}),We.jsx("div",{className:"flex md:hidden items-center",children:We.jsxs("span",{className:"px-2 text-sm",children:["Page ",p]})}),We.jsxs(_h,{onClick:()=>f(p+1),disabled:p===S,variant:"ghost",size:"sm",className:"ml-1","aria-label":"Next Page",children:[We.jsx("span",{className:"hidden md:inline mr-2",children:"Next"}),We.jsx("i",{className:"fas fa-chevron-right"})]})]})]})]})},{Link:xx}=m,yx=({status:e,tasks:t,allTasks:n,onDrop:a,onViewTask:s,onUpdateTask:r,allUsers:i,pinnedCount:o,meetingsMap:c})=>{const[d,u]=l.useState(!1),{currentUser:m}=Eh(),{addToast:p}=bh();return We.jsxs("div",{onDragOver:e=>{e.preventDefault(),u(!0)},onDragLeave:e=>{e.preventDefault(),u(!1)},onDrop:t=>{var s,r;t.preventDefault(),u(!1);const i=t.dataTransfer.getData("text/plain"),l=n.find(e=>e.id===i);if(!m||!l)return;let o;o=l.taskType===st.Team&&"Employee"===m.roleName?(null==(r=null==(s=l.memberProgress)?void 0:s[m.id])?void 0:r.status)||at.NotStarted:l.status,o!==e&&(l.taskType!==st.Team||"Employee"!==m.roleName||l.status!==at.Completed?a(i,e):p("This team task has already been marked as complete by the manager.","warning"))},className:"flex-1 min-w-[300px] rounded-xl p-2 transition-colors flex flex-col "+(d?"bg-primary-light dark:bg-sky-900/50":"bg-surface-secondary dark:bg-dark-bg"),children:[We.jsxs("h3",{className:`font-semibold p-3 rounded-lg text-center text-sm ${f=e,{[at.NotStarted]:"bg-slate-200 dark:bg-dark-surface-secondary border-b-4 border-slate-400 dark:border-slate-500 text-slate-700 dark:text-slate-200",[at.InProgress]:"bg-blue-200 dark:bg-blue-800/50 border-b-4 border-blue-500 dark:border-blue-500 text-blue-800 dark:text-blue-200",[at.Completed]:"bg-emerald-200 dark:bg-emerald-800/50 border-b-4 border-emerald-500 dark:border-emerald-500 text-emerald-800 dark:text-emerald-200",[at.Blocked]:"bg-red-200 dark:bg-red-800/50 border-b-4 border-red-500 dark:border-red-500 text-red-800 dark:text-red-200"}[f]}`,children:[e," (",t.length,")"]}),We.jsx("div",{className:"space-y-3 mt-2 h-[60vh] overflow-y-auto p-1 flex-grow",children:0===t.length?We.jsx("div",{className:"flex items-center justify-center h-full",children:We.jsx("p",{className:"text-xs text-text-secondary dark:text-dark-text-secondary italic p-4 text-center",children:"Drag tasks here or change their status to see them in this column."})}):t.map(e=>We.jsx(bx,{task:e,onViewTask:s,onUpdateTask:r,allUsers:i,pinnedCount:o,meetingsMap:c},e.id))})]});var f},bx=({task:e,onViewTask:t,onUpdateTask:n,allUsers:a,pinnedCount:s,meetingsMap:r})=>{const{currentUser:i,hasPermission:o}=Eh(),{addToast:c}=bh(),d=l.useMemo(()=>{var t,n;if(!i)return!1;if(o(Xe.CAN_EDIT_ANY_TASK_STATUS)||"Manager"===i.roleName&&e.createdBy===i.id)return!0;if("Employee"===i.roleName){if(e.taskType===st.Team){return(null==(n=null==(t=e.memberProgress)?void 0:t[i.id])?void 0:n.status)!==at.Completed&&e.status!==at.Completed}return e.status!==at.Completed}return!1},[e,i,o]),u=i&&e.pinnedBy.includes(i.id),m=e.meetingId?r.get(e.meetingId):null,p=e.status===at.Completed;return We.jsxs("div",{draggable:d,onDragStart:t=>{d?t.dataTransfer.setData("text/plain",e.id):t.preventDefault()},onClick:()=>t(e),className:`p-4 rounded-lg shadow-sm border dark:border-dark-border ${d?"cursor-grab":"cursor-pointer"} hover:shadow-lg dark:hover:border-slate-500 transition-all duration-200 ease-in-out ${u?"border-l-4 border-amber-400":""} animate-fade-in-up ${p?"opacity-70 bg-emerald-50 dark:bg-emerald-900/20":"bg-surface-primary dark:bg-dark-surface-primary"}`,children:[We.jsxs("div",{className:"flex justify-between items-start mb-2",children:[We.jsx("p",{className:"font-semibold text-text-primary dark:text-dark-text text-sm pr-2",children:e.teamName||Wd(e.title,a)}),We.jsx("button",{onClick:t=>{if(t.stopPropagation(),!i)return;const a=e.pinnedBy.includes(i.id);if(!a&&s>=5)return void c("You can pin a maximum of 5 tasks.","warning");const r=a?e.pinnedBy.filter(e=>e!==i.id):[...e.pinnedBy,i.id];n(e.id,{pinnedBy:r})},className:"p-1 text-xl flex-shrink-0 transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-amber-500 rounded-full",title:u?"Unpin task":"Pin task","aria-label":u?"Unpin task":"Pin task","aria-pressed":u,children:We.jsx("span",{className:"transition-all duration-200 "+(u?"transform scale-125 opacity-100":"opacity-40 hover:opacity-100"),children:""})})]}),m&&We.jsx(xx,{to:`/meetings/${m.id}`,onClick:e=>e.stopPropagation(),className:"text-xs text-text-secondary dark:text-dark-text-secondary mb-2 cursor-pointer inline-block",children:We.jsxs("span",{className:"inline-flex items-center bg-purple-100 dark:bg-purple-900/50 text-purple-800 dark:text-purple-300 font-medium px-2 py-0.5 rounded-full hover:bg-purple-200 dark:hover:bg-purple-900",children:[We.jsx("i",{className:"fas fa-link mr-1.5"}),"From: ",m.title]})}),"Team Task"===e.taskType&&e.memberProgress&&We.jsx("div",{className:"mb-2",children:We.jsx(fx,{task:e})}),We.jsxs("div",{className:"flex justify-between items-center text-xs text-text-secondary dark:text-dark-text-secondary",children:[We.jsxs("span",{className:""+(new Date(e.dueDate+"T23:59:59")<new Date&&e.status!==at.Completed?"text-red-500 dark:text-red-400 font-semibold":""),children:[We.jsx("i",{className:"far fa-calendar-alt mr-1"}),Wt(e.dueDate)]}),We.jsxs("div",{className:"flex items-center gap-x-2",children:[(e=>{const t={[nt.High]:"bg-red-100 dark:bg-red-500/20 text-red-800 dark:text-red-300",[nt.Medium]:"bg-amber-100 dark:bg-amber-500/20 text-amber-800 dark:text-amber-300",[nt.Low]:"bg-emerald-100 dark:bg-emerald-500/20 text-emerald-800 dark:text-emerald-300"};return We.jsx("span",{className:`px-2 py-0.5 text-xs font-semibold rounded-full ${t[e]}`,children:e})})(e.priority),We.jsxs("div",{className:"flex -space-x-2",children:[e.assignedTo.slice(0,3).map(e=>{return We.jsx(Uh,{name:(t=e,(null==(n=a.find(e=>e.id===t))?void 0:n.name)||"Unknown"),size:"sm",className:"border-2 border-white dark:border-dark-surface-primary"},e);var t,n}),e.assignedTo.length>3&&We.jsxs("div",{className:"w-6 h-6 rounded-full bg-slate-300 dark:bg-slate-600 text-slate-700 dark:text-slate-200 text-xs flex items-center justify-center border-2 border-white dark:border-dark-surface-primary",children:["+",e.assignedTo.length-3]})]})]})]})]})},vx=({tasks:e,onUpdateTaskStatus:t,onViewTask:n,onUpdateTask:a,meetingsMap:s=new Map})=>{const[r,i]=l.useState([]),o=[at.NotStarted,at.InProgress,at.Blocked,at.Completed];l.useEffect(()=>{(async()=>{i(await Cf())})()},[]);const{currentUser:c}=Eh(),d=l.useMemo(()=>c?e.filter(e=>e.pinnedBy.includes(c.id)).length:0,[e,c]),u=l.useMemo(()=>c?[...e].sort((e,t)=>{const n=e.pinnedBy.includes(c.id),a=t.pinnedBy.includes(c.id);return n&&!a?-1:!n&&a?1:e.status===t.status?new Date(e.dueDate).getTime()-new Date(t.dueDate).getTime():0}):e,[e,c]),m=e=>u.filter(t=>{var n,a;if(t.taskType===st.Team&&c&&"Employee"===c.roleName){const s=null==(a=null==(n=t.memberProgress)?void 0:n[c.id])?void 0:a.status;return s?s===e:e===at.NotStarted}return t.status===e});return We.jsx("div",{className:"flex space-x-4 overflow-x-auto pb-4",children:o.map(e=>We.jsx(yx,{status:e,tasks:m(e),allTasks:u,onDrop:t,onViewTask:n,onUpdateTask:a,allUsers:r,pinnedCount:d,meetingsMap:s},e))})},Nx=({taskToEdit:e,currentUser:t,onSave:n,onCancel:a,isPersonalTaskMode:s=!1,prefilledDueDate:r})=>{const{hasPermission:i}=Eh(),[o,c]=l.useState(null),[d,u]=l.useState(""),[m,p]=l.useState(""),[f,h]=l.useState(""),[g,x]=l.useState(""),[y,b]=l.useState(nt.Medium),[v,N]=l.useState(at.NotStarted),[w,k]=l.useState([]),[E,j]=l.useState([]),[C,_]=l.useState(""),[T,S]=l.useState(!1),[A,I]=l.useState(!1),[D,O]=l.useState(""),[R,P]=l.useState(0);l.useRef(null),l.useRef(null);const M=i(Xe.CAN_MANAGE_TEAM_TASKS)&&!s,[U,L]=l.useState("Direct");l.useEffect(()=>{if(e){const t={title:e.title,description:e.description,teamName:e.teamName||"",dueDate:e.dueDate,priority:e.priority,status:e.status,assignedTo:[...e.assignedTo],taskType:e.taskType,isPersonalTask:e.isPersonalTask};c(t),u(t.title),p(t.description),h(t.teamName),x(t.dueDate),b(t.priority),N(t.status),k(t.assignedTo),M&&L(t.isPersonalTask?"Personal":t.taskType===st.Team?"Team":"Direct")}else c(null),u(""),p(""),h(""),x(r||""),b(nt.Medium),N(at.NotStarted),k([]),L(M?"Direct":"Personal")},[e,r,M]),l.useEffect(()=>{(async()=>{if(i(Xe.CAN_MANAGE_TEAM_TASKS)){const e=(await Cf()).filter(e=>"Employee"===e.roleName&&e.status===et.ACTIVE&&e.businessUnitId===t.businessUnitId);j(e)}})()},[t.businessUnitId,i]);return We.jsxs("form",{onSubmit:async a=>{if(a.preventDefault(),_(""),d.trim()&&g){S(!0);try{let a;const r=!e;if(r){const e={title:d,description:m,teamName:M&&"Team"===U?f:void 0,dueDate:g,priority:y,status:v,assignedTo:s?[t.id]:w,createdBy:t.id,taskType:s?st.Personal:"Team"===U?st.Team:st.Direct,isPersonalTask:s};a=await Ff(e,t)}else{const n={title:d,description:m,teamName:M&&"Team"===U?f:void 0,dueDate:g,priority:y,status:v,assignedTo:s?[t.id]:w,taskType:s?st.Personal:"Team"===U?st.Team:st.Direct,isPersonalTask:s},r=await Bf(e.id,n,t);if(!r)throw new Error("Task update failed.");a=r}n(a,r)}catch(r){_(r.message||"An error occurred.")}finally{S(!1)}}else _("Title and Due Date are required.")},className:"space-y-4",children:[C&&We.jsx(Th,{type:"error",message:C,onClose:()=>_("")}),We.jsx(Ch,{label:"Task Title",value:d,onChange:e=>u(e.target.value),required:!0}),We.jsx(Yh,{label:"Description",value:m,onChange:e=>p(e.target.value),rows:4}),We.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[We.jsx(Ch,{label:"Due Date",type:"date",value:g,onChange:e=>x(e.target.value),required:!0,min:Ht(new Date)}),We.jsx(Oh,{label:"Priority",options:Object.values(nt).map(e=>({value:e,label:e})),value:y,onChange:e=>b(e.target.value)})]}),M&&We.jsx(Oh,{label:"Assign To",options:E.map(e=>({value:e.id,label:e.name})),value:w,onChange:e=>k(Array.from(e.target.selectedOptions,e=>e.value)),multiple:!0,size:5}),We.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[We.jsx(_h,{type:"button",variant:"ghost",onClick:a,children:"Cancel"}),We.jsx(_h,{type:"submit",variant:"primary",isLoading:T,children:T?"Saving...":"Save Task"})]})]})},wx=({tasks:e,currentUser:t,onViewTask:n,isManagerView:a=!1,teamMembers:s=[]})=>{const[r,i]=l.useState(new Date),{addToast:o}=bh(),[c,d]=l.useState(null),[u,m]=l.useState(""),[p,f]=l.useState(""),[h,g]=l.useState(""),[x,y]=l.useState(""),b=r.getFullYear(),v=r.getMonth(),N=l.useMemo(()=>new Date(b,v+1,0).getDate(),[b,v]),w=l.useMemo(()=>new Date(b,v,1).getDay(),[b,v]),k=l.useMemo(()=>e.filter(e=>(!u||e.taskType===u)&&((!p||e.status===p)&&((!h||e.priority===h)&&!(a&&x&&!e.assignedTo.includes(x))))),[e,u,p,h,x,a]),E=l.useMemo(()=>{const e=new Map;return k.forEach(t=>{var n;const a=t.dueDate;e.has(a)||e.set(a,[]),null==(n=e.get(a))||n.push(t)}),e},[k]),j=(e,t)=>t?"bg-red-100 hover:bg-red-200 text-red-800 border-l-4 border-red-500":{[at.NotStarted]:"bg-gray-100 hover:bg-gray-200 text-gray-800",[at.InProgress]:"bg-blue-100 hover:bg-blue-200 text-blue-800",[at.Completed]:"bg-green-100 hover:bg-green-200 text-green-800",[at.Blocked]:"bg-yellow-100 hover:bg-yellow-200 text-yellow-800"}[e],C=e=>{const t={[st.Direct]:"bg-blue-100 text-blue-800",[st.Team]:"bg-purple-100 text-purple-800",[st.Personal]:"bg-green-100 text-green-800"};return We.jsx("span",{className:`px-1.5 py-0.5 text-xs font-semibold rounded-full ${t[e]}`,children:e.replace(" Task","")})},_=l.useMemo(()=>[{value:"",label:"All Employees"},...s.map(e=>({value:e.id,label:e.name}))],[s]),T=l.useMemo(()=>[{value:"",label:"All Types"},...Object.values(st).map(e=>({value:e,label:e}))],[]),S=l.useMemo(()=>[{value:"",label:"All Statuses"},...Object.values(at).map(e=>({value:e,label:e}))],[]),A=l.useMemo(()=>[{value:"",label:"All Priorities"},...Object.values(nt).map(e=>({value:e,label:e}))],[]);return We.jsxs("div",{className:"bg-white p-4 rounded-lg",children:[We.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-4 gap-4",children:[We.jsxs("div",{className:"flex items-center space-x-2",children:[We.jsx(_h,{onClick:()=>i(new Date(b,v-1,1)),icon:We.jsx("i",{className:"fas fa-chevron-left"})}),We.jsx("h2",{className:"text-lg font-semibold w-40 text-center",children:r.toLocaleString("default",{month:"long",year:"numeric"})}),We.jsx(_h,{onClick:()=>i(new Date(b,v+1,1)),icon:We.jsx("i",{className:"fas fa-chevron-right"})})]}),We.jsx(_h,{onClick:()=>i(new Date),variant:"secondary",size:"sm",children:"Today"})]}),We.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 p-3 mb-4 border rounded-md bg-gray-50",children:[We.jsx(Oh,{label:"Task Type",options:T,value:u,onChange:e=>m(e.target.value),wrapperClassName:"!mb-0"}),We.jsx(Oh,{label:"Status",options:S,value:p,onChange:e=>f(e.target.value),wrapperClassName:"!mb-0"}),We.jsx(Oh,{label:"Priority",options:A,value:h,onChange:e=>g(e.target.value),wrapperClassName:"!mb-0"}),a&&We.jsx(Oh,{label:"Employee",options:_,value:x,onChange:e=>y(e.target.value),wrapperClassName:"!mb-0"})]}),We.jsxs("div",{className:"grid grid-cols-7 gap-px border bg-gray-200",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>We.jsx("div",{className:"text-center font-medium p-2 bg-gray-100 text-sm",children:e},e)),(()=>{const e=[],t=new Date;t.setHours(0,0,0,0);for(let n=0;n<w;n++)e.push(We.jsx("div",{className:"border p-2 min-h-[10rem] bg-gray-50"},`empty-${n}`));for(let s=1;s<=N;s++){const r=new Date(b,v,s);r.setHours(0,0,0,0);const i=`${b}-${String(v+1).padStart(2,"0")}-${String(s).padStart(2,"0")}`,l=E.get(i)||[];e.push(We.jsxs("div",{className:`border p-1 min-h-[10rem] flex flex-col ${r.getTime()===t.getTime()?"bg-blue-50":""} ${a?"cursor-pointer hover:bg-blue-100":""}`,onClick:()=>{return e=r,void(a&&d(e));var e},children:[We.jsx("span",{className:"font-semibold text-sm text-right pr-1 "+(r.getTime()===t.getTime()?"text-primary":"text-gray-700"),children:s}),We.jsx("div",{className:"mt-1 space-y-1 overflow-y-auto flex-grow",children:l.map(e=>{const a=r<t&&e.status!==at.Completed;return We.jsxs("div",{onClick:t=>{t.stopPropagation(),n(e)},className:`p-2 rounded-md cursor-pointer text-xs group ${j(e.status,a)}`,title:e.title,children:[We.jsxs("div",{className:"flex justify-between items-center mb-1",children:[C(e.taskType),a&&We.jsx("i",{className:"fas fa-exclamation-triangle text-red-600",title:"Overdue"})]}),We.jsx("p",{className:"font-semibold text-gray-800 group-hover:text-black truncate",children:e.title}),e.taskType===st.Team&&We.jsx("div",{className:"mt-1",children:We.jsx(fx,{task:e,size:"compact"})})]},e.id)})})]},s))}return e})()]}),c&&a&&We.jsx(Dh,{isOpen:!!c,onClose:()=>d(null),title:`Create New Task for ${Wt(c)}`,size:"lg",children:We.jsx(Nx,{currentUser:t,onSave:()=>{d(null),o("Task created successfully!","success")},onCancel:()=>d(null),prefilledDueDate:Ht(c)})})]})},kx=({task:e,allUsers:t})=>{if("Team Task"!==e.taskType||!e.memberProgress)return null;return We.jsxs("div",{className:"pt-4 mt-4 border-t dark:border-slate-700",children:[We.jsx("h4",{className:"font-semibold text-lg mb-2 text-secondary dark:text-slate-300",children:"Team Progress"}),We.jsx("div",{className:"mb-4",children:We.jsx(fx,{task:e})}),We.jsx("div",{className:"mt-4 space-y-2 max-h-48 overflow-y-auto pr-2",children:e.assignedTo.map(n=>{const a=t.find(e=>e.id===n),s=e.memberProgress[n];return a&&s?We.jsxs("div",{className:"flex items-center justify-between p-2.5 bg-slate-50 dark:bg-slate-800/50 rounded-lg border dark:border-slate-700",children:[We.jsx("span",{className:"font-medium text-gray-800 dark:text-slate-200",children:a.name}),We.jsxs("div",{className:"text-right",children:[We.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${r=s.status,{[at.NotStarted]:"bg-gray-200 dark:bg-slate-600 text-gray-800 dark:text-slate-200",[at.InProgress]:"bg-blue-200 dark:bg-blue-800/60 text-blue-800 dark:text-blue-200",[at.Completed]:"bg-green-200 dark:bg-green-800/60 text-green-800 dark:text-green-200",[at.Blocked]:"bg-red-200 dark:bg-red-800/60 text-red-800 dark:text-red-200"}[r]}`,children:s.status}),"Completed"===s.status&&s.completedAt&&We.jsxs("p",{className:"text-xs text-gray-500 dark:text-slate-400 mt-1",children:["on ",qt(s.completedAt)]})]})]},n):null;var r})})]})},{Link:Ex}=m,jx=({task:e,isOpen:t,onClose:n,onUpdateTask:a,currentUser:s,onEditTask:r})=>{const{hasPermission:i}=Eh(),{addToast:o}=bh(),[c,d]=l.useState([]),[u,m]=l.useState(""),[p,f]=l.useState([]),[h,g]=l.useState([]),[x,y]=l.useState(null);if(l.useEffect(()=>{t&&(async()=>{if(!e)return;if(e.meetingId){const t=await Zf(e.meetingId);y(t||null)}else y(null);const[t,n,a]=await Promise.all([Vf(e.id),Cf(),jf(s.id)]);d(t),g(n);const r=a.filter(t=>t.targetId===e.id).map(e=>lh(e,s)),i=await Promise.all(r);f(i)})()},[e,t,s.id]),!e)return null;const b=e=>{var t;return(null==(t=h.find(t=>t.id===e))?void 0:t.name)||"Unknown User"};e.taskType===st.Team?e.teamName:Wd(e.title,h);const v=("Manager"===s.roleName&&e.createdBy===s.id||e.isPersonalTask&&e.createdBy===s.id)&&e.status!==at.Completed,N="Manager"===s.roleName&&e.createdBy===s.id&&e.status===at.Completed,w=i(Xe.CAN_EDIT_ANY_TASK_STATUS)||"Manager"===s.roleName&&e.createdBy===s.id;return We.jsx(Dh,{isOpen:t,onClose:n,title:e.teamName?`Team Task: ${e.teamName}`:"Task Details",size:"lg",footer:We.jsxs("div",{className:"flex items-center justify-between w-full",children:[We.jsxs("div",{children:[v&&We.jsx(_h,{variant:"primary",onClick:()=>r(e),children:"Edit Task"}),N&&We.jsx(_h,{variant:"success",onClick:()=>{a(e.id,{status:at.InProgress}),n()},children:"Reopen Task"})]}),We.jsxs(_h,{variant:"ghost",onClick:n,children:[We.jsx("i",{className:"fas fa-times mr-2"}),"Close"]})]}),children:We.jsxs("div",{className:"space-y-4",children:[We.jsxs("div",{children:[We.jsx("h3",{className:"font-semibold text-lg",children:Wd(e.title,h)}),x&&We.jsxs(Ex,{to:`/meetings/${x.id}`,onClick:n,className:"text-sm text-gray-500 mb-2 inline-block",children:[We.jsx("span",{className:"font-semibold",children:" From Meeting:"}),We.jsxs("span",{className:"ml-2 inline-flex items-center bg-purple-100 text-purple-800 font-medium px-2.5 py-0.5 rounded-full hover:bg-purple-200 hover:text-purple-900 transition-colors",children:[We.jsx("i",{className:"fas fa-users-crown mr-1.5"}),x.title]})]}),We.jsx("p",{className:"whitespace-pre-wrap text-gray-700",children:Wd(e.description,h)})]}),e.subTasks&&e.subTasks.length>0&&We.jsxs("div",{className:"pt-2",children:[We.jsx("h4",{className:"font-semibold text-md mb-2",children:"Sub-tasks"}),We.jsx("div",{className:"space-y-2",children:e.subTasks.map((t,n)=>We.jsxs("div",{className:"flex items-center",children:[We.jsx("input",{type:"checkbox",checked:t.completed,onChange:()=>(t=>{if(!e||!e.subTasks)return;const n=e.subTasks.map((e,n)=>n===t?{...e,completed:!e.completed}:e);a(e.id,{subTasks:n})})(n),id:`subtask-${n}`,className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"}),We.jsx("label",{htmlFor:`subtask-${n}`,className:"ml-3 text-sm "+(t.completed?"line-through text-gray-500":"text-gray-800"),children:t.title})]},n))})]}),We.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[We.jsxs("div",{children:[We.jsx("span",{className:"font-semibold",children:"Due Date:"})," ",Wt(e.dueDate)]}),We.jsxs("div",{children:[We.jsx("span",{className:"font-semibold",children:"Priority:"})," ",e.priority]}),We.jsxs("div",{children:[We.jsx("span",{className:"font-semibold",children:"Overall Status:"})," ",w?We.jsx(Oh,{value:e.status,onChange:t=>a(e.id,{status:t.target.value}),options:Object.values(at).map(e=>({value:e,label:e})),className:"!inline-block !w-auto !py-1 !mt-0 !ml-2",wrapperClassName:"!inline-block !mb-0"}):e.status]}),We.jsxs("div",{children:[We.jsx("span",{className:"font-semibold",children:"Created By:"})," ",b(e.createdBy)]})]}),We.jsxs("div",{children:[We.jsx("p",{className:"font-semibold",children:"Assigned To:"}),We.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:e.assignedTo.map(e=>We.jsxs("div",{className:"flex items-center bg-primary-light text-primary-dark font-medium px-2 py-1 rounded-full",children:[We.jsx(Uh,{name:b(e),size:"sm",className:"mr-2"}),We.jsx("span",{children:b(e)})]},e))})]}),e.taskType===st.Team&&We.jsx(kx,{task:e,allUsers:h}),We.jsxs("div",{className:"pt-4 border-t",children:[We.jsx("h4",{className:"font-semibold text-lg mb-2",children:"Comments"}),We.jsxs("div",{className:"space-y-3 max-h-48 overflow-y-auto mb-3 pr-2",children:[c.map(e=>We.jsxs("div",{className:"flex items-start space-x-3",children:[We.jsx(Uh,{name:b(e.createdBy),size:"md"}),We.jsxs("div",{className:"flex-grow bg-gray-100 p-2 rounded-md",children:[We.jsx("p",{className:"text-sm font-semibold",children:b(e.createdBy)}),We.jsx("p",{className:"text-sm",children:Wd(e.text,h)}),We.jsx("p",{className:"text-xs text-gray-500 text-right mt-1",children:qt(e.createdOn)})]})]},e.id)),0===c.length&&We.jsx("p",{className:"text-sm text-gray-500 italic",children:"No comments yet."})]}),We.jsxs("div",{className:"flex space-x-2",children:[We.jsx(Yh,{value:u,onChange:e=>m(e.target.value),placeholder:"Add a comment... (you can @mention people)",wrapperClassName:"flex-grow"}),We.jsx(_h,{onClick:async()=>{if(!u.trim())return;const t=`temp_${Date.now()}`,n={id:t,taskId:e.id,text:u,createdBy:s.id,createdOn:Date.now()},a=[...c];d(e=>[...e,n]),m("");try{const n=await(async(e,t,n)=>{const a=cm("comment"),s={id:a,tenantId:n.tenantId,taskId:e,text:t,createdBy:n.id,createdOn:Date.now()};await Xp.addComment(a,s),sn({type:"ADD_TASK_COMMENT",payload:{...s}});const r=await Uf(e);if(r){await Ef({timestamp:s.createdOn,actorId:n.id,actorName:n.name,type:dt.TASK_COMMENT_ADDED,description:"commented on task:",targetId:r.id,targetName:r.title});const e=zd(t);for(const t of e)t!==n.id&&await Xf({userId:t,message:`${n.name} mentioned you in a comment on: "${r.title}"`,type:"info",link:oh(n.roleName)?`/team-tasks?taskId=${r.id}`:`/my-tasks?taskId=${r.id}`,isCrucial:!0});const a=new Set([...r.assignedTo,r.createdBy].filter(t=>!e.includes(t)));for(const t of a)t!==n.id&&await Xf({userId:t,message:`${n.name} commented on task: "${r.title}"`,type:"info",link:oh(n.roleName)?`/team-tasks?taskId=${r.id}`:`/my-tasks?taskId=${r.id}`,actionType:"TASK_COMMENT_ADDED",targetId:r.id,actors:[{id:n.id,name:n.name}],isCrucial:!0})}return s})(e.id,u,s);d(e=>e.map(e=>e.id===t?n:e))}catch(r){o("Failed to add comment. Please try again.","error"),d(a)}},disabled:!u.trim(),children:"Send"})]})]}),We.jsx("div",{className:"pt-4 border-t",children:We.jsx(Qh,{title:"Task History",events:p,maxHeight:"max-h-48"})})]})})},Cx=({currentUser:e,teamMembers:t=[],onTaskAdd:n,isManagerView:a=!1})=>{const{addToast:s}=bh(),[r,i]=l.useState(!1),[o,c]=l.useState(""),[d,u]=l.useState(""),[m,p]=l.useState(""),[f,h]=l.useState(""),[g,x]=l.useState(nt.Medium),[y,b]=l.useState(!1),[v,N]=l.useState(vf()),[w,k]=l.useState({prompt:"",isGenerating:!1,generatedTask:null,error:null}),E=l.useRef(null),j=l.useRef(null);l.useLayoutEffect(()=>{const e=E.current;e&&(e.style.height="auto",e.style.height=`${e.scrollHeight}px`)},[w.prompt,r,y]),l.useEffect(()=>{const e=e=>{j.current&&!j.current.contains(e.target)&&(o.trim()||d.trim()||w.prompt.trim()||(i(!1),b(!1)))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[o,d,w.prompt]);const C=l.useMemo(()=>zd(d),[d]),_=a&&C.length>1;l.useEffect(()=>{const e=wf(()=>{const e=vf();N(e),k(e=>({...e,error:null})),e||b(!1)});return()=>e()},[]),l.useEffect(()=>{y&&!v&&b(!1)},[y,v]);const T=l.useCallback(()=>{c(""),u(""),p(""),h(""),x(nt.Medium),i(!1),b(!1),k({prompt:"",isGenerating:!1,generatedTask:null,error:null})},[]),S=l.useCallback(()=>{if(!o.trim())return void s("Task title cannot be empty.","error");if(!f)return void s("Due Date is required.","error");let t,r=C;if(a){if(0===r.length)return void s("Please mention at least one team member using '@' to assign the task.","error");t=_?st.Team:st.Direct}else t=st.Personal,r=[e.id];n({title:o,description:d,teamName:t===st.Team?m.trim():"",dueDate:f,priority:g,assignedTo:r,createdBy:e.id,taskType:t,isPersonalTask:!a,status:at.NotStarted}),T()},[o,d,f,g,C,a,_,m,e.id,n,T,s]),A=l.useCallback(async()=>{if(!w.prompt.trim())return void s("Please describe the task for the AI.","error");const e=Nf();if(e){k(e=>({...e,isGenerating:!0,error:null,generatedTask:null}));try{const t=new Md({apiKey:e}),n=`You are a task management assistant. Analyze the user's request and create a structured JSON task object. The output must be valid JSON.\n      - 'title': A concise, action-oriented title.\n      - 'description': Clear, actionable steps using markdown bullet points ("- Step 1").\n      - 'suggestedDueDate': A date in YYYY-MM-DD format. Default to 3 days from today (${(new Date).toISOString().split("T")[0]}) if no timeframe is given.\n      - 'suggestedPriority': "High", "Medium", or "Low". Default to "Medium".`,a=await t.models.generateContent({model:"gemini-2.5-flash",contents:w.prompt,config:{systemInstruction:n,responseMimeType:"application/json",responseSchema:{type:us.OBJECT,properties:{title:{type:us.STRING},description:{type:us.STRING},suggestedDueDate:{type:us.STRING},suggestedPriority:{type:us.STRING,enum:["High","Medium","Low"]}},required:["title","description","suggestedDueDate","suggestedPriority"]}}}),s=JSON.parse(a.text);k(e=>({...e,isGenerating:!1,generatedTask:s}))}catch(t){const e="string"==typeof(null==t?void 0:t.message)?t.message:"Unknown error",n=/429|RESOURCE_EXHAUSTED/i.test(e)?"Google Gemini is rate-limiting this key right now. Try again shortly or paste a different key in the profile menu.":`AI task generation failed: ${e}`;k(e=>({...e,isGenerating:!1,error:n}))}}else k(e=>({...e,error:"AI features are not configured yet. Open your profile menu -> Manage AI API Key to paste a Google Gemini key."}))},[w.prompt,s]);return r?We.jsx("div",{ref:j,className:"p-4 mb-4 bg-white dark:bg-slate-800 rounded-lg border-2 border-primary shadow-lg relative",children:y&&a?We.jsxs("div",{children:[We.jsx("div",{className:"absolute top-2 right-3 z-10",children:We.jsx("button",{onClick:()=>b(!1),className:"text-sm text-primary hover:underline","aria-label":"Switch to manual task entry",children:" Manual Entry"})}),We.jsx("h3",{className:"font-semibold text-primary mb-2",children:"AI Task Assistant"}),w.error&&We.jsx(Th,{type:"error",message:w.error,onClose:()=>k(e=>({...e,error:null}))}),!v&&We.jsx(Th,{type:"info",message:"Paste your Google Gemini API key from the profile menu to enable the AI assistant."}),!w.generatedTask&&We.jsxs("div",{className:"flex items-start space-x-2",children:[We.jsx("textarea",{ref:E,placeholder:"Describe your task...",value:w.prompt,onChange:e=>k(t=>({...t,prompt:e.target.value,error:null})),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),A())},disabled:w.isGenerating||!v,className:"flex-grow w-full px-3 py-2 bg-slate-50 dark:bg-slate-700/50 text-gray-800 dark:text-slate-200 border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary placeholder:text-slate-400 text-sm transition resize-none overflow-hidden",rows:1,style:{minHeight:"44px",padding:"10px"},autoFocus:!0}),We.jsx(_h,{onClick:A,isLoading:w.isGenerating,disabled:!w.prompt.trim()||w.isGenerating||!v,children:"Generate"})]}),w.isGenerating&&We.jsx(Ph,{message:"AI is processing your task..."}),w.generatedTask&&!w.isGenerating&&We.jsxs("div",{className:"p-3 my-2 border rounded-lg bg-slate-50 dark:bg-slate-900/50 space-y-2",children:[We.jsxs("h4",{className:"font-semibold text-sm text-primary dark:text-sky-400 flex items-center",children:[We.jsx("i",{className:"fas fa-lightbulb mr-2"})," AI Suggestion"]}),We.jsxs("div",{children:[We.jsx("strong",{children:"Title:"})," ",w.generatedTask.title]}),We.jsxs("div",{children:[We.jsx("strong",{children:"Description:"}),We.jsx("div",{className:"whitespace-pre-wrap pl-2 border-l-2 ml-2 bg-white dark:bg-slate-800 p-2 rounded max-h-40 overflow-y-auto",children:w.generatedTask.description})]}),We.jsxs("div",{className:"flex items-center gap-x-4 pt-2",children:[We.jsxs("span",{children:[We.jsx("strong",{children:" Due:"})," ",Wt(w.generatedTask.suggestedDueDate)]}),We.jsxs("span",{children:[We.jsx("strong",{children:" Priority:"})," ",w.generatedTask.suggestedPriority]})]}),We.jsxs("div",{className:"flex justify-end space-x-2 mt-2",children:[We.jsx(_h,{variant:"ghost",size:"sm",onClick:()=>{k(e=>({...e,generatedTask:null,error:null}))},icon:We.jsx("i",{className:"fas fa-pencil-alt"}),children:"Edit Prompt"}),We.jsx(_h,{variant:"primary",size:"sm",onClick:()=>{w.generatedTask&&(c(w.generatedTask.title),u(w.generatedTask.description),h(w.generatedTask.suggestedDueDate),x(w.generatedTask.suggestedPriority),k({prompt:w.prompt,isGenerating:!1,generatedTask:null,error:null}),b(!1))},icon:We.jsx("i",{className:"fas fa-check"}),children:"Insert into Form"})]})]})]}):We.jsxs("div",{className:"relative",children:[a&&We.jsxs("button",{type:"button",onClick:()=>{v?b(!0):s("Add your Google Gemini API key from the profile menu before using the AI assistant.","warning")},className:"absolute top-1 right-2 z-10 flex items-center text-xs px-2 py-1 rounded-full whitespace-nowrap "+(v?"text-pink-600 dark:text-pink-400 bg-pink-100 dark:bg-pink-900/50 hover:bg-pink-200 dark:hover:bg-pink-900/80":"text-slate-400 dark:text-slate-500 bg-slate-200/60 dark:bg-slate-800/40 cursor-not-allowed"),"aria-label":"Switch to AI task assistant",disabled:!v,children:[We.jsx("i",{className:"fas fa-brain mr-1.5 text-pink-500"}),"AI Assistant"]}),We.jsx(Ch,{id:"inline-title",placeholder:a?"What needs to be done?":"New personal task title",value:o,onChange:e=>c(e.target.value),className:"text-lg font-semibold !border-0 !shadow-none !ring-0 !p-1 focus:!ring-0",wrapperClassName:"!mb-0",autoFocus:!0}),We.jsx(Rg,{value:d,onChange:u,placeholder:a?"Add details... type @ to mention and assign":"Add more details...",rows:1,className:"!border-0 !shadow-none !ring-0 !p-1 mt-1 bg-transparent",availableUsers:a?t:[]}),_&&We.jsx(Ch,{label:"Team Name (Optional)",value:m,onChange:e=>p(e.target.value),placeholder:"e.g., Q4 Launch Team",wrapperClassName:"mt-2"}),We.jsxs("div",{className:"flex flex-wrap items-center gap-4 mt-2",children:[We.jsx(Ch,{type:"date",value:f,onChange:e=>h(e.target.value),label:"Due Date",min:(new Date).toISOString().split("T")[0],wrapperClassName:"!mb-0"}),We.jsx(Oh,{label:"Priority",options:Object.values(nt).map(e=>({value:e,label:e})),value:g,onChange:e=>x(e.target.value),wrapperClassName:"!mb-0"})]}),We.jsxs("div",{className:"flex items-center justify-end space-x-2 mt-4 pt-3 border-t dark:border-slate-700",children:[We.jsx(_h,{variant:"ghost",size:"sm",onClick:T,children:"Cancel"}),We.jsx(_h,{variant:"primary",size:"sm",onClick:S,disabled:!o.trim()||!f,children:"Add Task"})]})]})}):a?We.jsxs("div",{className:"p-3 mb-4 flex items-center justify-center space-x-4",children:[We.jsxs("button",{onClick:()=>{i(!0),b(!1)},className:"flex-1 p-3 bg-white dark:bg-slate-800 rounded-lg border-2 border-dashed hover:border-primary text-gray-500 dark:text-slate-400 hover:text-primary dark:hover:text-primary transition-colors flex items-center justify-center",children:[We.jsx("i",{className:"fas fa-plus mr-2"})," Assign a Task Manually"]}),We.jsxs("button",{onClick:()=>{v?(i(!0),b(!0)):s("Add your Google Gemini API key from the profile menu before using the AI assistant.","warning")},className:"flex-1 p-3 rounded-lg border-2 border-dashed transition-colors flex items-center justify-center "+(v?"bg-blue-50 dark:bg-blue-900/20 hover:border-blue-500 dark:hover:border-blue-400 text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300":"bg-slate-100 dark:bg-slate-800/40 border-slate-300 dark:border-slate-700 text-slate-400 dark:text-slate-500 cursor-not-allowed"),disabled:!v,children:[We.jsx("i",{className:"fas fa-robot mr-2","aria-hidden":"true"})," Create Task with AI"]})]}):We.jsxs("button",{onClick:()=>i(!0),className:"w-full text-left p-3 mb-4 bg-white dark:bg-slate-800 rounded-lg border-2 border-dashed hover:border-primary dark:hover:border-primary text-gray-500 dark:text-slate-400 hover:text-primary dark:hover:text-primary transition-colors flex items-center",children:[We.jsx("i",{className:"fas fa-plus mr-2"})," Add a new personal task..."]})},_x=()=>{const{currentUser:e}=Eh(),{addToast:t}=bh();d();const[n,a]=f(),[s,r]=l.useState([]),[i,o]=l.useState(new Map),c=n.get("view")||"list",u=parseInt(n.get("page")||"1",10),m=n.get("taskId"),[p,h]=l.useState(null),[g,x]=l.useState(null),[y,b]=l.useState({isOpen:!1,title:"",message:"",onConfirm:null}),v=l.useCallback(async()=>{if(e){const[t,n]=await Promise.all([Lf(),dh(e.id)]),a=t.filter(t=>t.assignedTo.includes(e.id)||t.isPersonalTask&&t.createdBy===e.id);r(a),o(new Map(n.map(e=>[e.id,e])))}},[e]);l.useEffect(()=>{v();const e=tn.on("appDataChanged",e=>{const t=null==e?void 0:e.keyChanged;t!==bt&&t!==vt&&t!==wt||v()});return()=>e()},[v]),l.useEffect(()=>{if(m){if(s.length>0){const e=s.find(e=>e.id===m);e?x(e):k()}}else x(null)},[m,s]);const N=e=>{const t=new URLSearchParams(n);t.set("view",e),t.delete("page"),a(t)},w=e=>{const t=new URLSearchParams(n);t.set("taskId",e.id),a(t)},k=()=>{const e=new URLSearchParams(n);e.delete("taskId"),a(e)},E=l.useCallback(async n=>{e&&(await Ff({...n},e),t(" Task Created","success"),await v())},[e,t,v]),j=async(n,a)=>{if(!e)return;const i=[...s],l=i.findIndex(e=>e.id===n);if(-1===l)return;const o=[...i],c={...o[l],...a};o[l]=c,r(o),g&&g.id===n&&x(c);try{a.status&&c.taskType===st.Team?await Gf(n,e.id,a.status,e):await Bf(n,a,e)}catch(d){t("Failed to update task. Reverting change.","error"),r(i),g&&g.id===n&&x(i[l])}};return e?We.jsxs(We.Fragment,{children:[We.jsx(Ah,{title:"My Tasks",children:We.jsxs(Ih,{children:[We.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-4 gap-4",children:[We.jsx("h2",{className:"text-xl font-semibold text-primary dark:text-sky-400",children:"Your Tasks"}),We.jsxs("div",{className:"flex space-x-1 border border-gray-300 dark:border-slate-600 rounded-lg p-1 w-full md:w-auto justify-center",children:[We.jsx(_h,{size:"sm",variant:"list"===c?"primary":"ghost",onClick:()=>N("list"),icon:We.jsx("i",{className:"fas fa-list"}),children:"List"}),We.jsx(_h,{size:"sm",variant:"kanban"===c?"primary":"ghost",onClick:()=>N("kanban"),icon:We.jsx("i",{className:"fas fa-columns"}),children:"Board"}),We.jsx(_h,{size:"sm",variant:"calendar"===c?"primary":"ghost",onClick:()=>N("calendar"),icon:We.jsx("i",{className:"fas fa-calendar-alt"}),children:"Calendar"})]})]}),We.jsx(Cx,{currentUser:e,onTaskAdd:E,isManagerView:!1}),We.jsxs("div",{className:"mt-6",children:["list"===c&&We.jsx(gx,{tasks:s,currentUser:e,onViewTask:w,onEditTask:n=>{n.isPersonalTask&&n.createdBy===(null==e?void 0:e.id)?h(n):t("You can only edit your personal tasks.","error")},onUpdateTask:j,onDeleteTask:n=>{if(e){const a=s.find(e=>e.id===n);(null==a?void 0:a.isPersonalTask)&&(null==a?void 0:a.createdBy)===e.id?b({isOpen:!0,title:"Confirm Deletion",message:`Are you sure you want to delete the task "${a.title}"? This cannot be undone.`,onConfirm:async()=>{await $f(n,e),await v(),b({isOpen:!1,title:"",message:"",onConfirm:null}),t(" Task Deleted","info")}}):t("You can only delete your personal tasks.","error")}},meetingsMap:i,currentPage:u,onPageChange:e=>{const t=new URLSearchParams(n);t.set("page",String(e)),a(t)}}),"kanban"===c&&We.jsx(vx,{tasks:s,onUpdateTaskStatus:(e,t)=>j(e,{status:t}),onViewTask:w,onUpdateTask:j,meetingsMap:i}),"calendar"===c&&We.jsx(wx,{tasks:s,currentUser:e,onViewTask:w,isManagerView:!1})]})]})}),p&&We.jsx(Dh,{isOpen:!!p,onClose:()=>h(null),title:"Edit Task",children:We.jsx(Nx,{onSave:async(e,n)=>{await v(),h(null),t(" Task Updated","success")},onCancel:()=>h(null),currentUser:e,isPersonalTaskMode:p.isPersonalTask,taskToEdit:p})}),We.jsx(jx,{isOpen:!!g,onClose:k,task:g,onUpdateTask:j,currentUser:e,onEditTask:n=>{n.isPersonalTask&&n.createdBy===(null==e?void 0:e.id)?(k(),h(n)):t("You do not have permission to edit this task.","error")}}),We.jsx(Lh,{isOpen:y.isOpen,onClose:()=>{b({isOpen:!1,title:"",message:"",onConfirm:null})},onConfirm:async()=>{y.onConfirm&&await y.onConfirm()},title:y.title,confirmButtonVariant:"danger",children:We.jsx("p",{children:y.message})})]}):null},Tx=()=>{const{currentUser:e}=Eh(),{addToast:t}=bh();d();const[n,a]=f(),s=n.get("view")||"list",r=n.get("employee")||"",i=n.get("status")||"",o=n.get("dueDate")||"",c=parseInt(n.get("page")||"1",10),u=n.get("taskId"),[m,p]=l.useState([]),[h,g]=l.useState(new Map),[x,y]=l.useState([]),[b,v]=l.useState(null),[N,w]=l.useState(null),[k,E]=l.useState({isOpen:!1,title:"",message:"",onConfirm:null}),[j,C]=l.useState({type:null,taskIds:[]}),_=l.useCallback(async()=>{if(e&&"Manager"===e.roleName){const[t,n,a]=await Promise.all([Cf(),Lf(),dh(e.id)]),s=t.filter(t=>"Employee"===t.roleName&&t.status===et.ACTIVE&&t.businessUnitId===e.businessUnitId);y(s);const r=n.filter(t=>t.createdBy===e.id&&!t.isPersonalTask);p(r),g(new Map(a.map(e=>[e.id,e])))}},[e]);l.useEffect(()=>{_();const e=tn.on("appDataChanged",e=>{const t=null==e?void 0:e.keyChanged;t!==bt&&t!==vt&&t!==mt&&t!==wt||_()});return()=>e()},[_]);const T=l.useMemo(()=>{let e=[...m];return r&&(e=e.filter(e=>e.assignedTo.includes(r))),i&&(e=e.filter(e=>e.status===i)),o&&(e=e.filter(e=>e.dueDate===o)),e},[r,i,o,m]);l.useEffect(()=>{if(u){if(m.length>0){const e=m.find(e=>e.id===u);e?w(e):D()}}else w(null)},[u,m]);const S=(e,t)=>{const s=new URLSearchParams(n);t?s.set(e,t):s.delete(e),"page"!==e&&s.delete("page"),a(s)},A=e=>{S("view",e)},I=e=>{const t=new URLSearchParams(n);t.set("taskId",e.id),a(t)},D=()=>{const e=new URLSearchParams(n);e.delete("taskId"),a(e)},O=l.useCallback(async n=>{e&&(await Ff({...n,status:at.NotStarted},e),await _(),t(" Task Created & Assigned","success"))},[e,_,t]),R=async(t,n)=>{if(e&&(await Bf(t,n,e),await _(),N&&N.id===t)){const e=await Uf(t);e&&w(e)}},P=async(n,a,s)=>{if(!e)return;let r="";"delete"!==n?("complete"===n?(await Promise.all(a.map(t=>Bf(t,{status:at.Completed},e))),r=` ${a.length} tasks marked as Complete.`):"reassign"===n?(await Promise.all(a.map(t=>Bf(t,{assignedTo:s.assignees},e))),C({type:null,taskIds:[]}),r=` ${a.length} tasks reassigned.`):"dueDate"===n&&(await Promise.all(a.map(t=>Bf(t,{dueDate:s.dueDate},e))),C({type:null,taskIds:[]}),r=` Due date updated for ${a.length} tasks.`),r&&(t(r,"success"),await _())):E({isOpen:!0,title:"Confirm Batch Delete",message:`Are you sure you want to delete ${a.length} tasks? This cannot be undone.`,onConfirm:async()=>{await Promise.all(a.map(t=>$f(t,e))),await _(),E({isOpen:!1,title:"",message:"",onConfirm:null}),t(` ${a.length} tasks deleted.`,"info")}})},M=()=>{v(null)};if(!e)return null;const U=l.useMemo(()=>[{value:"",label:"All Team Members"},...x.map(e=>({value:e.id,label:e.name}))],[x]),L=l.useMemo(()=>[{value:"",label:"All Statuses"},...Object.values(at).map(e=>({value:e,label:e}))],[]);return We.jsxs(We.Fragment,{children:[We.jsx(Ah,{title:"Team Task Management",children:We.jsxs(Ih,{children:[We.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-4 gap-4",children:[We.jsx("h2",{className:"text-xl font-semibold text-primary dark:text-sky-400",children:"Tasks I've Assigned"}),We.jsxs("div",{className:"flex space-x-1 border border-gray-300 dark:border-slate-600 rounded-lg p-1 w-full md:w-auto justify-center",children:[We.jsx(_h,{size:"sm",variant:"list"===s?"primary":"ghost",onClick:()=>A("list"),icon:We.jsx("i",{className:"fas fa-list"}),children:"List"}),We.jsx(_h,{size:"sm",variant:"kanban"===s?"primary":"ghost",onClick:()=>A("kanban"),icon:We.jsx("i",{className:"fas fa-columns"}),children:"Board"}),We.jsx(_h,{size:"sm",variant:"calendar"===s?"primary":"ghost",onClick:()=>A("calendar"),icon:We.jsx("i",{className:"fas fa-calendar-alt"}),children:"Calendar"})]})]}),We.jsx(Cx,{currentUser:e,onTaskAdd:O,isManagerView:!0,teamMembers:x}),We.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 my-6 p-3 bg-gray-50 dark:bg-slate-800/50 dark:border dark:border-slate-700/50 rounded-lg",children:[We.jsx(Oh,{options:U,value:r,onChange:e=>S("employee",e.target.value),label:"Filter by Employee"}),We.jsx(Oh,{options:L,value:i,onChange:e=>S("status",e.target.value),label:"Filter by Status"}),We.jsx(Ch,{type:"date",value:o,onChange:e=>S("dueDate",e.target.value),label:"Filter by Due Date"})]}),"list"===s&&We.jsx(gx,{tasks:T,currentUser:e,onViewTask:I,onEditTask:n=>{n.createdBy===(null==e?void 0:e.id)?v(n):t("You can only edit tasks you have created.","error")},onUpdateTask:R,onDeleteTask:n=>{if(e){const a=m.find(e=>e.id===n);if(!a)return;E({isOpen:!0,title:"Confirm Deletion",message:`Are you sure you want to delete the task "${a.title}"? This cannot be undone.`,onConfirm:async()=>{await $f(n,e),await _(),E({isOpen:!1,title:"",message:"",onConfirm:null}),t(" Task Deleted","info")}})}},isManagerView:!0,onBatchDelete:e=>P("delete",e),onBatchChangeStatus:(e,t)=>P("complete",e,{}),onBatchChangeDueDate:e=>C({type:"dueDate",taskIds:e}),onBatchReassign:e=>C({type:"reassign",taskIds:e}),meetingsMap:h,currentPage:c,onPageChange:e=>{S("page",String(e))}}),"kanban"===s&&We.jsx(vx,{tasks:T,onUpdateTaskStatus:(e,t)=>R(e,{status:t}),onViewTask:I,onUpdateTask:R,meetingsMap:h}),"calendar"===s&&We.jsx(wx,{tasks:m,currentUser:e,onViewTask:I,isManagerView:!0,teamMembers:x})]})}),b&&We.jsx(Dh,{isOpen:!!b,onClose:M,title:b.id?"Edit Task":"Create / Assign Task",children:We.jsx(Nx,{onSave:async(e,n)=>{await _(),v(null),t(" Task Updated","success")},onCancel:M,currentUser:e,taskToEdit:b})}),We.jsx(jx,{isOpen:!!N,onClose:D,task:N,onUpdateTask:R,currentUser:e,onEditTask:n=>{n.createdBy===(null==e?void 0:e.id)?(D(),v(n)):t("You can only edit tasks you have created.","error")}}),We.jsx(Lh,{isOpen:k.isOpen,onClose:()=>E({isOpen:!1,title:"",message:"",onConfirm:null}),onConfirm:async()=>{k.onConfirm&&await k.onConfirm()},title:k.title,confirmButtonVariant:"danger",children:We.jsx("p",{children:k.message})}),"dueDate"===j.type&&We.jsx(Sx,{isOpen:!0,onClose:()=>C({type:null,taskIds:[]}),taskIds:j.taskIds,onConfirm:(e,t)=>P("dueDate",e,{dueDate:t})}),"reassign"===j.type&&We.jsx(Ax,{isOpen:!0,onClose:()=>C({type:null,taskIds:[]}),taskIds:j.taskIds,onConfirm:(e,t)=>P("reassign",e,{assignees:t}),teamMembers:x})]})},Sx=({isOpen:e,onClose:t,taskIds:n,onConfirm:a})=>{const[s,r]=l.useState("");return We.jsxs(Dh,{isOpen:e,onClose:t,title:`Change Due Date for ${n.length} tasks`,children:[We.jsx(Ch,{type:"date",value:s,onChange:e=>r(e.target.value),label:"New Due Date",required:!0,min:(new Date).toISOString().split("T")[0]}),We.jsxs("div",{className:"flex justify-end space-x-2 mt-4",children:[We.jsx(_h,{variant:"ghost",onClick:t,children:"Cancel"}),We.jsx(_h,{variant:"primary",onClick:()=>a(n,s),disabled:!s,children:"Update Due Date"})]})]})},Ax=({isOpen:e,onClose:t,taskIds:n,onConfirm:a,teamMembers:s})=>{const[r,i]=l.useState([]),o=l.useMemo(()=>s.map(e=>({value:e.id,label:e.name})),[s]);return We.jsxs(Dh,{isOpen:e,onClose:t,title:`Reassign ${n.length} tasks`,children:[We.jsx(Oh,{label:"Assign to",options:o,value:r,onChange:e=>{const t=e.target.options,n=[];for(let a=0;a<t.length;a++)t[a].selected&&n.push(t[a].value);i(n)},multiple:!0,size:6}),We.jsxs("div",{className:"flex justify-end space-x-2 mt-4",children:[We.jsx(_h,{variant:"ghost",onClick:t,children:"Cancel"}),We.jsx(_h,{variant:"primary",onClick:()=>a(n,r),disabled:0===r.length,children:"Reassign Tasks"})]})]})},Ix=()=>We.jsx(Ah,{title:" Leadership Board",children:We.jsx(xg,{})}),Dx=[{path:"/dashboard",label:"Dashboard",icon:le,permission:"dashboard",end:!0},{path:"/super-admin",label:"Super Admin Panel",icon:oe,permission:"super_admin"},{path:"/my-reports",label:"My EOD Reports",icon:ce,permission:Xe.CAN_VIEW_OWN_REPORTS},{path:"/submit-eod/today",label:"Submit EOD",icon:de,permission:Xe.CAN_SUBMIT_OWN_EOD},{path:"/my-tasks",label:"My Tasks",icon:ue,permission:Xe.CAN_CREATE_PERSONAL_TASKS},{path:"/meetings",label:"Meetings",icon:me,permission:Xe.CAN_VIEW_OWN_MEETINGS},{path:"/manage-reports",label:"Manage Reports",icon:pe,permission:Xe.CAN_MANAGE_TEAM_REPORTS},{path:"/team-tasks",label:"Team Tasks",icon:fe,permission:Xe.CAN_MANAGE_TEAM_TASKS},{path:"/performance-hub",label:"Performance Hub",icon:he,permission:Xe.CAN_USE_PERFORMANCE_HUB},{path:"/delinquent-reports",label:"Consistency Tracker",icon:ge,permission:Xe.CAN_MANAGE_TEAM_REPORTS},{path:"/integrations",label:"Integrations",icon:xe,permission:"integrations"},{path:"/calendar-view",label:"Calendar View",icon:ye,permission:Xe.CAN_VIEW_OWN_CALENDAR},{path:"/user-management",label:"User Management",icon:be,permission:Xe.CAN_MANAGE_USERS},{path:"/roles-permissions",label:"Roles & Permissions",icon:oe,permission:Xe.CAN_MANAGE_ROLES},{path:"/manage-business-units",label:"Business Units",icon:ve,permission:Xe.CAN_MANAGE_BUSINESS_UNITS},{path:"/all-reports",label:"All Reports",icon:Ne,permission:Xe.CAN_VIEW_ALL_REPORTS},{path:"/admin/leave-records",label:"Leave Management",icon:we,permission:Xe.CAN_MANAGE_ALL_LEAVES},{path:"/announcements",label:"Announcement Studio",icon:ke,permission:Xe.CAN_MANAGE_ANNOUNCEMENTS}],Ox=({isOpen:e,onClose:t,isCollapsed:n,onToggleCollapse:a,hasUnseenMeetings:s})=>{const{currentUser:r,hasPermission:i}=Eh(),l=Dx.filter(e=>"dashboard"===e.permission||("super_admin"===e.permission?"Super Admin"===(null==r?void 0:r.roleName):"integrations"===e.permission?i(Xe.CAN_USE_GOOGLE_CALENDAR)||i(Xe.CAN_USE_TELEGRAM_BOT):i(e.permission)));return We.jsxs(We.Fragment,{children:[e&&We.jsx("div",{className:"fixed inset-0 z-30 bg-black bg-opacity-50 lg:hidden",onClick:t}),We.jsxs("aside",{className:`fixed inset-y-0 left-0 z-40 bg-surface-secondary/80 dark:bg-dark-surface-secondary/70 backdrop-blur-xl text-text-primary dark:text-dark-text border-r border-border-primary dark:border-dark-border transform ${e?"translate-x-0":"-translate-x-full"} lg:translate-x-0 transition-all duration-300 ease-in-out shadow-2xl flex flex-col ${n?"w-20":"w-64"}`,children:[We.jsxs("div",{className:`flex items-center h-16 mb-4 flex-shrink-0 transition-all duration-300 ${n?"px-3":"px-4"} justify-between`,children:[We.jsxs(c,{to:"/",className:"flex items-center overflow-hidden min-w-0",title:"Go to Dashboard",children:[We.jsx("i",{className:"fas fa-infinity text-primary dark:text-accent text-2xl flex-shrink-0"}),We.jsx("span",{className:"text-xl font-bold text-text-primary dark:text-dark-text whitespace-nowrap transition-all duration-200 "+(n?"w-0 opacity-0 ml-0":"w-auto opacity-100 ml-3"),children:"Syncly"})]}),We.jsxs("div",{className:"flex items-center gap-2",children:[We.jsx("button",{onClick:a,className:"hidden lg:flex items-center justify-center w-9 h-9 rounded-full border border-border-primary/60 dark:border-dark-border/60 bg-surface-inset/50 dark:bg-dark-surface-inset text-text-secondary dark:text-dark-text-secondary hover:text-text-primary dark:hover:text-dark-text transition-colors shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent dark:focus:ring-offset-dark-bg","aria-label":"Toggle sidebar",title:n?"Expand sidebar":"Collapse sidebar",children:n?We.jsx(Ee,{size:18,strokeWidth:1.75}):We.jsx(je,{size:18,strokeWidth:1.75})}),We.jsx("button",{onClick:t,className:"lg:hidden text-text-secondary dark:text-dark-text-secondary hover:text-text-primary dark:hover:text-dark-text",children:We.jsx("i",{className:"fas fa-times text-xl"})})]})]}),We.jsx("nav",{className:"flex-grow px-2 overflow-y-auto",children:We.jsx("ul",{children:l.map(e=>{const a=e.icon;return We.jsxs("li",{className:"mb-2 relative group",children:[We.jsxs(g,{to:e.path,end:e.end,onClick:()=>{window.innerWidth<1024&&t()},className:({isActive:e})=>`flex items-center p-3 rounded-lg hover:bg-primary-light dark:hover:bg-dark-surface-hover transition-colors duration-150 text-text-secondary dark:text-dark-text-secondary font-medium ${e?"bg-primary/90 dark:bg-accent/80 text-white dark:text-white shadow-lg":""} ${n?"justify-center":""}`,children:[We.jsx(a,{className:"flex-shrink-0 transition-all duration-300 "+(n?"":"mr-4"),size:20,strokeWidth:1.75,"aria-hidden":"true"}),We.jsx("span",{className:"whitespace-nowrap transition-all duration-200 "+(n?"w-0 opacity-0":"w-auto opacity-100"),children:e.label}),"/meetings"===e.path&&s&&We.jsx("span",{className:"absolute bg-accent rounded-full animate-pulse "+(n?"w-2 h-2 top-2 right-2":"w-2.5 h-2.5 top-1/2 -translate-y-1/2 right-4"),title:"New Meeting Activity"})]}),n&&We.jsx("span",{className:"absolute left-full ml-4 top-1/2 -translate-y-1/2 bg-dark-bg text-white text-xs font-bold px-3 py-1.5 rounded-md opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none whitespace-nowrap z-50",children:e.label})]},e.path)})})}),We.jsx("div",{className:"flex-shrink-0 mt-auto border-t border-border-primary/50 dark:border-dark-border/50",children:We.jsxs("div",{className:"text-xs text-center text-text-secondary dark:text-dark-text-secondary py-2 transition-opacity duration-200 overflow-hidden "+(n?"opacity-0 h-0":"opacity-100"),children:[" ",(new Date).getFullYear()," Syncly"]})})]})]})},Rx=()=>{const e=void 0!==window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,[t,n]=vh("theme",e?"dark":"light");o.useEffect(()=>{const e=window.document.documentElement;"dark"===t?e.classList.add("dark"):e.classList.remove("dark")},[t]);return We.jsxs("button",{onClick:()=>{n(e=>"light"===e?"dark":"light")},className:"relative w-[74px] h-[38px] bg-slate-900 rounded-full flex items-center justify-between p-2 transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary dark:focus:ring-offset-slate-950 shadow-inner","aria-label":`Switch to ${"light"===t?"dark":"light"} mode`,"aria-pressed":"dark"===t,type:"button",children:[We.jsx("div",{className:"absolute top-[3px] left-[3px] w-8 h-8 bg-white rounded-full shadow-lg transform transition-transform duration-300 ease-in-out",style:{transform:"dark"===t?"translateX(36px)":"translateX(0)"}}),We.jsx("div",{className:"relative z-10 w-8 h-8 flex items-center justify-center",children:We.jsx("i",{className:"fas fa-sun transition-colors duration-300 "+("light"===t?"text-yellow-400":"text-slate-500")})}),We.jsx("div",{className:"relative z-10 w-8 h-8 flex items-center justify-center",children:We.jsx("i",{className:"fas fa-moon transition-colors duration-300 "+("dark"===t?"text-yellow-300":"text-slate-500")})})]})},Px=e=>{const{currentTenantId:t}=Eh(),[n,a]=l.useState([]),[s,r]=l.useState(0),[i,o]=l.useState(!1),[c,d]=l.useState(!0),u=l.useRef(new Set);l.useEffect(()=>{if(!e||!t)return a([]),r(0),o(!1),void d(!1);let n;d(!0);try{const s=ee(sm,"notifications"),i=Q(s,J("tenantId","==",t),J("userId","==",e),X("timestamp","desc"));n=ie(i,e=>{const t=[];e.forEach(e=>{t.push({id:e.id,...e.data()})}),a(t);const n=t.filter(e=>!e.read);r(n.length),o(n.some(e=>e.isCrucial)),d(!1);const s=t.find(e=>!e.read&&e.isCrucial&&!u.current.has(e.id));s&&"Notification"in window&&"granted"===Notification.permission&&(u.current.add(s.id),new Notification("warning"===s.type?" Important Alert":" New Notification",{body:s.message,icon:"/icons/icon-192x192.png",badge:"/icons/icon-badge-72x72.png",tag:s.id,requireInteraction:!0,data:{url:s.link||"/"}}))},e=>{d(!1)})}catch(s){d(!1)}return()=>{n&&n()}},[e,t]);return{notifications:n,unreadCount:s,hasCrucialUnread:i,isLoading:c,markAsRead:l.useCallback(async e=>{await(async e=>{await nf.update(e,{read:!0})})(e)},[]),markAllAsRead:l.useCallback(async()=>{await(async e=>{const t=await nf.getByUser(e);for(const n of t)n.read||await nf.update(n.id,{read:!0})})(e||"")},[e]),clearReadNotifications:l.useCallback(async()=>{await(async e=>{const t=(await nf.getByUser(e)).filter(e=>e.read);for(const n of t)await nf.delete(n.id)})(e||"")},[e])}},Mx=({onToggleSidebar:e})=>{const{currentUser:t,logout:n,hasPermission:a}=Eh(),{addToast:s}=bh(),[r,i]=l.useState(!1),[o,c]=l.useState(!1),u=l.useRef(null),m=l.useRef(null),[p,f]=l.useState(!1),h=l.useRef(0),g=d(),[x,y]=l.useState(!1),[b,N]=l.useState(!1),[w,k]=l.useState(""),[E,j]=l.useState(""),[C,_]=l.useState(""),[T,S]=l.useState(""),[A,I]=l.useState(!1),[D,O]=l.useState(!1),[R,P]=l.useState(""),[M,U]=l.useState(!1),[L,F]=l.useState(null),[B,$]=l.useState(!1),G=!!t&&(t.isPlatformAdmin||"function"==typeof a&&a(Xe.CAN_USE_GEMINI_AI));l.useEffect(()=>{if(!D)return;const e=Nf();P(e??""),$(Boolean(e)),F(null);const t=wf(e=>{P(e??""),$(Boolean(e)),F(null)});return()=>{t()}},[D]);const V=l.useCallback(()=>{const e=R.trim();if(e){U(!0),F(null);try{(e=>{var t,n;if("undefined"==typeof window)return;const a=e.trim();if(a){try{null==(t=window.localStorage)||t.setItem(hf,a)}catch(s){}try{null==(n=window.sessionStorage)||n.setItem(hf,a)}catch(s){}yf(a)}})(e),s("Gemini API key saved to this device. AI tools are ready to use.","success"),$(!0),O(!1)}catch(t){F("Could not save the API key on this device. Please try again.")}finally{U(!1)}}else F("Please paste a valid Google Gemini API key to enable AI features.")},[R,s]),z=l.useCallback(()=>{(()=>{var e,t;if("undefined"!=typeof window){try{null==(e=window.localStorage)||e.removeItem(hf)}catch(n){}try{null==(t=window.sessionStorage)||t.removeItem(hf)}catch(n){}yf(null)}})(),P(""),F(null),$(!1),s("Gemini API key removed from this device.","info")},[s]),{notifications:W,unreadCount:q,hasCrucialUnread:H,markAsRead:K,markAllAsRead:Y,clearReadNotifications:J}=Px(null==t?void 0:t.id),Z=t?(e=>{const t=new Map,n=new Map,a=new Map,s=[],r=e.filter(e=>!e.read);for(const l of r)if("TASK_COMMENT_ADDED"===l.actionType&&l.targetId){const e=t.get(l.targetId)||{...l,actors:[]};l.actors&&e.actors.push(...l.actors),e.timestamp=Math.max(e.timestamp,l.timestamp),t.set(l.targetId,e)}else if("ACKNOWLEDGE_REPORT"===l.actionType){const e=n.get("pending-reports")||{...l,actors:[],id:"group-pending-reports"};l.actors&&e.actors.push(...l.actors),e.timestamp=Math.max(e.timestamp,l.timestamp),n.set("pending-reports",e)}else if("EOD_ACKNOWLEDGED"===l.actionType){const e=a.get("acknowledged-reports")||{...l,actors:[],id:"group-ack-reports"};l.actors&&e.actors.push(...l.actors),e.timestamp=Math.max(e.timestamp,l.timestamp),a.set("acknowledged-reports",e)}else s.push(l);const i=[];return t.forEach((e,t)=>{const n=Array.from(new Map(e.actors.map(e=>[e.id,e])).values()),a=e.message.match(/"(.*?)"/),s=a?a[0]:"a task";let r="";r=1===n.length?`${n[0].name} commented on: ${s}`:2===n.length?`${n[0].name} and ${n[1].name} commented on: ${s}`:`${n[0].name}, ${n[1].name}, and ${n.length-2} others commented on: ${s}`,i.push({...e,message:r,actors:n,id:`group-comment-${t}`})}),n.forEach(e=>{const t=Array.from(new Map(e.actors.map(e=>[e.id,e])).values());let n="";n=1===t.length?`${t[0].name} submitted a new EOD report.`:2===t.length?`${t[0].name} and ${t[1].name} submitted new reports.`:`${t[0].name}, ${t[1].name}, and ${t.length-2} others submitted reports.`,i.push({...e,message:n,actors:t})}),a.forEach(e=>{const t=Array.from(new Map(e.actors.map(e=>[e.id,e])).values());let n="";n=1===t.length?`Your report for ${t[0].name} has been acknowledged.`:2===t.length?`Your reports for ${t[0].name} and ${t[1].name} were acknowledged.`:`Your reports for ${t[0].name}, ${t[1].name}, and ${t.length-2} others were acknowledged.`,i.push({...e,message:n,actors:t})}),[...i,...s,...e.filter(e=>e.read)]})(W,t.id):[];l.useEffect(()=>{if(q>h.current){f(!0);const e=setTimeout(()=>f(!1),1500);return()=>clearTimeout(e)}h.current=q},[q]),l.useEffect(()=>{const e=e=>{u.current&&!u.current.contains(e.target)&&i(!1),m.current&&!m.current.contains(e.target)&&c(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const Q=async e=>{e.id.startsWith("group-")||await K(e.id),e.link&&g(e.link),c(!1)};if(!t)return null;const X=Z.some(e=>e.read&&e.userId===t.id),ee=e=>{if("TASK_COMMENT_ADDED"===e.actionType)return We.jsx("span",{className:"mr-3 text-xl","aria-hidden":"true",children:""});if("ACKNOWLEDGE_REPORT"===e.actionType)return We.jsx("i",{className:"fas fa-file-alt mr-3 text-green-500"});if("EOD_ACKNOWLEDGED"===e.actionType)return We.jsx("i",{className:"fas fa-check-circle mr-3 text-green-500"});switch(e.type){case"reminder":return We.jsx("span",{className:"mr-3 text-xl","aria-hidden":"true",children:""});case"warning":return We.jsx("i",{className:"fas fa-exclamation-triangle mr-3 text-red-500"});default:return We.jsx("i",{className:"fas fa-info-circle mr-3 text-blue-500"})}},te=[...Z].sort((e,t)=>e.read!==t.read?e.read?1:-1:(e.isCrucial||!1)!==(t.isCrucial||!1)?e.isCrucial?-1:1:t.timestamp-e.timestamp);return We.jsxs(We.Fragment,{children:[We.jsxs("header",{className:"bg-surface-primary/80 dark:bg-dark-surface-secondary/80 backdrop-blur-lg border-b border-border-primary dark:border-dark-border p-4 flex justify-between items-center sticky top-0 z-20",children:[We.jsxs("div",{className:"flex items-center",children:[We.jsx("button",{onClick:e,className:"lg:hidden mr-4 p-2.5 rounded-md text-text-primary dark:text-dark-text hover:bg-surface-hover dark:hover:bg-dark-surface-hover","aria-label":"Open sidebar",children:We.jsx("i",{className:"fas fa-bars text-xl"})}),We.jsxs("h2",{className:"text-xl font-semibold text-text-primary dark:text-dark-text hidden md:block",children:["Welcome, ",t.name.split(" ")[0],"!"]})]}),We.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[We.jsx(Rx,{}),We.jsxs("div",{className:"relative",ref:m,children:[We.jsxs("button",{onClick:()=>c(!o),className:"relative w-10 h-10 flex items-center justify-center rounded-full text-text-secondary dark:text-dark-text-secondary hover:bg-surface-hover dark:hover:bg-dark-surface-hover focus:outline-none focus:ring-2 focus:ring-accent focus:ring-offset-1 transition-all duration-200","aria-label":`Notifications, ${q} unread`,children:[We.jsx("span",{style:{filter:q>0?"grayscale(0)":"grayscale(1)",opacity:q>0?1:.7},className:"text-2xl transition-all duration-300 ease-in-out "+(H?"animate-pulse-slow":p?"animate-bounce":""),"aria-hidden":"true",children:""}),q>0&&We.jsx("span",{className:"absolute top-0 right-0 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-red-100 transform translate-x-1/2 -translate-y-1/2 bg-red-600 rounded-full",children:q})]}),o&&We.jsxs("div",{className:"absolute right-0 mt-2 w-80 sm:w-96 bg-surface-primary dark:bg-dark-surface-primary backdrop-blur-md rounded-lg shadow-2xl overflow-hidden z-20 border border-border-primary dark:border-dark-border",children:[We.jsxs("div",{className:"p-3 font-semibold text-sm text-text-primary dark:text-dark-text border-b dark:border-dark-border flex justify-between items-center bg-surface-secondary/50 dark:bg-dark-surface-secondary/50",children:[We.jsx("span",{children:"Notifications"}),q>0&&We.jsx("button",{onClick:async e=>{e.stopPropagation(),await Y(),s("All notifications marked as read.","info")},className:"text-xs text-primary dark:text-accent hover:underline font-semibold",children:"Mark all as Read"})]}),0===te.length?We.jsx("p",{className:"p-4 text-sm text-text-secondary dark:text-dark-text-secondary",children:"No new notifications."}):We.jsx("ul",{className:"max-h-96 overflow-y-auto",children:te.map(e=>We.jsxs("li",{onClick:()=>Q(e),onKeyDown:t=>"Enter"===t.key&&Q(e),role:"button",tabIndex:0,className:"w-full text-left p-3 border-b border-border-primary dark:border-dark-border/50 hover:bg-surface-hover dark:hover:bg-dark-surface-hover transition-colors cursor-pointer focus:outline-none focus:ring-2 focus:ring-inset focus:ring-accent "+(!e.read&&e.isCrucial?"bg-amber-400/20":e.read?"":"bg-primary/10 dark:bg-sky-500/10"),children:[We.jsxs("div",{className:"flex items-start",children:[ee(e),We.jsx("p",{className:"text-sm text-text-primary dark:text-dark-text flex-grow",children:e.message})]}),We.jsxs("div",{className:"flex justify-between items-center mt-1 pl-8",children:[We.jsx("p",{className:"text-xs text-text-secondary dark:text-dark-text-secondary",children:new Date(e.timestamp).toLocaleString()}),!e.read&&!e.id.startsWith("group-")&&We.jsx("button",{onClick:t=>(async(e,t)=>{e.stopPropagation(),await K(t)})(t,e.id),className:"text-xs text-primary dark:text-accent hover:underline font-semibold",children:"Mark as Read"})]}),"ACKNOWLEDGE_REPORT"===e.actionType&&e.targetId&&!e.read&&!e.id.startsWith("group-")&&We.jsx("div",{className:"pl-8 mt-2",children:We.jsxs(_h,{variant:"success",size:"sm",onClick:n=>(async(e,n,a)=>{if(e.stopPropagation(),t)try{await Rf({id:n,status:tt.ACKNOWLEDGED},t),s("Report Acknowledged!","success"),a.startsWith("group-")||await K(a)}catch(r){s("Failed to acknowledge report.","error")}})(n,e.targetId,e.id),className:"w-full",children:[We.jsx("i",{className:"fas fa-check-circle mr-2"})," Acknowledge Report"]})})]},e.id))}),Z.length>0&&We.jsxs("div",{className:"p-2 border-t dark:border-dark-border flex justify-end space-x-2 bg-surface-secondary/50 dark:bg-dark-surface-secondary/50",children:[We.jsx(_h,{variant:"ghost",size:"sm",onClick:async()=>{await J()},disabled:!X,children:"Clear Read"}),We.jsx(_h,{variant:"danger",size:"sm",onClick:()=>y(!0),children:"Clear All"})]})]})]}),We.jsxs("div",{className:"relative",ref:u,children:[We.jsxs("button",{onClick:()=>i(!r),className:"flex items-center focus:outline-none p-1 rounded-full hover:bg-surface-hover dark:hover:bg-dark-surface-hover focus:ring-2 focus:ring-accent focus:ring-offset-1 transition-colors",children:[We.jsx(Uh,{name:t.name,size:"md",className:"ring-2 ring-white/20 dark:ring-dark-bg/20"}),We.jsx("span",{className:"text-text-primary dark:text-dark-text font-semibold mr-2 hidden md:inline ml-2",children:t.name}),We.jsx("i",{className:"fas fa-chevron-down ml-1 text-text-secondary dark:text-dark-text-secondary transition-transform "+(r?"rotate-180":"")})]}),r&&We.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-surface-primary dark:bg-dark-surface-primary backdrop-blur-md rounded-lg shadow-2xl py-1 z-20 border border-border-primary dark:border-dark-border",children:[We.jsxs("div",{className:"px-4 py-3 text-sm text-text-secondary dark:text-dark-text-secondary border-b border-border-primary dark:border-dark-border/50",children:[We.jsx("p",{className:"font-semibold text-text-primary dark:text-dark-text",children:t.name}),We.jsx("p",{className:"text-xs",children:t.email}),We.jsx("p",{className:"text-xs mt-1 bg-surface-secondary dark:bg-dark-surface-secondary text-text-secondary dark:text-dark-text-secondary inline-block px-2 py-0.5 rounded-full",children:t.roleName||"Platform Admin"})]}),G&&We.jsxs("button",{onClick:()=>{O(!0),i(!1)},className:"w-full text-left block px-4 py-2 text-sm text-text-primary dark:text-dark-text hover:bg-surface-hover dark:hover:bg-dark-surface-hover",children:[We.jsx("i",{className:"fas fa-robot mr-2"}),"Manage AI API Key"]}),We.jsxs("button",{onClick:()=>{N(!0),i(!1)},className:"w-full text-left block px-4 py-2 text-sm text-text-primary dark:text-dark-text hover:bg-surface-hover dark:hover:bg-dark-surface-hover",children:[We.jsx("i",{className:"fas fa-key mr-2"}),"Change Password"]}),We.jsxs("button",{onClick:()=>{n(),i(!1)},className:"w-full text-left block px-4 py-2 text-sm text-red-600 hover:bg-red-500/10",children:[We.jsx("i",{className:"fas fa-sign-out-alt mr-2"}),"Logout"]})]})]})]})]}),We.jsx(Lh,{isOpen:x,onClose:()=>y(!1),onConfirm:async()=>{t&&(await(async e=>{const t=await nf.getByUser(e);for(const n of t)await nf.delete(n.id)})(t.id),s("All notifications have been cleared.","success"),y(!1))},title:"Confirm Clear All Notifications",confirmButtonVariant:"danger",confirmText:"Yes, Clear All",children:We.jsx("p",{children:"Are you sure you want to clear all your notifications? This action cannot be undone."})}),We.jsx(Dh,{isOpen:D,onClose:()=>{M||(O(!1),P(""),F(null))},title:"Manage AI API Key",children:We.jsxs("div",{className:"space-y-4",children:[We.jsxs(Th,{type:"info",message:"Enable AI assistance with Google Gemini",className:"mb-2",children:[We.jsx("p",{className:"text-sm",children:"Paste your personal Google Gemini API key to unlock AI-powered summaries and task helpers. The key stays on this device only and is never sent to Syncly servers."}),We.jsxs("p",{className:"text-sm",children:["Need a key?",We.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"Generate one in Google AI Studio "})]})]}),We.jsxs("div",{children:[We.jsx("label",{className:"block text-sm font-medium text-text-primary dark:text-dark-text mb-1",children:"Google Gemini API Key"}),We.jsx("input",{type:"password",value:R,onChange:e=>P(e.target.value),className:"w-full px-3 py-2 border border-border-primary dark:border-dark-border rounded-lg bg-surface-primary dark:bg-dark-surface-secondary text-text-primary dark:text-dark-text focus:outline-none focus:ring-2 focus:ring-accent",placeholder:"Paste your API key here",disabled:M})]}),L&&We.jsx("p",{className:"text-red-500 text-sm",children:L}),We.jsxs("div",{className:"flex flex-wrap justify-end gap-2 mt-4",children:[We.jsx(_h,{variant:"secondary",onClick:()=>{M||(O(!1),P(""),F(null))},disabled:M,children:"Close"}),We.jsx(_h,{variant:"ghost",onClick:z,disabled:M||!B,children:"Remove Key"}),We.jsx(_h,{variant:"primary",onClick:V,disabled:M||!R.trim(),isLoading:M,children:"Save Key"})]})]})}),We.jsx(Dh,{isOpen:b,onClose:()=>{N(!1),k(""),j(""),_(""),S("")},title:"Change Password",children:We.jsxs("div",{className:"space-y-4",children:[!(null==t?void 0:t.isPlatformAdmin)&&We.jsxs("div",{children:[We.jsx("label",{className:"block text-sm font-medium text-text-primary dark:text-dark-text mb-1",children:"Current Password"}),We.jsx("input",{type:"password",value:w,onChange:e=>k(e.target.value),className:"w-full px-3 py-2 border border-border-primary dark:border-dark-border rounded-lg bg-surface-primary dark:bg-dark-surface-secondary text-text-primary dark:text-dark-text focus:outline-none focus:ring-2 focus:ring-accent",placeholder:"Enter current password",disabled:A})]}),We.jsxs("div",{children:[We.jsx("label",{className:"block text-sm font-medium text-text-primary dark:text-dark-text mb-1",children:"New Password"}),We.jsx("input",{type:"password",value:E,onChange:e=>j(e.target.value),className:"w-full px-3 py-2 border border-border-primary dark:border-dark-border rounded-lg bg-surface-primary dark:bg-dark-surface-secondary text-text-primary dark:text-dark-text focus:outline-none focus:ring-2 focus:ring-accent",placeholder:"Enter new password (min 6 characters)",disabled:A})]}),We.jsxs("div",{children:[We.jsx("label",{className:"block text-sm font-medium text-text-primary dark:text-dark-text mb-1",children:"Confirm Password"}),We.jsx("input",{type:"password",value:C,onChange:e=>_(e.target.value),className:"w-full px-3 py-2 border border-border-primary dark:border-dark-border rounded-lg bg-surface-primary dark:bg-dark-surface-secondary text-text-primary dark:text-dark-text focus:outline-none focus:ring-2 focus:ring-accent",placeholder:"Confirm new password",disabled:A})]}),T&&We.jsx("p",{className:"text-red-500 text-sm",children:T}),We.jsxs("div",{className:"flex justify-end space-x-2 mt-4",children:[We.jsx(_h,{variant:"secondary",onClick:()=>{N(!1),k(""),j(""),_(""),S("")},disabled:A,children:"Cancel"}),We.jsxs(_h,{variant:"primary",onClick:async()=>{if(t){S(""),I(!0);try{const{updatePassword:e,reauthenticateWithCredential:t,EmailAuthProvider:n}=await v(async()=>{const{updatePassword:e,reauthenticateWithCredential:t,EmailAuthProvider:n}=await import("./firebase-B8V1oFvZ.js").then(e=>e.I);return{updatePassword:e,reauthenticateWithCredential:t,EmailAuthProvider:n}},[]),{auth:a}=await v(async()=>{const{auth:e}=await Promise.resolve().then(()=>lm);return{auth:e}},void 0),r=a.currentUser;if(!r)return S("Not authenticated"),void I(!1);const i=!0===(await r.getIdTokenResult()).claims.isPlatformAdmin;if(!i&&(!w||w.length<6))return S("Current password is required"),void I(!1);if(!E||E.length<6)return S("New password must be at least 6 characters long"),void I(!1);if(E!==C)return S("Passwords do not match"),void I(!1);if(!i){const e=n.credential(r.email,w);await t(r,e)}await e(r,E),s("Password changed successfully!","success"),N(!1),k(""),j(""),_(""),S("")}catch(e){"auth/wrong-password"===e.code?S("Current password is incorrect"):"auth/requires-recent-login"===e.code?S("Please log out and log back in before changing password"):S(e.message||"Failed to change password")}finally{I(!1)}}},disabled:A,children:[We.jsx("i",{className:`fas ${A?"fa-spinner fa-spin":"fa-key"} mr-2`}),A?"Changing...":"Change Password"]})]})]})})]})},Ux=()=>{try{const e=localStorage.getItem(Nt);return e?JSON.parse(e):{}}catch(e){return{}}},Lx=e=>{const t=Ux();t[e]=Date.now();try{localStorage.setItem(Nt,JSON.stringify(t))}catch(n){}},Fx=e=>!!Ux()[e],Bx=async e=>{if(!e)return;if(e.isPlatformAdmin)return;const t=new Date,n=(await Lf()).filter(t=>t.assignedTo.includes(e.id));await(async(e,t)=>{if(18!==t.getHours()||t.getMinutes()<45)return;const n=Ht(t),a=`eod-reminder-${e.id}-${n}`;if(Fx(a))return;if(!(await hh(t,e)))return void Lx(a);(await Of(e.id)).some(e=>e.date===n)||(await Xf({userId:e.id,message:" It's 6:45 PM. Time to prepare and submit your End-of-Day report!",type:"reminder",link:"/submit-eod/today",isCrucial:!0}),Lx(a))})(e,t),await(async(e,t)=>{if(9!==t.getHours()||t.getMinutes()<30||t.getMinutes()>34)return;let n=new Date(t);n.setDate(t.getDate()-1),n.setHours(0,0,0,0);let a=0;for(;a<7&&!(await hh(n,e));)n.setDate(n.getDate()-1),a++;const s=Ht(n),r=`missed-eod-nudge-${e.id}-${s}`;if(Fx(r))return;(await Of(e.id)).some(e=>e.date===s)||await Xf({userId:e.id,message:`You missed submitting your EOD report for ${Wt(s)}. Please submit a late report.`,type:"warning",link:`/submit-eod/${s}`,isCrucial:!0}),Lx(r)})(e,t),await(async(e,t,n)=>{if(18!==n.getHours()||n.getMinutes()>4)return;const a=new Date(n);a.setDate(n.getDate()+1);const s=Ht(a),r=t.filter(e=>e.dueDate===s&&e.status!==at.Completed);for(const i of r){const t=`task-due-tomorrow-${i.id}`;Fx(t)||(await Xf({userId:e.id,message:`Task due tomorrow: "${i.title}"`,type:"reminder",link:`/my-tasks?taskId=${i.id}`,isCrucial:!0}),Lx(t))}})(e,n,t),await(async(e,t,n)=>{if(9!==n.getHours()||n.getMinutes()>4)return;const a=Ht(n),s=t.filter(e=>e.dueDate===a&&e.status!==at.Completed);for(const r of s){const t=`task-due-today-${r.id}`;Fx(t)||(await Xf({userId:e.id,message:`Task is due today: "${r.title}"`,type:"reminder",link:`/my-tasks?taskId=${r.id}`,isCrucial:!0}),Lx(t))}})(e,n,t),await(async(e,t,n)=>{if(10!==n.getHours()||n.getMinutes()>4)return;const a=Ht(n),s=new Date(n.getFullYear(),n.getMonth(),n.getDate()),r=t.filter(e=>new Date(e.dueDate)<s&&e.status!==at.Completed);for(const i of r){const t=`task-overdue-${i.id}-${a}`;Fx(t)||(await Xf({userId:e.id,message:` Task is overdue: "${i.title}"`,type:"warning",link:`/my-tasks?taskId=${i.id}`,isCrucial:!0}),Lx(t))}})(e,n,t),await(async e=>{const t=await nh(e);for(const n of t){const t=`announcement-alert-${n.id}-${e.id}`;Fx(t)||(await Xf({userId:e.id,message:n.title,type:"info",link:"/announcements",targetId:n.id,targetType:"announcement"}),Lx(t))}})(e),await(async e=>{const t=await Jf();for(const n of t){const t=Kt(n);if(t){const a=t.getTime()-e.getTime(),s=Math.floor(a/6e4);if((10===s||5===s)&&a>0){const e=`meeting-reminder-${n.id}-${t.toISOString()}-${s}m`;if(Fx(e))continue;if(n.createdBy){const e=Date.now()+Math.random();tn.emit("show-meeting-reminder",{meeting:n,occurrenceDate:t,toastId:e})}for(const t of n.attendeeIds)t!==n.createdBy&&await Xf({userId:t,message:`Meeting starting in ${s} mins: "${n.title}"`,type:"reminder",link:`/meetings/${n.id}`,isCrucial:!0});Lx(e)}}}})(t),await(async e=>{if(15!==e.getMinutes())return;const t=await Jf(),n=864e5;for(const a of t){if("formal_meeting"!==a.meetingType||a.recurrenceEndDate)continue;const t=Kt(a);if(t){const s=t.getTime()-e.getTime();if(s>846e5&&s<=n){const e=`agenda-reminder-${a.id}-${t.toISOString()}`;if(Fx(e))continue;a.agenda&&""!==a.agenda.trim()||(await Xf({userId:a.createdBy,message:`Your meeting "${a.title}" is tomorrow. Consider adding an agenda to help attendees prepare.`,type:"info",link:`/meetings/${a.id}`}),Lx(e))}}}})(t),0===t.getMinutes()&&(()=>{const e=Ux(),t=Date.now(),n={};for(const a in e)Object.prototype.hasOwnProperty.call(e,a)&&t-e[a]<2592e5&&(n[a]=e[a]);localStorage.setItem(Nt,JSON.stringify(n))})()},$x=({meeting:e,occurrenceDate:t,allUsers:n,onClose:a})=>{const s=d(),{currentUser:r}=Eh(),{addToast:i}=bh(),l=n.filter(t=>e.attendeeIds.includes(t.id));return We.jsxs("div",{className:"p-1",children:[We.jsxs("h4",{className:"font-bold text-base text-slate-800 dark:text-slate-100 flex items-center",children:[We.jsx("i",{className:"fas fa-hourglass-start text-primary dark:text-sky-400 mr-2 animate-pulse"}),"Meeting Starting Soon"]}),We.jsx("p",{className:"font-semibold text-lg my-1 text-secondary dark:text-slate-200",children:e.title}),We.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:["at ",t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),We.jsxs("div",{className:"flex items-center -space-x-2 my-2",title:`${l.length} attendee(s)`,children:[l.slice(0,5).map(e=>We.jsx(Uh,{name:e.name,size:"sm",className:"border-2 border-white dark:border-slate-800"},e.id)),l.length>5&&We.jsxs("div",{className:"w-6 h-6 rounded-full bg-slate-200 text-slate-600 text-xs flex items-center justify-center border-2 border-white dark:border-slate-800",children:["+",l.length-5]})]}),We.jsxs("div",{className:"flex justify-end space-x-2 mt-3",children:[(null==r?void 0:r.id)===e.createdBy&&We.jsx(_h,{variant:"danger",size:"sm",onClick:async()=>{if(r){const n=t.toISOString().split("T")[0];await fh(e.id,n,r),i(`Skipped meeting: "${e.title}"`,"info"),a()}},children:"Skip This Time"}),We.jsx(_h,{variant:"primary",size:"sm",onClick:()=>{s(`/meetings/${e.id}`),a()},children:"Join Now"})]})]})},Gx=new Set(["P","BR","STRONG","B","EM","I","U","UL","OL","LI","SPAN","DIV","H1","H2","H3","H4"]),Vx=["color","font-size","font-weight","text-decoration"],zx=e=>{if(e.nodeType===Node.ELEMENT_NODE){const n=e;if(!Gx.has(n.tagName)){const e=n.parentNode;for(;n.firstChild;)null==e||e.insertBefore(n.firstChild,n);return void(null==e||e.removeChild(n))}if(n.hasAttribute("style")){const e=(t=n.getAttribute("style"))?t.split(";").map(e=>e.trim()).filter(e=>{const[t]=e.split(":").map(e=>e.trim().toLowerCase());return t&&Vx.includes(t)}).join("; "):"";e?n.setAttribute("style",e):n.removeAttribute("style")}const a=["style"];Array.from(n.attributes).forEach(e=>{a.includes(e.name.toLowerCase())||n.removeAttribute(e.name)})}var t;Array.from(e.childNodes).forEach(zx)},Wx=e=>{if(!e)return"";if("undefined"==typeof window||"undefined"==typeof DOMParser)return e;try{const t=new DOMParser,n=t.parseFromString(`<div data-rich-text-root>${e}</div>`,"text/html").querySelector("[data-rich-text-root]");return n?(Array.from(n.childNodes).forEach(zx),n.innerHTML||""):e}catch{return e}},qx=({announcements:e,isOpen:t,onDismiss:n})=>{const[a,s]=l.useState(0);l.useEffect(()=>{s(0)},[e.length]);const r=e[a],i=l.useMemo(()=>r?Wx(r.content||""):"",[r]);if(!t||!r)return null;const o=async(e=!1)=>{await n(r,e)},c=r.media&&r.media.length>0,d=e.length-(a+1);return We.jsx("div",{className:"fixed inset-0 z-[999] flex items-center justify-center bg-slate-900/70 backdrop-blur-sm p-4",children:We.jsxs("div",{className:"relative w-full max-w-4xl rounded-3xl bg-white dark:bg-slate-900 shadow-2xl overflow-hidden animate-fade-in-up",children:[We.jsxs("div",{className:"absolute top-4 right-4 flex items-center gap-2 text-xs font-semibold text-slate-500 dark:text-slate-400",children:[d>0&&We.jsxs("span",{className:"px-2 py-1 rounded-full bg-slate-100 dark:bg-slate-800",children:[d+1," announcements"]}),We.jsx("button",{onClick:()=>o(!1),className:"w-10 h-10 rounded-full bg-white/80 dark:bg-slate-800/80 text-slate-600 dark:text-slate-300 hover:bg-white dark:hover:bg-slate-700 shadow","aria-label":"Dismiss announcement",children:We.jsx("i",{className:"fas fa-times"})})]}),c&&We.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 p-4 bg-gradient-to-r from-indigo-50 via-sky-50 to-cyan-50 dark:from-slate-800 dark:via-slate-800/70 dark:to-slate-900 border-b border-slate-100 dark:border-slate-800",children:r.media.map((e,t)=>We.jsxs("figure",{className:"h-56 rounded-2xl overflow-hidden relative",children:[We.jsx("img",{src:e.storageUrl,alt:e.caption||`Announcement media ${t+1}`,className:"object-cover w-full h-full"}),e.caption&&We.jsx("figcaption",{className:"absolute bottom-0 inset-x-0 bg-slate-900/60 text-white text-xs px-3 py-1.5",children:e.caption})]},e.id))}),We.jsxs("div",{className:"p-8 space-y-6",children:[We.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[We.jsxs("div",{children:[We.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400 dark:text-slate-500",children:"Announcement"}),We.jsx("h2",{className:"text-3xl font-extrabold text-slate-900 dark:text-white tracking-tight break-words",children:r.title})]}),We.jsxs("div",{className:"text-sm text-slate-500 dark:text-slate-400",children:[We.jsxs("p",{children:["Active from"," ",We.jsx("span",{className:"font-semibold text-slate-700 dark:text-slate-200",children:qt(new Date(r.startsAt))})]}),We.jsxs("p",{children:["until"," ",We.jsx("span",{className:"font-semibold text-slate-700 dark:text-slate-200",children:qt(new Date(r.endsAt))})]})]})]}),We.jsx("article",{className:"prose prose-slate dark:prose-invert max-w-none leading-relaxed text-lg",dangerouslySetInnerHTML:{__html:i}}),We.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 border-t border-slate-100 dark:border-slate-800 pt-4",children:[We.jsxs("div",{className:"text-xs uppercase tracking-[0.3em] text-slate-400 dark:text-slate-500",children:["Posted by ",r.createdByName]}),We.jsxs("div",{className:"flex gap-3",children:[We.jsx("button",{onClick:()=>o(!1),className:"px-4 py-2 rounded-full border border-slate-300 dark:border-slate-600 text-slate-600 dark:text-slate-200 text-sm font-semibold hover:bg-slate-50 dark:hover:bg-slate-800 transition",children:"Close"}),r.requireAcknowledgement&&We.jsx("button",{onClick:()=>o(!0),className:"px-5 py-2 rounded-full bg-primary text-white text-sm font-semibold shadow hover:bg-primary/90 transition",children:"I Acknowledge"})]})]})]})]})})},Hx=({children:e})=>{const{currentUser:t}=Eh(),{addToast:n,removeToast:a}=bh(),[s,r]=l.useState([]),[i,o]=l.useState(!1),[c,d]=vh("sidebar_collapsed",!1),[u,m]=l.useState(!1),[p,f]=l.useState([]),[h,g]=l.useState(!1);l.useEffect(()=>{t&&!t.isPlatformAdmin&&Cf().then(r)},[t]);const x=l.useCallback(async()=>{if(t&&!t.isPlatformAdmin){const e=(await dh(t.id)).some(e=>{var n;return!(null==(n=e.seenBy)?void 0:n.includes(t.id))});m(e)}},[t]),y=l.useCallback(async()=>{if(!t||t.isPlatformAdmin)return f([]),void g(!1);try{const[e,n]=await Promise.all([nh(t),sh(t.id)]),a=e.filter(e=>{const t=n[e.id];if(!t)return!0;const a=t.acknowledgedAt||t.viewedAt;return(e.updatedAt||e.startsAt)>(a||0)});f(a),g(a.length>0)}catch(e){}},[t]);if(l.useEffect(()=>{x();const e=tn.on("appDataChanged",e=>{(null==e?void 0:e.keyChanged)===wt&&x(),(null==e?void 0:e.keyChanged)===jt&&y()});return()=>e()},[x,y]),l.useEffect(()=>{y()},[y]),l.useEffect(()=>{const e=e=>{e.key&&e.key.startsWith("eod_")&&tn.emit("appDataChanged",{keyChanged:e.key})};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}},[]),l.useEffect(()=>(window.innerWidth<1024&&i?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[i]),l.useEffect(()=>{const e="notification_permission_requested",t=localStorage.getItem(e);"Notification"in window&&"default"===Notification.permission&&!t&&Notification.requestPermission().then(t=>{localStorage.setItem(e,"true")})},[]),l.useEffect(()=>{const e=tn.on("show-meeting-reminder",e=>{const t=e.toastId;n(We.jsx($x,{meeting:e.meeting,occurrenceDate:e.occurrenceDate,allUsers:s,onClose:()=>a(t)}),"custom",1/0)});return()=>e()},[n,a,s]),l.useEffect(()=>{if(!t)return;Bx(t);const e=setInterval(()=>{t&&Bx(t)},6e4);return()=>{clearInterval(e)}},[t]),!t)return null;return We.jsxs("div",{className:"flex h-screen bg-transparent",children:[We.jsx(Ox,{isOpen:i,onClose:()=>o(!1),isCollapsed:c,onToggleCollapse:()=>d(e=>!e),hasUnseenMeetings:u}),We.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden transition-all duration-300 ease-in-out "+(c?"lg:ml-20":"lg:ml-64"),children:[We.jsx(Mx,{onToggleSidebar:()=>o(!i)}),We.jsx(qx,{announcements:p,isOpen:h,onDismiss:async(e,n)=>{t&&(await(async(e,t,n)=>{const a=`${e}_${t.id}`,s=await sf.getByUser(e,t.id),r=Date.now(),i={id:a,announcementId:e,tenantId:Up(),userId:t.id,viewedAt:(null==s?void 0:s.viewedAt)??r,acknowledgedAt:(null==n?void 0:n.acknowledge)?r:null==s?void 0:s.acknowledgedAt};await sf.upsert(a,i),uf();const l=await th(e);l&&((null==n?void 0:n.acknowledge)?await Ef({timestamp:r,actorId:t.id,actorName:t.name,type:dt.ANNOUNCEMENT_ACKNOWLEDGED,description:`acknowledged "${l.title}"`,targetId:l.id,targetName:l.title}):s||await Ef({timestamp:r,actorId:t.id,actorName:t.name,type:dt.ANNOUNCEMENT_VIEWED,description:`viewed "${l.title}"`,targetId:l.id,targetName:l.title}))})(e.id,t,{acknowledge:n}),await y())}}),We.jsx("main",{className:"flex-1 overflow-x-hidden overflow-y-auto animate-fade-in-up",children:e})]})]})},Kx=({message:e,type:t,duration:n=4e3,onClose:a})=>{const[s,r]=l.useState(!1);l.useEffect(()=>{if(n!==1/0){const e=setTimeout(()=>{r(!0),setTimeout(a,300)},n);return()=>clearTimeout(e)}},[a,n]);const i={success:We.jsx("i",{className:"fas fa-check-circle mr-3"}),error:We.jsx("i",{className:"fas fa-exclamation-circle mr-3"}),info:We.jsx("span",{className:"mr-3 text-xl","aria-hidden":"true",children:""}),warning:We.jsx("i",{className:"fas fa-exclamation-triangle mr-3"}),custom:null},o="custom"===t,c="string"==typeof e?We.jsxs("div",{className:"flex items-center",children:[We.jsx("div",{className:"text-xl",children:i[t]}),We.jsx("div",{className:"flex-grow font-medium",children:e})]}):e;return We.jsx("div",{className:`p-4 rounded-xl shadow-2xl transition-all duration-300 ease-in-out transform w-full ${{success:"bg-emerald-500 text-white dark:bg-emerald-500/90 dark:text-emerald-50",error:"bg-red-500 text-white dark:bg-red-500/90 dark:text-red-50",info:"bg-blue-500 text-white dark:bg-sky-500/90 dark:text-sky-50",warning:"bg-amber-500 text-white dark:bg-amber-500/90 dark:text-amber-50",custom:"bg-white dark:bg-dark-surface-secondary text-text-primary dark:text-dark-text-primary border border-border-primary dark:border-dark-border"}[t]} ${s?"opacity-0 translate-x-full":"opacity-100 translate-x-0"}`,role:"alert",children:We.jsxs("div",{className:"flex items-start",children:[We.jsx("div",{className:"flex-grow",children:c}),We.jsx("button",{onClick:()=>{r(!0),setTimeout(a,300)},"aria-label":"Dismiss",className:"ml-4 text-xl font-semibold opacity-80 hover:opacity-100 "+(o?"text-text-secondary dark:text-dark-text-secondary":""),children:""})]})})},Yx=()=>{const{toasts:e,removeToast:t}=bh();return We.jsx("div",{className:"fixed top-5 right-5 z-[100] w-full max-w-xs space-y-3",children:e.map(e=>We.jsx(Kx,{message:e.message,type:e.type,duration:e.duration,onClose:()=>t(e.id)},e.id))})},Jx=({allLeaveRecords:e,allUsers:t,allBusinessUnits:n})=>{const{addToast:a}=bh(),[s,r]=f(),[i,o]=l.useState(!1),[c,d]=l.useState(!1),u=l.useRef(null),m=s.get("search")||"",p=s.get("startDate")||null,h=s.get("endDate")||null,g=s.get("employee")||"",x=s.get("bu")||"",y=parseInt(s.get("page")||"1",10);l.useEffect(()=>{const e=e=>{u.current&&!u.current.contains(e.target)&&d(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const b=l.useMemo(()=>t.filter(e=>"Employee"===e.roleName).map(e=>({value:e.id,label:e.name})),[t]),v=l.useMemo(()=>n.map(e=>({value:e.id,label:e.name})),[n]),j=l.useMemo(()=>e.filter(e=>{const n=t.find(t=>t.id===e.employeeId);if(!n||"Employee"!==n.roleName)return!1;const a=m.toLowerCase(),s=e.employeeName.toLowerCase().includes(a)||(null==n?void 0:n.email)&&n.email.toLowerCase().includes(a)||(null==n?void 0:n.designation)&&n.designation.toLowerCase().includes(a)||e.reason&&e.reason.toLowerCase().includes(a),r=!g||e.employeeId===g,i=new Date(e.date+"T00:00:00Z"),l=p?new Date(p+"T00:00:00Z"):null,o=h?new Date(h+"T23:59:59Z"):null,c=(!l||i>=l)&&(!o||i<=o),d=!x||n&&n.businessUnitId===x;return s&&r&&c&&d}).sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()||e.employeeName.localeCompare(t.employeeName)),[e,m,p,h,g,x,t]),C=Math.ceil(j.length/15),_=l.useMemo(()=>{const e=15*(y-1);return j.slice(e,e+15)},[j,y]),T=(e,t)=>{const n=new URLSearchParams(s);t?n.set(e,t):n.delete(e),"page"!==e&&n.delete("page"),r(n)},S=(e,t)=>{const n=new URLSearchParams(s);t?n.set(e,t):n.delete(e);const i=n.get("startDate"),l=n.get("endDate");i&&l&&i>l?a("Start date cannot be after end date.","error"):(n.delete("page"),r(n))},A=e=>{e>=1&&e<=C&&T("page",String(e))},I=async e=>{o(!0);const n=j.map(e=>{const n=t.find(t=>t.id===e.employeeId);return{"Employee ID":e.employeeId,"Employee Name":e.employeeName,"Employee Email":(null==n?void 0:n.email)||"N/A",Designation:(null==n?void 0:n.designation)||"N/A","Business Unit":e.businessUnitName||"N/A","Leave Date":Wt(e.date),"Leave Status":e.status,Reason:e.reason||"N/A","Marked At":qt(e.createdAt)}});if(0===n.length)return alert("No data to export based on current filters."),void o(!1);if(await new Promise(e=>setTimeout(e,100)),"csv"===e){const e=Object.keys(n[0]),t="data:text/csv;charset=utf-8,"+e.join(",")+"\n"+n.map(t=>e.map(e=>`"${String(t[e]).replace(/"/g,'""')}"`).join(",")).join("\n"),a=encodeURI(t),s=document.createElement("a");s.setAttribute("href",a),s.setAttribute("download","leave_records.csv"),document.body.appendChild(s),s.click(),document.body.removeChild(s)}else if("pdf"===e){const e=new N({orientation:"landscape"}),t=Object.keys(n[0]),a=n.map(e=>t.map(t=>String(e[t])));w(e,{head:[t],body:a,styles:{fontSize:7,cellPadding:1.5},headStyles:{fillColor:[0,85,164],fontSize:8},margin:{top:10,right:7,bottom:10,left:7}}),e.save("leave_records.pdf")}else if("excel"===e){const e=k.json_to_sheet(n),t=k.book_new();k.book_append_sheet(t,e,"Leave Records"),E(t,"leave_records.xlsx")}d(!1),o(!1)};return!i||_.length||j.length?We.jsxs(Ih,{title:"Employee Leave Records",titleIcon:We.jsx("i",{className:"fas fa-calendar-times"}),actions:We.jsxs("div",{className:"relative",ref:u,children:[We.jsxs(_h,{variant:"secondary",onClick:()=>d(!c),icon:We.jsx("i",{className:"fas fa-file-export"}),disabled:0===j.length||i,isLoading:i,children:["Export (",j.length,")",We.jsx("i",{className:"fas fa-chevron-down ml-2 transition-transform "+(c?"rotate-180":"")})]}),c&&We.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-surface-primary dark:bg-dark-surface-primary rounded-md shadow-lg py-1 z-20 border border-border-primary dark:border-dark-border",children:[We.jsxs("button",{onClick:()=>I("csv"),className:"w-full text-left block px-4 py-2 text-sm text-text-primary dark:text-dark-text hover:bg-surface-hover dark:hover:bg-dark-surface-hover hover:text-primary",children:[We.jsx("i",{className:"fas fa-file-csv mr-2"}),"Export as CSV"]}),We.jsxs("button",{onClick:()=>I("pdf"),className:"w-full text-left block px-4 py-2 text-sm text-text-primary dark:text-dark-text hover:bg-surface-hover dark:hover:bg-dark-surface-hover hover:text-primary",children:[We.jsx("i",{className:"fas fa-file-pdf mr-2"}),"Export as PDF"]}),We.jsxs("button",{onClick:()=>I("excel"),className:"w-full text-left block px-4 py-2 text-sm text-text-primary dark:text-dark-text hover:bg-surface-hover dark:hover:bg-dark-surface-hover hover:text-primary",children:[We.jsx("i",{className:"fas fa-file-excel mr-2"}),"Export as Excel"]})]})]}),children:[We.jsxs("div",{className:"mb-4 p-3 border rounded-md bg-surface-secondary dark:bg-dark-surface-secondary dark:border-dark-border",children:[We.jsx("h3",{className:"text-base font-medium text-primary dark:text-sky-400 mb-1",children:"Filter Leave Records"}),We.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3 items-end",children:[We.jsx(Ch,{type:"text",placeholder:"Search (name, email, design., reason...)",value:m,onChange:e=>T("search",e.target.value),wrapperClassName:"mb-0"}),We.jsx(Oh,{options:[{value:"",label:"All Employees"},...b],value:g,onChange:e=>T("employee",e.target.value),wrapperClassName:"mb-0",placeholder:"Filter by Employee"}),We.jsx(Oh,{options:[{value:"",label:"All Business Units"},...v],value:x,onChange:e=>T("bu",e.target.value),wrapperClassName:"mb-0",placeholder:"Filter by Business Unit"}),We.jsx(Ch,{type:"date",label:"Leave Start Date",value:p||"",onChange:e=>S("startDate",e.target.value||null),max:h||void 0,wrapperClassName:"mb-0"}),We.jsx(Ch,{type:"date",label:"Leave End Date",value:h||"",onChange:e=>S("endDate",e.target.value||null),min:p||void 0,wrapperClassName:"mb-0"}),We.jsx("div",{className:"lg:col-start-4",children:We.jsx(_h,{onClick:()=>{r({})},variant:"ghost",className:"w-full",children:"Reset Filters"})})]})]}),We.jsx("div",{className:"overflow-x-auto",children:We.jsxs("table",{className:"min-w-full divide-y divide-border-primary dark:divide-dark-border",children:[We.jsx("thead",{className:"bg-surface-secondary dark:bg-dark-surface-secondary",children:We.jsxs("tr",{children:[We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase",children:"Employee Name"}),We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase",children:"Email"}),We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase",children:"Designation"}),We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase",children:"Business Unit"}),We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase",children:"Leave Date"}),We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase",children:"Reason"}),We.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary dark:text-dark-text-secondary uppercase",children:"Marked At"})]})}),We.jsxs("tbody",{className:"bg-surface-primary dark:bg-dark-surface-primary divide-y divide-border-primary dark:divide-dark-border",children:[_.map(e=>{const n=t.find(t=>t.id===e.employeeId);return We.jsxs("tr",{className:"hover:bg-surface-hover dark:hover:bg-dark-surface-hover",children:[We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-text-primary dark:text-dark-text",children:e.employeeName}),We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-text-secondary dark:text-dark-text-secondary",children:(null==n?void 0:n.email)||"N/A"}),We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-text-secondary dark:text-dark-text-secondary",children:(null==n?void 0:n.designation)||"N/A"}),We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-text-secondary dark:text-dark-text-secondary",children:e.businessUnitName||"N/A"}),We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-text-secondary dark:text-dark-text-secondary",children:Wt(e.date)}),We.jsx("td",{className:"px-6 py-4 whitespace-normal text-sm text-text-secondary dark:text-dark-text-secondary break-words max-w-xs",children:e.reason||"N/A"}),We.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-text-secondary dark:text-dark-text-secondary",children:qt(e.createdAt)})]},e.id)}),0===j.length&&We.jsx("tr",{children:We.jsx("td",{colSpan:7,className:"text-center py-8 text-text-secondary dark:text-dark-text-secondary",children:"No leave records match your filters."})})]})]})}),C>1&&We.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row justify-between items-center space-y-3 sm:space-y-0",children:[We.jsxs("span",{className:"text-sm text-text-secondary dark:text-dark-text-secondary",children:["Page ",y," of ",C," (Total records: ",j.length,")"]}),We.jsxs("div",{className:"flex items-center",children:[We.jsx(_h,{onClick:()=>A(y-1),disabled:1===y,variant:"ghost",size:"sm",icon:We.jsx("i",{className:"fas fa-chevron-left"}),className:"mr-2",children:"Prev"}),(()=>{const e=[];if(C<=7)for(let t=1;t<=C;t++)e.push(We.jsx(_h,{onClick:()=>A(t),variant:t===y?"primary":"ghost",size:"sm",className:"mx-1",children:t},t));else{e.push(We.jsx(_h,{onClick:()=>A(1),variant:1===y?"primary":"ghost",size:"sm",className:"mx-1",children:"1"},1));let t=Math.max(2,y-Math.floor(1.5)),n=Math.min(C-1,y+Math.floor(1.5));y<=Math.ceil(2.5)?n=4:y>C-Math.ceil(2.5)&&(t=C-3),t>2&&e.push(We.jsx("span",{className:"mx-1 p-2",children:"..."},"start-ellipsis"));for(let a=t;a<=n;a++)e.push(We.jsx(_h,{onClick:()=>A(a),variant:a===y?"primary":"ghost",size:"sm",className:"mx-1",children:a},a));n<C-1&&e.push(We.jsx("span",{className:"mx-1 p-2",children:"..."},"end-ellipsis")),e.push(We.jsx(_h,{onClick:()=>A(C),variant:C===y?"primary":"ghost",size:"sm",className:"mx-1",children:C},C))}return e})(),We.jsx(_h,{onClick:()=>A(y+1),disabled:y===C,variant:"ghost",size:"sm",icon:We.jsx("i",{className:"fas fa-chevron-right"}),className:"ml-2",children:"Next"})]})]})]}):We.jsx(Ph,{message:"Loading leave records..."})},Zx=()=>{const{currentUser:e,hasPermission:t}=Eh(),[n,a]=l.useState([]),[s,r]=l.useState([]),[i,o]=l.useState([]),[c,d]=l.useState(!0);if(l.useEffect(()=>{(async()=>{d(!0);const[e,t,n]=await Promise.all([zf(),Cf(),If()]);a(e),r(t),o(n),d(!1)})()},[]),c)return We.jsx(Ah,{title:"Manage Leave Records",children:We.jsx(Ph,{message:"Loading leave records..."})});const u=t(Xe.CAN_VIEW_ALL_REPORTS)||"HR"===(null==e?void 0:e.roleName)||(null==e?void 0:e.isPlatformAdmin),m=null==e?void 0:e.businessUnitId,p=u?s:m?s.filter(e=>e.businessUnitId===m):[],f=new Set(p.map(e=>e.id)),h=u?n:m?n.filter(e=>f.has(e.employeeId)):[],g=u?i:m?i.filter(e=>e.id===m):[];return We.jsx(Ah,{title:"Manage All Employee Leave Records",children:We.jsx(Jx,{allLeaveRecords:h,allUsers:p,allBusinessUnits:g})})},{Link:Qx}=m,Xx=e=>{const[t,n,a]=e.split("-").map(Number),s=new Date(Date.UTC(t,n-1,a));if((e=>{const t=new Date;return e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()})(s))return"Today";if((e=>{const t=new Date;return t.setDate(t.getDate()-1),e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()})(s))return"Yesterday";return s.toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric",timeZone:"UTC"})},ey=()=>{const{currentUser:e}=Eh(),[t,n]=l.useState([]),[a,s]=l.useState([]),[r,i]=l.useState(!0),[o,c]=l.useState({startDate:null,endDate:null}),{addToast:d}=bh();l.useEffect(()=>{(async()=>{if(e){i(!0);const[t,a]=await Promise.all([dh(e.id),Cf()]);n(t),s(a),i(!1)}})()},[e]);const u=l.useMemo(()=>t.filter(e=>{if(!o.startDate&&!o.endDate)return!0;const t=Ht(new Date(e.meetingDateTime)),n=!o.startDate||t>=o.startDate,a=!o.endDate||t<=o.endDate;return n&&a}),[t,o]),m=l.useMemo(()=>{const e=new Map;return u.forEach(t=>{const n=Ht(new Date(t.meetingDateTime));e.has(n)||e.set(n,[]),e.get(n).push(t)}),Array.from(e.entries()).sort((e,t)=>t[0].localeCompare(e[0])).map(([e,t])=>({date:e,meetings:t.sort((e,t)=>e.meetingDateTime-t.meetingDateTime)}))},[u]),p="Manager"===(null==e?void 0:e.roleName)?"Meeting Workspaces":"My Meetings";return r?We.jsx(Ah,{title:p,children:We.jsx(Ph,{message:"Loading meetings..."})}):We.jsxs(Ah,{title:p,children:[We.jsx(Ih,{className:"mb-6",children:We.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-end",children:[We.jsx(Ch,{label:"Filter From Date",type:"date",value:o.startDate||"",onChange:e=>{const t=e.target.value||null;o.endDate&&t&&t>o.endDate?d("Start date cannot be after end date.","error"):c(e=>({...e,startDate:t}))}}),We.jsx(Ch,{label:"Filter To Date",type:"date",value:o.endDate||"",onChange:e=>c(t=>({...t,endDate:e.target.value||null})),min:o.startDate||void 0}),We.jsx(_h,{onClick:()=>c({startDate:null,endDate:null}),variant:"ghost",children:"Reset Date Filter"})]})}),0===t.length?We.jsx(gg,{icon:We.jsx("i",{className:"fas fa-folder-open"}),title:"No Meetings Found",message:"Manager"===(null==e?void 0:e.roleName)?"You haven't created any meetings yet. Use the 'New Meeting' button to get started.":"You haven't been invited to any meetings yet."}):0===m.length?We.jsx(gg,{icon:We.jsx("i",{className:"fas fa-calendar-times"}),title:"No Meetings in Range",message:"No meetings match the selected date range. Try adjusting or resetting the date filter."}):We.jsx("div",{className:"space-y-6",children:m.map(({date:e,meetings:t})=>We.jsxs("div",{children:[We.jsx("h2",{className:"text-lg font-bold text-slate-700 dark:text-slate-300 mb-3 ml-2",children:Xx(e)}),We.jsx("div",{className:"space-y-3",children:t.map(e=>"live_memo"===e.meetingType?We.jsx(Qx,{to:`/meetings/${e.id}`,className:"block group animate-fade-in-up",children:We.jsxs("div",{className:"flex items-stretch",children:[We.jsx("div",{className:"w-2 bg-amber-500 rounded-l-xl"}),We.jsx(Ih,{className:"flex-grow !rounded-l-none group-hover:border-amber-500/50 dark:group-hover:border-amber-500/50",children:We.jsxs("div",{className:"flex flex-col sm:flex-row items-start justify-between gap-4",children:[We.jsxs("div",{children:[We.jsx("p",{className:"font-semibold text-lg text-amber-700 dark:text-amber-400 group-hover:underline",children:e.title}),We.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:[We.jsx("i",{className:"fas fa-bolt mr-2"}),"Live Memo captured at ",new Date(e.meetingDateTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),We.jsxs("div",{className:"flex items-center -space-x-2",title:`${e.attendeeIds.length} attendee(s)`,children:[e.attendeeIds.slice(0,4).map(e=>{const t=a.find(t=>t.id===e);return t?We.jsx(Uh,{name:t.name,size:"md",className:"border-2 border-white dark:border-slate-900"},e):null}),e.attendeeIds.length>4&&We.jsxs("div",{className:"w-8 h-8 rounded-full bg-slate-200 text-slate-600 text-xs flex items-center justify-center border-2 border-white dark:border-slate-900 dark:bg-slate-700 dark:text-slate-200",children:["+",e.attendeeIds.length-4]})]})]})})]})},e.id):We.jsx(Qx,{to:`/meetings/${e.id}`,className:"block group animate-fade-in-up",children:We.jsxs("div",{className:"flex items-stretch",children:[We.jsx("div",{className:"w-2 bg-blue-500 dark:bg-sky-500 rounded-l-xl"}),We.jsx(Ih,{className:"flex-grow !rounded-l-none group-hover:border-primary/50 dark:group-hover:border-sky-500/50",children:We.jsxs("div",{className:"flex flex-col sm:flex-row items-start justify-between gap-4",children:[We.jsxs("div",{children:[We.jsx("p",{className:"font-semibold text-lg text-primary dark:text-sky-400 group-hover:underline",children:e.title}),We.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:[We.jsx("i",{className:"far fa-clock mr-2"}),new Date(e.meetingDateTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),We.jsxs("div",{className:"flex items-center -space-x-2",children:[e.attendeeIds.slice(0,4).map(e=>{const t=a.find(t=>t.id===e);return t?We.jsx(Uh,{name:t.name,size:"md",className:"border-2 border-white dark:border-slate-900"},e):null}),e.attendeeIds.length>4&&We.jsxs("div",{className:"w-8 h-8 rounded-full bg-slate-200 text-slate-600 text-xs flex items-center justify-center border-2 border-white dark:border-slate-900 dark:bg-slate-700 dark:text-slate-200",children:["+",e.attendeeIds.length-4]})]})]})})]})},e.id))})]},e))})]})},ty=(e,t="")=>{if(null==e)return t;if("string"==typeof e||"number"==typeof e)return String(e);try{return JSON.stringify(e)}catch{return t}},ny=({task:e,allUsers:t,currentUser:n,onViewTask:a,onUpdateMemberStatus:s,onUpdateTask:r})=>{var i,l;const o=e=>{var n;return(null==(n=t.find(t=>t.id===e))?void 0:n.name)||"Unknown"},c=e.assignedTo.includes(n.id),d=c&&(null==(l=null==(i=e.memberProgress)?void 0:i[n.id])?void 0:l.status)||at.NotStarted,u=Object.values(at).filter(e=>e!==at.Blocked).map(e=>({value:e,label:e})),m=c&&(e.taskType===st.Team||e.taskType===st.Direct)&&e.status!==at.Completed;return We.jsxs("div",{className:"block w-full text-left p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg hover:shadow-md transition-shadow relative",children:[We.jsxs("div",{className:"flex justify-between items-start",children:[We.jsxs("div",{className:"flex-grow pr-4",children:[We.jsx("p",{onClick:()=>a(e),className:"font-semibold text-slate-800 dark:text-slate-200 cursor-pointer hover:underline",children:e.title}),We.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:["Due: ",Wt(e.dueDate)]})]}),We.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${(e=>{switch(e){case"Completed":return"bg-emerald-100 text-emerald-800 dark:bg-emerald-900/50 dark:text-emerald-300";case"In Progress":return"bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-300";case"Blocked":return"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300";default:return"bg-slate-100 text-slate-800 dark:bg-slate-700 dark:text-slate-300"}})(e.status)}`,children:e.status})]}),We.jsxs("div",{className:"mt-2 pt-2 border-t border-slate-200 dark:border-slate-700/50 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2",children:[We.jsxs("div",{className:"flex items-center gap-2",children:[We.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Assigned To:"}),We.jsx("div",{className:"flex flex-wrap gap-1",children:e.assignedTo.map(e=>We.jsxs("div",{className:"flex items-center bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 text-xs font-medium px-1.5 py-0.5 rounded-full shadow-sm",children:[We.jsx(Uh,{name:o(e),size:"sm",className:"w-4 h-4 text-[10px] mr-1.5"}),We.jsx("span",{children:o(e)})]},e))})]}),m&&We.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[We.jsx("label",{htmlFor:`status-select-${e.id}`,className:"text-xs font-medium text-slate-600 dark:text-slate-300",children:"My Status:"}),We.jsx(Oh,{id:`status-select-${e.id}`,options:u,value:e.taskType===st.Team?d:e.status,onChange:t=>{const n=t.target.value;e.taskType===st.Team?s(e.id,n):e.taskType===st.Direct&&r(e.id,{status:n})},wrapperClassName:"!mb-0 flex-grow",className:"!mt-0 !text-xs !py-1"})]})]})]})},ay=({tasks:e,allUsers:t,currentUser:n,onViewTask:a,onUpdateMemberStatus:s,onUpdateTask:r})=>We.jsx("div",{className:"space-y-3",children:e.map(e=>We.jsx(ny,{task:e,allUsers:t,currentUser:n,onViewTask:a,onUpdateMemberStatus:s,onUpdateTask:r},e.id))}),sy=({previousSessionData:e,onCopyNote:t,onCopyTask:n,allUsers:a})=>{if(!e)return We.jsx("div",{className:"p-4 mb-4 bg-slate-100 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700/50 rounded-lg text-center text-sm text-slate-500 italic",children:"This is the first session for this recurring meeting."});const{instance:s,tasks:r}=e,i=s.meetingMinutes,l=e=>{var t;return(null==(t=a.find(t=>t.id===e))?void 0:t.name)||"Unknown"};return We.jsxs("div",{className:"p-4 bg-indigo-50 dark:bg-indigo-900/40 border border-indigo-200 dark:border-indigo-800/50 rounded-lg h-full flex flex-col",children:[We.jsxs("h4",{className:"text-md font-semibold text-indigo-800 dark:text-indigo-200 flex items-center mb-3 flex-shrink-0",children:[We.jsx("i",{className:"fas fa-history mr-2"})," Recall: ",Wt(s.occurrenceDate)]}),We.jsxs("div",{className:"space-y-4 overflow-y-auto flex-grow",children:[We.jsxs("div",{children:[We.jsxs("h5",{className:"text-sm font-bold uppercase text-indigo-600 dark:text-indigo-300 tracking-wider",children:["Pending Action Items (",r.length,")"]}),We.jsx("div",{className:"mt-2 space-y-2",children:r.length>0?r.map(e=>We.jsxs("div",{className:"text-sm p-2 bg-white/60 dark:bg-slate-800/40 rounded-md flex justify-between items-start gap-2",children:[We.jsxs("div",{className:"flex-grow",children:[We.jsx("p",{className:"font-medium text-slate-800 dark:text-slate-200",children:e.title}),We.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[We.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:"To:"}),We.jsx("div",{className:"flex -space-x-2",children:e.assignedTo.map(e=>We.jsx(Uh,{name:l(e),size:"sm",className:"border border-white dark:border-slate-800"},e))})]})]}),We.jsx(_h,{variant:"ghost",size:"sm",onClick:()=>n((e=>{let t=`/task ${e.title}`;e.assignedTo&&e.assignedTo.length>0&&(t+=e.assignedTo.map(e=>{const t=a.find(t=>t.id===e);return t?` @[${t.name}](${t.id})`:""}).filter(e=>""!==e).join(""));return e.dueDate&&(t+=` due:${e.dueDate}`),e.priority&&"Medium"!==e.priority&&(t+=` priority:${e.priority.toLowerCase()}`),t})(e)),icon:We.jsx("i",{className:"fas fa-plus-circle"}),className:"!p-1 h-auto flex-shrink-0",title:"Carry over this task with original assignees","aria-label":"Carry over this pending task to the current session with all metadata preserved"})]},e.id)):We.jsx("p",{className:"text-xs text-indigo-700 dark:text-indigo-300 italic p-2",children:"All tasks from the previous session were completed. Great job!"})})]}),i&&We.jsxs("div",{className:"pt-3 border-t border-indigo-200/50 dark:border-indigo-700/50",children:[We.jsxs("div",{className:"flex justify-between items-center",children:[We.jsx("h5",{className:"text-xs font-bold uppercase text-indigo-600 dark:text-indigo-300 tracking-wider",children:"Previous Minutes"}),We.jsx(_h,{variant:"ghost",size:"sm",onClick:()=>t(i),icon:We.jsx("i",{className:"fas fa-copy"}),className:"!p-1 h-auto",title:"Copy note to current session","aria-label":"Copy previous notes to the current session"})]}),We.jsx("div",{className:"mt-2 text-sm p-2 bg-white/60 dark:bg-slate-800/40 rounded-md max-h-48 overflow-y-auto",children:We.jsx("div",{className:"whitespace-pre-wrap prose prose-sm dark:prose-invert max-w-full",children:Wd(i,a)})})]})]})]})},ry=({isOpen:e,onClose:t,onConfirm:n,initialTasks:a,meetingTitle:s,attendees:r})=>{const[i,o]=l.useState([]);return l.useEffect(()=>{o(JSON.parse(JSON.stringify(a)))},[a,e]),We.jsx(Dh,{isOpen:e,onClose:t,title:`Finalize: ${s}`,size:"lg",footer:We.jsxs(We.Fragment,{children:[We.jsx(_h,{variant:"ghost",onClick:t,children:"Cancel"}),We.jsxs(_h,{variant:"primary",onClick:()=>n(i),children:[We.jsx("i",{className:"fas fa-check-circle mr-2"})," Confirm & Distribute"]})]}),children:We.jsxs("div",{className:"space-y-4",children:[We.jsx("p",{className:"text-slate-600 dark:text-slate-300",children:"Review the action items detected in your notes. They will be created and assigned upon confirmation."}),i.length>0?We.jsx("div",{className:"space-y-3 max-h-[50vh] overflow-y-auto p-2 bg-slate-100 dark:bg-slate-800/50 rounded-md",children:i.map((e,t)=>We.jsx(Dg,{task:e,attendees:r},t))}):We.jsx("p",{className:"text-center text-slate-500 italic py-6",children:"No action items were detected in the notes."})]})})},{useParams:iy,useNavigate:ly,useSearchParams:oy}=m,cy=()=>{const{meetingId:e}=iy(),[t]=oy(),n=t.get("date"),{currentUser:a}=Eh(),s=ly(),{addToast:r}=bh(),{isSignedIn:i,signIn:o}=Fg(),[c,d]=l.useState(null),[u,m]=l.useState([]),[p,f]=l.useState([]),[h,g]=l.useState(!0),[x,y]=l.useState(!1),[b,v]=l.useState(""),[N,w]=l.useState(!1),[k,E]=l.useState(null),[j,C]=l.useState(!1),[_,T]=l.useState(""),[S,A]=l.useState(null),[I,D]=l.useState(null),[O,R]=l.useState(null),[P,M]=l.useState(null),[U,L]=l.useState([]),[F,B]=l.useState(null),$=l.useMemo(()=>U.find(e=>e.id===F)||null,[U,F]),G=l.useRef(!1),V=l.useMemo(()=>c?p.filter(e=>(c.attendeeIds||[]).includes(e.id)):[],[c,p]),z=l.useCallback(async()=>{if(e&&a)try{const[t,i,l,o]=await Promise.all([Zf(e),Cf(),Lf(),Qf(e)]);if(!t||!Array.isArray(t.attendeeIds)||!t.attendeeIds.includes(a.id)&&t.createdBy!==a.id)return r("You don't have access to this meeting.","error"),void s("/dashboard");G.current||(await(async(e,t)=>{const n=await tf.getById(e);if(n){const a=new Set(n.seenBy||[]);a.add(t),await tf.update(e,{seenBy:Array.from(a)})}})(e,a.id),G.current=!0),d(t),f(i),L(o);const c=n?o.find(e=>e.occurrenceDate===n):o.length>0?o[0]:null;B(c?c.id:null),m(l.filter(e=>((null==c?void 0:c.taskIds)||[]).includes(e.id)))}catch(t){r("Failed to load meeting workspace.","error"),s("/dashboard")}else s("/")},[e,a,s,r,n]);l.useEffect(()=>{var e;if((null==c?void 0:c.recurrenceRule)&&"none"!==c.recurrenceRule&&!x){const t=new Date;t.setHours(0,0,0,0);let n=null,a=new Date(c.meetingDateTime);for(;a<t;){const t=Ht(a),s=U.some(e=>e.occurrenceDate===t),r=null==(e=c.cancelledOccurrences)?void 0:e.includes(t);switch(s||r||(n=t),c.recurrenceRule){case"daily":a.setDate(a.getDate()+1);break;case"weekly":a.setDate(a.getDate()+7);break;case"monthly":a.setMonth(a.getMonth()+1)}}E(n)}else E(null)},[c,U,x]),l.useEffect(()=>{let e=!0;(async()=>{g(!0),await z(),e&&g(!1)})();const t=tn.on("appDataChanged",t=>{e&&t&&(t.keyChanged===wt||t.keyChanged===bt)&&z()});return()=>{e=!1,t()}},[z]);const W=l.useMemo(()=>cn(b,0,null==c?void 0:c.attendeeIds),[b,V,c]),q=l.useMemo(()=>cn(_,0,null==c?void 0:c.attendeeIds),[_,V,c]),H=l.useCallback(async(e,t,n,s)=>{if(a&&c){g(!0),w(!1),y(!1),C(!1);try{const i=await Yf(c.id,n,t,e,a,s);i.calendarSynced?r("Session finalized and synced to your calendar!","success"):i.error?r(`Session finalized, but calendar sync failed: ${i.error}`,"warning",6e3):r("Session finalized successfully!","success")}catch(i){r(`An error occurred during finalization: ${i.message}`,"error")}finally{g(!1),await z()}}},[a,c,r,z]);l.useEffect(()=>{if(i&&I){r("Google Sign-In successful. Resuming action...","success");const{data:e}=I;H(e.tasks,e.notes,e.date,e.isAsync),D(null)}},[i,I,H,r]);const K=async()=>{if(c&&k){const e=await gh(c,new Date(k+"T23:59:59"));A(e),T(""),C(!0)}},Y=async()=>{if(!(a&&c&&k&&_.trim()))return;const e={tasks:q,notes:_,date:k,isAsync:!0};if(c.googleEventId&&!i)return r("Please sign in with Google to continue.","info"),D({type:"catch-up",data:e}),void o();await H(e.tasks,e.notes,e.date,e.isAsync)};if(h||!c||!a)return We.jsx(Ah,{children:We.jsx(Ph,{message:"Loading Meeting Workspace..."})});const J=a.id===c.createdBy,Z=c.recurrenceRule&&"none"!==c.recurrenceRule,Q=Kt(c);return We.jsxs(Ah,{children:[x&&J?We.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-6",children:[We.jsx("div",{className:"lg:col-span-2",children:We.jsx(Ih,{title:"Live Notes & Task Creation",className:"h-full flex flex-col",children:We.jsx(Rg,{value:b,onChange:v,placeholder:"Type notes... Use / to create tasks.",className:"flex-grow !border-0 !p-0 focus:!ring-0",wrapperClassName:"flex-grow",availableUsers:V})})}),We.jsx("div",{className:"lg:col-span-2",children:We.jsx(Ih,{title:"Action Items Preview",className:"h-full flex flex-col",children:We.jsx("div",{className:"space-y-2 flex-grow overflow-y-auto p-1",children:W.length>0?W.map((e,t)=>We.jsx(Dg,{task:e,attendees:V},t)):We.jsx("p",{className:"text-sm italic text-slate-500 text-center pt-8",children:"No tasks detected."})})})}),We.jsxs("div",{className:"lg:col-span-1 space-y-4",children:[We.jsx(sy,{previousSessionData:S,onCopyNote:e=>v(t=>`${t}\n\n${e}`),onCopyTask:e=>v(t=>`${t}\n${e}`),allUsers:p}),We.jsxs("div",{className:"flex-shrink-0 flex flex-col gap-2 mt-4",children:[We.jsx(_h,{variant:"primary",onClick:()=>w(!0),children:"Finalize Session"}),We.jsx(_h,{variant:"ghost",onClick:()=>y(!1),children:"Cancel Session"})]})]})]}):We.jsxs("div",{className:"space-y-6",children:[We.jsx(Ih,{children:We.jsxs("div",{className:"flex justify-between items-start",children:[We.jsxs("div",{children:[We.jsx("h2",{className:"text-2xl font-bold text-darktext dark:text-slate-200",children:ty(c.title)}),We.jsxs("p",{className:"text-slate-500 dark:text-slate-400",children:[Z?"Series started:":"Scheduled:"," ",qt(c.meetingDateTime)]}),Z&&Q&&!c.recurrenceEndDate&&We.jsxs("p",{className:"text-sm text-indigo-600 dark:text-indigo-400 font-semibold mt-1",children:["Next: ",qt(Q)]}),c.recurrenceEndDate&&We.jsxs("p",{className:"text-sm text-red-500 font-semibold mt-1",children:["Series Ended on: ",Wt(c.recurrenceEndDate)]})]}),J&&(!c.recurrenceEndDate||!Z)&&We.jsx(_h,{onClick:async()=>{if(c)if(v(c.agenda||`Meeting Notes for ${c.title}\n\n`),c.recurrenceRule&&"none"!==c.recurrenceRule){const e=await gh(c,new Date);A(e)}else A(null);y(!0)},variant:"secondary",icon:We.jsx("i",{className:"fas fa-bolt"}),children:"Start Live Session"})]})}),!k||x?null:j?We.jsx(Ih,{title:`Post Asynchronous Update for ${Wt(k)}`,className:"mb-6 bg-amber-50 dark:bg-amber-900/40",children:We.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-6",children:[We.jsxs("div",{className:"lg:col-span-3 space-y-3",children:[We.jsx(Rg,{placeholder:"Enter notes and tasks from your catch-up meeting...",value:_,onChange:T,rows:6,availableUsers:V}),q.length>0&&We.jsxs("div",{className:"mt-2",children:[We.jsx("h4",{className:"text-sm font-semibold",children:"Detected Tasks:"}),We.jsx("div",{className:"space-y-1 mt-1 max-h-40 overflow-y-auto",children:q.map((e,t)=>We.jsx(Dg,{task:e,attendees:V},t))})]}),We.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[We.jsx(_h,{variant:"ghost",size:"sm",onClick:()=>C(!1),children:"Cancel"}),We.jsx(_h,{variant:"primary",size:"sm",onClick:Y,isLoading:h,disabled:!_.trim(),children:"Post Catch-up Update"})]})]}),We.jsx("div",{className:"lg:col-span-2",children:We.jsx(sy,{previousSessionData:S,onCopyNote:e=>T(t=>`${t}\n\n${e}`),onCopyTask:e=>T(t=>`${t}\n${e}`),allUsers:p})})]})}):We.jsx(Th,{type:"info",className:"mb-6",children:We.jsxs("div",{className:"flex justify-between items-center",children:[We.jsxs("div",{children:[We.jsx("p",{className:"font-semibold",children:"Missed a session?"}),We.jsxs("p",{children:["It looks like you missed the session for ",Wt(k),"."]})]}),We.jsx(_h,{onClick:K,children:"Post Asynchronous Update"})]})}),We.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[We.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[We.jsx(Ih,{title:`Action Items (${u.length})`,titleIcon:We.jsx("i",{className:"fas fa-tasks text-teal-500"}),children:We.jsx(ay,{tasks:u,allUsers:p,currentUser:a,onViewTask:R,onUpdateMemberStatus:async(e,t)=>{await Gf(e,a.id,t,a),z()},onUpdateTask:async(e,t)=>{await Bf(e,t,a),z()}})}),We.jsx(Ih,{title:$?`Minutes for ${Wt($.occurrenceDate)}`:"Agenda",children:We.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none whitespace-pre-wrap",children:$?Wd(ty($.meetingMinutes),p)||We.jsx("p",{className:"italic",children:"No minutes."}):Wd(ty(c.agenda||""),p)||We.jsx("p",{className:"italic",children:"No agenda."})})})]}),We.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[Z&&We.jsx(Ih,{title:"Session History",children:0===U.length?We.jsx("p",{className:"text-center text-sm text-slate-500 py-4 italic",children:"No sessions finalized."}):We.jsx("ul",{className:"space-y-2 max-h-60 overflow-y-auto pr-2",children:U.map(e=>We.jsx("li",{children:We.jsxs("button",{onClick:()=>B(e.id),className:"w-full text-left p-3 rounded-md transition-colors "+(F===e.id?"bg-primary text-white shadow-md":"bg-slate-100 dark:bg-slate-800 hover:bg-primary-light dark:hover:bg-slate-700"),children:[We.jsxs("div",{className:"flex justify-between items-center",children:[We.jsx("span",{className:"font-semibold",children:Wt(e.occurrenceDate)}),e.isAsynchronous&&We.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-300",children:"Catch-up"})]}),We.jsxs("span",{className:"text-xs block opacity-80",children:[e.taskIds.length," action items"]})]})},e.id))})}),We.jsx(Ih,{title:`Attendees (${V.length})`,titleIcon:We.jsx("i",{className:"fas fa-users text-purple-500"}),children:We.jsx("div",{className:"space-y-3",children:V.map(e=>We.jsxs("div",{className:"flex items-center",children:[We.jsx(Uh,{name:ty(e.name),size:"md",className:"mr-3"}),We.jsxs("div",{children:[We.jsx("p",{className:"font-semibold text-sm text-darktext dark:text-slate-200",children:ty(e.name)}),We.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:ty(e.designation)})]})]},e.id))})})]})]})]}),N&&We.jsx(ry,{isOpen:N,onClose:()=>w(!1),onConfirm:async e=>{if(!a||!c)return;const t={tasks:e,notes:b,date:Ht(new Date),isAsync:!1};if(c.googleEventId&&!i)return r("Please sign in with Google to continue.","info"),D({type:"finalize",data:t}),w(!1),void o();await H(t.tasks,t.notes,t.date,t.isAsync)},initialTasks:W,meetingTitle:c.title,attendees:V}),We.jsx(jx,{isOpen:!!O,onClose:()=>R(null),task:O,onUpdateTask:async(e,t)=>{await Bf(e,t,a),z()},currentUser:a,onEditTask:e=>{R(null),M(e)}}),We.jsx(Dh,{isOpen:!!P,onClose:()=>M(null),title:"Edit Task",children:We.jsx(Nx,{taskToEdit:P,currentUser:a,onSave:async()=>{await z(),M(null)},onCancel:()=>M(null)})})]})},dy=()=>{const{isSignedIn:e,isGapiReady:t,signIn:n,signOut:a,googleUser:s,initializationError:r}=Fg(),{currentUser:i}=Eh(),[o,c]=l.useState(!1),[d,u]=l.useState(null),[m,p]=l.useState(!1),[f,h]=l.useState(null),[g,x]=l.useState(!0),y=l.useRef(!1);l.useEffect(()=>{y.current=m},[m]),l.useEffect(()=>{if(!(null==i?void 0:i.id))return x(!1),c(!1),void u(null);x(!0);const e=z(sm,"users",i.id),t=ie(e,e=>{const t=e.data(),n=Boolean(null==t?void 0:t.telegramChatId);c(n),u((null==t?void 0:t.telegramUsername)||null),x(!1),y.current&&n&&(y.current=!1,p(!1),h("Telegram connected successfully!"))},e=>{h("Failed to check Telegram connection status. Please try again."),x(!1)});return()=>t()},[null==i?void 0:i.id]),l.useEffect(()=>{if(!m)return;const e=setTimeout(()=>{y.current=!1,p(!1),h(e=>e??"Still waiting for Telegram confirmation...")},3e4);return()=>clearTimeout(e)},[m]);const b=async()=>{p(!0),h(null);try{const e=await pg();window.open(e.deepLink,"_blank"),h("Opening Telegram... Follow the instructions in the bot to complete linking.")}catch(e){h(e.message||"Failed to generate linking code. Please try again."),p(!1)}},v=async()=>{if(i&&confirm("Are you sure you want to disconnect Telegram? You will no longer receive notifications via Telegram."))try{await q(z(sm,"users",i.id),{telegramChatId:null,telegramUsername:null,telegramFirstName:null,telegramLastName:null}),c(!1),u(null),h("Telegram disconnected successfully. You can reconnect anytime.")}catch(e){h("Failed to disconnect Telegram. Please try again.")}},N=(e,t,n)=>We.jsxs(Ih,{className:"flex flex-col opacity-50",children:[We.jsxs("div",{className:"flex items-center mb-4",children:[We.jsx("img",{src:t,alt:e,className:"w-12 h-12 mr-4"}),We.jsxs("div",{children:[We.jsx("h3",{className:"text-xl font-semibold text-darktext dark:text-slate-200",children:e}),We.jsx("p",{className:"text-sm text-mediumtext dark:text-slate-400",children:n})]})]}),We.jsx("div",{className:"flex-grow flex items-center justify-center",children:We.jsx("span",{className:"text-sm font-semibold text-mediumtext dark:text-slate-400 bg-slate-200 dark:bg-slate-700 px-3 py-1 rounded-full",children:"Coming Soon"})}),We.jsx("div",{className:"mt-auto pt-4 border-t border-border-primary dark:border-dark-border",children:We.jsx(_h,{variant:"ghost",disabled:!0,className:"w-full",children:"Connect"})})]});return We.jsxs(Ah,{title:"Syncly Integrations",children:[We.jsx("p",{className:"mb-6 text-mediumtext dark:text-slate-400",children:"Connect your favorite tools to Syncly to streamline your workflow."}),We.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[We.jsxs(Ih,{className:"flex flex-col",children:[We.jsxs("div",{className:"flex items-center mb-4",children:[We.jsx("img",{src:"https://www.gstatic.com/images/branding/product/2x/calendar_48dp.png",alt:"Google Calendar",className:"w-12 h-12 mr-4"}),We.jsxs("div",{children:[We.jsx("h3",{className:"text-xl font-semibold text-darktext dark:text-slate-200",children:"Google Calendar"}),We.jsx("p",{className:"text-sm text-mediumtext dark:text-slate-400",children:"Sync your formal meetings directly to your calendar."})]})]}),We.jsx("div",{className:"flex-grow flex items-center justify-center py-4 min-h-[100px]",children:r?We.jsx(Th,{type:"error",message:r}):t?e?We.jsx("div",{className:"text-center",children:s?We.jsxs(We.Fragment,{children:[We.jsx(Uh,{name:s.name,size:"lg",className:"mx-auto mb-2"}),We.jsx("p",{className:"font-semibold text-darktext dark:text-slate-200",children:s.name}),We.jsx("p",{className:"text-sm text-mediumtext dark:text-slate-400",children:s.email}),We.jsxs("span",{className:"mt-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-emerald-100 text-emerald-800 dark:bg-emerald-900/50 dark:text-emerald-300",children:[We.jsx("i",{className:"fas fa-check-circle mr-1.5"})," Connected"]})]}):We.jsxs(We.Fragment,{children:[We.jsxs("span",{className:"mt-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-emerald-100 text-emerald-800 dark:bg-emerald-900/50 dark:text-emerald-300",children:[We.jsx("i",{className:"fas fa-check-circle mr-1.5"})," Connected"]}),We.jsx("p",{className:"text-xs text-mediumtext dark:text-slate-400 mt-2",children:"Syncly has permission to create calendar events."})]})}):We.jsx("p",{className:"text-sm text-mediumtext dark:text-slate-400",children:"Connect your Google account to enable calendar sync for new meetings."}):We.jsx(Ph,{message:"Initializing..."})}),We.jsx("div",{className:"mt-auto pt-4 border-t border-border-primary dark:border-dark-border",children:t&&!r&&(e?We.jsx(_h,{variant:"danger",onClick:a,className:"w-full",children:"Disconnect Google Calendar"}):We.jsx(_h,{variant:"primary",onClick:n,className:"w-full",children:"Connect Google Calendar"}))})]}),We.jsxs(Ih,{className:"flex flex-col",children:[We.jsxs("div",{className:"flex items-center mb-4",children:[We.jsx("div",{className:"w-12 h-12 mr-4 flex items-center justify-center bg-blue-500 rounded-lg text-white text-2xl",children:We.jsx("i",{className:"fab fa-telegram-plane"})}),We.jsxs("div",{children:[We.jsx("h3",{className:"text-xl font-semibold text-darktext dark:text-slate-200",children:"Telegram"}),We.jsx("p",{className:"text-sm text-mediumtext dark:text-slate-400",children:"Get notifications and manage tasks via Telegram bot."})]})]}),f&&We.jsx(Th,{type:f.includes("success")?"success":"info",message:f,className:"mb-4"}),We.jsx("div",{className:"flex-grow flex items-center justify-center py-4 min-h-[100px]",children:g?We.jsx(Ph,{message:"Checking status..."}):o?We.jsxs("div",{className:"text-center",children:[We.jsx("div",{className:"w-16 h-16 mx-auto mb-2 flex items-center justify-center bg-blue-100 dark:bg-blue-900/30 rounded-full text-blue-600 dark:text-blue-400 text-3xl",children:We.jsx("i",{className:"fab fa-telegram-plane"})}),d&&We.jsxs("p",{className:"font-semibold text-darktext dark:text-slate-200",children:["@",d]}),We.jsxs("span",{className:"mt-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-emerald-100 text-emerald-800 dark:bg-emerald-900/50 dark:text-emerald-300",children:[We.jsx("i",{className:"fas fa-check-circle mr-1.5"})," Connected"]})]}):We.jsxs("div",{className:"text-center px-4",children:[We.jsx("p",{className:"text-sm text-mediumtext dark:text-slate-400 mb-3",children:"Connect your Telegram account to receive:"}),We.jsxs("ul",{className:"text-xs text-mediumtext dark:text-slate-400 space-y-1 text-left max-w-xs mx-auto",children:[We.jsx("li",{children:" Real-time task notifications"}),We.jsx("li",{children:" Daily EOD reminders"}),We.jsx("li",{children:" Meeting alerts"}),We.jsx("li",{children:" Streak milestones"})]})]})}),We.jsx("div",{className:"mt-auto pt-4 border-t border-border-primary dark:border-dark-border",children:o?We.jsx(_h,{variant:"danger",onClick:v,className:"w-full",children:"Disconnect Telegram"}):We.jsx(_h,{variant:"primary",onClick:b,disabled:m,className:"w-full",children:m?"Opening...":"Connect Telegram"})})]}),N("Slack","https://a.slack-edge.com/80588/marketing/img/meta/slack_hash_256.png","Get task notifications and reminders in Slack."),N("Jira","https://cdn.worldvectorlogo.com/logos/jira-1.svg","Sync tasks and issues between Syncly and Jira.")]})]})},uy=()=>{const e=d();return We.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-indigo-50",children:[We.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-50",children:We.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:We.jsxs("div",{className:"flex items-center justify-between",children:[We.jsxs("button",{onClick:()=>e("/"),className:"flex items-center space-x-3 group",children:[We.jsx("div",{className:"bg-gradient-to-br from-indigo-600 to-purple-600 text-white p-2.5 rounded-xl shadow-lg group-hover:scale-110 transition-transform duration-300",children:We.jsx("i",{className:"fas fa-infinity text-2xl"})}),We.jsx("span",{className:"text-2xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent",children:"Syncly"})]}),We.jsxs("button",{onClick:()=>e("/"),className:"text-gray-600 hover:text-indigo-600 transition-colors",children:[We.jsx("i",{className:"fas fa-arrow-left mr-2"}),"Back to Home"]})]})})}),We.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:[We.jsx("h1",{className:"text-5xl font-extrabold text-gray-900 mb-4 text-center",children:"Terms of Service"}),We.jsx("p",{className:"text-center text-gray-600 mb-12 text-lg",children:"Last Updated: October 23, 2025"}),We.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 md:p-12 space-y-8",children:[We.jsxs("div",{children:[We.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"1. Acceptance of Terms"}),We.jsx("p",{className:"text-gray-700 leading-relaxed",children:"By accessing or using Syncly's services, you agree to be bound by these Terms of Service. If you do not agree to these terms, please do not use our services."})]}),We.jsxs("div",{children:[We.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"2. Service Description"}),We.jsx("p",{className:"text-gray-700 leading-relaxed mb-4",children:"Syncly provides an AI-powered team collaboration platform that includes:"}),We.jsxs("ul",{className:"list-disc list-inside space-y-2 text-gray-700 ml-4",children:[We.jsx("li",{children:"End-of-Day (EOD) reporting with AI summaries"}),We.jsx("li",{children:"Task management and Kanban boards"}),We.jsx("li",{children:"Smart meeting assistant with Google Calendar integration"}),We.jsx("li",{children:"Performance tracking and gamification"}),We.jsx("li",{children:"AI-powered consistency tracking"})]})]}),We.jsxs("div",{children:[We.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"3. Account Registration"}),We.jsx("p",{className:"text-gray-700 leading-relaxed mb-4",children:"To use Syncly, you must:"}),We.jsxs("ul",{className:"list-disc list-inside space-y-2 text-gray-700 ml-4",children:[We.jsx("li",{children:"Provide accurate and complete registration information"}),We.jsx("li",{children:"Maintain the security of your account credentials"}),We.jsx("li",{children:"Be at least 18 years old or have parental consent"}),We.jsx("li",{children:"Notify us immediately of any unauthorized account access"}),We.jsx("li",{children:"Accept responsibility for all activities under your account"})]})]}),We.jsxs("div",{children:[We.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"4. Subscription and Payment"}),We.jsxs("p",{className:"text-gray-700 leading-relaxed mb-3",children:[We.jsx("strong",{children:"Free Trial:"})," New users receive a 14-day free trial with full access to all features."]}),We.jsxs("p",{className:"text-gray-700 leading-relaxed mb-4",children:[We.jsx("strong",{children:"Paid Plans:"})," After the trial, you may subscribe to our Starter, Professional, or Enterprise plans."]}),We.jsxs("ul",{className:"list-disc list-inside space-y-2 text-gray-700 ml-4",children:[We.jsx("li",{children:"Subscriptions are billed monthly or annually"}),We.jsx("li",{children:"Payments are non-refundable except as required by law"}),We.jsx("li",{children:"You may cancel your subscription at any time"}),We.jsx("li",{children:"Price changes will be communicated 30 days in advance"})]})]}),We.jsxs("div",{children:[We.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"5. Acceptable Use Policy"}),We.jsx("p",{className:"text-gray-700 leading-relaxed mb-4",children:"You agree NOT to:"}),We.jsxs("ul",{className:"list-disc list-inside space-y-2 text-gray-700 ml-4",children:[We.jsx("li",{children:"Use the service for any illegal or unauthorized purpose"}),We.jsx("li",{children:"Violate any laws or regulations"}),We.jsx("li",{children:"Impersonate any person or entity"}),We.jsx("li",{children:"Transmit viruses, malware, or harmful code"}),We.jsx("li",{children:"Attempt to gain unauthorized access to our systems"}),We.jsx("li",{children:"Scrape, spider, or data mine our platform"}),We.jsx("li",{children:"Interfere with other users' access to the service"})]})]}),We.jsxs("div",{children:[We.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"6. Intellectual Property"}),We.jsx("p",{className:"text-gray-700 leading-relaxed",children:"All content, features, and functionality of Syncly are owned by us and are protected by copyright, trademark, and other intellectual property laws. You may not copy, modify, distribute, or reverse engineer any part of our services."})]}),We.jsxs("div",{children:[We.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"7. Data Ownership"}),We.jsx("p",{className:"text-gray-700 leading-relaxed",children:"You retain all rights to your data (reports, tasks, meeting notes, etc.). We do not claim ownership of your content. However, you grant us a license to use, store, and process your data to provide our services and improve our AI algorithms."})]}),We.jsxs("div",{children:[We.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"8. Service Availability"}),We.jsx("p",{className:"text-gray-700 leading-relaxed",children:"We strive for 99.9% uptime but do not guarantee uninterrupted service. We may perform maintenance, updates, or experience downtime. We are not liable for any losses resulting from service interruptions."})]}),We.jsxs("div",{children:[We.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"9. Limitation of Liability"}),We.jsx("p",{className:"text-gray-700 leading-relaxed",children:'Syncly is provided "as is" without warranties of any kind. We are not liable for any indirect, incidental, or consequential damages arising from your use of our services. Our total liability shall not exceed the amount you paid us in the past 12 months.'})]}),We.jsxs("div",{children:[We.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"10. Termination"}),We.jsx("p",{className:"text-gray-700 leading-relaxed",children:"We reserve the right to suspend or terminate your account if you violate these terms. You may terminate your account at any time through your account settings. Upon termination, your data will be deleted within 30 days."})]}),We.jsxs("div",{children:[We.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"11. Changes to Terms"}),We.jsx("p",{className:"text-gray-700 leading-relaxed",children:"We may update these Terms of Service from time to time. We will notify you of material changes via email or in-app notification. Continued use of our services after changes constitutes acceptance of the new terms."})]}),We.jsxs("div",{children:[We.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"12. Governing Law"}),We.jsx("p",{className:"text-gray-700 leading-relaxed",children:"These Terms are governed by the laws of India. Any disputes shall be resolved in the courts of the appropriate jurisdiction."})]}),We.jsxs("div",{className:"border-t border-gray-200 pt-8",children:[We.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"13. Contact Information"}),We.jsx("p",{className:"text-gray-700 leading-relaxed mb-4",children:"For questions about these Terms of Service:"}),We.jsx("div",{className:"bg-indigo-50 p-6 rounded-xl border border-indigo-200",children:We.jsxs("div",{className:"space-y-2",children:[We.jsxs("div",{className:"flex items-center space-x-3",children:[We.jsx("i",{className:"fas fa-envelope text-indigo-600"}),We.jsxs("span",{className:"text-gray-700",children:["Email: ",We.jsx("a",{href:"mailto:syncly19@gmail.com",className:"text-indigo-600 hover:underline font-semibold",children:"syncly19@gmail.com"})]})]}),We.jsxs("div",{className:"flex items-center space-x-3",children:[We.jsx("i",{className:"fas fa-phone text-indigo-600"}),We.jsxs("span",{className:"text-gray-700",children:["Phone: ",We.jsx("a",{href:"tel:+919270279703",className:"text-indigo-600 hover:underline font-semibold",children:"+91 92702 79703"})]})]})]})})]})]})]}),We.jsx("footer",{className:"bg-gray-900 text-gray-400 py-8 px-4",children:We.jsx("div",{className:"max-w-7xl mx-auto text-center",children:We.jsx("p",{className:"text-sm",children:" 2025 Syncly. All rights reserved."})})})]})},my=()=>{const e=d();return We.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-indigo-50",children:[We.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-50",children:We.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:We.jsxs("div",{className:"flex items-center justify-between",children:[We.jsxs("button",{onClick:()=>e("/"),className:"flex items-center space-x-3 group",children:[We.jsx("div",{className:"bg-gradient-to-br from-indigo-600 to-purple-600 text-white p-2.5 rounded-xl shadow-lg group-hover:scale-110 transition-transform duration-300",children:We.jsx("i",{className:"fas fa-infinity text-2xl"})}),We.jsx("span",{className:"text-2xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent",children:"Syncly"})]}),We.jsxs("button",{onClick:()=>e("/"),className:"text-gray-600 hover:text-indigo-600 transition-colors",children:[We.jsx("i",{className:"fas fa-arrow-left mr-2"}),"Back to Home"]})]})})}),We.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:[We.jsx("h1",{className:"text-5xl font-extrabold text-gray-900 mb-4 text-center",children:"Privacy Policy"}),We.jsx("p",{className:"text-center text-gray-600 mb-12 text-lg",children:"Last Updated: October 23, 2025"}),We.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 md:p-12 space-y-8",children:[We.jsxs("div",{children:[We.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"1. Information We Collect"}),We.jsx("p",{className:"text-gray-700 leading-relaxed mb-4",children:"Syncly collects information to provide, maintain, and improve our services. We collect:"}),We.jsxs("ul",{className:"list-disc list-inside space-y-2 text-gray-700 ml-4",children:[We.jsxs("li",{children:[We.jsx("strong",{children:"Account Information:"})," Name, email address, company name, and phone number"]}),We.jsxs("li",{children:[We.jsx("strong",{children:"Usage Data:"})," EOD reports, tasks, meeting notes, and performance metrics"]}),We.jsxs("li",{children:[We.jsx("strong",{children:"Technical Data:"})," IP address, browser type, device information, and access logs"]}),We.jsxs("li",{children:[We.jsx("strong",{children:"Google Calendar Data:"})," Calendar events and meeting schedules (with your explicit permission)"]})]})]}),We.jsxs("div",{children:[We.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"2. How We Use Your Information"}),We.jsxs("ul",{className:"list-disc list-inside space-y-2 text-gray-700 ml-4",children:[We.jsx("li",{children:"To provide and maintain our AI-powered collaboration services"}),We.jsx("li",{children:"To analyze usage patterns and improve our AI algorithms"}),We.jsx("li",{children:"To send you service updates and important notifications"}),We.jsx("li",{children:"To provide customer support and respond to your inquiries"}),We.jsx("li",{children:"To detect and prevent fraud, abuse, or security issues"})]})]}),We.jsxs("div",{children:[We.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"3. Data Security"}),We.jsx("p",{className:"text-gray-700 leading-relaxed mb-4",children:"We implement industry-standard security measures to protect your data:"}),We.jsxs("ul",{className:"list-disc list-inside space-y-2 text-gray-700 ml-4",children:[We.jsx("li",{children:"End-to-end encryption for data transmission"}),We.jsx("li",{children:"Multi-tenant architecture with complete data isolation"}),We.jsx("li",{children:"Regular security audits and penetration testing"}),We.jsx("li",{children:"Role-based access control (RBAC) for team members"}),We.jsx("li",{children:"Secure cloud infrastructure with Firebase and Google Cloud"})]})]}),We.jsxs("div",{children:[We.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"4. Data Sharing"}),We.jsx("p",{className:"text-gray-700 leading-relaxed mb-4",children:"We do not sell your personal information. We may share data only in these circumstances:"}),We.jsxs("ul",{className:"list-disc list-inside space-y-2 text-gray-700 ml-4",children:[We.jsxs("li",{children:[We.jsx("strong",{children:"With Your Consent:"})," When you explicitly authorize data sharing"]}),We.jsxs("li",{children:[We.jsx("strong",{children:"Service Providers:"})," Third-party services that help us operate (Google Cloud, Firebase)"]}),We.jsxs("li",{children:[We.jsx("strong",{children:"Legal Requirements:"})," When required by law or to protect our rights"]}),We.jsxs("li",{children:[We.jsx("strong",{children:"Business Transfers:"})," In case of merger, acquisition, or asset sale"]})]})]}),We.jsxs("div",{children:[We.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"5. Your Rights"}),We.jsx("p",{className:"text-gray-700 leading-relaxed mb-4",children:"You have the right to:"}),We.jsxs("ul",{className:"list-disc list-inside space-y-2 text-gray-700 ml-4",children:[We.jsx("li",{children:"Access your personal data and download a copy"}),We.jsx("li",{children:"Request correction of inaccurate or incomplete data"}),We.jsx("li",{children:"Request deletion of your account and associated data"}),We.jsx("li",{children:"Opt-out of marketing communications"}),We.jsx("li",{children:"Withdraw consent for Google Calendar integration"})]})]}),We.jsxs("div",{children:[We.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"6. Data Retention"}),We.jsx("p",{className:"text-gray-700 leading-relaxed",children:"We retain your data for as long as your account is active or as needed to provide services. Upon account deletion, we permanently remove your data within 30 days, except where required by law to retain certain information."})]}),We.jsxs("div",{children:[We.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"7. Cookies and Tracking"}),We.jsx("p",{className:"text-gray-700 leading-relaxed",children:"We use cookies and similar technologies to enhance user experience, analyze usage patterns, and maintain session security. You can control cookie preferences through your browser settings."})]}),We.jsxs("div",{className:"border-t border-gray-200 pt-8",children:[We.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"8. Contact Us"}),We.jsx("p",{className:"text-gray-700 leading-relaxed mb-4",children:"For privacy-related questions or to exercise your rights:"}),We.jsx("div",{className:"bg-indigo-50 p-6 rounded-xl border border-indigo-200",children:We.jsxs("div",{className:"space-y-2",children:[We.jsxs("div",{className:"flex items-center space-x-3",children:[We.jsx("i",{className:"fas fa-envelope text-indigo-600"}),We.jsxs("span",{className:"text-gray-700",children:["Email: ",We.jsx("a",{href:"mailto:syncly19@gmail.com",className:"text-indigo-600 hover:underline font-semibold",children:"syncly19@gmail.com"})]})]}),We.jsxs("div",{className:"flex items-center space-x-3",children:[We.jsx("i",{className:"fas fa-phone text-indigo-600"}),We.jsxs("span",{className:"text-gray-700",children:["Phone: ",We.jsx("a",{href:"tel:+919270279703",className:"text-indigo-600 hover:underline font-semibold",children:"+91 92702 79703"})]})]})]})})]})]})]}),We.jsx("footer",{className:"bg-gray-900 text-gray-400 py-8 px-4",children:We.jsx("div",{className:"max-w-7xl mx-auto text-center",children:We.jsx("p",{className:"text-sm",children:" 2025 Syncly. All rights reserved."})})})]})},py=()=>{const e=d();return We.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-indigo-50",children:[We.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-50",children:We.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:We.jsxs("div",{className:"flex items-center justify-between",children:[We.jsxs("button",{onClick:()=>e("/"),className:"flex items-center space-x-3 group",children:[We.jsx("div",{className:"bg-gradient-to-br from-indigo-600 to-purple-600 text-white p-2.5 rounded-xl shadow-lg group-hover:scale-110 transition-transform duration-300",children:We.jsx("i",{className:"fas fa-infinity text-2xl"})}),We.jsx("span",{className:"text-2xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent",children:"Syncly"})]}),We.jsxs("button",{onClick:()=>e("/"),className:"text-gray-600 hover:text-indigo-600 transition-colors",children:[We.jsx("i",{className:"fas fa-arrow-left mr-2"}),"Back to Home"]})]})})}),We.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:[We.jsx("h1",{className:"text-5xl font-extrabold text-gray-900 mb-8 text-center",children:"About Syncly"}),We.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 md:p-12 space-y-8",children:[We.jsx("div",{children:We.jsx("p",{className:"text-xl text-gray-700 leading-relaxed mb-6",children:"Syncly is a cutting-edge, AI-powered team collaboration platform designed to revolutionize how modern teams work together. Founded with a vision to make productivity tools intelligent and intuitive, we combine advanced artificial intelligence with beautiful, minimalistic design."})}),We.jsxs("div",{children:[We.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Our Mission"}),We.jsx("p",{className:"text-lg text-gray-700 leading-relaxed",children:"To empower teams worldwide with intelligent tools that enhance productivity, foster collaboration, and provide actionable insights through AI. We believe work should be smarter, not harder."})]}),We.jsxs("div",{children:[We.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"What We Offer"}),We.jsxs("div",{className:"space-y-4",children:[We.jsxs("div",{className:"flex items-start space-x-4 p-4 bg-gradient-to-r from-cyan-50 to-blue-50 rounded-xl border border-cyan-200",children:[We.jsx("i",{className:"fas fa-brain text-cyan-600 text-2xl mt-1"}),We.jsxs("div",{children:[We.jsx("h3",{className:"font-bold text-gray-900 mb-1",children:"AI-Powered EOD Reports"}),We.jsx("p",{className:"text-gray-600",children:"Intelligent end-of-day reporting with automated summaries and insights"})]})]}),We.jsxs("div",{className:"flex items-start space-x-4 p-4 bg-gradient-to-r from-emerald-50 to-teal-50 rounded-xl border border-emerald-200",children:[We.jsx("i",{className:"fas fa-calendar-check text-emerald-600 text-2xl mt-1"}),We.jsxs("div",{children:[We.jsx("h3",{className:"font-bold text-gray-900 mb-1",children:"Smart Meeting Assistant"}),We.jsx("p",{className:"text-gray-600",children:"Seamless Google Calendar integration with live memos and action item tracking"})]})]}),We.jsxs("div",{className:"flex items-start space-x-4 p-4 bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl border border-purple-200",children:[We.jsx("i",{className:"fas fa-chart-line text-purple-600 text-2xl mt-1"}),We.jsxs("div",{children:[We.jsx("h3",{className:"font-bold text-gray-900 mb-1",children:"Consistency Tracker"}),We.jsx("p",{className:"text-gray-600",children:"AI-driven habit tracking that helps teams maintain productivity streaks"})]})]}),We.jsxs("div",{className:"flex items-start space-x-4 p-4 bg-gradient-to-r from-orange-50 to-red-50 rounded-xl border border-orange-200",children:[We.jsx("i",{className:"fas fa-trophy text-orange-600 text-2xl mt-1"}),We.jsxs("div",{children:[We.jsx("h3",{className:"font-bold text-gray-900 mb-1",children:"Performance Hub"}),We.jsx("p",{className:"text-gray-600",children:"Gamification with intelligent badges, leaderboards, and performance analytics"})]})]})]})]}),We.jsxs("div",{children:[We.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Why Choose Syncly?"}),We.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[We.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-purple-50 p-6 rounded-xl border border-indigo-200",children:[We.jsx("div",{className:"text-3xl mb-3",children:""}),We.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:"Enterprise-Grade Security"}),We.jsx("p",{className:"text-gray-600",children:"Multi-tenant architecture with complete data isolation and role-based access control"})]}),We.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-blue-50 p-6 rounded-xl border border-cyan-200",children:[We.jsx("div",{className:"text-3xl mb-3",children:""}),We.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:"Real AI Integration"}),We.jsx("p",{className:"text-gray-600",children:"Not just buzzwordsactual machine learning that learns from your team"})]}),We.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 p-6 rounded-xl border border-emerald-200",children:[We.jsx("div",{className:"text-3xl mb-3",children:""}),We.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:"Mobile-First Design"}),We.jsx("p",{className:"text-gray-600",children:"Progressive Web App that works seamlessly across all devices"})]}),We.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-red-50 p-6 rounded-xl border border-orange-200",children:[We.jsx("div",{className:"text-3xl mb-3",children:""}),We.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:"Built for Scale"}),We.jsx("p",{className:"text-gray-600",children:"From startups to enterprisesour platform grows with you"})]})]})]}),We.jsxs("div",{className:"border-t border-gray-200 pt-8 mt-8",children:[We.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-6 text-center",children:"Get in Touch"}),We.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 text-white p-8 rounded-2xl text-center",children:[We.jsx("p",{className:"text-lg mb-6 font-semibold",children:"Have questions or want to learn more about Syncly?"}),We.jsxs("div",{className:"space-y-3",children:[We.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[We.jsx("i",{className:"fas fa-envelope text-xl"}),We.jsx("a",{href:"mailto:syncly19@gmail.com",className:"text-lg hover:text-indigo-200 transition-colors underline",children:"syncly19@gmail.com"})]}),We.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[We.jsx("i",{className:"fas fa-phone text-xl"}),We.jsx("a",{href:"tel:+919270279703",className:"text-lg hover:text-indigo-200 transition-colors underline",children:"+91 92702 79703"})]})]}),We.jsx("p",{className:"text-indigo-200 mt-6 text-sm",children:"Our team is ready to help you transform your team's productivity"})]})]}),We.jsx("div",{className:"text-center pt-8",children:We.jsxs("button",{onClick:()=>e("/login"),className:"bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-10 py-4 rounded-xl font-bold text-lg shadow-xl hover:shadow-2xl hover:scale-105 transition-all duration-300 inline-flex items-center",children:[We.jsx("i",{className:"fas fa-rocket mr-2"}),"Start Free Trial"]})})]})]}),We.jsx("footer",{className:"bg-gray-900 text-gray-400 py-8 px-4",children:We.jsx("div",{className:"max-w-7xl mx-auto text-center",children:We.jsx("p",{className:"text-sm",children:" 2025 Syncly. All rights reserved."})})})]})};class fy extends l.Component{constructor(e){super(e),a(this,"handleReload",()=>{window.location.reload()}),a(this,"handleGoHome",()=>{window.location.href="/"}),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e,errorInfo:null}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t}),"undefined"!=typeof window&&window.logSystemEvent&&window.logSystemEvent({tenantId:"unknown",level:"ERROR",category:"ERROR",operation:"react_error_boundary",message:e.message,metadata:{componentStack:t.componentStack,errorStack:e.stack}})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:We.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-950 p-4",children:We.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-slate-800 rounded-2xl shadow-xl p-8 text-center",children:[We.jsx("div",{className:"mb-6",children:We.jsx("div",{className:"mx-auto w-16 h-16 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center",children:We.jsx(Ce,{className:"w-8 h-8 text-red-600 dark:text-red-400"})})}),We.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mb-2",children:"Oops! Something went wrong"}),We.jsx("p",{className:"text-slate-600 dark:text-slate-400 mb-6",children:"We're sorry for the inconvenience. The application encountered an unexpected error."}),!1,We.jsxs("div",{className:"flex gap-3 justify-center",children:[We.jsxs("button",{onClick:this.handleReload,className:"flex items-center gap-2 px-4 py-2 bg-primary hover:bg-primary-hover text-white rounded-lg transition-colors",children:[We.jsx(_e,{className:"w-4 h-4"}),"Reload Page"]}),We.jsxs("button",{onClick:this.handleGoHome,className:"flex items-center gap-2 px-4 py-2 bg-slate-200 hover:bg-slate-300 dark:bg-slate-700 dark:hover:bg-slate-600 text-slate-900 dark:text-slate-100 rounded-lg transition-colors",children:[We.jsx(Te,{className:"w-4 h-4"}),"Go Home"]})]})]})}):this.props.children}}function hy(){const[e,t]=l.useState([]),[n,a]=l.useState(!0);l.useEffect(()=>{s()},[]);const s=async()=>{try{const e=await te(ee(sm,"users")),n=[];e.forEach(e=>{const t=e.data();n.push({id:e.id,email:t.email,name:t.name,tenantId:t.tenantId,isPlatformAdmin:t.isPlatformAdmin||!1,roleName:t.roleName,status:"pending"})}),t(n),a(!1)}catch(e){a(!1)}},r=async n=>{t(e.map(e=>e.id===n.id?{...e,status:"fixing"}:e));try{await ug({userId:n.id,tenantId:n.isPlatformAdmin?void 0:n.tenantId,isPlatformAdmin:n.isPlatformAdmin||!1}),t(e.map(e=>e.id===n.id?{...e,status:"success",message:"Claims set! Ask user to re-login."}:e))}catch(a){t(e.map(e=>e.id===n.id?{...e,status:"error",message:a.message.includes("user-not-found")?"No Firebase Auth account - user needs to be recreated":a.message}:e))}};return n?We.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:We.jsxs("div",{className:"text-center",children:[We.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),We.jsx("p",{className:"text-gray-600",children:"Loading users..."})]})}):We.jsx("div",{className:"min-h-screen bg-gray-50 p-8",children:We.jsx("div",{className:"max-w-6xl mx-auto",children:We.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[We.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:" Fix Existing Users"}),We.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 mb-6",children:We.jsxs("p",{className:"text-blue-700",children:[We.jsx("strong",{children:" What This Does:"}),We.jsx("br",{}),"This tool sets custom claims (tenantId, isPlatformAdmin) for existing users so they can login.",We.jsx("br",{}),"After setting claims, users must ",We.jsx("strong",{children:"logout and login again"})," to get a fresh token."]})}),We.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6",children:We.jsxs("p",{className:"text-yellow-700",children:[We.jsx("strong",{children:" Important:"}),We.jsx("br",{}),"This only works for users who have Firebase Auth accounts.",We.jsx("br",{}),'If a user shows "No Firebase Auth account", they must be recreated using the dashboard.']})}),We.jsx("div",{className:"mb-6",children:We.jsx("button",{onClick:async()=>{for(const t of e)"pending"!==t.status&&"error"!==t.status||(await r(t),await new Promise(e=>setTimeout(e,500)))},className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:" Fix All Users"})}),We.jsx("div",{className:"space-y-4",children:e.map(e=>We.jsx("div",{className:"border rounded-lg p-4 "+("success"===e.status?"bg-green-50 border-green-200":"error"===e.status?"bg-red-50 border-red-200":"fixing"===e.status?"bg-blue-50 border-blue-200":"bg-white border-gray-200"),children:We.jsxs("div",{className:"flex justify-between items-start",children:[We.jsxs("div",{className:"flex-1",children:[We.jsx("h3",{className:"font-semibold text-lg text-gray-900",children:e.name}),We.jsx("p",{className:"text-gray-600",children:e.email}),We.jsx("p",{className:"text-sm text-gray-500 mt-1",children:e.isPlatformAdmin?We.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded bg-purple-100 text-purple-800",children:"Platform Admin"}):We.jsxs(We.Fragment,{children:[We.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded bg-blue-100 text-blue-800 mr-2",children:e.roleName||"Employee"}),We.jsxs("span",{className:"text-gray-400",children:["TenantId: ",e.tenantId]})]})}),We.jsxs("p",{className:"text-sm font-medium mt-2",children:["pending"===e.status&&We.jsx("span",{className:"text-gray-600",children:"Ready to fix"}),"fixing"===e.status&&We.jsx("span",{className:"text-blue-600",children:" Setting claims..."}),"success"===e.status&&We.jsxs("span",{className:"text-green-600",children:[" ",e.message]}),"error"===e.status&&We.jsxs("span",{className:"text-red-600",children:[" ",e.message]})]})]}),We.jsx("button",{onClick:()=>r(e),disabled:"fixing"===e.status||"success"===e.status,className:"px-4 py-2 rounded-lg font-medium transition-colors "+("success"===e.status?"bg-green-100 text-green-800 cursor-not-allowed":"fixing"===e.status?"bg-blue-100 text-blue-800 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:"success"===e.status?" Done":"fixing"===e.status?"Fixing...":"error"===e.status?"Retry":"Fix User"})]})},e.id))}),We.jsxs("div",{className:"mt-8 bg-gray-50 rounded-lg p-6",children:[We.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:" After Setting Claims:"}),We.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-gray-700",children:[We.jsxs("li",{children:["Ask each user to ",We.jsx("strong",{children:"logout completely"})," from the app"]}),We.jsx("li",{children:"Clear browser cache/cookies (optional but recommended)"}),We.jsxs("li",{children:[We.jsx("strong",{children:"Login again"})," with their credentials"]}),We.jsx("li",{children:" Custom claims will now be in their token!"})]})]}),We.jsxs("div",{className:"mt-6 bg-yellow-50 rounded-lg p-6",children:[We.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:' If "No Firebase Auth Account" Error:'}),We.jsx("p",{className:"text-gray-700 mb-2",children:"This means the user was created only in Firestore, not in Firebase Auth."}),We.jsxs("p",{className:"text-gray-700",children:[We.jsx("strong",{children:"Solution:"})," Go to Users  Add User in your dashboard and recreate them with a password."]})]})]})})})}const gy="jay_assistant_disabled_until",xy="jay-assistant-status",yy=e=>{var t,n;"undefined"!=typeof window&&(e>Date.now()?null==(t=window.localStorage)||t.setItem(gy,String(e)):null==(n=window.localStorage)||n.removeItem(gy),(()=>{if("undefined"==typeof window)return;const e=ky();window.dispatchEvent(new CustomEvent(xy,{detail:e}))})())},by=()=>Date.now()<(()=>{var e;if("undefined"==typeof window)return 0;const t=null==(e=window.localStorage)?void 0:e.getItem(gy),n=t?Number(t):0;return Number.isFinite(n)?n:0})(),vy=()=>yy(0),Ny=()=>{const e=new Date(new Date);e.setHours(24,5,0,0),yy(e.getTime())},wy=()=>{const e=zp("VITE_JAY_PROXY_URL","JAY_PROXY_URL");if(e)return e;if("undefined"!=typeof window){const e=window.__JAY_PROXY_URL__;if("string"==typeof e&&e.trim())return e.trim()}return null},ky=()=>{const e=!!wy(),t=!!Nf(),n=e?"proxy":t?"direct":"none";return{canAccessJay:"none"!==n,source:n,isTemporarilyDisabled:by()}},Ey=e=>`\n\nYou are Jay, the friendly AI assistant for Syncly - an AI-native workforce operations platform built for distributed teams.\nYou help users with:\n- EOD (End of Day) reporting best practices, summaries, and troubleshooting\n- Leave & attendance management, including future leave planning and approvals\n- Task management, priorities, and performance coaching for teams\n- Announcement workflows, HR updates, and company-wide broadcasts\n- Meeting scheduling, agendas, action items, and follow-ups\n- Tenant provisioning, roles/permissions, telemetry, and platform configuration\n\nGuidelines:\n- Keep tone warm, concise, and professional. Avoid long paragraphs; favor bullet points when listing steps.\n- Always ground answers in Syncly concepts (EOD, Leaves, Announcements, Tasks, Tenants, Roles, Dashboards, etc.).\n- If you don't have the requested data (e.g., the user asks for a specific employee's private data), say you don't have access and remind them where to look in Syncly.\n- Suggest specific navigation paths (e.g., "Go to Manager Dashboard -> Performance Hub") when referencing features.\n- Offer proactive tips when relevant (e.g., remind about scheduled reminders, tagging teammates, or using HR announcements).\n\n\nConversation so far:\n${e.slice(-6).map(e=>`${"user"===e.role?"User":"Jay"}: ${e.content}`).join("\n\n")}\n\nRespond as Jay with concise, actionable guidance.`,jy=()=>{const e=ky();return e.canAccessJay&&!e.isTemporarilyDisabled},Cy={app:{greeting:"Hey, I'm Jayyour Syncly co-pilot. Need help with EODs, leave flows, announcements, or performance insights? Ask away!",subtitle:"Smarter workflows in one chat",badge:"Jay  Syncly AI",suggestions:["Give me ideas to improve EOD consistency for my team.","Walk me through setting up an HR announcement board.","How do I coach someone using Performance Hub insights?","What's the best way to plan future leaves in Syncly?"],placeholder:"Ask Jay anything about Syncly..."},landing:{greeting:"Hey, I'm Jayyour Syncly tour guide. Curious about our AI-native workspace assistant or pricing? I can help you explore before you sign up.",subtitle:"Ask about pricing, features, and onboarding",badge:"Chat with Jay  Syncly",suggestions:["How is Syncly different from other ops tools?","Show me the AI features teams love.","What plans do you offer and whats included?","How do I book a live demo with your team?"],placeholder:"Ask Jay about Synclys product or plans..."}},_y=e=>({id:`jay-greeting-${e}`,role:"assistant",content:Cy[e].greeting,timestamp:Date.now()}),Ty=({onDeactivate:e,currentUser:t=null,variant:n="app"})=>{const a=Cy[n],s="landing"===n?"jay_assistant_history_landing_v1":"jay_assistant_history_app_v1",r="landing"===n?"jay_assistant_is_open_landing":"jay_assistant_is_open_app",[i,o]=vh(s,[]),[c,d]=vh(r,!1),[u,m]=l.useState(""),[p,f]=l.useState(!1),[h,g]=l.useState(null),x=l.useRef(null),y=l.useRef(null);l.useEffect(()=>{0===i.length&&o([_y(n)])},[i.length,o,n]),l.useEffect(()=>{if(!c)return;const e=x.current;e&&(e.scrollTop=e.scrollHeight)},[i,c]),l.useEffect(()=>{if(!c)return;const e=window.setTimeout(()=>{var e;null==(e=y.current)||e.focus()},200);return()=>window.clearTimeout(e)},[c]);const b=()=>{d(e=>!e)};l.useCallback(e=>{o(t=>[...t,e])},[o]);const v=l.useCallback((e,t)=>{o(n=>n.map(n=>n.id===e?t(n):n))},[o]),N=l.useMemo(()=>{var e;if(!t)return{role:"user",content:"You are chatting with a visitor on the Syncly website. They have not logged in yet. Introduce Syncly clearly and focus on explaining value, pricing, AI capabilities, and onboarding steps."};const n=t.name??"Syncly user",a=t.designation??t.roleName??"Member",s=(null==(e=t.tenant)?void 0:e.companyName)??t.tenantId??"their workspace",r=[];return t.isPlatformAdmin&&r.push("Platform Admin"),t.isTenantAdmin&&r.push("Tenant Admin"),t.roleName&&r.push(t.roleName),{role:"user",content:`Context about the person you're helping:\n- Name: ${n}\n- Role/Designation: ${a}\n- Organization: ${s}\n- Privileges: ${r.length?r.join(", "):"Standard employee"}\n\nUse this context to tailor your advice.`}},[t]),w=l.useCallback(e=>{const t=(e??i).filter(e=>!("assistant"===e.role&&e.isPending));return[N,...t.map(e=>({role:e.role,content:e.content}))]},[i,N]),k=async t=>{if(p)return;const a=(t??u).trim();if(!a)return;g(null),m(""),f(!0);const s={id:`user-${Date.now()}`,role:"user",content:a,timestamp:Date.now()},r={id:`jay-${Date.now()}`,role:"assistant",content:"",isPending:!0,timestamp:Date.now()},l=[...i,s,r];o(l);try{const e=await(async(e,t={})=>{var n;if("undefined"==typeof window)throw Object.assign(new Error("Jay is only available in the browser."),{code:"JAY_UNAVAILABLE"});if(by())throw Object.assign(new Error("Jay will be back soon."),{code:"JAY_DISABLED"});const a=wy(),s=a?null:Nf();if(!a&&!s)throw Object.assign(new Error("Jay is not configured."),{code:"JAY_NO_KEY"});try{if(a){const n=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:e,variant:t.variant??"app"})}),s=await n.json().catch(()=>({}));if(!n.ok){if(429===n.status||"quota_exceeded"===(null==s?void 0:s.error))throw Ny(),Object.assign(new Error("Jay is recharging. Please check later."),{code:"JAY_DISABLED"});const e=(null==s?void 0:s.message)||(null==s?void 0:s.error)||"Jay is unavailable. Please try again shortly.";throw Object.assign(new Error(e),{code:"JAY_PROXY_ERROR"})}const r="string"==typeof(null==s?void 0:s.text)?s.text.trim():"";if(!r)throw new Error("Jay could not craft a response right now.");return by()&&vy(),r}const r=new Md({apiKey:s}),i=await r.models.generateContent({model:"gemini-2.5-flash",contents:Ey(e)}),l=null==(n=null==i?void 0:i.text)?void 0:n.trim();if(!l)throw new Error("Jay could not craft a response right now.");return by()&&vy(),l}catch(r){if((e=>{var t;const n=((null==e?void 0:e.message)??"").toString().toLowerCase();return 429===(null==e?void 0:e.code)||429===(null==e?void 0:e.status)||429===(null==(t=null==e?void 0:e.error)?void 0:t.code)||/quota/.test(n)||/resource exhausted/.test(n)||/rate limit/.test(n)})(r))throw Ny(),Object.assign(new Error("Jay is recharging. Please check later."),{code:"JAY_DISABLED"});const e="string"==typeof(null==r?void 0:r.message)?r.message:"Jay ran into an issue. Please try again.";throw Object.assign(new Error(e),{code:(null==r?void 0:r.code)??"JAY_ERROR"})}})(w(l),{variant:n});v(r.id,t=>({...t,content:e,isPending:!1,isError:!1}))}catch(c){if("JAY_DISABLED"===(null==c?void 0:c.code))return null==e||e(),void d(!1);v(r.id,e=>({...e,content:(null==c?void 0:c.message)||"Jay is having trouble responding right now.",isPending:!1,isError:!0}))}finally{f(!1)}};return"app"!==n||t?We.jsxs("div",{className:"pointer-events-none fixed bottom-4 right-4 z-[60] flex flex-col items-end space-y-3 text-gray-900 sm:bottom-5 sm:right-5",children:[We.jsxs("div",{"aria-hidden":!c,className:"pointer-events-auto flex w-[268px] max-h-[60vh] flex-col gap-3 rounded-[22px] border border-slate-100 bg-white/95 p-3 shadow-[0_16px_35px_rgba(15,23,42,0.2)] backdrop-blur-xl transition-all duration-300 origin-bottom-right sm:w-[310px] sm:max-h-[68vh] sm:p-4 dark:border-slate-700/60 dark:bg-slate-900/90 "+(c?"translate-y-0 scale-100 opacity-100 visible":"translate-y-4 scale-95 opacity-0 invisible"),children:[We.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-slate-100 bg-white/95 px-3 py-2 shadow-sm dark:border-slate-700/80 dark:bg-slate-900/90",children:[We.jsxs("div",{className:"flex flex-1 items-center gap-2.5",children:[We.jsx("div",{className:"rounded-xl bg-indigo-500/10 p-2 text-indigo-500",children:We.jsx(Se,{size:17})}),We.jsxs("div",{children:[We.jsx("p",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:a.badge}),We.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:a.subtitle})]})]}),We.jsx("button",{type:"button",onClick:b,className:"rounded-2xl border border-slate-200/80 bg-white/70 p-1.5 text-slate-500 transition hover:bg-white hover:text-slate-800 dark:border-slate-700 dark:bg-slate-900/70","aria-label":"Close Jay",children:We.jsx(Ae,{size:14})})]}),We.jsxs("div",{ref:x,className:"thin-scrollbar flex-1 space-y-3 overflow-y-auto rounded-2xl border border-slate-100/80 bg-white/90 px-3 py-3 pr-1.5 text-sm shadow-inner min-h-[120px] max-h-[38vh] sm:max-h-[45vh] dark:border-slate-800/70 dark:bg-slate-900/60",children:[i.map(e=>We.jsx("div",{className:"flex "+("user"===e.role?"justify-end":"justify-start"),children:We.jsx("div",{className:`max-w-[85%] rounded-2xl px-3 py-2 text-[13px] shadow-sm ${"user"===e.role?"bg-indigo-600 text-white":"bg-white text-slate-800 dark:bg-slate-800 dark:text-slate-100"} ${e.isError?"border border-rose-200 dark:border-rose-400/60":""}`,children:e.isPending?We.jsxs("span",{className:"flex items-center gap-2 text-slate-500",children:[We.jsx(Ie,{size:14,className:"animate-spin"}),"Crafting a response..."]}):We.jsx("span",{className:"whitespace-pre-line leading-relaxed",children:e.content})})},e.id)),!i.some(e=>"user"===e.role)&&We.jsx("div",{className:"flex flex-wrap gap-2 pt-1",children:a.suggestions.map(e=>We.jsx("button",{type:"button",onClick:()=>(e=>{g(e),m(e),k(e)})(e),className:"rounded-full border border-slate-200/80 px-3 py-1 text-[11px] font-medium text-slate-600 transition hover:border-indigo-200 hover:bg-indigo-50 hover:text-indigo-600 dark:border-slate-700 dark:text-slate-200",children:e},e))})]}),We.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-inner transition focus-within:border-indigo-300 dark:border-slate-700 dark:bg-slate-900/70",children:[We.jsx("textarea",{ref:y,value:u,onChange:e=>m(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),k())},placeholder:h??a.placeholder,rows:2,className:"w-full resize-none rounded-2xl bg-transparent px-4 py-2.5 text-sm text-slate-800 outline-none placeholder:text-slate-400 dark:text-slate-100"}),We.jsxs("div",{className:"flex items-center justify-between px-3 pb-3",children:[We.jsx("span",{className:"text-[10px] uppercase tracking-wide text-slate-400",children:"Powered by Gemini - Optimized for Syncly"}),We.jsx("button",{type:"button",onClick:()=>k(),disabled:!u.trim()||p,className:"flex items-center gap-1 rounded-full bg-indigo-600 px-4 py-1.5 text-xs font-semibold text-white shadow-lg transition disabled:cursor-not-allowed disabled:bg-indigo-300",children:p?We.jsxs(We.Fragment,{children:[We.jsx(Ie,{size:14,className:"animate-spin"}),"Sending"]}):We.jsxs(We.Fragment,{children:["Send",We.jsx(de,{size:14})]})})]})]})]}),We.jsx("div",{className:"pointer-events-none h-14 sm:h-16",children:We.jsxs("button",{type:"button",onClick:b,className:"pointer-events-auto group flex h-full items-center gap-3 rounded-full border border-white/30 bg-white/95 px-4 py-2.5 text-left shadow-xl backdrop-blur-xl transition hover:-translate-y-0.5 hover:shadow-2xl dark:border-slate-700/60 dark:bg-slate-900/85 "+(c?"translate-y-1 opacity-0 pointer-events-none":"translate-y-0 opacity-100"),children:[We.jsx("span",{className:"relative flex h-10 w-10 items-center justify-center rounded-2xl bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 text-white shadow-lg",children:We.jsx(Se,{size:20,className:"animate-pulse"})}),We.jsxs("div",{className:"text-left",children:[We.jsx("p",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:"landing"===n?"Ask Jay about Syncly":"Jay is here"}),We.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"landing"===n?"Pricing, AI features, onboarding":"Ask anything about Syncly"})]}),We.jsx(De,{size:22,className:"text-indigo-500"})]})})]}):null},Sy=!("false"===((null==(t=null==(e=import.meta)?void 0:e.env)?void 0:t.VITE_SHOW_JAY_LANDING)??"true").toString().toLowerCase()),Ay=()=>{const e=d(),[t,n]=l.useState(!1),[a,s]=l.useState("monthly"),[r,i]=l.useState(!1),[o,c]=l.useState(!1),[u,m]=l.useState(""),[p,f]=l.useState(""),[h,g]=l.useState(()=>!(!Sy||"undefined"==typeof window)&&jy()),[x,y]=l.useState({name:"",email:"",contactNumber:"",companyName:"",companySize:"1-10"});l.useEffect(()=>{const e=()=>{n(window.scrollY>50)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]),l.useEffect(()=>{if(!Sy||"undefined"==typeof window)return;g(jy());const e=(e=>{if("undefined"==typeof window)return()=>{};const t=t=>{t instanceof CustomEvent&&t.detail&&e(t.detail)};return window.addEventListener(xy,t),()=>window.removeEventListener(xy,t)})(e=>{g(e.canAccessJay&&!e.isTemporarilyDisabled)}),t=wf(()=>{g(jy())});return()=>{e(),t()}},[]);const b=e=>{const t=document.getElementById(e);null==t||t.scrollIntoView({behavior:"smooth"})},v=e=>t=>{y(n=>({...n,[e]:t.target.value}))};return We.jsxs("div",{className:"min-h-screen bg-white",children:[We.jsx("nav",{className:"fixed top-0 w-full z-50 transition-all duration-500 "+(t?"bg-white/95 backdrop-blur-lg shadow-lg":"bg-transparent"),children:We.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:We.jsxs("div",{className:"flex justify-between items-center h-20",children:[We.jsxs("div",{className:"flex items-center space-x-3 cursor-pointer group",onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),children:[We.jsx("div",{className:"bg-gradient-to-br from-indigo-600 to-purple-600 text-white p-2.5 rounded-xl shadow-lg group-hover:scale-110 transition-transform duration-300",children:We.jsx("i",{className:"fas fa-infinity text-2xl"})}),We.jsx("span",{className:"text-2xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent",children:"Syncly"})]}),We.jsxs("div",{className:"hidden md:flex items-center space-x-8",children:[We.jsx("button",{onClick:()=>b("ai-features"),className:"font-medium text-gray-700 hover:text-indigo-600 transition-colors duration-300",children:"AI Features"}),We.jsx("button",{onClick:()=>b("meetings"),className:"font-medium text-gray-700 hover:text-indigo-600 transition-colors duration-300",children:"Meetings"}),We.jsx("button",{onClick:()=>b("pricing"),className:"font-medium text-gray-700 hover:text-indigo-600 transition-colors duration-300",children:"Pricing"})]}),We.jsxs("div",{className:"flex items-center space-x-4",children:[We.jsx("button",{onClick:()=>e("/login"),className:"text-gray-700 hover:text-indigo-600 font-medium transition-colors duration-300",children:"Sign In"}),We.jsx("button",{onClick:()=>i(!0),className:"hidden sm:inline-flex items-center justify-center px-5 py-2.5 rounded-lg font-semibold border border-indigo-200 text-indigo-600 hover:bg-indigo-50 transition-all duration-300",children:"Book a Live Demo"}),We.jsx("button",{onClick:()=>e("/login"),className:"bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-6 py-2.5 rounded-lg font-semibold shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300",children:"Get Started"})]})]})})}),p&&We.jsxs("div",{className:"fixed top-6 right-6 z-50 max-w-sm bg-white shadow-2xl rounded-2xl border border-green-100 p-4 flex items-start space-x-3 animate-slide-in",children:[We.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-green-100 text-green-600 flex items-center justify-center text-xl",children:We.jsx("i",{className:"fas fa-check"})}),We.jsxs("div",{className:"flex-1",children:[We.jsx("p",{className:"text-sm font-semibold text-gray-900",children:"We got your request!"}),We.jsx("p",{className:"text-sm text-gray-600",children:p})]}),We.jsx("button",{onClick:()=>f(""),className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Dismiss notification",children:We.jsx("i",{className:"fas fa-times"})})]}),We.jsxs("section",{className:"relative pt-32 pb-20 px-4 sm:px-6 lg:px-8 overflow-hidden min-h-[90vh] flex items-center",children:[We.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[We.jsx("div",{className:"absolute top-1/4 -left-20 w-96 h-96 bg-gradient-to-br from-cyan-400/30 to-blue-500/30 rounded-full blur-3xl animate-float"}),We.jsx("div",{className:"absolute bottom-1/4 -right-20 w-96 h-96 bg-gradient-to-br from-indigo-400/30 to-purple-500/30 rounded-full blur-3xl animate-float-delayed"}),We.jsx("div",{className:"absolute top-1/2 left-1/2 w-96 h-96 bg-gradient-to-br from-pink-400/20 to-orange-500/20 rounded-full blur-3xl animate-float-slow"})]}),We.jsx("div",{className:"max-w-7xl mx-auto relative z-10",children:We.jsxs("div",{className:"max-w-3xl",children:[We.jsxs("div",{className:"inline-flex items-center space-x-2 mb-6 px-4 py-2 bg-gradient-to-r from-cyan-50 to-indigo-50 border border-indigo-200/50 rounded-full",children:[We.jsx("div",{className:"w-2 h-2 bg-gradient-to-r from-cyan-500 to-indigo-600 rounded-full animate-pulse"}),We.jsx("span",{className:"text-indigo-700 font-semibold text-sm",children:"AI-Powered Team Collaboration Platform"})]}),We.jsxs("h1",{className:"text-5xl sm:text-6xl lg:text-7xl font-extrabold text-gray-900 mb-6 leading-tight",children:["Work Smarter with",We.jsx("br",{}),We.jsx("span",{className:"bg-gradient-to-r from-cyan-500 via-indigo-600 to-purple-600 bg-clip-text text-transparent",children:"AI Intelligence"})]}),We.jsx("p",{className:"text-xl sm:text-2xl text-gray-600 mb-10 leading-relaxed",children:"Transform your team's productivity with AI-powered EOD reports, intelligent consistency tracking, Telegram bot notifications, Google Calendar sync, and performance insightsall in one beautiful platform."}),We.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-12",children:[We.jsxs("button",{onClick:()=>e("/login"),className:"group bg-gradient-to-r from-cyan-600 via-indigo-600 to-purple-600 text-white px-8 py-4 rounded-xl font-bold text-lg shadow-xl hover:shadow-2xl hover:scale-105 transition-all duration-300 flex items-center justify-center",children:["Start Free Trial",We.jsx("i",{className:"fas fa-arrow-right ml-2 group-hover:translate-x-1 transition-transform duration-300"})]}),We.jsxs("button",{onClick:()=>i(!0),className:"bg-white/90 backdrop-blur-sm text-gray-800 px-8 py-4 rounded-xl font-bold text-lg shadow-lg hover:shadow-xl border-2 border-indigo-100 hover:border-indigo-300 transition-all duration-300 flex items-center justify-center",children:["Book a Live Demo",We.jsx("i",{className:"fas fa-calendar-check ml-2 text-indigo-500"})]})]}),We.jsxs("div",{className:"flex flex-wrap items-center gap-8 text-sm text-gray-600",children:[We.jsxs("div",{className:"flex items-center space-x-2",children:[We.jsx("i",{className:"fas fa-check-circle text-green-500"}),We.jsx("span",{children:"No credit card required"})]}),We.jsxs("div",{className:"flex items-center space-x-2",children:[We.jsx("i",{className:"fas fa-shield-alt text-indigo-500"}),We.jsx("span",{children:"Enterprise security"})]}),We.jsxs("div",{className:"flex items-center space-x-2",children:[We.jsx("i",{className:"fas fa-users text-purple-500"}),We.jsx("span",{children:"10,000+ teams"})]})]})]})})]}),We.jsx("section",{className:"py-12 px-4 sm:px-6 lg:px-8 bg-gradient-to-r from-slate-50 to-slate-100 border-y border-slate-200",children:We.jsx("div",{className:"max-w-7xl mx-auto",children:We.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-8 text-center",children:[We.jsxs("div",{className:"fade-slide",children:[We.jsx("div",{className:"text-4xl font-extrabold bg-gradient-to-r from-cyan-600 to-indigo-600 bg-clip-text text-transparent mb-1",children:"10K+"}),We.jsx("div",{className:"text-sm text-gray-600 font-medium",children:"Active Users"})]}),We.jsxs("div",{className:"fade-slide",style:{animationDelay:"100ms"},children:[We.jsx("div",{className:"text-4xl font-extrabold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent mb-1",children:"98%"}),We.jsx("div",{className:"text-sm text-gray-600 font-medium",children:"Satisfaction Rate"})]}),We.jsxs("div",{className:"fade-slide",style:{animationDelay:"200ms"},children:[We.jsx("div",{className:"text-4xl font-extrabold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent mb-1",children:"50K+"}),We.jsx("div",{className:"text-sm text-gray-600 font-medium",children:"Daily Reports"})]}),We.jsxs("div",{className:"fade-slide",style:{animationDelay:"300ms"},children:[We.jsx("div",{className:"text-4xl font-extrabold bg-gradient-to-r from-orange-600 to-red-600 bg-clip-text text-transparent mb-1",children:"99.9%"}),We.jsx("div",{className:"text-sm text-gray-600 font-medium",children:"Uptime"})]})]})})}),We.jsxs("section",{id:"ai-features",className:"py-24 px-4 sm:px-6 lg:px-8 bg-gradient-to-br from-slate-900 via-indigo-950 to-slate-900 relative overflow-hidden",children:[We.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PHBhdHRlcm4gaWQ9ImdyaWQiIHdpZHRoPSI2MCIgaGVpZ2h0PSI2MCIgcGF0dGVyblVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+PHBhdGggZD0iTSAxMCAwIEwgMCAwIDAgMTAiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzFmMjkzNyIgc3Ryb2tlLXdpZHRoPSIxIi8+PC9wYXR0ZXJuPjwvZGVmcz48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJ1cmwoI2dyaWQpIi8+PC9zdmc+')] opacity-40"}),We.jsx("div",{className:"absolute top-0 left-1/4 w-96 h-96 bg-cyan-500/10 rounded-full blur-3xl"}),We.jsx("div",{className:"absolute bottom-0 right-1/4 w-96 h-96 bg-indigo-500/10 rounded-full blur-3xl"}),We.jsxs("div",{className:"max-w-7xl mx-auto relative z-10",children:[We.jsxs("div",{className:"text-center mb-16",children:[We.jsxs("div",{className:"inline-flex items-center space-x-2 mb-4 px-4 py-2 bg-gradient-to-r from-cyan-500/10 to-indigo-500/10 border border-cyan-500/20 rounded-full backdrop-blur-sm",children:[We.jsx("i",{className:"fas fa-sparkles text-cyan-400"}),We.jsx("span",{className:"text-cyan-300 font-semibold text-sm",children:"Powered by Advanced AI"})]}),We.jsx("h2",{className:"text-4xl sm:text-5xl font-extrabold text-white mb-4",children:"Intelligent Features & Integrations"}),We.jsx("p",{className:"text-xl text-slate-300 max-w-2xl mx-auto",children:"AI-powered insights combined with seamless integrations to supercharge your team's productivity"})]}),We.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12",children:[{icon:"fa-brain",iconClass:"fas",title:"AI-Powered EOD Reports",description:"Intelligent summaries that extract key insights from your daily work. Our AI analyzes patterns and highlights what matters most.",gradient:"from-cyan-500 via-blue-500 to-indigo-600",benefits:["Smart summaries","Pattern recognition","Auto-categorization"],chipClass:"bg-cyan-500/10 text-cyan-300 border-cyan-500/20"},{icon:"fa-chart-line",iconClass:"fas",title:"Consistency Tracker",description:"AI-powered habit tracking that learns your work patterns and helps you maintain productivity streaks across all activities.",gradient:"from-indigo-500 via-purple-500 to-pink-600",benefits:["Habit analysis","Streak tracking","Smart reminders"],chipClass:"bg-purple-500/10 text-purple-300 border-purple-500/20"},{icon:"fa-trophy",iconClass:"fas",title:"Performance Hub",description:"Gamification meets AI insights. Real-time performance analytics, intelligent badges, and personalized growth recommendations.",gradient:"from-orange-500 via-red-500 to-pink-600",benefits:["AI insights","Smart badges","Leaderboards"],chipClass:"bg-orange-500/10 text-orange-300 border-orange-500/20"},{icon:"fa-robot",iconClass:"fas",title:"AI Task Generation",description:"Automatically generate tasks from meetings, EOD reports, and conversations. Never miss action items again.",gradient:"from-green-500 via-emerald-500 to-teal-600",benefits:["Auto-generation","Smart prioritization","Context-aware"],chipClass:"bg-emerald-500/10 text-emerald-300 border-emerald-500/20"},{icon:"fa-telegram-plane",iconClass:"fab",title:"Telegram Bot Integration",description:"Stay connected on-the-go with real-time notifications, task updates, and instant commands through Telegram. Never miss important updates.",gradient:"from-blue-400 via-sky-500 to-blue-600",benefits:["Real-time alerts","Instant commands","Mobile-first"],chipClass:"bg-blue-500/10 text-blue-300 border-blue-500/20"},{icon:"fa-google",iconClass:"fab",title:"Google Calendar Sync",description:"Seamless two-way synchronization with Google Calendar. Smart scheduling, automated meeting notes, and intelligent time management.",gradient:"from-emerald-500 via-green-500 to-teal-600",benefits:["Two-way sync","Smart scheduling","Auto invites"],chipClass:"bg-emerald-500/10 text-emerald-300 border-emerald-500/20"}].map((e,t)=>We.jsxs("div",{className:"group relative fade-slide",style:{animationDelay:150*t+"ms"},children:[We.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${e.gradient} rounded-2xl blur-xl opacity-0 group-hover:opacity-20 transition-opacity duration-500`}),We.jsxs("div",{className:"relative bg-white/5 backdrop-blur-lg border border-white/10 rounded-2xl p-8 hover:border-white/20 transition-all duration-500 h-full",children:[We.jsx("div",{className:`inline-flex items-center justify-center w-14 h-14 bg-gradient-to-br ${e.gradient} rounded-xl mb-6 group-hover:scale-110 group-hover:rotate-3 transition-all duration-500 shadow-lg`,children:We.jsx("i",{className:`${e.iconClass} ${e.icon} text-2xl text-white`})}),We.jsx("h3",{className:"text-2xl font-bold text-white mb-3 group-hover:text-transparent group-hover:bg-gradient-to-r group-hover:bg-clip-text group-hover:from-cyan-300 group-hover:to-indigo-300 transition-all duration-300",children:e.title}),We.jsx("p",{className:"text-slate-300 leading-relaxed mb-6",children:e.description}),We.jsx("div",{className:"flex flex-wrap gap-2",children:e.benefits.map((t,n)=>We.jsx("span",{className:`px-3 py-1 text-xs font-semibold ${e.chipClass} rounded-full`,children:t},n))})]})]},t))}),We.jsx("div",{className:"text-center",children:We.jsxs("button",{onClick:()=>e("/login"),className:"inline-flex items-center px-8 py-4 bg-gradient-to-r from-cyan-600 via-indigo-600 to-purple-600 text-white rounded-xl font-bold text-lg shadow-xl hover:shadow-2xl hover:scale-105 transition-all duration-300",children:[We.jsx("i",{className:"fas fa-rocket mr-2"}),"Experience AI Intelligence"]})})]})]}),We.jsx("section",{id:"meetings",className:"py-24 px-4 sm:px-6 lg:px-8 bg-gradient-to-br from-white via-emerald-50/30 to-white",children:We.jsx("div",{className:"max-w-7xl mx-auto",children:We.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12 items-center",children:[We.jsxs("div",{className:"fade-slide",children:[We.jsxs("div",{className:"inline-flex items-center space-x-2 mb-4 px-4 py-2 bg-emerald-50 border border-emerald-200 rounded-full",children:[We.jsx("i",{className:"fas fa-calendar-check text-emerald-600"}),We.jsx("span",{className:"text-emerald-700 font-semibold text-sm",children:"Google Calendar Integration"})]}),We.jsxs("h2",{className:"text-4xl sm:text-5xl font-extrabold text-gray-900 mb-6",children:["Smart Meeting",We.jsx("br",{}),We.jsx("span",{className:"bg-gradient-to-r from-emerald-600 to-teal-600 bg-clip-text text-transparent",children:"Assistant"})]}),We.jsx("p",{className:"text-xl text-gray-600 mb-8 leading-relaxed",children:"Seamlessly integrate with Google Calendar for intelligent meeting scheduling, live memos, automated action items, and real-time collaboration."}),We.jsx("div",{className:"space-y-4 mb-8",children:[{icon:"fa-sync",title:"Two-Way Sync",desc:"Automatic synchronization with Google Calendar"},{icon:"fa-edit",title:"Live Memos",desc:"Collaborative notes during meetings with AI summaries"},{icon:"fa-tasks",title:"Auto Action Items",desc:"AI extracts tasks and assigns them automatically"},{icon:"fa-clock",title:"Smart Scheduling",desc:"Find optimal meeting times across timezones"}].map((e,t)=>We.jsxs("div",{className:"flex items-start space-x-4 p-4 bg-white rounded-xl shadow-sm hover:shadow-md transition-all duration-300 border border-gray-100",children:[We.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-gradient-to-br from-emerald-500 to-teal-600 text-white rounded-lg flex items-center justify-center",children:We.jsx("i",{className:`fas ${e.icon}`})}),We.jsxs("div",{children:[We.jsx("h4",{className:"font-bold text-gray-900 mb-1",children:e.title}),We.jsx("p",{className:"text-sm text-gray-600",children:e.desc})]})]},t))}),We.jsxs("button",{onClick:()=>e("/login"),className:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-emerald-600 to-teal-600 text-white rounded-lg font-semibold shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300",children:[We.jsx("i",{className:"fab fa-google mr-2"}),"Connect Google Calendar"]})]}),We.jsx("div",{className:"relative fade-slide",style:{animationDelay:"300ms"},children:We.jsxs("div",{className:"relative",children:[We.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-6 border border-gray-200",children:[We.jsxs("div",{className:"flex items-center justify-between mb-6",children:[We.jsxs("div",{className:"flex items-center space-x-2",children:[We.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),We.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500"}),We.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"})]}),We.jsx("i",{className:"fab fa-google text-2xl text-gray-400"})]}),We.jsx("div",{className:"space-y-3",children:[{time:"09:00 AM",title:"Team Standup",color:"blue",live:!0},{time:"11:30 AM",title:"Product Review",color:"purple",live:!1},{time:"02:00 PM",title:"Client Meeting",color:"emerald",live:!1},{time:"04:30 PM",title:"Sprint Planning",color:"orange",live:!1}].map((e,t)=>We.jsxs("div",{className:`flex items-center space-x-4 p-4 bg-gradient-to-r from-${e.color}-50 to-${e.color}-100/50 rounded-xl border border-${e.color}-200 hover:scale-105 transition-all duration-300`,children:[We.jsx("div",{className:`w-2 h-12 bg-gradient-to-b from-${e.color}-500 to-${e.color}-600 rounded-full`}),We.jsxs("div",{className:"flex-grow",children:[We.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[We.jsx("span",{className:"text-sm font-bold text-gray-900",children:e.title}),e.live&&We.jsx("span",{className:"px-2 py-0.5 text-xs font-semibold bg-red-500 text-white rounded-full animate-pulse",children:"LIVE"})]}),We.jsx("span",{className:"text-xs text-gray-600",children:e.time})]}),We.jsx("i",{className:"fas fa-video text-gray-400"})]},t))})]}),We.jsxs("div",{className:"absolute -top-4 -right-4 bg-gradient-to-r from-emerald-600 to-teal-600 text-white px-4 py-2 rounded-full shadow-xl flex items-center space-x-2 animate-float",children:[We.jsx("i",{className:"fas fa-robot"}),We.jsx("span",{className:"text-sm font-bold",children:"AI Powered"})]})]})})]})})}),We.jsx("section",{className:"py-20 px-4 sm:px-6 lg:px-8 bg-slate-50",children:We.jsxs("div",{className:"max-w-7xl mx-auto",children:[We.jsxs("div",{className:"text-center mb-12",children:[We.jsx("h2",{className:"text-4xl font-extrabold text-gray-900 mb-4",children:"Built for Production"}),We.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:"Enterprise-grade features for teams of all sizes"})]}),We.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[{icon:"fa-tasks",title:"Advanced Task Management",description:"Kanban boards, personal tasks, team collaboration, and employee mention system.",gradient:"from-slate-600 to-slate-800"},{icon:"fa-shield-alt",title:"Enterprise Security",description:"Multi-tenant architecture with complete data isolation and role-based access control.",gradient:"from-slate-600 to-slate-800"},{icon:"fa-mobile-alt",title:"Progressive Web App",description:"Seamless experience across desktop, tablet, and mobile with offline capabilities.",gradient:"from-slate-600 to-slate-800"}].map((e,t)=>We.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-100 hover:border-gray-200 fade-slide",style:{animationDelay:150*t+"ms"},children:[We.jsx("div",{className:`bg-gradient-to-br ${e.gradient} text-white w-14 h-14 rounded-xl flex items-center justify-center mb-6`,children:We.jsx("i",{className:`fas ${e.icon} text-2xl`})}),We.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3",children:e.title}),We.jsx("p",{className:"text-gray-600 leading-relaxed",children:e.description})]},t))})]})}),We.jsx("section",{className:"py-20 px-4 sm:px-6 lg:px-8 bg-white",children:We.jsxs("div",{className:"max-w-7xl mx-auto",children:[We.jsxs("div",{className:"text-center mb-16",children:[We.jsx("h2",{className:"text-4xl font-extrabold text-gray-900 mb-4",children:"Trusted by Industry Leaders"}),We.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:"See how teams are transforming productivity with Syncly"})]}),We.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[{name:"Sarah Mitchell",role:"VP of Engineering",company:"TechFlow Inc",quote:"The AI-powered insights transformed how we track team productivity. Consistency tracker alone saved us 10 hours weekly.",rating:5},{name:"David Chen",role:"Director of Operations",company:"Innovate Labs",quote:"Google Calendar integration is seamless. Meeting memos with AI summaries have eliminated our post-meeting email threads.",rating:5},{name:"Emma Rodriguez",role:"CEO",company:"GrowthMetrics",quote:"Finally, a platform that actually uses AI meaningfully. The performance hub keeps our distributed team engaged and motivated.",rating:5}].map((e,t)=>We.jsxs("div",{className:"bg-gradient-to-br from-white to-slate-50 p-8 rounded-2xl shadow-lg hover:shadow-xl transition-all duration-500 border border-slate-100 hover:scale-105 fade-slide",style:{animationDelay:150*t+"ms"},children:[We.jsx("div",{className:"flex text-yellow-400 mb-4",children:[...Array(e.rating)].map((e,t)=>We.jsx("i",{className:"fas fa-star"},t))}),We.jsxs("p",{className:"text-gray-700 leading-relaxed italic mb-6",children:['"',e.quote,'"']}),We.jsxs("div",{className:"border-t border-slate-200 pt-4",children:[We.jsx("h4",{className:"font-bold text-gray-900",children:e.name}),We.jsx("p",{className:"text-sm text-gray-600",children:e.role}),We.jsx("p",{className:"text-sm text-gray-500",children:e.company})]})]},t))})]})}),We.jsx("section",{id:"pricing",className:"py-20 px-4 sm:px-6 lg:px-8 bg-gradient-to-br from-slate-50 to-indigo-50",children:We.jsxs("div",{className:"max-w-7xl mx-auto",children:[We.jsxs("div",{className:"text-center mb-16",children:[We.jsx("h2",{className:"text-4xl sm:text-5xl font-extrabold text-gray-900 mb-4",children:"Production-Ready Pricing"}),We.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto mb-8",children:"Choose the perfect plan for your team. All plans include 14-day free trial."}),We.jsxs("div",{className:"flex items-center justify-center gap-4 mb-8",children:[We.jsx("span",{className:"text-lg font-semibold transition-all duration-300 "+("monthly"===a?"text-gray-900 scale-105":"text-gray-500"),children:"Monthly"}),We.jsx("button",{onClick:()=>s("monthly"===a?"annually":"monthly"),className:"relative w-16 h-8 rounded-full transition-all duration-500 ease-out focus:outline-none focus:ring-4 focus:ring-indigo-200 "+("annually"===a?"bg-gradient-to-r from-indigo-600 to-purple-600 shadow-lg":"bg-gray-300"),children:We.jsx("span",{className:"absolute top-1 left-1 w-6 h-6 bg-white rounded-full shadow-lg transition-all duration-500 ease-out "+("annually"===a?"translate-x-8 shadow-indigo-300":"")})}),We.jsx("span",{className:"text-lg font-semibold transition-all duration-300 "+("annually"===a?"text-gray-900 scale-105":"text-gray-500"),children:"Annually"}),We.jsx("div",{className:"w-32 flex justify-start",children:"annually"===a&&We.jsx("span",{className:"bg-gradient-to-r from-green-500 to-emerald-600 text-white px-3 py-1.5 rounded-full text-sm font-bold shadow-lg animate-fade-in",children:"Save up to 37%"})})]})]}),We.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 max-w-6xl mx-auto",children:[{name:"Starter",monthlyPrice:19,annualPrice:12,users:"Up to 10 users",features:["AI-Powered EOD Reports","Task Management","Team Calendar","Basic Analytics","Email Support"],highlighted:!1},{name:"Professional",monthlyPrice:49,annualPrice:35,users:"Up to 50 users",features:["Everything in Starter","Smart Meeting Assistant","Google Calendar Integration","Telegram Bot Integration","Performance Hub & Gamification","AI Consistency Tracker","Priority Support"],highlighted:!0},{name:"Enterprise",monthlyPrice:null,annualPrice:null,users:"Unlimited users",features:["Everything in Professional","Dedicated Account Manager","Custom AI Workflows","Advanced Security & SLA","White-label Options","On-premise Deployment"],highlighted:!1}].map((t,n)=>{const s="monthly"===a?t.monthlyPrice:t.annualPrice,r=t.monthlyPrice&&t.annualPrice?t.monthlyPrice-t.annualPrice:0,i=t.monthlyPrice&&t.annualPrice?Math.round((t.monthlyPrice-t.annualPrice)/t.monthlyPrice*100):0;return We.jsxs("div",{className:"relative bg-white rounded-2xl shadow-xl p-8 transition-all duration-500 hover:shadow-2xl hover:scale-105 fade-slide "+(t.highlighted?"ring-4 ring-indigo-600 scale-105":""),style:{animationDelay:150*n+"ms"},children:[t.highlighted&&We.jsx("div",{className:"absolute -top-5 left-1/2 transform -translate-x-1/2",children:We.jsx("span",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-4 py-1 rounded-full text-sm font-bold shadow-lg",children:"MOST POPULAR"})}),We.jsxs("div",{className:"text-center mb-8",children:[We.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:t.name}),We.jsx("div",{className:"h-20 flex items-center justify-center mb-3",children:null!==s?We.jsxs("div",{className:"inline-block",children:[We.jsxs("span",{className:"text-5xl font-extrabold text-gray-900 inline-block transition-all duration-500 ease-out animate-fade-scale",children:["$",s]}),We.jsx("span",{className:"text-gray-600 text-lg transition-opacity duration-300",children:"/month"})]},`${a}-${s}`):We.jsx("span",{className:"text-5xl font-extrabold text-gray-900",children:"Custom"})}),We.jsx("div",{className:"h-16 flex items-center justify-center relative overflow-hidden mb-3",children:null!==s&&"annually"===a?We.jsxs("div",{className:"absolute inset-x-0 flex flex-col items-center justify-center transition-all duration-500 ease-out animate-slide-up",children:[We.jsxs("div",{className:"text-sm text-green-600 font-semibold mb-1 animate-fade-in",children:["Save $",r,"/mo (",i,"% off)"]}),We.jsxs("div",{className:"text-xs text-gray-500 animate-fade-in",style:{animationDelay:"100ms"},children:["$",12*s,"/year billed annually"]})]},"annual-savings"):We.jsx("div",{className:"opacity-0 h-full"})}),We.jsx("p",{className:"text-gray-600 font-medium",children:t.users})]}),We.jsx("ul",{className:"space-y-4 mb-8",children:t.features.map((e,t)=>We.jsxs("li",{className:"flex items-center text-gray-700",children:[We.jsx("i",{className:"fas fa-check-circle text-indigo-600 mr-3"}),e]},t))}),We.jsx("button",{onClick:()=>e("/login"),className:"w-full py-3 px-6 rounded-xl font-bold transition-all duration-300 hover:scale-105 "+(t.highlighted?"bg-gradient-to-r from-indigo-600 to-purple-600 text-white shadow-lg hover:shadow-xl":"bg-gray-100 text-gray-900 hover:bg-gray-200"),children:t.highlighted?"Start Free Trial":"Get Started"})]},n)})})]})}),We.jsxs("section",{className:"py-20 px-4 sm:px-6 lg:px-8 bg-gradient-to-r from-cyan-600 via-indigo-600 to-purple-600 relative overflow-hidden",children:[We.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PHBhdHRlcm4gaWQ9ImdyaWQiIHdpZHRoPSI2MCIgaGVpZ2h0PSI2MCIgcGF0dGVyblVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+PHBhdGggZD0iTSAxMCAwIEwgMCAwIDAgMTAiIGZpbGw9Im5vbmUiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS1vcGFjaXR5PSIwLjEiIHN0cm9rZS13aWR0aD0iMSIvPjwvcGF0dGVybj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNncmlkKSIvPjwvc3ZnPg==')] opacity-40"}),We.jsxs("div",{className:"max-w-4xl mx-auto text-center relative z-10",children:[We.jsx("h2",{className:"text-4xl sm:text-5xl font-extrabold text-white mb-6",children:"Ready to Transform Your Team?"}),We.jsx("p",{className:"text-xl text-indigo-100 mb-10 max-w-2xl mx-auto leading-relaxed",children:"Join 10,000+ teams already working smarter with AI-powered collaboration. Start your free trial todayno credit card required."}),We.jsxs("button",{onClick:()=>e("/login"),className:"bg-white text-indigo-600 px-10 py-4 rounded-xl font-bold text-lg shadow-2xl hover:scale-105 transition-all duration-300 inline-flex items-center",children:[We.jsx("i",{className:"fas fa-rocket mr-2"}),"Start Free 14-Day Trial"]}),We.jsxs("p",{className:"text-indigo-200 mt-6 text-sm",children:[We.jsx("i",{className:"fas fa-check mr-2"}),"No credit card required  Cancel anytime  24/7 Support"]})]})]}),We.jsx("footer",{className:"bg-gray-900 text-gray-400 py-12 px-4 sm:px-6 lg:px-8",children:We.jsxs("div",{className:"max-w-7xl mx-auto",children:[We.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8 mb-8",children:[We.jsxs("div",{className:"md:col-span-2",children:[We.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[We.jsx("div",{className:"bg-gradient-to-br from-indigo-600 to-purple-600 text-white p-2 rounded-lg",children:We.jsx("i",{className:"fas fa-infinity text-xl"})}),We.jsx("span",{className:"text-xl font-bold text-white",children:"Syncly"})]}),We.jsx("p",{className:"text-sm mb-4 max-w-md",children:"AI-Powered Team Collaboration Platform. Transform your team's productivity with intelligent EOD reports, smart meetings, and performance insights."}),We.jsxs("div",{className:"space-y-2 text-sm",children:[We.jsxs("div",{className:"flex items-center space-x-2",children:[We.jsx("i",{className:"fas fa-envelope text-indigo-400"}),We.jsx("a",{href:"mailto:syncly19@gmail.com",className:"hover:text-indigo-400 transition-colors",children:"syncly19@gmail.com"})]}),We.jsxs("div",{className:"flex items-center space-x-2",children:[We.jsx("i",{className:"fas fa-phone text-indigo-400"}),We.jsx("a",{href:"tel:+919270279703",className:"hover:text-indigo-400 transition-colors",children:"+91 92702 79703"})]})]})]}),We.jsxs("div",{children:[We.jsx("h4",{className:"text-white font-bold mb-4",children:"Product"}),We.jsxs("ul",{className:"space-y-2 text-sm",children:[We.jsx("li",{children:We.jsx("button",{onClick:()=>b("ai-features"),className:"hover:text-indigo-400 transition-colors text-left",children:"AI Features"})}),We.jsx("li",{children:We.jsx("button",{onClick:()=>b("meetings"),className:"hover:text-indigo-400 transition-colors text-left",children:"Smart Meetings"})}),We.jsx("li",{children:We.jsx("button",{onClick:()=>b("pricing"),className:"hover:text-indigo-400 transition-colors text-left",children:"Pricing"})}),We.jsx("li",{children:We.jsx("button",{onClick:()=>e("/login"),className:"hover:text-indigo-400 transition-colors text-left",children:"Sign In"})})]})]}),We.jsxs("div",{children:[We.jsx("h4",{className:"text-white font-bold mb-4",children:"Company & Legal"}),We.jsxs("ul",{className:"space-y-2 text-sm",children:[We.jsx("li",{children:We.jsx("button",{onClick:()=>e("/about"),className:"hover:text-indigo-400 transition-colors text-left",children:"About Us"})}),We.jsx("li",{children:We.jsx("button",{onClick:()=>e("/privacy"),className:"hover:text-indigo-400 transition-colors text-left",children:"Privacy Policy"})}),We.jsx("li",{children:We.jsx("button",{onClick:()=>e("/terms"),className:"hover:text-indigo-400 transition-colors text-left",children:"Terms of Service"})}),We.jsx("li",{children:We.jsx("a",{href:"mailto:syncly19@gmail.com",className:"hover:text-indigo-400 transition-colors",children:"Contact Support"})})]})]})]}),We.jsx("div",{className:"border-t border-gray-800 pt-8",children:We.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0",children:[We.jsx("p",{className:"text-sm text-center md:text-left",children:" 2025 Syncly. All rights reserved. Built with  for teams worldwide."}),We.jsxs("div",{className:"flex items-center space-x-6",children:[We.jsx("a",{href:"https://twitter.com",target:"_blank",rel:"noopener noreferrer",className:"hover:text-indigo-400 transition-colors","aria-label":"Twitter",children:We.jsx("i",{className:"fab fa-twitter text-xl"})}),We.jsx("a",{href:"https://linkedin.com",target:"_blank",rel:"noopener noreferrer",className:"hover:text-indigo-400 transition-colors","aria-label":"LinkedIn",children:We.jsx("i",{className:"fab fa-linkedin text-xl"})}),We.jsx("a",{href:"mailto:syncly19@gmail.com",className:"hover:text-indigo-400 transition-colors","aria-label":"Email",children:We.jsx("i",{className:"fas fa-envelope text-xl"})})]})]})})]})}),r&&We.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center px-4 py-6",children:[We.jsx("div",{className:"absolute inset-0 bg-slate-900/70 backdrop-blur-sm",onClick:()=>i(!1)}),We.jsxs("div",{className:"relative w-full max-w-2xl bg-white rounded-3xl shadow-2xl border border-indigo-50 p-8 space-y-6 animate-fade-in-up",children:[We.jsxs("div",{className:"flex items-start justify-between",children:[We.jsxs("div",{children:[We.jsx("p",{className:"text-sm uppercase tracking-[0.3em] text-indigo-400",children:"Live Demo"}),We.jsx("h3",{className:"text-2xl font-extrabold text-gray-900 mt-2",children:"See Syncly in action"}),We.jsx("p",{className:"text-gray-600 mt-2",children:"Share a few details and our team will reach out within one business day to schedule your personalised walkthrough."})]}),We.jsx("button",{onClick:()=>i(!1),className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close demo form",children:We.jsx("i",{className:"fas fa-times text-xl"})})]}),u&&We.jsx("div",{className:"rounded-2xl border border-red-100 bg-red-50 text-red-700 px-4 py-3 text-sm",children:u}),We.jsxs("form",{onSubmit:async e=>{e.preventDefault(),m("");const{name:t,email:n,contactNumber:a,companyName:s,companySize:r}=x;if(t&&n&&a&&s&&r){c(!0);try{await dg({name:t.trim(),email:n.trim(),contactNumber:a.trim(),companyName:s.trim(),companySize:r}),i(!1),y({name:"",email:"",contactNumber:"",companyName:"",companySize:"1-10"}),f("Thanks! Our solutions team will reach out within the next few hours."),setTimeout(()=>f(""),6e3)}catch(l){m(l.message||"Something went wrong. Please try again in a moment.")}finally{c(!1)}}else m("Please complete all fields so we can schedule your session.")},className:"space-y-4",children:[We.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[We.jsxs("div",{children:[We.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-1.5",children:"Name"}),We.jsx("input",{type:"text",value:x.name,onChange:v("name"),className:"w-full rounded-2xl border border-gray-200 px-4 py-3 focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Jane Doe",required:!0})]}),We.jsxs("div",{children:[We.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-1.5",children:"Work Email"}),We.jsx("input",{type:"email",value:x.email,onChange:v("email"),className:"w-full rounded-2xl border border-gray-200 px-4 py-3 focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"jane@company.com",required:!0})]})]}),We.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[We.jsxs("div",{children:[We.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-1.5",children:"Contact Number"}),We.jsx("input",{type:"tel",value:x.contactNumber,onChange:v("contactNumber"),className:"w-full rounded-2xl border border-gray-200 px-4 py-3 focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"+1 555 123 4567",required:!0})]}),We.jsxs("div",{children:[We.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-1.5",children:"Company Name"}),We.jsx("input",{type:"text",value:x.companyName,onChange:v("companyName"),className:"w-full rounded-2xl border border-gray-200 px-4 py-3 focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Acme Corp",required:!0})]})]}),We.jsxs("div",{children:[We.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-1.5",children:"Company Size"}),We.jsx("select",{value:x.companySize,onChange:v("companySize"),className:"w-full rounded-2xl border border-gray-200 px-4 py-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-white",required:!0,children:["1-10","11-50","51-200","201-500","500+"].map(e=>We.jsxs("option",{value:e,children:[e," employees"]},e))})]}),We.jsxs("div",{className:"rounded-2xl bg-indigo-50 px-4 py-3 text-sm text-indigo-700 flex items-center space-x-2",children:[We.jsx("i",{className:"fas fa-bolt"}),We.jsx("p",{children:"We reply fast: expect an email or call within a few hours."})]}),We.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 pt-2",children:[We.jsx("p",{className:"text-sm text-gray-500",children:"By submitting, you agree to receive updates about Syncly. We respect your inbox."}),We.jsx("button",{type:"submit",disabled:o,className:"inline-flex items-center justify-center px-6 py-3 rounded-2xl font-semibold text-white bg-gradient-to-r from-indigo-600 to-purple-600 shadow-lg hover:shadow-xl disabled:opacity-60 transition-all duration-300",children:o?We.jsxs(We.Fragment,{children:[We.jsx("span",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Booking your slot..."]}):We.jsxs(We.Fragment,{children:["Schedule My Demo",We.jsx("i",{className:"fas fa-arrow-right ml-2"})]})})]})]})]})]}),We.jsx("style",{children:"\n        @keyframes float {\n          0%, 100% { transform: translateY(0px) translateX(0px); }\n          50% { transform: translateY(-20px) translateX(20px); }\n        }\n\n        @keyframes fadeInUp {\n          from { opacity: 0; transform: translateY(20px); }\n          to { opacity: 1; transform: translateY(0); }\n        }\n\n        .animate-fade-in-up {\n          animation: fadeInUp 0.35s ease forwards;\n        }\n        \n        @keyframes float-delayed {\n          0%, 100% { transform: translateY(0px) translateX(0px); }\n          50% { transform: translateY(-30px) translateX(-20px); }\n        }\n        \n        @keyframes float-slow {\n          0%, 100% { transform: translateY(0px) translateX(0px) scale(1); }\n          50% { transform: translateY(20px) translateX(30px) scale(1.1); }\n        }\n        \n        .animate-float {\n          animation: float 8s ease-in-out infinite;\n        }\n        \n        .animate-float-delayed {\n          animation: float-delayed 10s ease-in-out infinite;\n        }\n        \n        .animate-float-slow {\n          animation: float-slow 12s ease-in-out infinite;\n        }\n\n        @keyframes slideInToast {\n          from { opacity: 0; transform: translateY(10px); }\n          to { opacity: 1; transform: translateY(0); }\n        }\n\n        .animate-slide-in {\n          animation: slideInToast 0.35s ease forwards;\n        }\n\n        @keyframes fadeSlide {\n          from {\n            opacity: 0;\n            transform: translateY(30px);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n        \n        .fade-slide {\n          animation: fadeSlide 0.8s ease-out forwards;\n          opacity: 0;\n        }\n\n        html {\n          scroll-behavior: smooth;\n        }\n\n        @media (prefers-reduced-motion: reduce) {\n          * {\n            animation-duration: 0.01ms !important;\n            animation-iteration-count: 1 !important;\n            transition-duration: 0.01ms !important;\n          }\n        }\n      "}),Sy&&h&&We.jsx(Ty,{variant:"landing",currentUser:null,onDeactivate:()=>g(!1)})]})},Iy=[{label:"B",command:"bold",tooltip:"Bold"},{label:"I",command:"italic",tooltip:"Italic"},{label:"U",command:"underline",tooltip:"Underline"}],Dy=({label:e,value:t,onChange:n,placeholder:a})=>{const s=l.useRef(null);l.useEffect(()=>{s.current&&s.current.innerHTML!==t&&(s.current.innerHTML=t||"")},[t]);const r=(e,t)=>{var n;document.execCommand(e,!1,t),null==(n=s.current)||n.focus()},i=()=>{var e;const t=(null==(e=s.current)?void 0:e.innerHTML)||"";n(t)};return We.jsxs("div",{className:"space-y-2",children:[e&&We.jsx("label",{className:"text-sm font-semibold text-slate-600 dark:text-slate-200",children:e}),We.jsxs("div",{className:"flex flex-wrap items-center gap-2 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900/40 px-3 py-2",children:[Iy.map(e=>We.jsx("button",{type:"button",title:e.tooltip,className:"w-8 h-8 rounded-md bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-200 text-sm font-semibold hover:bg-primary/10",onClick:()=>r(e.command),children:e.label},e.command)),We.jsxs("select",{className:"h-8 rounded-md bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-200 text-sm px-2",onChange:e=>{const t=e.target.value;"paragraph"===t&&r("formatBlock","P"),"h1"===t&&r("formatBlock","H1"),"h2"===t&&r("formatBlock","H2"),e.target.value=""},defaultValue:"",children:[We.jsx("option",{value:"",disabled:!0,children:"Format"}),We.jsx("option",{value:"paragraph",children:"Paragraph"}),We.jsx("option",{value:"h1",children:"Heading"}),We.jsx("option",{value:"h2",children:"Subheading"})]}),We.jsxs("select",{className:"h-8 rounded-md bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-200 text-sm px-2",onChange:e=>{const t=e.target.value;t&&r("fontSize",t),e.target.value=""},defaultValue:"",children:[We.jsx("option",{value:"",disabled:!0,children:"Size"}),We.jsx("option",{value:"2",children:"Small"}),We.jsx("option",{value:"3",children:"Normal"}),We.jsx("option",{value:"4",children:"Large"}),We.jsx("option",{value:"5",children:"X-Large"})]})]}),We.jsx("div",{ref:s,contentEditable:!0,className:"min-h-[180px] rounded-2xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900/40 px-4 py-3 text-slate-700 dark:text-slate-100 focus:outline-none focus:ring-2 focus:ring-primary/40","data-placeholder":a,onInput:i,onBlur:i})]})},Oy=e=>{const t=new Date(e);return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}T${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`},Ry=({isOpen:e,onClose:t,onSubmit:n,businessUnits:a,users:s,announcement:r})=>{var i;const[o,c]=l.useState(""),[d,u]=l.useState(""),[m,p]=l.useState("all"),[f,h]=l.useState([]),[g,x]=l.useState([]),[y,b]=l.useState(Oy(Date.now())),[v,N]=l.useState(Oy(Date.now()+864e5)),[w,k]=l.useState(!1),[E,j]=l.useState([]),[C,_]=l.useState(!1),[T,S]=l.useState(!1),[A,I]=l.useState(null),[D,O]=l.useState("edit"),[R,P]=l.useState(null),M=l.useMemo(()=>Object.fromEntries(a.map(e=>[e.id,e])),[a]),U=l.useMemo(()=>Object.fromEntries(s.map(e=>[e.id,e])),[s]);l.useEffect(()=>{if(!r)return c(""),u(""),p("all"),h([]),x([]),b(Oy(Date.now())),N(Oy(Date.now()+864e5)),k(!1),j([]),I(null),O("edit"),void P(null);c(r.title),u(Wx(r.content)),p(r.targetType),h(r.targetBusinessUnitIds||[]),x(r.targetUserIds||[]),b(Oy(r.startsAt)),N(Oy(r.endsAt)),k(!!r.requireAcknowledgement),j(r.media||[]),I(null),O("edit"),P(null)},[r]),l.useEffect(()=>{e||(O("edit"),P(null),I(null))},[e]);const L=l.useMemo(()=>Wx(d||""),[d]),F=()=>{const e=o.trim();if(!e)return I("Title is required."),null;const t=Wx(d||"");if(!(t.replace(/<style[^>]*>.*?<\/style>/gim,"").replace(/<[^>]*>/g,"").replace(/&nbsp;/gi," ").replace(/\s+/g,"").trim().length>0))return I("Content cannot be empty."),null;const n=new Date(y).getTime(),a=new Date(v).getTime();return Number.isNaN(n)||Number.isNaN(a)||a<=n?(I("End time must be after the start time."),null):"businessUnits"===m&&0===f.length?(I("Select at least one business unit."),null):"users"===m&&0===g.length?(I("Select at least one recipient."),null):{title:e,content:t,targetType:m,targetBusinessUnitIds:f,targetUserIds:g,startsAt:n,endsAt:a,requireAcknowledgement:w,media:E}},B=()=>{C||(P(null),O("edit"),I(null),t())},$=(e,t)=>{t(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},G="businessUnits"===m,V="users"===m,z=R?(e=>{if("all"===e.targetType)return{headline:"Entire organization",detail:"Every active employee will receive this update."};if("businessUnits"===e.targetType){const t=e.targetBusinessUnitIds||[],n=t.map(e=>{var t;return null==(t=M[e])?void 0:t.name}).filter(Boolean);return{headline:`${t.length} business unit${1===t.length?"":"s"}`,detail:n.length?n.join(", "):"Selected business units"}}const t=e.targetUserIds||[],n=t.map(e=>{var t,n;return(null==(t=U[e])?void 0:t.name)||(null==(n=U[e])?void 0:n.email)||e}).filter(Boolean),a=n.slice(0,3).join(", ");return{headline:`${t.length} individual${1===t.length?"":"s"}`,detail:n.length?`${a}${n.length>3?"...":""}`:"Selected users"}})(R):null;return We.jsx(Dh,{isOpen:e,onClose:B,title:r?"Edit Announcement":"Create Announcement",size:"xl",footer:We.jsxs("div",{className:"flex flex-wrap justify-end gap-3",children:[We.jsx(_h,{variant:"ghost",onClick:B,disabled:C,children:"Cancel"}),"review"===D?We.jsxs(We.Fragment,{children:[We.jsx(_h,{variant:"secondary",onClick:()=>{P(null),O("edit"),I(null)},disabled:C,children:"Back to editing"}),We.jsx(_h,{variant:"primary",onClick:async()=>{const e=R||F();if(e){_(!0),I(null);try{await n(e,r),P(null),O("edit"),t()}catch(a){I((null==a?void 0:a.message)||"Unable to save the announcement.")}finally{_(!1)}}},isLoading:C,children:r?"Finalize Update":"Finalize & Publish"})]}):We.jsx(_h,{variant:"primary",onClick:()=>{const e=F();e&&(P(e),O("review"),I(null))},isLoading:C,disabled:T,children:"Review Final Preview"})]}),children:We.jsxs("div",{className:"space-y-4",children:[A&&We.jsx("div",{className:"px-4 py-2 rounded-lg bg-red-50 text-red-600 text-sm dark:bg-red-500/10 dark:text-red-300",children:A}),"review"===D&&R?We.jsxs("div",{className:"space-y-6",children:[We.jsxs("div",{className:"rounded-3xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900/60 p-6 shadow-xl",children:[We.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-start md:justify-between",children:[We.jsxs("div",{children:[We.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.4em] text-slate-400",children:"Final Preview"}),We.jsx("h2",{className:"mt-2 text-2xl font-semibold text-slate-900 dark:text-slate-100",children:R.title}),We.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:["Active ",qt(new Date(R.startsAt))," -"," ",qt(new Date(R.endsAt))]})]}),R.requireAcknowledgement&&We.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-amber-100 px-3 py-1 text-xs font-semibold text-amber-700 dark:bg-amber-500/20 dark:text-amber-200",children:[We.jsx("i",{className:"fas fa-shield-check"}),"Acknowledgement required"]})]}),We.jsx("div",{className:"mt-6 prose prose-slate dark:prose-invert max-w-none",dangerouslySetInnerHTML:{__html:R.content}}),R.media&&R.media.length>0&&We.jsx("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:R.media.map(e=>We.jsxs("figure",{className:"overflow-hidden rounded-2xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900",children:[We.jsx("img",{src:e.storageUrl,alt:e.caption,className:"w-full h-48 object-cover"}),e.caption&&We.jsx("figcaption",{className:"px-4 py-2 text-xs text-slate-500 dark:text-slate-400",children:e.caption})]},e.id))})]}),We.jsxs("div",{className:"grid gap-4 rounded-2xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900/40 p-4 md:grid-cols-3",children:[We.jsxs("div",{children:[We.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-slate-400",children:"Audience"}),We.jsx("p",{className:"text-base font-semibold text-slate-800 dark:text-slate-100",children:null==z?void 0:z.headline}),We.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:null==z?void 0:z.detail})]}),We.jsxs("div",{children:[We.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-slate-400",children:"Schedule"}),We.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:["Starts ",qt(new Date(R.startsAt)),We.jsx("br",{}),"Ends ",qt(new Date(R.endsAt))]})]}),We.jsxs("div",{children:[We.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-slate-400",children:"Media"}),We.jsxs("p",{className:"text-base font-semibold text-slate-800 dark:text-slate-100",children:[(null==(i=R.media)?void 0:i.length)||0," item(s)"]}),We.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:R.media&&R.media.length>0?"Images render below the body.":"No media attached."})]})]}),We.jsx("p",{className:"text-xs text-center text-slate-500 dark:text-slate-400",children:"This is the exact announcement experience employees will receive once you finalize."})]}):We.jsxs(We.Fragment,{children:[We.jsx(Ch,{label:"Title",value:o,onChange:e=>c(e.target.value),placeholder:"E.g., FY26 Leave Policy Updates"}),We.jsx(Dy,{label:"Body",value:d,onChange:u,placeholder:"Write the announcement details..."}),We.jsxs("div",{children:[We.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-slate-400 mb-2",children:"Preview"}),We.jsx("div",{className:"rounded-2xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800/40 p-4 prose prose-slate dark:prose-invert max-w-none",dangerouslySetInnerHTML:{__html:L||'<p class="text-slate-400">Start typing to preview.</p>'}})]}),We.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[We.jsxs("div",{children:[We.jsx("label",{className:"text-sm font-semibold text-slate-600 dark:text-slate-200",children:"Starts At"}),We.jsx("input",{type:"datetime-local",className:"mt-1 w-full rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 px-3 py-2 text-sm",value:y,onChange:e=>b(e.target.value)})]}),We.jsxs("div",{children:[We.jsx("label",{className:"text-sm font-semibold text-slate-600 dark:text-slate-200",children:"Ends At"}),We.jsx("input",{type:"datetime-local",className:"mt-1 w-full rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 px-3 py-2 text-sm",value:v,onChange:e=>N(e.target.value)})]})]}),We.jsxs("div",{className:"space-y-2",children:[We.jsx("p",{className:"text-sm font-semibold text-slate-600 dark:text-slate-200",children:"Audience"}),We.jsx("div",{className:"flex flex-wrap gap-3",children:["all","businessUnits","users"].map(e=>We.jsxs("button",{className:"px-4 py-2 rounded-full text-sm font-semibold border transition "+(m===e?"bg-primary text-white border-primary":"border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-300"),onClick:()=>p(e),type:"button",children:["all"===e&&"Everyone","businessUnits"===e&&"Business Units","users"===e&&"Specific Users"]},e))}),G&&We.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:a.map(e=>We.jsx("button",{type:"button",className:"px-3 py-1 rounded-full border text-xs font-semibold "+(f.includes(e.id)?"bg-emerald-100 text-emerald-700 border-emerald-200 dark:bg-emerald-500/20 dark:text-emerald-200":"border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-300"),onClick:()=>$(e.id,h),children:e.name},e.id))}),V&&We.jsx("div",{className:"mt-3 max-h-48 overflow-y-auto rounded-xl border border-slate-200 dark:border-slate-700 p-3 space-y-1 bg-slate-50 dark:bg-slate-900/40",children:s.map(e=>We.jsxs("label",{className:"flex items-center gap-2 text-sm text-slate-600 dark:text-slate-300",children:[We.jsx("input",{type:"checkbox",className:"rounded border-slate-300 text-primary focus:ring-primary",checked:g.includes(e.id),onChange:()=>$(e.id,x)}),We.jsx("span",{children:e.name}),We.jsxs("span",{className:"text-xs text-slate-400",children:["(",e.businessUnitName||"Unassigned",")"]})]},e.id))})]}),We.jsxs("div",{className:"flex items-center justify-between border rounded-xl p-3 bg-slate-50 dark:bg-slate-800/40 border-slate-200 dark:border-slate-700",children:[We.jsxs("label",{className:"flex items-center gap-3 text-sm font-semibold text-slate-600 dark:text-slate-200",children:[We.jsx("input",{type:"checkbox",checked:w,onChange:e=>k(e.target.checked),className:"rounded border-slate-300 text-primary focus:ring-primary"}),"Require acknowledgement"]}),We.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Users must confirm before the banner disappears."})]}),We.jsxs("div",{className:"space-y-2",children:[We.jsx("label",{className:"text-sm font-semibold text-slate-600 dark:text-slate-200",children:"Images"}),We.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:async e=>{if(e.target.files&&e.target.files.length){S(!0);try{const t=await Promise.all(Array.from(e.target.files).map(async e=>{const t=`${Date.now()}_${e.name.replace(/[^a-zA-Z0-9.-]/g,"_")}`,{downloadUrl:n,storagePath:a}=await $h(e,"announcements",t);return{id:`${Date.now()}_${Math.random().toString(36).slice(2)}`,storageUrl:n,storagePath:a,caption:e.name}}));j(e=>[...e,...t])}catch(t){I("Unable to upload image. Please try again.")}finally{S(!1),e.target&&(e.target.value="")}}},disabled:T,className:"text-sm text-slate-500 file:mr-4 file:rounded-full file:border-0 file:bg-primary/10 file:text-primary file:px-4 file:py-2 file:text-sm hover:file:bg-primary/20"}),T&&We.jsx("p",{className:"text-xs text-slate-400",children:"Uploading..."}),E.length>0&&We.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:E.map(e=>We.jsxs("figure",{className:"relative rounded-xl overflow-hidden border border-slate-200 dark:border-slate-700",children:[We.jsx("img",{src:e.storageUrl,alt:e.caption,className:"w-full h-32 object-cover"}),We.jsx("button",{type:"button",className:"absolute top-2 right-2 w-7 h-7 rounded-full bg-slate-900/70 text-white text-xs",onClick:()=>j(t=>t.filter(t=>t.id!==e.id)),"aria-label":"Remove image",children:We.jsx("i",{className:"fas fa-times"})})]},e.id))})]})]})]})})},Py=()=>{const{currentUser:e}=Eh(),{addToast:t}=bh(),[n,a]=l.useState([]),[s,r]=l.useState([]),[i,o]=l.useState([]),[c,d]=l.useState({}),[u,m]=l.useState(!0),[p,f]=l.useState(!1),[h,g]=l.useState(null),x=l.useCallback(async()=>{m(!0);try{const[e,t,n]=await Promise.all([eh(),If(),Cf()]);a(e),r(t),o(n);const s=await Promise.all(e.map(async e=>{const t=await(async e=>{const t=await sf.getByAnnouncement(e),n=t.length,a=t.filter(e=>!!e.acknowledgedAt).length;return{totalViews:n,acknowledged:a,pendingAcknowledgements:n-a}})(e.id);return[e.id,t]}));d(Object.fromEntries(s))}catch(e){t("Unable to load announcements.","error")}finally{m(!1)}},[t]);l.useEffect(()=>{x()},[x]);const y=l.useMemo(()=>({active:n.filter(e=>"active"===e.status).length,scheduled:n.filter(e=>"scheduled"===e.status).length,expired:n.filter(e=>"expired"===e.status).length}),[n]),b=async n=>{if(!e)return;window.confirm(`Delete announcement "${n.title}"?`)&&(await(async(e,t)=>{const n=await th(e);n&&(await af.delete(e),await Ef({timestamp:Date.now(),actorId:t.id,actorName:t.name,type:dt.ANNOUNCEMENT_DELETED,description:`deleted announcement "${n.title}"`,targetId:e,targetName:n.title}),uf(),await eh())})(n.id,e),t("Announcement deleted.","info"),await x())},v=()=>{g(null),f(!0)};return u?We.jsx(Ah,{title:"Announcement Studio",children:We.jsx("div",{className:"flex justify-center py-20",children:We.jsx(Ph,{message:"Loading announcements..."})})}):We.jsxs(Ah,{title:"Announcement Studio",description:"Plan, schedule, and broadcast organization-wide updates with engagement insights.",action:We.jsxs(_h,{onClick:v,children:[We.jsx("i",{className:"fas fa-plus mr-2"}),"New Announcement"]}),children:[We.jsx(Ih,{className:"mb-6 bg-gradient-to-r from-primary/90 via-sky-500 to-cyan-500 text-white border-none shadow-xl",children:We.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[We.jsxs("div",{children:[We.jsx("p",{className:"text-xs uppercase tracking-[0.4em] opacity-80",children:"Broadcast"}),We.jsx("h2",{className:"text-2xl font-semibold mt-1",children:"Create your next announcement"}),We.jsx("p",{className:"opacity-80",children:"Target specific business units or everyone, add media, and schedule go-live / expiry times."})]}),We.jsxs(_h,{variant:"secondary",onClick:v,className:"bg-white text-primary hover:bg-white/90",children:[We.jsx("i",{className:"fas fa-plus mr-2"}),"Start drafting"]})]})}),We.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[We.jsxs(Ih,{className:"flex items-center gap-4",children:[We.jsx("div",{className:"w-12 h-12 rounded-2xl bg-emerald-100 text-emerald-600 flex items-center justify-center",children:We.jsx(ke,{size:20})}),We.jsxs("div",{children:[We.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Active"}),We.jsx("p",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100",children:y.active})]})]}),We.jsxs(Ih,{className:"flex items-center gap-4",children:[We.jsx("div",{className:"w-12 h-12 rounded-2xl bg-indigo-100 text-indigo-600 flex items-center justify-center",children:We.jsx(Oe,{size:20})}),We.jsxs("div",{children:[We.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Scheduled"}),We.jsx("p",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100",children:y.scheduled})]})]}),We.jsxs(Ih,{className:"flex items-center gap-4",children:[We.jsx("div",{className:"w-12 h-12 rounded-2xl bg-slate-200 text-slate-600 flex items-center justify-center",children:We.jsx(ye,{size:20})}),We.jsxs("div",{children:[We.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Expired"}),We.jsx("p",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100",children:y.expired})]})]})]}),We.jsx(Ih,{title:"All Announcements",children:0===n.length?We.jsxs("div",{className:"py-12 text-center text-slate-500 dark:text-slate-400 space-y-4",children:[We.jsx("p",{children:"No announcements yet. Click below to create your first message."}),We.jsxs(_h,{onClick:v,children:[We.jsx("i",{className:"fas fa-pen mr-2"}),"Create Announcement"]})]}):We.jsx("div",{className:"space-y-4",children:n.map(e=>{const t=c[e.id];return We.jsxs("div",{className:"p-4 border border-slate-100 dark:border-slate-800 rounded-2xl bg-white dark:bg-slate-900/60 shadow-sm hover:shadow-md transition",children:[We.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[We.jsxs("div",{children:[We.jsxs("div",{className:"flex items-center gap-3",children:[We.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-semibold "+("active"===e.status?"bg-emerald-100 text-emerald-700":"scheduled"===e.status?"bg-amber-100 text-amber-700":"bg-slate-100 text-slate-600"),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)}),e.requireAcknowledgement&&We.jsx("span",{className:"text-xs font-semibold text-primary",children:"Requires acknowledgement"})]}),We.jsx("h3",{className:"text-xl font-semibold text-slate-800 dark:text-slate-100 mt-2",children:e.title}),We.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:[qt(new Date(e.startsAt))," "," ",qt(new Date(e.endsAt))]})]}),We.jsxs("div",{className:"flex gap-2",children:[We.jsxs(_h,{variant:"ghost",onClick:()=>{g(e),f(!0)},children:[We.jsx(Re,{size:16,className:"mr-1"}),"Edit"]}),We.jsxs(_h,{variant:"ghost",className:"text-red-500",onClick:()=>b(e),children:[We.jsx(Pe,{size:16,className:"mr-1"}),"Delete"]})]})]}),We.jsx("div",{className:"prose prose-sm prose-slate dark:prose-invert mt-3 max-w-none",dangerouslySetInnerHTML:{__html:Wx(e.content)}}),e.media&&e.media.length>0&&We.jsx("div",{className:"mt-4 grid grid-cols-2 gap-3",children:e.media.slice(0,2).map(t=>We.jsxs("figure",{className:"rounded-xl overflow-hidden border border-slate-100 dark:border-slate-800",children:[We.jsx("img",{src:t.storageUrl,alt:t.caption||e.title,className:"w-full h-32 object-cover"}),t.caption&&We.jsx("figcaption",{className:"text-xs text-slate-500 dark:text-slate-400 px-3 py-1",children:t.caption})]},t.id))}),We.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-4 text-sm text-slate-500 dark:text-slate-400",children:[We.jsxs("span",{children:[We.jsx(Me,{className:"inline-block mr-1 text-emerald-500",size:16}),"Viewed: ",(null==t?void 0:t.totalViews)??0]}),We.jsxs("span",{children:[We.jsx(Me,{className:"inline-block mr-1 text-primary",size:16}),"Acknowledged: ",(null==t?void 0:t.acknowledged)??0]}),We.jsxs("span",{children:["Target: ","all"===e.targetType?"Everyone":e.targetType]})]})]},e.id)})})}),We.jsx(Ry,{isOpen:p,onClose:()=>{f(!1),g(null)},onSubmit:async(n,a)=>{e&&(a?(await(async(e,t,n)=>{const a=await th(e);if(!a)return null;const s=t?ff({...a,...t}):a,r=Date.now(),i={...a,title:void 0!==t.title?t.title.trim():a.title,content:t.content??a.content,targetType:t.targetType??a.targetType,targetBusinessUnitIds:void 0!==t.targetBusinessUnitIds?s.targetBusinessUnitIds:a.targetBusinessUnitIds,targetUserIds:void 0!==t.targetUserIds?s.targetUserIds:a.targetUserIds,startsAt:t.startsAt??a.startsAt,endsAt:t.endsAt??a.endsAt,requireAcknowledgement:t.requireAcknowledgement??a.requireAcknowledgement,media:t.media??a.media,updatedAt:r};i.status=mf(i,r),await af.update(e,i),await Ef({timestamp:r,actorId:n.id,actorName:n.name,type:dt.ANNOUNCEMENT_UPDATED,description:`updated announcement "${i.title}"`,targetId:i.id,targetName:i.title}),uf();const l=pf(i);return await eh(),"active"===l.status&&"active"!==a.status&&await ah(l,n),l})(a.id,n,e),t("Announcement updated successfully.","success")):(await(async(e,t)=>{const n=Up(),a=ff(e),s=cm("announce"),r=Date.now(),i={id:s,tenantId:n,title:a.title.trim(),content:a.content,targetType:a.targetType,targetBusinessUnitIds:a.targetBusinessUnitIds,targetUserIds:a.targetUserIds,startsAt:a.startsAt,endsAt:a.endsAt,status:mf({startsAt:a.startsAt,endsAt:a.endsAt},r),media:a.media,requireAcknowledgement:a.requireAcknowledgement??!1,createdBy:t.id,createdByName:t.name,createdAt:r,updatedAt:r};await af.create(s,i),await Ef({timestamp:r,actorId:t.id,actorName:t.name,type:dt.ANNOUNCEMENT_PUBLISHED,description:`published "${i.title}"`,targetId:i.id,targetName:i.title}),uf();const l=pf(i);return await eh(),"active"===l.status&&await ah(l,t),l})(n,e),t("Announcement published successfully.","success")),g(null),f(!1),await x())},businessUnits:s,users:i,announcement:h})]})},My=()=>{const{currentUser:e,hasPermission:t}=Eh();if(!e)return We.jsx(p,{to:"/login",replace:!0});const n=()=>(null==e?void 0:e.isPlatformAdmin)?We.jsx(hg,{}):t(Xe.CAN_MANAGE_USERS)?We.jsx(eg,{}):"HR"===(null==e?void 0:e.roleName)?We.jsx(Qg,{}):"Director"===(null==e?void 0:e.roleName)?We.jsx(Zg,{}):t(Xe.CAN_MANAGE_TEAM_REPORTS)?We.jsx(Wg,{}):We.jsx(cx,{});return We.jsxs(y,{children:[We.jsx(b,{path:"/",element:n()}),We.jsx(b,{path:"/dashboard",element:n()}),(null==e?void 0:e.isPlatformAdmin)&&We.jsx(b,{path:"/super-admin",element:We.jsx(hg,{})}),(null==e?void 0:e.isPlatformAdmin)&&We.jsx(b,{path:"/fix-users",element:We.jsx(hy,{})}),t(Xe.CAN_MANAGE_USERS)&&We.jsx(b,{path:"/user-management",element:We.jsx(tg,{})}),t(Xe.CAN_MANAGE_ROLES)&&We.jsx(b,{path:"/roles-permissions",element:We.jsx(rg,{})}),t(Xe.CAN_MANAGE_BUSINESS_UNITS)&&We.jsx(b,{path:"/manage-business-units",element:We.jsx(sg,{})}),t(Xe.CAN_VIEW_ALL_REPORTS)&&We.jsx(b,{path:"/all-reports",element:We.jsx(ng,{})}),t(Xe.CAN_MANAGE_USERS)&&We.jsx(b,{path:"/admin-trigger-log",element:We.jsx(ag,{})}),t(Xe.CAN_MANAGE_ALL_LEAVES)&&We.jsx(b,{path:"/admin/leave-records",element:We.jsx(Zx,{})}),"HR"===(null==e?void 0:e.roleName)&&We.jsx(b,{path:"/hr-dashboard",element:We.jsx(Qg,{})}),t(Xe.CAN_MANAGE_ANNOUNCEMENTS)&&We.jsx(b,{path:"/announcements",element:We.jsx(Py,{})}),t(Xe.CAN_MANAGE_TEAM_REPORTS)&&We.jsx(b,{path:"/manage-reports",element:We.jsx(qg,{})}),t(Xe.CAN_MANAGE_TEAM_REPORTS)&&We.jsx(b,{path:"/delinquent-reports",element:We.jsx(Hg,{})}),t(Xe.CAN_MANAGE_TEAM_TASKS)&&We.jsx(b,{path:"/team-tasks",element:We.jsx(Tx,{})}),t(Xe.CAN_USE_PERFORMANCE_HUB)&&We.jsx(b,{path:"/performance-hub",element:We.jsx(Yg,{})}),(t(Xe.CAN_USE_GOOGLE_CALENDAR)||t(Xe.CAN_USE_TELEGRAM_BOT))&&We.jsx(b,{path:"/integrations",element:We.jsx(dy,{})}),"Director"===(null==e?void 0:e.roleName)&&We.jsx(b,{path:"/director-dashboard",element:We.jsx(Zg,{})}),t(Xe.CAN_VIEW_OWN_REPORTS)&&We.jsx(b,{path:"/my-reports",element:We.jsx(dx,{})}),t(Xe.CAN_SUBMIT_OWN_EOD)&&We.jsx(b,{path:"/submit-eod/:forDate",element:We.jsx(ux,{})}),t(Xe.CAN_SUBMIT_OWN_EOD)&&We.jsx(b,{path:"/edit-eod/:reportId",element:We.jsx(mx,{})}),t(Xe.CAN_CREATE_PERSONAL_TASKS)&&We.jsx(b,{path:"/my-tasks",element:We.jsx(_x,{})}),t(Xe.CAN_VIEW_OWN_CALENDAR)&&We.jsx(b,{path:"/calendar-view",element:t(Xe.CAN_MANAGE_TEAM_REPORTS)?We.jsx(Kg,{}):We.jsx(px,{})}),t(Xe.CAN_USE_PERFORMANCE_HUB)&&We.jsx(b,{path:"/leaderboard",element:We.jsx(Ix,{})}),t(Xe.CAN_VIEW_OWN_MEETINGS)&&We.jsx(b,{path:"/meetings",element:We.jsx(ey,{})}),t(Xe.CAN_VIEW_OWN_MEETINGS)&&We.jsx(b,{path:"/meetings/:meetingId",element:We.jsx(cy,{})}),We.jsx(b,{path:"*",element:We.jsx(p,{to:"/",replace:!0})})]})},Uy=()=>{const{currentUser:e,isLoading:t}=Eh(),{addToast:n}=bh();return l.useEffect(()=>{rn();const e=()=>{n("Connection restored. Syncing pending actions...","info"),rn()};window.addEventListener("online",e);const t=tn.on("sync-complete",()=>{n(" Data synced successfully!","success")});return()=>{window.removeEventListener("online",e),t()}},[n]),We.jsxs(y,{children:[We.jsx(b,{path:"/",element:e?t?We.jsx("div",{className:"w-screen h-screen flex items-center justify-center bg-slate-100 dark:bg-slate-950",children:We.jsx(Ph,{message:"Loading..."})}):We.jsx(p,{to:"/dashboard",replace:!0}):We.jsx(Ay,{})}),We.jsx(b,{path:"/login",element:e?t?We.jsx("div",{className:"w-screen h-screen flex items-center justify-center bg-slate-100 dark:bg-slate-950",children:We.jsx(Ph,{message:"Loading..."})}):We.jsx(p,{to:"/dashboard",replace:!0}):We.jsx(Sh,{})}),We.jsx(b,{path:"/about",element:We.jsx(py,{})}),We.jsx(b,{path:"/privacy",element:We.jsx(my,{})}),We.jsx(b,{path:"/terms",element:We.jsx(uy,{})}),We.jsx(b,{path:"/*",element:e?We.jsx(Hx,{children:We.jsx(My,{})}):t?We.jsx("div",{className:"w-screen h-screen flex items-center justify-center bg-slate-100 dark:bg-slate-950",children:We.jsx(Ph,{message:"Loading..."})}):We.jsx(p,{to:"/",replace:!0})})]})},Ly=()=>(l.useEffect(()=>{(async()=>{try{await async function(){}(),(()=>{if(!localStorage.getItem(mt)){const e=At,t=Dt,n=Rt.map(n=>{const a=e.find(e=>e.id===n.businessUnitId),s=t.find(e=>e.id===n.roleId);return{...n,id:cm("user"),businessUnitName:null==a?void 0:a.name,roleName:null==s?void 0:s.name}});df(mt,n),df("eod_business_units",e),df("eod_roles",t);const a=n.find(e=>"manager.sales@mittaleod.com"===e.email),s=n.find(e=>"priya.mehta@mittaleod.com"===e.email),r=n.find(e=>"rohan.singh@mittaleod.com"===e.email),i=n.find(e=>"neha.patel@mittaleod.com"===e.email),l=n.find(e=>"alok.sharma@mittaleod.com"===e.email),o=n.find(e=>"vivek.kumar@mittaleod.com"===e.email);if(a&&s&&r&&i&&l&&o){const e=[],t=[],n=[],c=[],d=[],u=[],m=[],p=[],f=new Date,h=new Date(f.getTime()-36e5);let g=0;for(let r=15;r>=0&&g<12;r--){const t=new Date;if(t.setDate(f.getDate()-r),Zt(t,s.weeklyOffDay))continue;const n=new Date(t);n.setHours(18,30,0,0);const i=new Date(n.getTime()+72e5),l={id:cm("report"),employeeId:s.id,employeeName:s.name,date:Ht(t),versions:[{versionNumber:1,tasksCompleted:`- Completed daily client calls.\n- Prepared materials for ${1===r?"tomorrow's":"the next day's"} pitch.\n- Coordinated with marketing on campaign data.`,planForTomorrow:"- Follow up with new leads.",timestamp:n.getTime(),action:"submitted"}],status:tt.ACKNOWLEDGED,managerComments:"Good work.",isLate:!1,submittedAt:n.getTime(),acknowledgedByManagerId:a.id,acknowledgedAt:i.getTime()};e.push(l),g++,p.push({id:cm("act"),timestamp:l.submittedAt,actorId:s.id,actorName:s.name,type:dt.EOD_SUBMITTED,description:"submitted EOD report for",targetId:l.id,targetName:Wt(l.date)}),p.push({id:cm("act"),timestamp:l.acknowledgedAt,actorId:a.id,actorName:a.name,type:dt.EOD_ACKNOWLEDGED,description:`acknowledged ${s.name}'s EOD report for`,targetId:l.id,targetName:Wt(l.date),targetUserId:s.id,targetUserName:s.name})}m.push({id:cm("badge"),userId:s.id,badgeType:ct.TEN_DAY_STREAK,earnedDate:Ht(new Date),description:"Earned for a 10-day reporting streak."});const x=Yt(2),y=Yt(4),b={id:cm("report"),employeeId:r.id,employeeName:r.name,date:x,versions:[{versionNumber:1,tasksCompleted:"- Cold called 20 leads.\n- Onboarded new client.",timestamp:new Date(x+"T18:00:00").getTime(),action:"submitted"},{versionNumber:2,tasksCompleted:"- Cold called 25 potential leads.\n- Onboarded new client.\n- Updated CRM with contacts.",challengesFaced:"Initial data was incomplete.",timestamp:new Date(x+"T19:00:00").getTime(),action:"edited"}],status:tt.PENDING_ACKNOWLEDGMENT,isLate:!1,submittedAt:new Date(x+"T18:00:00").getTime()};e.push(b),p.push({id:cm("act"),timestamp:b.submittedAt,actorId:r.id,actorName:r.name,type:dt.EOD_SUBMITTED,description:"submitted EOD report for",targetId:b.id,targetName:Wt(b.date)}),p.push({id:cm("act"),timestamp:b.versions[1].timestamp,actorId:r.id,actorName:r.name,type:dt.EOD_EDITED,description:"edited EOD report for",targetId:b.id,targetName:Wt(b.date)});const v={id:cm("report"),employeeId:r.id,employeeName:r.name,date:y,versions:[{versionNumber:1,tasksCompleted:"- Followed up on all high-priority leads.",planForTomorrow:"- Start new campaign outreach.",timestamp:new Date(y+"T21:00:00").getTime(),action:"submitted"}],status:tt.ACKNOWLEDGED,managerComments:"Thanks for getting this in.",isLate:!0,submittedAt:new Date(y+"T21:00:00").getTime(),acknowledgedByManagerId:a.id,acknowledgedAt:new Date(y+"T22:00:00").getTime()};e.push(v),p.push({id:cm("act"),timestamp:v.submittedAt,actorId:r.id,actorName:r.name,type:dt.EOD_LATE_SUBMITTED,description:"submitted a late EOD report for",targetId:v.id,targetName:Wt(v.date),isCrucial:!0}),p.push({id:cm("act"),timestamp:v.acknowledgedAt,actorId:a.id,actorName:a.name,type:dt.EOD_ACKNOWLEDGED,description:`acknowledged ${r.name}'s EOD report for`,targetId:v.id,targetName:Wt(v.date),targetUserId:r.id,targetUserName:r.name});const N=Yt(1),w={id:cm("report"),employeeId:i.id,employeeName:i.name,date:N,versions:[{versionNumber:1,tasksCompleted:"- Finalized the social media schedule for next week.",timestamp:new Date(N+"T17:00:00").getTime(),action:"submitted"}],status:tt.ACKNOWLEDGED,managerComments:"Thanks for putting in the extra time!",isLate:!1,submittedAt:new Date(N+"T17:00:00").getTime(),acknowledgedByManagerId:a.id,acknowledgedAt:new Date(N+"T18:00:00").getTime(),submittedOnWeekOff:!0};e.push(w),p.push({id:cm("act"),timestamp:w.submittedAt,actorId:i.id,actorName:i.name,type:dt.EOD_SUBMITTED,description:"submitted EOD report for",targetId:w.id,targetName:Wt(w.date)});const k=Yt(1);if(!Zt(new Date(k.replace(/-/g,"/")),l.weeklyOffDay)){const t={id:cm("report"),employeeId:l.id,employeeName:l.name,date:k,versions:[{versionNumber:1,tasksCompleted:"- Conducted 5 product demos.\n- Finalized monthly sales report.",planForTomorrow:"- Follow up with leads from demos.",timestamp:new Date(k+"T18:00:00").getTime(),action:"submitted"}],status:tt.PENDING_ACKNOWLEDGMENT,isLate:!1,submittedAt:new Date(k+"T18:00:00").getTime()};e.push(t),p.push({id:cm("act"),timestamp:t.submittedAt,actorId:l.id,actorName:l.name,type:dt.EOD_SUBMITTED,description:"submitted EOD report for",targetId:t.id,targetName:Wt(t.date)})}if(!Zt(new Date(k.replace(/-/g,"/")),o.weeklyOffDay)){const t={id:cm("report"),employeeId:o.id,employeeName:o.name,date:k,versions:[{versionNumber:1,tasksCompleted:"- Analyzed campaign performance data.\n- Created new ad creatives.",challengesFaced:"Ad platform had a temporary outage.",timestamp:new Date(k+"T18:15:00").getTime(),action:"submitted"}],status:tt.PENDING_ACKNOWLEDGMENT,isLate:!1,submittedAt:new Date(k+"T18:15:00").getTime()};e.push(t),p.push({id:cm("act"),timestamp:t.submittedAt,actorId:o.id,actorName:o.name,type:dt.EOD_SUBMITTED,description:"submitted EOD report for",targetId:t.id,targetName:Wt(t.date)})}const E=Yt(3),j={id:cm("leave"),employeeId:l.id,employeeName:l.name,date:E,status:it.APPROVED,reason:"Personal Emergency",createdAt:new Date(E+"T09:00:00").getTime(),businessUnitId:l.businessUnitId,businessUnitName:l.businessUnitName};d.push(j),p.push({id:cm("act"),timestamp:j.createdAt,actorId:l.id,actorName:l.name,type:dt.LEAVE_MARKED_BY_EMPLOYEE,description:"marked leave for",targetId:j.id,targetName:Wt(j.date),isCrucial:!0});const C=Jt(5),_={id:cm("leave"),employeeId:o.id,employeeName:o.name,date:C,status:it.APPROVED,reason:"Vacation",createdAt:h.getTime(),businessUnitId:o.businessUnitId,businessUnitName:o.businessUnitName};d.push(_),p.push({id:cm("act"),timestamp:_.createdAt,actorId:o.id,actorName:o.name,type:dt.LEAVE_FUTURE_SCHEDULED_BY_EMPLOYEE,description:"scheduled future leave for",targetId:_.id,targetName:Wt(_.date)});const T={id:cm("task"),title:"Outline Q4 personal growth goals",description:"Review last quarter's performance and outline 3-5 key goals.",priority:nt.Medium,status:at.InProgress,dueDate:Jt(7),assignedTo:[s.id],createdBy:s.id,createdOn:new Date(Yt(2)).getTime(),updatedOn:new Date(Yt(2)).getTime(),taskType:st.Personal,isPersonalTask:!0,pinnedBy:[s.id]};t.push(T),p.push({id:cm("act"),timestamp:T.createdOn,actorId:s.id,actorName:s.name,type:dt.TASK_CREATED,description:'created a personal task: "Outline Q4 personal growth goals"',targetId:T.id,targetName:T.title});const S={id:cm("task"),title:"Follow up with XYZ Corp",description:"Contact John Doe at XYZ Corp regarding the new proposal.",priority:nt.High,status:at.Completed,dueDate:Yt(1),assignedTo:[r.id],memberProgress:{[r.id]:{status:at.Completed,completedAt:new Date(Yt(1)).getTime()}},createdBy:a.id,createdOn:new Date(Yt(4)).getTime(),updatedOn:new Date(Yt(1)).getTime(),taskType:st.Direct,isPersonalTask:!1,pinnedBy:[]};t.push(S),p.push({id:cm("act"),timestamp:S.createdOn,actorId:a.id,actorName:a.name,type:dt.TASK_CREATED,description:`assigned a task to ${r.name}:`,targetId:S.id,targetName:S.title,targetUserId:r.id,targetUserName:r.name});const A={id:cm("task"),title:"Q3 Sales Strategy Brainstorm",description:`Collaborate on a document to outline the sales strategy. @[Priya Mehta](${s.id}) is the lead.`,teamName:"Q3 Strategy Team",priority:nt.High,status:at.InProgress,dueDate:Jt(10),assignedTo:[s.id,r.id,i.id],memberProgress:{[s.id]:{status:at.InProgress},[r.id]:{status:at.Completed,completedAt:new Date(Yt(1)).getTime()},[i.id]:{status:at.NotStarted}},createdBy:a.id,createdOn:new Date(Yt(5)).getTime(),updatedOn:new Date(Yt(1)).getTime(),taskType:st.Team,isPersonalTask:!1,pinnedBy:[a.id],subTasks:[{title:"Analyze competitor data",completed:!0},{title:"Draft initial proposal points",completed:!1},{title:"Schedule follow-up meeting",completed:!1}]};t.push(A),p.push({id:cm("act"),timestamp:A.createdOn,actorId:a.id,actorName:a.name,type:dt.TASK_CREATED,description:"created a team task:",targetId:A.id,targetName:A.title});const I={id:cm("task"),title:"Prepare Q3 pitch deck",description:"Create the main presentation for the Q3 client pitch.",priority:nt.High,status:at.Completed,dueDate:Yt(5),assignedTo:[s.id],memberProgress:{[s.id]:{status:at.Completed,completedAt:new Date(Yt(5)).getTime()}},createdBy:a.id,createdOn:new Date(Yt(8)).getTime(),updatedOn:new Date(Yt(5)).getTime(),taskType:st.Direct,isPersonalTask:!1,pinnedBy:[]};t.push(I),p.push({id:cm("act"),timestamp:I.createdOn,actorId:a.id,actorName:a.name,type:dt.TASK_CREATED,description:`assigned a task to ${s.name}:`,targetId:I.id,targetName:I.title,targetUserId:s.id,targetUserName:s.name}),p.push({id:cm("act"),timestamp:I.memberProgress[s.id].completedAt,actorId:s.id,actorName:s.name,type:dt.TASK_COMPLETED,description:"completed the task:",targetId:I.id,targetName:I.title});const D={id:cm("task"),title:"Research Top 5 Competitors",description:"Compile a report on the top 5 competitors' latest marketing strategies.",priority:nt.Medium,status:at.Completed,dueDate:Yt(10),assignedTo:[l.id],memberProgress:{[l.id]:{status:at.Completed,completedAt:new Date(Yt(10)).getTime()}},createdBy:a.id,createdOn:new Date(Yt(15)).getTime(),updatedOn:new Date(Yt(10)).getTime(),taskType:st.Direct,isPersonalTask:!1,pinnedBy:[]};t.push(D),p.push({id:cm("act"),timestamp:D.createdOn,actorId:a.id,actorName:a.name,type:dt.TASK_CREATED,description:`assigned a task to ${l.name}:`,targetId:D.id,targetName:D.title,targetUserId:l.id,targetUserName:l.name}),p.push({id:cm("act"),timestamp:D.memberProgress[l.id].completedAt,actorId:l.id,actorName:l.name,type:dt.TASK_COMPLETED,description:"completed the task:",targetId:D.id,targetName:D.title});const O={id:cm("meet"),title:"Weekly Sales Sync",meetingDateTime:new Date(Yt(7)+"T10:00:00").getTime(),attendeeIds:[a.id,s.id,r.id,i.id,l.id,o.id],createdBy:a.id,createdAt:new Date(Yt(8)).getTime(),updatedAt:new Date(Yt(8)).getTime(),attendeeRsvps:{[a.id]:rt.ATTENDING,[s.id]:rt.ATTENDING,[r.id]:rt.ATTENDING},meetingType:"formal_meeting",agenda:"- Review weekly sales numbers\n- Discuss blockers\n- Plan for the upcoming week",recurrenceRule:"weekly",seenBy:[a.id,s.id],googleEventId:"test-google-event-id-123"};n.push(O),p.push({id:cm("act"),timestamp:O.createdAt,actorId:a.id,actorName:a.name,type:dt.MEETING_CREATED,description:"created a recurring meeting:",targetId:O.id,targetName:O.title});const R={id:cm("task"),title:"Update client pipeline from sync meeting",description:"As discussed, update the pipeline with the latest status for all active leads.",priority:nt.Medium,status:at.InProgress,dueDate:Jt(2),assignedTo:[s.id,r.id],createdBy:a.id,createdOn:new Date(Yt(7)+"T11:00:00").getTime(),updatedOn:new Date(Yt(7)+"T11:00:00").getTime(),taskType:st.Team,isPersonalTask:!1,pinnedBy:[],meetingId:O.id};t.push(R);const P={id:cm("inst"),seriesId:O.id,occurrenceDate:Yt(7),meetingMinutes:`Great sync today.\n\nPriya showcased the new deck.\n\nRohan has a new high-value lead.\n\n/task Update client pipeline from sync meeting due: in 2 days @[Priya Mehta](${s.id}) @[Rohan Singh](${r.id})`,taskIds:[R.id],finalizedAt:new Date(Yt(7)+"T11:00:00").getTime()};c.push(P),p.push({id:cm("act"),timestamp:P.finalizedAt,actorId:a.id,actorName:a.name,type:dt.MEETING_FINALIZED,description:`finalized the meeting session for "${O.title}" on`,targetId:O.id,targetName:Wt(P.occurrenceDate)});const M={id:cm("meet"),title:"Client Pitch Brainstorm",meetingDateTime:new Date(Yt(2)+"T15:00:00").getTime(),attendeeIds:[a.id,s.id],createdBy:a.id,createdAt:new Date(Yt(2)+"T15:00:00").getTime(),updatedAt:new Date(Yt(2)+"T15:00:00").getTime(),meetingType:"live_memo",seenBy:[]};n.push(M);const U={id:cm("task"),title:"Draft initial slides for new pitch deck",description:"",priority:nt.High,status:at.NotStarted,dueDate:Jt(4),assignedTo:[s.id],createdBy:a.id,createdOn:new Date(Yt(2)+"T15:30:00").getTime(),updatedOn:new Date(Yt(2)+"T15:30:00").getTime(),taskType:st.Direct,isPersonalTask:!1,pinnedBy:[],meetingId:M.id};t.push(U);const L={id:cm("inst"),seriesId:M.id,occurrenceDate:Yt(2),meetingMinutes:`Discussed the main value propositions.\n\n/task Draft initial slides for new pitch deck due: in 4 days @[Priya Mehta](${s.id})`,taskIds:[U.id],finalizedAt:new Date(Yt(2)+"T15:30:00").getTime()};c.push(L),u.push({id:cm("notif"),userId:s.id,message:`${a.name} assigned you to the team task: "${A.title}"`,timestamp:A.createdOn,read:!0,type:"info",link:`/my-tasks?taskId=${A.id}`}),u.push({id:cm("notif"),userId:a.id,message:`${r.name}'s report for ${Wt(b.date)} is pending your acknowledgment.`,timestamp:h.getTime(),read:!1,type:"reminder",link:"/manage-reports",actionType:"ACKNOWLEDGE_REPORT",targetId:b.id,actors:[{id:r.id,name:r.name}]}),u.push({id:cm("notif"),userId:s.id,message:`Meeting starting in 10 mins: "${O.title}"`,timestamp:f.getTime()-5e3,read:!1,type:"reminder",link:`/meetings/${O.id}`,isCrucial:!0}),df(pt,e),df(bt,t),df(wt,n),df(kt,c),df(ht,d),df(ft,u),df(xt,m);const F=[a,s,r,i,l,o];for(const a of F){const e=p.filter(e=>e.actorId===a.id||e.targetUserId===a.id||"manager"===a.roleId&&e.targetId&&(e.targetId.startsWith("task_")||e.targetId.startsWith("meet_"))).sort((e,t)=>t.timestamp-e.timestamp),t=Array.from(new Map(e.map(e=>[e.id,e])).values());df(`${yt}${a.id}`,t.slice(0,200))}}else df(pt,Pt),df(ft,Mt),df(ht,Lt),df(bt,Ut),df(wt,$t),df(kt,Gt),df(xt,Bt);df(gt,Ft)}})(),(async()=>{})()}catch(e){}})()},[]),We.jsx(fy,{children:We.jsxs(yh,{children:[We.jsx(x,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:We.jsx(kh,{children:We.jsx(Lg,{children:We.jsx(Uy,{})})})}),We.jsx(Yx,{})]})})),Fy=document.getElementById("root");if(!Fy)throw new Error("Root element not found");Qe.createRoot(Fy).render(We.jsx(o.StrictMode,{children:We.jsx(Ly,{})}));try{"production"==="production"&&"serviceWorker"in navigator&&window.location.origin===self.origin&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(e=>{}).catch(e=>{})})}catch(By){}
